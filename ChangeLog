2008-10-18  Bruno Haible  <bruno@clisp.org>

	* lib/atanl.c: Don't include isnanl.h.
	* lib/cosl.c: Likewise.
	* lib/ldexpl.c: Likewise.
	* lib/logl.c: Likewise.
	* lib/sinl.c: Likewise.
	* lib/sqrtl.c: Likewise.
	* lib/tanl.c: Likewise.

	Move the isnanf(), isnand(), isnanl() declarations to <math.h>.
	* lib/isnanf.h: Remove file.
	* lib/isnand.h: Remove file.
	* lib/isnanl.h: Remove file.
	* lib/math.in.h: Include the contents of lib/isnanf.h, lib/isnand.h,
	lib/isnanl.h. Use HAVE_ISNANF, HAVE_ISNAND, HAVE_ISNANL as substituted
	macros.
	* m4/isnanf.m4 (gl_FUNC_ISNANF): Require gl_MATH_H_DEFAULTS. Set
	HAVE_ISNANF, don't define it as a C macro.
	* m4/isnand.m4 (gl_FUNC_ISNAND): Require gl_MATH_H_DEFAULTS. Set
	HAVE_ISNAND, don't define it as a C macro.
	* m4/isnanl.m4 (gl_FUNC_ISNANL): Require gl_MATH_H_DEFAULTS. Set
	HAVE_ISNANL, don't define it as a C macro.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_ISNAN[FDL] and
	HAVE_ISNAN[FDL].
	* modules/isnanf (Files): Remove lib/isnanf.h.
	(Depends-on): Add math.
	(configure.ac): Invoke gl_MATH_MODULE_INDICATOR.
	(Include): Specify <math.h> instead of isnanf.h.
	* modules/isnand (Files): Remove lib/isnand.h.
	(Depends-on): Add math.
	(configure.ac): Invoke gl_MATH_MODULE_INDICATOR.
	(Include): Specify <math.h> instead of isnand.h.
	* modules/isnanl (Files): Remove lib/isnanl.h.
	(Depends-on): Add math.
	(configure.ac): Invoke gl_MATH_MODULE_INDICATOR.
	(Include): Specify <math.h> instead of isnanl.h.
	* modules/math (Makefile.am): Substitute GNULIB_ISNAN[FDL] and
	HAVE_ISNAN[FDL].
	* tests/test-isnanf.c: Include <math.h> instead of isnanf.h.
	* tests/test-isnand.c: Include <math.h> instead of isnand.h.
	* tests/test-isnanl.c: Include <math.h> instead of isnanl.h.
	* NEWS: Mention the change.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	Add getusershell(), setusershell(), endusershell() declarations to
	<unistd.h>.
	* lib/unistd.in.h (getusershell, setusershell, endusershell): New
	declarations.
	* lib/getusershell.c: Include unistd.h.
	* m4/getusershell.m4 (gl_FUNC_GETUSERSHELL): Require
	gl_UNISTD_H_DEFAULTS and AC_USE_SYSTEM_EXTENSIONS. Set
	HAVE_GETUSERSHELL.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize GNULIB_GETUSERSHELL
	and HAVE_GETUSERSHELL.
	* modules/getusershell (Depends-on): Add unistd, extensions.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.
	(Include): Specify <unistd.h>.
	* modules/unistd (Makefile.am): Substitute GNULIB_GETUSERSHELL and
	HAVE_GETUSERSHELL.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	Add a getloadavg() declaration to <stdlib.h>.
	* lib/stdlib.in.h; Include <sys/loadavg.h> when needed for the
	getloadavg declaration.
	(getloadavg): New declaration.
	* lib/getloadavg.c: Include <stdlib.h> first.
	* m4/getloadavg.m4 (gl_GETLOADAVG): Require gl_STDLIB_H_DEFAULTS and
	AC_USE_SYSTEM_EXTENSIONS. Test whether sys/loadavg.h exists. Set
	HAVE_SYS_LOADAVG_H and HAVE_DECL_GETLOADAVG.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Initialize GNULIB_GETLOADAVG,
	HAVE_SYS_LOADAVG_H, HAVE_DECL_GETLOADAVG.
	* modules/getloadavg (Depends-on): Add stdlib, extensions.
	(configure.ac): Invoke gl_STDLIB_MODULE_INDICATOR.
	(Include): Specify <stdlib.h>.
	* modules/stdlib (Makefile.am): Substitute GNULIB_GETLOADAVG,
	HAVE_SYS_LOADAVG_H, HAVE_DECL_GETLOADAVG.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	* lib/dirchownmod.c: Don't include lchmod.h.

	Move the lchmod() declaration to <sys/stat.h>.
	* lib/lchmod.h: Remove file.
	* lib/sys_stat.in.h: Add placeholder for GL_LINK_WARNING.
	(lchmod): New declaration, moved here from lib/lchown.h.
	* m4/lchmod.m4 (gl_FUNC_LCHMOD): Require gl_SYS_STAT_H_DEFAULTS and
	AC_USE_SYSTEM_EXTENSIONS. Set HAVE_LCHMOD.
	* m4/sys_stat_h.m4 (gl_SYS_STAT_H_DEFAULTS): Initialize GNULIB_LCHMOD
	and HAVE_LCHMOD.
	* modules/lchmod (Files): Remove lib/lchmod.h.
	(Depends-on): Add sys_stat, extensions.
	(configure.ac): Invoke gl_SYS_STAT_MODULE_INDICATOR.
	(Include): Specify <sys/stat.h> instead of lchmod.h.
	* modules/sys_stat (Depends-on): Add link-warning.
	(Makefile.am): Substitute GNULIB_LCHMOD, HAVE_LCHMOD, and the
	definition of GL_LINK_WARNING.
	* NEWS: Mention the change.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	* lib/fchdir.c: Don't include dirfd.h.
	* lib/fts.c: Likewise.
	* lib/getcwd.c: Likewise.
	* lib/glob.c: Likewise.

	Move the dirfd() declaration to <dirent.h>.
	* lib/dirfd.h: Remove file.
	* lib/dirent.in.h: Add placeholder for GL_LINK_WARNING.
	(dirfd): New declaration.
	* lib/dirfd.c: Include <dirent.h> instead of dirfd.h.
	* m4/dirfd.m4 (gl_FUNC_DIRFD): Require gl_DIRENT_H_DEFAULTS and
	AC_USE_SYSTEM_EXTENSIONS. Invoke gl_REPLACE_DIRENT_H. Set
	HAVE_DECL_DIRFD.
	* m4/dirent_h.m4 (gl_DIRENT_H_DEFAULTS): Initialize GNULIB_DIRFD and
	HAVE_DECL_DIRFD.
	* modules/dirfd (Files): Remove lib/dirfd.h.
	(Depends-on): Add dirent, extensions.
	(configure.ac): Invoke gl_DIRENT_MODULE_INDICATOR.
	(Include): Specify <dirent.h> instead of dirfd.h.
	* modules/dirent (Depends-on): Add link-warning.
	(Makefile.am): Substitute GNULIB_DIRFD, HAVE_DECL_DIRFD, and
	definition of GL_LINK_WARNING.
	* NEWS: Mention the change.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	Move the euidaccess() declaration to <unistd.h>.
	* lib/euidaccess.h: Remove file.
	* lib/unistd.in.h (euidaccess): New declaration.
	* lib/euidaccess.c: Don't include euidaccess.h.
	* m4/euidaccess.m4 (gl_FUNC_EUIDACCESS): Require gl_UNISTD_H_DEFAULTS.
	Don't check whether euidaccess is declared. Set HAVE_EUIDACCESS.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize GNULIB_EUIDACCESS
	and HAVE_EUIDACCESS.
	* modules/euidaccess (Files): Remove lib/euidaccess.h.
	(Depends-on): Add unistd.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.
	(Include): Specify <unistd.h> instead of euidaccess.h.
	* modules/unistd (Makefile.am): Substitute GNULIB_EUIDACCESS and
	HAVE_EUIDACCESS.
	* NEWS: Mention the change.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	* lib/xgetdomainname.c: Include <unistd.h> instead of getdomainname.h.

	Move the getdomainname() declaration to <unistd.h>.
	* lib/getdomainname.h: Remove file.
	* lib/unistd.in.h (getdomainname): New declaration.
	* lib/getdomainname.c: Include <unistd.h> instead of getdomainname.h.
	* m4/getdomainname.m4 (gl_FUNC_GETDOMAINNAME): Require
	gl_UNISTD_H_DEFAULTS and AC_USE_SYSTEM_EXTENSIONS. Set
	HAVE_GETDOMAINNAME.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize
	GNULIB_GETDOMAINNAME and HAVE_GETDOMAINNAME.
	* modules/getdomainname (Files): Remove lib/getdomainname.h.
	(Depends-on): Add unistd, extensions.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.
	(Includes): Specify <unistd.h> instead of getdomainname.h.
	* modules/unistd (Makefile.am): Substitute GNULIB_GETDOMAINNAME and
	HAVE_GETDOMAINNAME.
	* NEWS: Mention the change.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	* modules/dirent: New file.
	* m4/dirent_h.m4: New file.
	* m4/fchdir.m4 (gl_FUNC_FCHDIR): Require gl_DIRENT_H_DEFAULTS.
	Invoke gl_REPLACE_DIRENT_H. Don't assign DIRENT_H directly.
	* modules/fchdir (Files): Remove lib/dirent.in.h.
	(Depends-on): Add dirent.
	(Makefile.am): Move rules to modules/dirent.
	* doc/posix-headers/dirent.texi: Mention the new module.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	Avoid -Wunused-parameter warnings in public gnulib header files.
	* m4/gnulib-common.m4 (gl_COMMON_BODY): Define _UNUSED_PARAMETER_ as a
	macro.
	* lib/unistr.h (u32_mbtouc_unsafe, u32_mbtouc): Use it.

2008-10-18  Bruno Haible  <bruno@clisp.org>

	* doc/glibc-functions/dirfd.texi: Mention the module 'dirfd'.
	* doc/glibc-functions/error.texi: Mention the module 'error'.
	* doc/glibc-functions/euidaccess.texi: Mention the module 'euidaccess'.
	* doc/glibc-functions/getdomainname.texi: Mention the module
	'getdomainname'.
	* doc/glibc-functions/getloadavg.texi: Mention the module 'getloadavg'.
	* doc/glibc-functions/getpagesize.texi: Mention the module
	'getpagesize'.
	* doc/glibc-functions/getusershell.texi: Mention the module
	'getusershell'.
	* doc/glibc-functions/isnanl.texi: Mention the module 'isnanl'.
	* doc/glibc-functions/lchmod.texi: Mention the module 'lchmod'.
	* doc/glibc-functions/mempcpy.texi: Mention the module 'mempcpy'.
	* doc/glibc-functions/memrchr.texi: Mention the module 'memrchr'.
	* doc/glibc-functions/mkdtemp.texi: Mention the module 'mkdtemp'.
	* doc/glibc-functions/rpmatch.texi: Mention the module 'rpmatch'.
	* doc/glibc-functions/stpcpy.texi: Mention the module 'stpcpy'.
	* doc/glibc-functions/stpncpy.texi: Mention the module 'stpncpy'.
	* doc/glibc-functions/strchrnul.texi: Mention the module 'strchrnul'.
	* doc/glibc-functions/strndup.texi: Mention the module 'strndup'.
	* doc/glibc-functions/strnlen.texi: Mention the module 'strnlen'.
	* doc/glibc-functions/strsep.texi: Mention the module 'strsep'.
	* doc/glibc-functions/timegm.texi: Mention the module 'timegm'.
	* doc/glibc-functions/vasprintf.texi: Mention the module 'vasprintf'.

2008-10-17  Bruno Haible  <bruno@clisp.org>

	* m4/signbit.m4 (gl_SIGNBIT_TEST_PROGRAM): On platforms other than
	HP-UX and IRIX, use -0.0L.
	* tests/test-ceill.c (minus_zero): Likewise.
	* tests/test-floorl.c (minus_zero): Likewise.
	* tests/test-frexpl.c (minus_zero): Likewise.
	* tests/test-isnan.c (minus_zerol): Likewise.
	* tests/test-isnanl.h (minus_zero): Likewise.
	* tests/test-ldexpl.c (minus_zero): Likewise.
	* tests/test-roundl.c (minus_zero): Likewise.
	* tests/test-signbit.c (minus_zerol): Likewise.
	* tests/test-snprintf-posix.h (minus_zerol): Likewise.
	* tests/test-sprintf-posix.h (minus_zerol): Likewise.
	* tests/test-truncl.c (minus_zero): Likewise.
	* tests/test-vasnprintf-posix.c (minus_zerol): Likewise.
	* tests/test-vasprintf-posix.c (minus_zerol): Likewise.
	Reported by Markus Armbruster <armbru@redhat.com> via Jim Meyering
	and by Nelson H. F. Beebe <beebe@math.utah.edu> via Eric Blake.

2008-10-17  Bruno Haible  <bruno@clisp.org>

	Avoid gcc warnings because of #pragma GCC system_header on older gcc.
	* lib/arpa_inet.in.h: Encloses reference to PRAGMA_SYSTEM_HEADER so
	that it gets activated only for gcc >= 3.0.
	* lib/dirent.in.h: Likewise.
	* lib/errno.in.h: Likewise.
	* lib/fcntl.in.h: Likewise.
	* lib/float.in.h: Likewise.
	* lib/iconv.in.h: Likewise.
	* lib/inttypes.in.h: Likewise.
	* lib/locale.in.h: Likewise.
	* lib/math.in.h: Likewise.
	* lib/netdb.in.h: Likewise.
	* lib/netinet_in.in.h: Likewise.
	* lib/search.in.h: Likewise.
	* lib/signal.in.h: Likewise.
	* lib/spawn.in.h: Likewise.
	* lib/stdarg.in.h: Likewise.
	* lib/stdint.in.h: Likewise.
	* lib/stdio.in.h: Likewise.
	* lib/stdlib.in.h: Likewise.
	* lib/string.in.h: Likewise.
	* lib/strings.in.h: Likewise.
	* lib/sys_file.in.h: Likewise.
	* lib/sys_ioctl.in.h: Likewise.
	* lib/sys_select.in.h: Likewise.
	* lib/sys_socket.in.h: Likewise.
	* lib/sys_stat.in.h: Likewise.
	* lib/sys_time.in.h: Likewise.
	* lib/sysexits.in.h: Likewise.
	* lib/time.in.h: Likewise.
	* lib/unistd.in.h: Likewise.
	* lib/wchar.in.h: Likewise.
	* lib/wctype.in.h: Likewise.
	Reported by Yoann Vandoorselaere <yoann.v@prelude-ids.com>.

2008-10-17  Jim Meyering  <meyering@redhat.com>

	ignore-value: don't depend on inline module
	* modules/ignore-value (Depends-on): Remove 'inline'.
	(configure.ac): Instead, add AC_REQUIRE([AC_C_INLINE]) here.
	Suggestion from Bruno Haible.

2008-10-17  Bruno Haible  <bruno@clisp.org>

	New implementation of condition variables for Win32.
	* lib/glthread/cond.h (struct gl_waitqueue_link): New type.
	(gl_linked_waitqueue_t): New type.
	(gl_cond_t): Use it.
	* lib/glthread/cond.c (struct gl_waitqueue_element): New type.
	(gl_waitqueue_init, gl_waitqueue_add, gl_waitqueue_remove,
	gl_waitqueue_notify_first, gl_waitqueue_notify_all): New functions.
	(glthread_cond_init_func, glthread_cond_wait_func,
	glthread_cond_timedwait_func, glthread_cond_signal_func,
	glthread_cond_broadcast_func, glthread_cond_destroy_func):
	Reimplemented on the basis of gl_linked_waitqueue_t.
	* lib/glthread/lock.h (gl_carray_waitqueue_t): Renamed from
	gl_waitqueue_t.
	(gl_rwlock_t): Update.
	* lib/glthread/lock.c (gl_waitqueue_t): Alias to gl_carray_waitqueue_t.

2008-10-17  Simon Josefsson  <simon@josefsson.org>

	* modules/recvfrom (Depends-on): Add dependency on getpeername.
	Reported by Yoann Vandoorselaere <yoann@prelude-ids.org>.

2008-10-17  Jim Meyering  <meyering@redhat.com>

	ignore-value: new module
	* modules/ignore-value: New file.
	* lib/ignore-value.h: New file.
	* MODULES.html.sh (Compiler warning management): New section,
	just for this module.  More to come.

2008-10-16  Paul Eggert  <eggert@cs.ucla.edu>

	open-safer.c: avoid 'signed and unsigned in conditional...' warning
	* lib/open-safer.c (open_safer): Use an "if/else" statement in place
	of the ternary operator.  Reported by Reuben Thomas <rrt@sc3d.org>.

2008-10-16  Jim Meyering  <meyering@redhat.com>

	openat-die.c: avoid 'no previous prototype' warning
	* lib/openat-die.c: Include "openat.h".
	Reported by Reuben Thomas <rrt@sc3d.org>.

2008-10-16  Simon Josefsson  <simon@josefsson.org>

	* m4/netdb_h.m4: Assume that if netdb.h exists, it works.
	* lib/netdb.in.h: Fix typo.
	Reported by Bruno Haible  <bruno@clisp.org>

	* lib/netdb.in.h: Include sys/socket.h for platforms without
	netdb.h, to get structures like hostent on MinGW.
	* modules/netdb (Depends-on): Add sys_socket.

2008-10-15  Simon Josefsson  <simon@josefsson.org>

	* modules/netdb, modules/netdb-tests: New file.
	* m4/netdb_h.m4: New file.
	* lib/netdb.in.h: Add, currently just an empty file pending
	definitions.
	* tests/test-netdb.c: New file.
	* doc/posix-headers/netdb.texi: Mention that we replace it if
	needed.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add
	netdb.

2008-10-15  Simon Josefsson  <simon@josefsson.org>

	* doc/gnulib.texi (Getaddrinfo and WINVER): Sync documentation
	with code.

2008-10-13  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/cond.c (glthread_cond_wait_func,
	glthread_cond_timedwait_func): Add a comment.

2008-10-13  Yoann Vandoorselaere  <yoann@prelude-ids.org>

	* tests/test-poll.c: Include <sys/ioctl.h>, for ioctl().
	* tests/test-select.c: Likewise,

2008-10-13  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/cond.c (glthread_cond_wait_func,
	glthread_cond_timedwait_func): Fix variable name.
	Reported by Yoann Vandoorselaere <yoann@prelude-ids.org>.

2008-10-13  Paolo Bonzini  <bonzini@gnu.org>

	fix getaddrinfo emulation for systems with struct sockaddr.sa_len
	* m4/getaddrinfo.m4 (gl_PREREQ_GETADDRINFO): Detect
	struct sockaddr.sa_len.
	* lib/getaddrinfo.c (getaddrinfo): Set it if appropriate.

2008-10-13  Simon Josefsson  <simon@josefsson.org>

	* build-aux/pmccabe2html: Add css and css_url parameters.

2008-10-12  Bruno Haible  <bruno@clisp.org>

	* tests/test-sameacls.c (main) [AIX]: Clear type argument before
	calling aclx_get.
	Reported by Rainer Tammer <tammer@tammer.net>.

2008-10-12  Bruno Haible  <bruno@clisp.org>

	Use msvcrt aware primitives for creation/termination of Win32 threads.
	* lib/glthread/thread.c: Include <process.h>.
	(glthread_create_func): Use _beginthreadex instead of CreateThread.
	(wrapper_func): Update signature.
	(gl_thread_exit_func): Use _endthreadex instead of EndThread.

2008-10-11  Yoann Vandoorselaere  <yoann@prelude-ids.org>
            Bruno Haible  <bruno@clisp.org>

	Provide a Win32 implementation of the 'cond' module.
	* lib/glthread/cond.h [USE_WIN32]: New implementation.
	* lib/glthread/cond.c (glthread_cond_init_func,
	glthread_cond_wait_func, glthread_cond_timedwait_func,
	glthread_cond_signal_func, glthread_cond_broadcast_func,
	glthread_cond_destroy_func) [USE_WIN32]: New functions.
	* modules/cond (Dependencies): Add gettimeofday.

2008-10-11  Bruno Haible  <bruno@clisp.org>

	Make sleep work on older versions of mingw.
	* m4/sleep.m4 (gl_FUNC_SLEEP): Test whether 'sleep' is declared, not
	only whether it exists.
	* doc/posix-functions/sleep.texi: Mention the problem with older
	versions of mingw.

2008-10-11  Bruno Haible  <bruno@clisp.org>

	New module 'shutdown'.
	* modules/shutdown: New file.
	* lib/sys_socket.in.h (shutdown): New declaration.
	* lib/winsock.c (shutdown): New function.
	* m4/sys_socket_h.m4 (gl_SYS_SOCKET_H_DEFAULTS): Initialize
	GNULIB_SHUTDOWN.
	* modules/sys_socket (Makefile.am): Substitute GNULIB_SHUTDOWN.
	* doc/posix-functions/shutdown.texi: Document the new module.

2008-10-11  Jim Meyering  <meyering@redhat.com>

	* lib/fclose.c: Fix typo in comment: s/close/fclose/.

2008-10-11  Bruno Haible  <bruno@clisp.org>

	New module 'fclose'.
	* modules/fclose: New file.
	* lib/stdio.in.h (fclose): New declaration.
	* lib/fclose.c: New file.
	* m4/fclose.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Initialize GNULIB_FCLOSE,
	REPLACE_FCLOSE.
	* m4/close.m4 (gl_REPLACE_CLOSE): Invoke gl_REPLACE_FCLOSE.
	* modules/stdio (Makefile.am): Substitute GNULIB_FCLOSE,
	REPLACE_FCLOSE.
	* modules/close (Depends-on): fclose.
	* doc/posix-functions/fclose.texi: Mention the problem on Windows.

2008-10-11  Bruno Haible  <bruno@clisp.org>

	* lib/winsock.c (_gl_close_fd_maybe_socket): If closesocket fails,
	set errno and don't call _close.

2008-10-10  Bruno Haible  <bruno@clisp.org>

	* lib/copy-acl.c (qcopy_acl) [CYGWIN]: Call chmod before setting the
	ACL, not afterwards. Fixes test failure on Cygwin.

2008-10-09  Ben Pfaff  <blp@gnu.org>

	* build-aux/announce-gen: Fix gnulib version related part of usage
	message.  Die with a useful error message if no tarballs are
	found.

2008-10-10  Jim Meyering  <meyering@redhat.com>

	bootstrap: use git's --depth=N option only if it's supported
	* build-aux/bootstrap: Work with git-1.4.4.4, which does not
	recognize the --depth option.  Reported by Pádraig Brady.

2008-10-09  Bruno Haible  <bruno@clisp.org>

	New module 'ioctl'.
	* modules/ioctl: New file.
	* lib/sys_socket.in.h (ioctl): Remove declaration.
	* lib/winsock.c: Include <sys/ioctl.h>.
	(rpl_ioctl): Define only of the gnulib module 'ioctl' is present.
	* m4/sys_socket_h.m4 (gl_PREREQ_SYS_H_WINSOCK2): Require
	gl_SYS_IOCTL_H_DEFAULTS. Set also SYS_IOCTL_H_HAVE_WINSOCK2_H.
	* modules/sys_socket (Files): Add m4/sys_ioctl_h.m4.
	* doc/posix-functions/ioctl.texi: Mention the new module.

2008-10-09  Bruno Haible  <bruno@clisp.org>

	New module 'sys_ioctl'.
	* lib/sys_ioctl.in.h: New file.
	* m4/sys_ioctl_h.m4: New file.
	* modules/sys_ioctl: New file.
	* doc/glibc-headers/sys_ioctl.texi: Mention the new module.

2008-10-09  Bruno Haible  <bruno@clisp.org>

	* lib/sys_socket.in.h (ioctl): Make signature POSIX compliant.
	* lib/winsock.c: Include <stdarg.h>.
	(rpl_ioctl): Change to second argument 'int' and then varargs.

2008-10-09  Bruno Haible  <bruno@clisp.org>

	* m4/close.m4 (gl_FUNC_CLOSE): Arrange to replace the close() function
	when the sys_socket module is present and the system has <winsock2.h>.

2008-10-09  Bruno Haible  <bruno@clisp.org>

	* doc/posix-functions/close.texi: Mention module 'close' instead of
	module 'sys_socket'.

2008-10-09  Bruno Haible  <bruno@clisp.org>

	* doc/glibc-headers/sys_ioctl.texi: New file.
	* doc/gnulib.texi: Include it.

2008-10-09  Paolo Bonzini  <bonzini@gnu.org>
            Bruno Haible  <bruno@clisp.org>

	Combine the two replacements of 'close'.
	* lib/sys_socket.in.h (close): Define to a reminder to include
	<unistd.h>.
	(_gl_close_fd_maybe_socket): New declaration.
	(HAVE__GL_CLOSE_FD_MAYBE_SOCKET): New macro.
	* lib/winsock.c (close): Remove undefinition.
	(_gl_close_fd_maybe_socket): Renamed from rpl_close. Define only when
	needed for the gnulib module 'close'.
	* lib/unistd.in.h (close): If the gnulib module 'close' is not used,
	define to an error symbol or to a warning, if suitable.
	* lib/close.c: Include <sys/socket.h>.
	(rpl_close): Invoke _gl_close_fd_maybe_socket when gnulib defines it.
	* m4/sys_socket_h.m4 (gl_PREREQ_SYS_H_WINSOCK2): Set also
	UNISTD_H_HAVE_WINSOCK2_H.
	(gl_SYS_SOCKET_H_DEFAULTS): Require gl_UNISTD_H_DEFAULTS.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize
	UNISTD_H_HAVE_WINSOCK2_H.
	* modules/sys_socket (Files): Add m4/unistd_h.m4.
	(configure.ac): Set a module indicator.
	(Makefile.am): Substitute GNULIB_CLOSE.
	* modules/unistd (Makefile.am): Substitute UNISTD_H_HAVE_WINSOCK2_H.
	* modules/poll-tests (Depends-on): Add close.
	* modules/select-tests (Depends-on): Likewise.

2008-10-09  Paolo Bonzini  <bonzini@gnu.org>
            Bruno Haible  <bruno@clisp.org>

	New module 'close'.
	* modules/close: New file.
	* lib/unistd.in.h (close): Move declaration out of the
	FCHDIR_REPLACEMENT scope.
	(_gl_unregister_fd): New declaration.
	* lib/close.c: New file.
	* lib/fchdir.c (rpl_close): Remove function.
	* m4/close.m4: New file.
	* m4/fchdir.m4 (gl_FUNC_FCHDIR): When replacing fchdir, also replace
	close.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize GNULIB_CLOSE and
	REPLACE_CLOSE.
	* modules/unistd (Makefile.am): Substitute GNULIB_CLOSE and
	REPLACE_CLOSE.
	* modules/fchdir (Depends-on): Add close.

2008-10-09  Paolo Bonzini  <bonzini@gnu.org>
            Bruno Haible  <bruno@clisp.org>

	* lib/fcntl.in.h (open): Simplify conditionals.
	(_gl_register_fd): New declaration.
	* lib/fchdir.c (rpl_open): Remove function.
	* lib/open.c: When FCHDIR_REPLACEMENT is defined, compile the file
	also.
	(open): When FCHDIR_REPLACEMENT is defined, invoke _gl_register_fd.
	* m4/fchdir.m4 (gl_FUNC_FCHDIR): When replacing fchdir, also replace
	open.

2008-10-09  Jim Meyering  <meyering@redhat.com>

	GNUmakefile: use the more name-space-friendly "_version"
	* top/GNUmakefile (_dummy): Update.
	(_version): Rename from "version".

2008-10-09  Paolo Bonzini  <bonzini@gnu.org>
            Bruno Haible  <bruno@clisp.org>

	* lib/fchdir.c (_gl_unregister_fd): New functions, extracted from
	rpl_close.
	(_gl_register_fd): New function, extracted from rpl_open.
	(rpl_close, rpl_closedir): Use _gl_unregister_fd.
	(rpl_open, rpl_opendir): Use _gl_register_fd.

2008-10-09  Paolo Bonzini  <bonzini@gnu.org>

	Fix organization of 'open' replacement.
	* m4/open.m4 (gl_REPLACE_OPEN): New macro.
	(gl_FUNC_OPEN): Use it.
	(gl_PREREQ_OPEN): Add a : to make the body non-empty.

2008-10-08  Bruno Haible  <bruno@clisp.org>

	* modules/getdate-tests (test_getdata_LDADD): Add LIBINTL.

2008-10-08  Simon Josefsson  <simon@josefsson.org>

	* m4/sys_socket_h.m4: Don't AC_LIBOBJ(winsock).  The file is
	AC_LIBOBJ'ed by each gnulib module that needs it (e.g., socket,
	listen).

2008-10-08  Eric Blake  <ebb9@byu.net>

	GNUmakefile: add 'make version' target
	* top/GNUmakefile (_curr-ver): Split version update rules...
	(version): ...into a target.

2008-10-07  Bruno Haible  <bruno@clisp.org>

	Use a more portable replacement expression for -0.0L.
	* m4/signbit.m4 (gl_SIGNBIT_TEST_PROGRAM): Use -LDBL_MIN * LDBL_MIN
	instead of -0.0L. Fix m4 quotation.

	* tests/test-signbit.c: Include <float.h>.
	(minus_zero): New variable.
	(test_signbitl): Use minus_zero instead of -zero.
	* modules/signbit-tests (Depends-on): Add float.

	* tests/test-ceill.c: Include <float.h>.
	(zero): Remove variable.
	(minus_zero): New variable.
	(main): Use minus_zero instead of -zero.
	* modules/ceill-tests (Depends-on): Add float.

	* tests/test-floorl.c: Include <float.h>.
	(zero): Remove variable.
	(minus_zero): New variable.
	(main): Use minus_zero instead of -zero.
	* modules/floorl-tests (Depends-on): Add float.

	* tests/test-roundl.c: Include <float.h>.
	(zero): Remove variable.
	(minus_zero): New variable.
	(main): Use minus_zero instead of -zero.
	* modules/roundl-tests (Depends-on): Add float.

	* tests/test-truncl.c: Include <float.h>.
	(zero): Remove variable.
	(minus_zero): New variable.
	(main): Use minus_zero instead of -zero.
	* modules/truncl-tests (Depends-on): Add float.

	* tests/test-frexpl.c (zero): Remove variable.
	(minus_zero): New variable.
	(main): Use minus_zero instead of -zero.
	* modules/frexpl-tests (Depends-on): Add float.

	* tests/test-isnan.c (zerol): Remove variable.
	(minus_zerol): New variable.
	(test_long_double): Use minus_zerol instead of -zerol.
	* modules/isnan-tests (Depends-on): Add float.

	* tests/test-isnanl.h (zero): Remove variable.
	(minus_zero): New variable.
	(main): Use minus_zero instead of -zero.
	* modules/isnanl-nolibm-tests (Depends-on): Add float.
	* modules/isnanl-tests (Depends-on): Add float.

	* tests/test-ldexpl.c (zero): Remove variable.
	(minus_zero): New variable.
	(main): Use minus_zero instead of -zero.
	* modules/ldexpl-tests (Depends-on): Add float.

	* tests/test-snprintf-posix.h (zerol): Remove variable.
	(minus_zerol): New variable.
	(test_function): Use minus_zerol instead of -zerol.
	* modules/snprintf-posix-tests (Depends-on): Add float.
	* modules/vsnprintf-posix-tests (Depends-on): Add float.

	* tests/test-sprintf-posix.h (zerol): Remove variable.
	(minus_zerol): New variable.
	(test_function): Use minus_zerol instead of -zerol.
	* modules/sprintf-posix-tests (Depends-on): Add float.
	* modules/vsprintf-posix-tests (Depends-on): Add float.

	* tests/test-vasnprintf-posix.c (zerol): Remove variable.
	(minus_zerol): New variable.
	(test_function): Use minus_zerol instead of -zerol.
	* modules/vasnprintf-posix-tests (Depends-on): Add float.

	* tests/test-vasprintf-posix.c (zerol): Remove variable.
	(minus_zerol): New variable.
	(test_function): Use minus_zerol instead of -zerol.
	* modules/vasprintf-posix-tests (Depends-on): Add float.

2008-10-07  Simon Josefsson  <simon@josefsson.org>

	* MODULES.html.sh (Support for building documentation): Mention
	pmccabe2html.  Sort entries.

	Add pmccabe2html module, from gnupdf.
	* build-aux/pmccabe.css: New file.
	* build-aux/pmccabe2html: New file.
	* m4/pmccabe2html.m4: New file.
	* modules/pmccabe2html: New file.

2008-10-07  Richard W.M. Jones <rjones@redhat.com>

	flock: new module
	* MODULES.html.sh: Add to list of modules.
	* lib/flock.c: flock implementation for Windows and Unix systems
	which have fcntl.
	* doc/glibc-functions/flock.texi: Update documentation.
	* lib/sys_file.in.h: <sys/file.h> header file.
	* m4/flock.m4: M4 macros.
	* m4/sys_file_h.m4: M4 macros for replacement sys/file.h.
	* modules/flock: flock module.
	* modules/flock-tests: flock tests module.
	* modules/sys_file: sys/file.h module.
	* tests/test-flock.c: test suite for flock.

2008-10-06  Jim Meyering  <meyering@redhat.com>

	bootstrap: check for LT_INIT more portably still ;-)
	* build-aux/bootstrap: Don't rely on \>, since it's not portable.
	Spotted by Bruno Haible.

2008-10-06  Eric Blake  <ebb9@byu.net>

	test-signbit: avoid tripping Irix cc bug on -0.0L
	* tests/test-signbit.c (minus_zerol): Delete, and replace with
	'-zerol'.  This may break on HP-UX/hppa, but at least makes the
	entire testsuite consistent and avoids an Irix 6.2 bug.

2008-10-05  Bruno Haible  <bruno@clisp.org>
	    Jim Meyering  <jim@meyering.net>

	Add an option for ignoring EPIPE during close_stdout.
	* lib/closeout.h: Include <stdbool.h>.
	(close_stdout_set_ignore_EPIPE): New declaration.
	* lib/closeout.c: Include <stdbool.h>.
	(ignore_EPIPE): New variable.
	(close_stdout_set_ignore_EPIPE): New function.
	(close_stdout): Ignore EPIPE error if ignore_EPIPE is set.
	* lib/close-stream.c (close_stream): Mention the possible EPIPE
	failure.
	* modules/closeout (Depends-on): Add stdbool.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* modules/accept: New file.
	* modules/bind: New file.
	* modules/connect: New file.
	* modules/getpeername: New file.
	* modules/getsockname: New file.
	* modules/getsockopt: New file.
	* modules/listen: New file.
	* modules/recv: New file.
	* modules/recvfrom: New file.
	* modules/send: New file.
	* modules/sendto: New file.
	* modules/setsockopt: New file.
	* modules/socket: New file.
	* lib/sys_socket.in.h: Include the GL_LINK_WARNING definition.
	(socket, connect, accept, bind, getpeername, getsockname, getsockopt,
	listen, recv, send, recvfrom, sendto, setsockopt): Declare only when
	the particular module is requested. Add a link warning when the
	particular module is not requested.
	* lib/winsock.c (rpl_socket, rpl_connect, rpl_accept, rpl_bind,
	rpl_getpeername, rpl_getsockname, rpl_getsockopt, rpl_listen, rpl_recv,
	rpl_send, rpl_recvfrom, rpl_sendto, rpl_setsockopt): Define only when
	the particular module is requested.
	* m4/sys_socket_h.m4 (gl_SYS_SOCKET_MODULE_INDICATOR,
	gl_SYS_SOCKET_H_DEFAULTS): New macros.
	(gl_HEADER_SYS_SOCKET): Require gl_SYS_SOCKET_H_DEFAULTS.
	* modules/sys_socket (Depends-on): Add link-warning.
	(Makeifle.am): Substitute GNULIB_SOCKET, GNULIB_CONNECT, GNULIB_ACCEPT,
	GNULIB_BIND, GNULIB_GETPEERNAME, GNULIB_GETSOCKNAME, GNULIB_GETSOCKOPT,
	GNULIB_LISTEN, GNULIB_RECV, GNULIB_SEND, GNULIB_RECVFROM,
	GNULIB_SENDTO, GNULIB_SETSOCKOPT, and the definition of
	GL_LINK_WARNING.
	* doc/posix-functions/accept.texi: Mention the new module 'accept'.
	* doc/posix-functions/bind.texi: Mention the new module 'bind'.
	* doc/posix-functions/connect.texi: Mention the new module 'connect'.
	* doc/posix-functions/getpeername.texi: Mention the new module
	'getpeername'.
	* doc/posix-functions/getsockname.texi: Mention the new module
	'getsockname'.
	* doc/posix-functions/getsockopt.texi: Mention the new module
	'getsockopt'.
	* doc/posix-functions/listen.texi: Mention the new module 'listen'.
	* doc/posix-functions/recv.texi: Mention the new module 'recv'.
	* doc/posix-functions/recvfrom.texi: Mention the new module 'recvfrom'.
	* doc/posix-functions/send.texi: Mention the new module 'send'.
	* doc/posix-functions/sendto.texi: Mention the new module 'sendto'.
	* doc/posix-functions/setsockopt.texi: Mention the new module
	'setsockopt'.
	* doc/posix-functions/socket.texi: Mention the new module 'socket'.
	* modules/poll-tests (Depends-on): Add socket, bind, getsockopt,
	listen, connect, accept.
	* modules/select-tests (Depends-on): Likewise.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* lib/winsock.c (strerror): Remove unused #undef.
	(rpl_close): Remove unused local variable.

	* modules/sys_socket (Depends-on); Add errno.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* lib/sys_select.in.h: Include the GL_LINK_WARNING definition.
	(select): Add a link warning when the 'select' module is not used.
	* modules/sys_select (Depends-on): Add link-warning.
	(Makefile.am): Substitute the definition of GL_LINK_WARNING.
	Suggested by Paolo Bonzini.

2008-10-05  Jim Meyering  <meyering@redhat.com>

	bootstrap: check for LT_INIT more portably
	* build-aux/bootstrap: Avoid using grep -E, since it's not
	portable enough.  Suggestion from Bruno Haible.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* doc/posix-headers/sys_select.texi: Mention 'struct timeval' problem
	as being fixed by gnulib.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* modules/select-tests: New file, mostly copied from
	modules/sys_select-tests.
	* tests/test-select.c: New file, mostly copied from
	tests/test-sys_select.c.
	* tests/test-sys_select.c: Move most of the code to tests/test-select.c.
	* modules/sys_select-tests (Depends-on): Remove all dependencies.
	(Makefile.am): Remove test_sys_select_LDADD.

	* lib/sys_select.in.h (select): If GNULIB_SELECT is not set, define it
	to an undefined symbol, for an error message.
	* m4/sys_select_h.m4 (gl_SYS_SELECT_MODULE_INDICATOR): New macro.
	(gl_SYS_SELECT_H_DEFAULTS): New macro.
	(gl_HEADER_SYS_SELECT): Require it. Don't require compilation of
	winsock-select.c here.
	* modules/sys_select (Files): Remove lib/winsock-select.c.
	(Depends-on): Remove alloca.
	(Makefile.am): Substitute GNULIB_SELECT.
	* modules/select: New file.
	* doc/posix-functions/select.texi: Update.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* lib/spawn_faction_addclose.c (__sysconf): Use getdtablesize always.
	* lib/spawn_faction_adddup2.c (__sysconf): Likewise.
	* lib/spawn_faction_addopen.c (__sysconf): Likewise.
	* modules/posix_spawn_file_actions_addclose (Depends-on): Add
	getdtablesize.
	* modules/posix_spawn_file_actions_adddup2 (Depends-on): Likewise.
	* modules/posix_spawn_file_actions_addopen (Depends-on): Likewise.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* modules/getdtablesize-tests: New file.
	* tests/test-getdtablesize.c: New file.

	New module 'getdtablesize'.
	* lib/unistd.in.h (getdtablesize): New declaration.
	* lib/getdtablesize.c: New file.
	* m4/getdtablesize.m4: New file.
	* modules/getdtablesize: New file.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize
	GNULIB_GETDTABLESIZE, HAVE_GETDTABLESIZE.
	* modules/unistd (Makefile.am): Substitute GNULIB_GETDTABLESIZE,
	HAVE_GETDTABLESIZE.
	* doc/glibc-functions/getdtablesize.texi: Mention the new module.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* modules/sched (Makefile.am): Fix typo.
	Reported by Simon Josefsson.

2008-10-05  Jim Meyering  <meyering@redhat.com>

	bootstrap: check for LT_INIT, too
	* build-aux/bootstrap: Both AC_PROG_LIBTOOL and AM_PROG_LIBTOOL
	are deprecated.  Suggestion from Ralf Wildenhues.

2008-10-05  Bruno Haible  <bruno@clisp.org>

	* lib/spawn.in.h (POSIX_SPAWN_*): Use the system's values, rather than
	overriding them by ours.
	(POSIX_SPAWN_USEVFORK): Use the next free bit position.

2008-10-05  Jim Meyering  <meyering@redhat.com>

	bootstrap: check for AC_PROG_LIBTOOL as well as AM_PROG_LIBTOOL
	* build-aux/bootstrap: Check for AC_PROG_LIBTOOL, as well as the
	obsolete AM_PROG_LIBTOOL.  Spotted by Debarshi Ray <rishi@gnu.org>.

2008-10-04  Bruno Haible  <bruno@clisp.org>

	* modules/dup2 (License): Change to LGPLv2+.
	* modules/sleep (License): Likewise.
	* modules/perror (License): Likewise.
	* modules/fopen (License): Change to LGPLv2+, with approval by Eric
	Blake.
	* modules/signal (License): Likewise.
	* modules/sigprocmask (License): Likewise.
	* modules/raise (License): Change to LGPLv2+, with approval by Jim
	Meyering.

2008-10-04  Bruno Haible  <bruno@clisp.org>

	* lib/spawn.in.h (POSIX_SPAWN_*): Undefine before redefining.
	Reported by Rainer Tammer <tammer@tammer.net>.

2008-10-03  Paolo Bonzini  <bonzini@gnu.org>
	    Bruno Haible  <bruno@clisp.org>

	* lib/errno.in.h (EWOULDBLOCK) [win32]: Define to EAGAIN.
	* lib/winsock.c (set_winsock_errno): Map WSAEWOULDBLOCK to EWOULDBLOCK.
	* lib/strerror.c (rpl_strerror): Remove error string for EWOULDBLOCK.

2008-10-03  Kamil Dudka  <kdudka@redhat.com>

	filevercmp: new module
	* lib/filevercmp.h: New function filevercmp comparing version strings.
	* lib/filevercmp.c: Implementation of filevercmp function.
	* modules/filevercmp: Module metadata.
	* tests/test-filevercmp.c: Unit test for new module.
	* modules/filevercmp-tests: Unit test metadata.
	* MODULES.html.sh: Add filevercmp module.

2008-10-03  Bruno Haible  <bruno@clisp.org>

	* lib/c-ctype.h: Add comment.
	Reported by Jim Meyering.

2008-10-02  Bruno Haible  <bruno@clisp.org>

	* modules/posix_spawn-internal (Depends-on): Add 'open'.

2008-10-02  Paolo Bonzini  <bonzini@gnu.org>

	* build-aux/bootstrap: Allow renaming bootstrap, and change the
	name of bootstrap.conf accordingly.

2008-10-02  Paolo Bonzini  <bonzini@gnu.org>

	* build-aux/bootstrap: Install git-merge-changelog configuration
	items into .gitconfig if needed.

2008-10-02  Paolo Bonzini  <bonzini@gnu.org>

	* build-aux/bootstrap: Recognize `gnulib' being a submodule in a
	git repository, and initialize/update it accordingly.

2008-10-02  Richard W.M. Jones  <rjones@redhat.com>

	* modules/fsync-tests: New file.
	* tests/test-fsync.c: New file.

	New module 'fsync'.
	* lib/fsync.c: New file.
	* m4/fsync.m4: New file.
	* modules/fsync: New file.
	* lib/unistd.in.h (fsync): New declaration.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Define and AC_SUBST both
	GNULIB_FSYNC and HAVE_FSYNC.
	* modules/unistd: Substitute GNULIB_FSYNC and HAVE_FSYNC.
	* MODULES.html.sh (posix_functions): Add fsync.
	* doc/posix-functions/fsync.texi: Mention the new module.

2008-10-02  Jim Meyering  <meyering@redhat.com>

	fts.c: sync with similar code from coreutils' remove.c
	* lib/fts.c (dirent_inode_sort_may_be_useful): Merge from coreutils.
	Guard also with "#if defined __linux__", since for now at least,
	this code is Linux-kernel-specific.

2008-10-02  Jim Meyering  <meyering@redhat.com>

	fts: bug fixes
	* lib/fts.c: Remove unnecessary "defined" in cpp directive.
	Include <sys/vfs.h>, not <sys/statfs.h>.

	* m4/fts.m4 (gl_FUNC_FTS_CORE): Fix typo s/vfs/vfs.h/.
	Include <sys/vfs.h>, not <sys/statfs.h>.

2008-10-01  Bruno Haible  <bruno@clisp.org>

	Avoid the broken posix_spawn function on AIX 5.3 and 6.1.
	* m4/posix_spawn.m4 (gl_POSIX_SPAWN_WORKS): New macro.
	(gl_POSIX_SPAWN_BODY): Invoke it. Set REPLACE_POSIX_SPAWN if needed.
	* doc/posix-functions/posix_spawn.texi: Mention the AIX bugs.
	* doc/posix-functions/posix_spawnp.texi: Likewise.
	* m4/execute.m4 (gl_EXECUTE): Invoke gl_POSIX_SPAWN_WORKS, to check
	whether posix_spawn actually works.
	* m4/pipe.m4 (gl_PIPE): Likewise.
	* modules/execute (Files): Add m4/posix_spawn.m4.
	* modules/pipe (Files): Add m4/posix_spawn.m4.
	Reported and analyzed by Rainer Tammer <tammer@tammer.net>.

2008-10-01  Jim Meyering  <meyering@redhat.com>

	remove trailing spaces
	* NEWS: Likewise.
	* lib/poll.c (poll): Likewise.
	* lib/sys_socket.in.h (SHUT_RDWR): Likewise.
	* lib/winsock.c (rpl_close): Likewise.
	* m4/memcmp.m4 (gl_FUNC_MEMCMP): Likewise.
	* modules/yield: Likewise.
	* tests/test-poll.c (connect_to_socket, poll1): Likewise.
	* tests/test-sys_select.c (connect_to_socket): Likewise.

	fts.c: adjust a new interface to be more generally useful
	* lib/fts.c (dirent_inode_sort_may_be_useful): Take an FD parameter.
	(fts_build): Adjust caller.

2008-09-30  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* modules/cond-tests: New file.
	* tests/test-cond.c: New file.

2008-09-30  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>
	    Bruno Haible  <bruno@clisp.org>

	* modules/cond (Dependencies): Add errno, time.
	* lib/glthread/cond.h: Include <time.h>.
	(gl_cond_define, gl_cond_define_initialized): Use the same definition
	across platforms.

2008-09-30  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>
	    Bruno Haible  <bruno@clisp.org>

	* m4/thread.m4 (gl_THREAD): Fix detection of pthread_atfork function.

2008-09-30  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>
	    Bruno Haible  <bruno@clisp.org>

	* modules/tls-tests (Depends-on): Add thread, yield.
	(configure.ac): Remove all checks.
	(test_tls_LDADD): Use YIELD_LIB instead of LIBSCHED.
	* tests/test-tls.c (gl_thread_t, gl_thread_join, gl_thread_yield,
	gl_thread_self): Remove definitions. Include glthread/thread.h and
	glthread/yield.h instead.
	(test_tls): Pass an additional NULL argument to gl_thread_join.

2008-09-30  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>
	    Bruno Haible  <bruno@clisp.org>

	* modules/lock-tests (Depends-on): Add thread, yield.
	(configure.ac): Remove all checks.
	(test_lock_LDADD): Use YIELD_LIB instead of LIBSCHED.
	* tests/test-lock.c (gl_thread_t, gl_thread_join, gl_thread_yield,
	gl_thread_self): Remove definitions. Include glthread/thread.h and
	glthread/yield.h instead.
	(test_lock, test_rwlock, test_recursive_lock, test_once): Pass an
	additional NULL argument to gl_thread_join.

2008-09-30  Bruno Haible  <bruno@clisp.org>

	Fix the Win32 implementation of the 'thread' module.
	* lib/glthread/thread.h [USE_WIN32_THREADS] (gl_thread_t): Change to a
	pointer type.
	(gl_thread_self): Invoke gl_thread_self_func.
	(gl_thread_self_func): New declaration.
	* lib/glthread/thread.c [USE_WIN32_THREADS] (self_key): New variable.
	(do_init_self_key, init_self_key): New functions.
	(struct gl_thread_struct): Renamed from 'struct thread_extra'.
	Remove some fields.
	(running_threads, running_lock): Remove variables.
	(get_current_thread_handle): New function.
	(gl_thread_self_func, wrapper_func, glthread_create_func,
	glthread_join_func, gl_thread_exit_func): Largely rewritten and
	simplified.

2008-09-30  Bruno Haible  <bruno@clisp.org>

	* lib/winsock-select.c (win32_poll_handle): Add shortcut for regular
	files.

2008-09-30  Jim Meyering  <meyering@redhat.com>

	fts.m4: correct the test for statfs.f_type
	* m4/fts.m4 (gl_FUNC_FTS_CORE): Include <sys/statfs.h>
	when checking for statfs.f_type.

2008-09-15  Simon Josefsson  <simon@josefsson.org>

	tests: avoid some compiler warnings
	* tests/test-memchr.c (main): Pass NULL indirectly.
	* tests/test-getdate.c (main): Remove unused variable 'ret'.

2008-09-29  Ondřej Vašík  <ovasik@redhat.com>

	getdate.y: disallow countable dayshifts like "4 yesterday ago"
	* lib/getdate.y (relative_time_table) [tDAY_SHIFT]: New type for
	exactly specified dayshifts.
	(dayshift): New rule.
	(rel): Add dayshift.
	(relative_time_table) [tomorrow, yesterday, today, now]:
	Use tDAY_SHIFT in place of tDAY_UNIT.
	* tests/test-getdate.c: Add tests for now-disallowed countable
	dayshifts, e.g., "4 yesterday ago".

2008-09-29  Bruno Haible  <bruno@clisp.org>

	* tests/test-posix_spawn1.c: Renamed from tests/test-posix_spawn.c.
	* tests/test-posix_spawn1.in.sh: Renamed from
	tests/test-posix_spawn.in.sh.
	* tests/test-posix_spawn2.c: New file.
	* tests/test-posix_spawn2.in.sh: New file.
	* modules/posix_spawnp-tests (Files): Update.
	(Makefile.am): Update. Add test-posix_spawn2 to the tests.

2008-09-29  Bruno Haible  <bruno@clisp.org>

	Propagate effects of putenv/setenv/unsetenv to child processes.
	* lib/execute.c (execute): Use spawnvpe instead of spawnvp.
	* lib/pipe.c (create_pipe): Likewise.

2008-09-29  Bruno Haible  <bruno@clisp.org>

	Enable use of shell scripts as executables in mingw.
	* lib/execute.c (execute): When spawnv fails with error ENOEXEC,
	run the program as a shell script.
	* lib/pipe.c (create_pipe): Likewise.
	* lib/w32spawn.h (prepare_spawn): Add a hidden element in front of the
	resulting array.

2008-09-29  Eric Blake  <ebb9@byu.net>

	* m4/arpa_inet_h.m4 (gl_REPLACE_ARPA_INET_H): Fix typo.

2008-08-24  Paolo Bonzini  <bonzini@gnu.org>

	* doc/posix-functions/accept.texi: Update mingw problems.
	* doc/posix-functions/bind.texi: Update mingw problems.
	* doc/posix-functions/close.texi: Update mingw problems.
	* doc/posix-functions/connect.texi: Update mingw problems.
	* doc/posix-functions/getpeername.texi: Update mingw problems.
	* doc/posix-functions/getsockname.texi: Update mingw problems.
	* doc/posix-functions/getsockopt.texi: Update mingw problems.
	* doc/posix-functions/ioctl.texi: Update mingw problems.
	* doc/posix-functions/listen.texi: Update mingw problems.
	* doc/posix-functions/recv.texi: Update mingw problems.
	* doc/posix-functions/recvfrom.texi: Update mingw problems.
	* doc/posix-functions/select.texi: Update mingw problems.
	* doc/posix-functions/send.texi: Update mingw problems.
	* doc/posix-functions/sendto.texi: Update mingw problems.
	* doc/posix-functions/setsockopt.texi: Update mingw problems.
	* doc/posix-functions/socket.texi: Update mingw problems.

2008-09-29  Paolo Bonzini  <bonzini@gnu.org>
	    Bruno Haible  <bruno@clisp.org>

	* lib/sys_select.in.h: Include sys/time.h.
	* m4/sys_select.h.m4: Test that struct timeval is fully defined.
	* modules/sys_select: Depend on sys_time.
	* tests/test-sys_select.c: Test that sys/select.h defines struct
	timeval fully.

2008-09-29  Bruno Haible  <bruno@clisp.org>

	* lib/sys_socket.in.h: Wrap the definitions in 'extern "C"'.
	* lib/sys_select.in.h: Likewise.

2008-09-29  Bruno Haible  <bruno@clisp.org>

	* lib/winsock.c (rpl_close, rpl_socket): Remove unused variables.

2008-09-29  Bruno Haible  <bruno@clisp.org>

	* m4/sockets.m4 (gl_SOCKETS): Check also for the need to use -lsocket.
	Set LIBSOCKET instead of augmenting LIBS.
	* modules/sockets (Link): New section.
	* modules/sockets-tests (test_sockets_LDADD): New variable.
	* modules/sys_select-tests (test_sys_select_LDADD): New variable.
	* modules/poll-tests (test_poll_LDADD): New variable.
	* NEWS: Document the change.

2008-09-29  Bruno Haible  <bruno@clisp.org>

	* m4/arpa_inet_h.m4 (gl_REPLACE_ARPA_INET_H): New macro.
	* m4/inet_ntop.m4 (gl_INET_NTOP): Invoke it instead of assigning
	ARPA_INET_H directly.
	* m4/inet_pton.m4 (gl_INET_PTON): Likewise.

2008-09-28  Bruno Haible  <bruno@clisp.org>

	* m4/sys_socket_h.m4 (gl_PREREQ_SYS_H_WINSOCK2): New macro, extracted
	from gl_HEADER_SYS_SOCKET.
	(gl_HEADER_SYS_SOCKET): Invoke it.
	* m4/sys_select_h.m4 (gl_HEADER_SYS_SELECT): Likewise.

2008-09-28  Bruno Haible  <bruno@clisp.org>

	* doc/posix-headers/sys_select.texi: Mention 'struct timeval' problem.
	* tests/test-sys_select.c: Include <sys/time.h>, for struct timeval.
	Needed on OSF/1 4.0.

2008-09-28  Bruno Haible  <bruno@clisp.org>

	Override open more carefully.
	* lib/open.c (orig_open): New function.
	(rpl_open): Use orig_open instead of open.
	* lib/fcntl.in.h: Add special invocation convention.
	* m4/open.m4 (gl_PREREQ_OPEN): New macro.
	(gl_FUNC_OPEN): Invoke it.

	Override freopen more carefully.
	* lib/freopen.c (orig_freopen): New function.
	(rpl_freopen): Use orig_freopen instead of freopen.
	* m4/freopen.m4 (gl_PREREQ_FREOPEN): New macro.
	(gl_FUNC_FREOPEN): Invoke it.

	Override fopen more carefully.
	* lib/fopen.c (orig_fopen): New function.
	(rpl_fopen): Use orig_fopen instead of fopen.
	* m4/fopen.m4 (gl_PREREQ_FOPEN): New macro.
	(gl_FUNC_FOPEN): Invoke it.
	Needed on AIX. Reported by Rainer Tammer <tammer@tammer.net>.

2008-09-28  Bruno Haible  <bruno@clisp.org>

	* lib/pipe.h (create_pipe_out, create_pipe_bidi): Add comment about
	SIGPIPE.

2008-09-28  Bruno Haible  <bruno@clisp.org>

	* tests/test-sigaction.c (handler, main): Disable the check whether
	SA_RESETHAND has reverted the installed handler to SIG_DFL. Needed on
	glibc systems with LinuxThreads.

2008-09-28  Bruno Haible  <bruno@clisp.org>

	* doc/posix-functions/freopen.texi: Mention the trailing slash problem.

	* lib/stdio.in.h (fopen, freopen): Undefine before redefining. Needed
	with AIX xlc.
	* lib/fcntl.in.h (open): Likewise.
	Reported by Rainer Tammer <tammer@tammer.net>.

2008-09-28  Bruno Haible  <bruno@clisp.org>

	* modules/posix_spawnp-tests: New file.
	* tests/test-posix_spawn.c: New file.
	* tests/test-posix_spawn.in.sh: New file.

	New module 'posix_spawnp'.
	* modules/posix_spawnp: New file.
	* lib/spawnp.c: New file, from GNU libc with modifications.
	* doc/posix-functions/posix_spawnp.texi: Mention the new module.

	New module 'posix_spawn'.
	* modules/posix_spawn: New file.
	* lib/spawn.c: New file, from GNU libc with modifications.
	* doc/posix-functions/posix_spawn.texi: Mention the new module.

	New module 'posix_spawnattr_destroy'.
	* modules/posix_spawnattr_destroy: New file.
	* lib/spawnattr_destroy.c: New file, from GNU libc with modifications.
	* doc/posix-functions/posix_spawnattr_destroy.texi: Mention the new
	module.

	New module 'posix_spawnattr_setsigmask'.
	* modules/posix_spawnattr_setsigmask: New file.
	* lib/spawnattr_setsigmask.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_setsigmask.texi: Mention the
	new module.

	New module 'posix_spawnattr_getsigmask'.
	* modules/posix_spawnattr_getsigmask: New file.
	* lib/spawnattr_getsigmask.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_getsigmask.texi: Mention the
	new module.

	New module 'posix_spawnattr_setsigdefault'.
	* modules/posix_spawnattr_setsigdefault: New file.
	* lib/spawnattr_setdefault.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_setsigdefault.texi: Mention the
	new module.

	New module 'posix_spawnattr_getsigdefault'.
	* modules/posix_spawnattr_getsigdefault: New file.
	* lib/spawnattr_getdefault.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_getsigdefault.texi: Mention the
	new module.

	New module 'posix_spawnattr_setschedpolicy'.
	* modules/posix_spawnattr_setschedpolicy: New file.
	* lib/spawnattr_setschedpolicy.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_setschedpolicy.texi: Mention the
	new module.

	New module 'posix_spawnattr_getschedpolicy'.
	* modules/posix_spawnattr_getschedpolicy: New file.
	* lib/spawnattr_getschedpolicy.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_getschedpolicy.texi: Mention the
	new module.

	New module 'posix_spawnattr_setschedparam'.
	* modules/posix_spawnattr_setschedparam: New file.
	* lib/spawnattr_setschedparam.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_setschedparam.texi: Mention the
	new module.

	New module 'posix_spawnattr_getschedparam'.
	* modules/posix_spawnattr_getschedparam: New file.
	* lib/spawnattr_getschedparam.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_getschedparam.texi: Mention the
	new module.

	New module 'posix_spawnattr_setpgroup'.
	* modules/posix_spawnattr_setpgroup: New file.
	* lib/spawnattr_setpgroup.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_setpgroup.texi: Mention the new
	module.

	New module 'posix_spawnattr_getpgroup'.
	* modules/posix_spawnattr_getpgroup: New file.
	* lib/spawnattr_getpgroup.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawnattr_getpgroup.texi: Mention the new
	module.

	New module 'posix_spawnattr_setflags'.
	* modules/posix_spawnattr_setflags: New file.
	* lib/spawnattr_setflags.c: New file, from GNU libc with modifications.
	* doc/posix-functions/posix_spawnattr_setflags.texi: Mention the new
	module.

	New module 'posix_spawnattr_getflags'.
	* modules/posix_spawnattr_getflags: New file.
	* lib/spawnattr_getflags.c: New file, from GNU libc with modifications.
	* doc/posix-functions/posix_spawnattr_getflags.texi: Mention the new
	module.

	New module 'posix_spawnattr_init'.
	* modules/posix_spawnattr_init: New file.
	* lib/spawnattr_init.c: New file, from GNU libc with modifications.
	* doc/posix-functions/posix_spawnattr_init.texi: Mention the new
	module.

	New module 'posix_spawn_file_actions_destroy'.
	* modules/posix_spawn_file_actions_destroy: New file.
	* lib/spawn_faction_destroy.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawn_file_actions_destroy.texi: Mention
	the new module.

	New module 'posix_spawn_file_actions_addopen'.
	* modules/posix_spawn_file_actions_addopen: New file.
	* lib/spawn_faction_addopen.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawn_file_actions_addopen.texi: Mention
	the new module.

	New module 'posix_spawn_file_actions_adddup2'.
	* modules/posix_spawn_file_actions_adddup2: New file.
	* lib/spawn_faction_adddup2.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawn_file_actions_adddup2.texi: Mention
	the new module.

	New module 'posix_spawn_file_actions_addclose'.
	* modules/posix_spawn_file_actions_addclose: New file.
	* lib/spawn_faction_addclose.c: New file, from GNU libc with
	modifications.
	* doc/posix-functions/posix_spawn_file_actions_addclose.texi: Mention
	the new module.

	New module 'posix_spawn_file_actions_init'.
	* modules/posix_spawn_file_actions_init: New file.
	* lib/spawn_faction_init.c: New file, from GNU libc with modifications.
	* doc/posix-functions/posix_spawn_file_actions_init.texi: Mention the
	new module.

	New module 'posix_spawn-internal'.
	* modules/posix_spawn-internal: New file.
	* lib/spawn_int.h: New file, from GNU libc with modifications.
	* lib/spawni.c: New file, from GNU libc with modifications.
	* m4/posix_spawn.m4: New file.

	New module 'spawn'.
	* modules/spawn: New file.
	* lib/spawn.in.h: New file, from GNU libc with modifications.
	* m4/spawn_h.m4: New file.
	* doc/posix-headers/spawn.texi: Mention the new module.

2008-09-28  Bruno Haible  <bruno@clisp.org>

	* modules/sched-tests: New file.
	* tests/test-sched.c: New file.

	New module 'sched'.
	* modules/sched: New file.
	* lib/sched.in.h: New file.
	* m4/sched_h.m4: New file.
	* doc/posix-headers/sched.texi: Mention the new module.

2008-09-27  Eric Blake  <ebb9@byu.net>

	Fix previous patch, and tweak references to $0.
	* posix-modules: Call func_gnulib_dir before using $gnulib_dir.
	(func_version, func_gnulib_dir): Don't call this program
	gnulib-tool.
	(func_gnulib_dir, func_tmpdir, func_fatal_error): Avoid shell bugs
	with using $0 in function.
	* gnulib-tool (func_gnulib_dir, func_tmpdir): Likewise.
	(func_fatal_error): Reuse the name the user invoked us with.

2008-09-27  Bruno Haible  <bruno@clisp.org>

	* m4/iconv_h.m4 (gl_REPLACE_ICONV_H): New macro.
	(gl_ICONV_H_DEFAULTS): Initialize ICONV_H here...
	(gl_ICONV_H): Not here.
	* m4/iconv_open.m4 (gl_REPLACE_ICONV_OPEN): Invoke gl_REPLACE_ICONV_H
	instead of assigning ICONV_H directly.

	* m4/wchar.m4 (gl_REPLACE_WCHAR_H): New macro.
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Invoke it instead of assigning
	WCHAR_H directly.

2008-09-27  Bruno Haible  <bruno@clisp.org>

	* lib/arpa_inet.in.h: Include the GL_LINK_WARNING anchor.
	* modules/arpa_inet (Depends-on): Add link-warning.
	(Makefile.am): Insert the definition of GL_LINK-WARNING.
	* modules/unistd (Makefile.am): Likewise.

2008-09-26  Bruno Haible  <bruno@clisp.org>

	* posix-modules (cvsdatestamp, last_checkin_date, version): Remove
	variables.
	(func_version): Essentially copied from gnulib-tool.
	(func_exit, func_gnulib_dir, func_tmpdir, func_fatal_error,
	func_readlink): Copied from gnulib-tool.

2008-09-26  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_version): Change directory to $gnulib_dir before
	invoking git-version-gen.

2008-09-26  Bruno Haible  <bruno@clisp.org>

	* posix-modules: Update to directory names changed on 2008-01-19.
	Remove commas in output before splitting into words. No more need to
	avoid 'ftruncate' since 2007-02-19.

2008-09-26  Bruno Haible  <bruno@clisp.org>

	* doc/posix-headers/errno.texi: Remove mention of module 'EOVERFLOW'.

2008-09-26  Bruno Haible  <bruno@clisp.org>

	* lib/fwriteerror.c (do_fwriteerror): Ignore error EPIPE.
	* modules/fwriteerror (Depends-on): Add errno.

2008-09-26  Bruno Haible  <bruno@clisp.org>

	* tests/test-vc-list-files-git.sh: Explain reason for skipping test.
	* tests/test-vc-list-files-cvs.sh: Likewise.

2008-09-26  Bruno Haible  <bruno@clisp.org>

	* doc/posix-headers/sys_resource.texi: Reorder items.

2008-09-26  Jim Meyering  <meyering@redhat.com>

	fts: tweak inode comparison function
	* lib/fts.c (fts_compare_ino): Sort on increasing, not decreasing
	inode numbers, as documented.

	fts: sort dirent entries on inode number before traversing
	This avoids a quadratic, seek-related performance penalty when
	operating on a directory containing many entries (measurable at 10k;
	3.5 hours at 2 million entries with a cold cache) on certain types
	of file systems, including ext3 and ext4, but not tmpfs.
	* lib/fts.c (DT_MUST_BE, NOT_AN_INODE_NUMBER, D_INO): Define.
	(FTS_INODE_SORT_DIR_ENTRIES_THRESHOLD): Define if not defined.
	(S_MAGIC_TMPFS, S_MAGIC_NFS): Define.
	(fs_handles_readdir_ordered_dirents_efficiently): New function.
	(dirent_inode_sort_may_be_useful, fts_compare_ino): Likewise.
	(fts_build): Set the stat.st_ino member from D_INO.
	If it is likely to be useful, sort dirent entries on inode number.

	* m4/fts.m4 (gl_FUNC_FTS_CORE): Check for fstatfs, sys/vfs.h,
	and the struct statfs.f_type member.
	* modules/fts (Depends-on): Add d-ino.

2008-09-26  Bruno Haible  <bruno@clisp.org>

	* modules/sigpipe-die (Depends-on): Add sigpipe.

	* lib/stdio.in.h (fprintf, vfprintf, printf, vprintf, fputc, putc,
	putchar, fputs, puts, fwrite): Replace when REPLACE_STDIO_WRITE_FUNCS
	and GNULIB_STDIO_H_SIGPIPE are set.
	* lib/stdio-write.c: New file.
	* m4/stdio_h.m4 (gl_STDIO_H): Set GNULIB_FPRINTF, GNULIB_PRINTF,
	GNULIB_VFPRINTF, GNULIB_VPRINTF, GNULIB_FPUTC, GNULIB_PUTC,
	GNULIB_PUTCHAR, GNULIB_FPUTS, GNULIB_PUTS, GNULIB_FWRITE,
	REPLACE_STDIO_WRITE_FUNCS.
	(gl_STDIO_H_DEFAULTS): Initialize GNULIB_FPRINTF, GNULIB_PRINTF,
	GNULIB_VFPRINTF, GNULIB_VPRINTF, GNULIB_FPUTC, GNULIB_PUTC,
	GNULIB_PUTCHAR, GNULIB_FPUTS, GNULIB_PUTS, GNULIB_FWRITE,
	GNULIB_STDIO_H_SIGPIPE, REPLACE_STDIO_WRITE_FUNCS.
	* modules/stdio (Files): Add lib/stdio-write.c.
	(Makefile.am): Substitute GNULIB_FPRINTF, GNULIB_PRINTF,
	GNULIB_VFPRINTF, GNULIB_VPRINTF, GNULIB_FPUTC, GNULIB_PUTC,
	GNULIB_PUTCHAR, GNULIB_FPUTS, GNULIB_PUTS, GNULIB_FWRITE,
	GNULIB_STDIO_H_SIGPIPE, REPLACE_STDIO_WRITE_FUNCS.
	* m4/fprintf-posix.m4 (gl_REPLACE_FPRINTF): Define
	REPLACE_FPRINTF_POSIX.
	* m4/printf-posix-rpl.m4 (gl_REPLACE_PRINTF): Define
	REPLACE_PRINTF_POSIX.
	* m4/vfprintf-posix.m4 (gl_REPLACE_VFPRINTF): Define
	REPLACE_VFPRINTF_POSIX.
	* m4/vprintf-posix.m4 (gl_REPLACE_VPRINTF): Define
	REPLACE_VPRINTF_POSIX.
	* doc/posix-functions/fprintf.texi: Mention the sigpipe module and the
	SIGPIPE issue.
	* doc/posix-functions/fputc.texi: Likewise.
	* doc/posix-functions/fputs.texi: Likewise.
	* doc/posix-functions/fwrite.texi: Likewise.
	* doc/posix-functions/printf.texi: Likewise.
	* doc/posix-functions/putc.texi: Likewise.
	* doc/posix-functions/putchar.texi: Likewise.
	* doc/posix-functions/puts.texi: Likewise.
	* doc/posix-functions/vfprintf.texi: Likewise.
	* doc/posix-functions/vprintf.texi: Likewise.

	* modules/safe-write (Depends-on): Add write.

	* modules/sigpipe-tests: New file.
	* tests/test-sigpipe.c: New file.
	* tests/test-sigpipe.sh: New file.

	* modules/write: New file.
	* lib/unistd.in.h: Include <sys/types.h>.
	(write): New declaration.
	* lib/write.c: New file.
	* m4/write.m4: New file.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize
	GNULIB_UNISTD_H_SIGPIPE, GNULIB_WRITE, REPLACE_WRITE.
	* modules/unistd (Makefile.am): Substitute GNULIB_UNISTD_H_SIGPIPE,
	GNULIB_WRITE, REPLACE_WRITE.
	* doc/posix-functions/write.texi: Mention the write, sigpipe modules
	and the SIGPIPE issue.

	* lib/signal.in.h (SIGPIPE): Define to a replacement value.
	(raise): New declaration.
	* lib/sigprocmask.c (SIGPIPE_handler): New variable.
	(ext_signal): New function.
	(rpl_raise): New function.
	* m4/signal_h.m4 (gl_SIGNAL_H_DEFAULTS): Initialize
	GNULIB_SIGNAL_H_SIGPIPE.
	* modules/signal (Makefile.am): Substitute GNULIB_SIGNAL_H_SIGPIPE.
	* doc/posix-headers/signal.texi: Mention the SIGPIPE issue.

	* modules/sigpipe: New file.
	* m4/sigpipe.m4: New file.

2008-09-25  Derek Price  <derek@ximbiot.com>
	    Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Report all license incompatibilities, not
	just the first one.

2008-09-25  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): When computing the edits, consider not
	only the Makefile.ams that exist but also those that will be generated.

2008-09-25  Simon Josefsson  <simon@josefsson.org>

	* modules/sys_select-tests (Depends-on): Remove sys_select itself,
	fixes gnulib-tool --test warning about duplicate dependency.

2008-09-25  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: Don't ask the user to perform edits in the generated
	Makefile.ams.
	(func_emit_lib_Makefile_am): Emit empty SUBDIRS. Execute edits that
	apply to the Makefile.am being generated.
	(func_emit_tests_Makefile_am): Execute edits that apply to the
	Makefile.am being generated.
	(func_import): Setup list of Makefile.am edits before emitting the
	Makefile.ams, not at the end.
	(func_create_testdir): Update.
	Reported by Yoann Vandoorselaere <yoann.v@prelude-ids.com>.

2008-09-25  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* gnulib-tool (func_import): Store the --tests-base option in the
	comment in gnulib-cache.m4.

2008-09-24  Paolo Bonzini  <bonzini@gnu.org>

	* NEWS: Document increased portability that sys_select now provides.

	* lib/sys_select.in.h: Install select wrapper.
	* lib/sys_socket.in.h: Use more descriptive name when there is no
	select wrapper.
	* lib/winsock-select.c: New.
	* m4/sys_select_h.m4: Compile lib/winsock-select.c if WinSock is used.
	Require gl_HEADER_SYS_SOCKET.
	* modules/sys_select: Depend on alloca, add lib/winsock-select.c.
	* modules/sys_select-tests: Copy dependencies from modules/poll-tests.
	* tests/test-sys_select.c: Add functional tests.

2008-09-24  Eric Blake  <ebb9@byu.net>

	open, fopen: close fd leak in last patch
	* lib/open.c (rpl_open): Close fd before returning error.
	* lib/fopen.c (rpl_fopen): Close fd before returning error.
	* doc/posix-functions/open.texi (open): Document that Irix also
	has the bug.
	* doc/posix-functions/fopen.texi (fopen): Likewise.
	Reported by Paolo Bonzini.

2008-09-24  Bruno Haible  <bruno@clisp.org>

	Ensure that a filename ending in a slash cannot be used to access a
	non-directory.
	* lib/open.c (rpl_open): When the filename ends in a slash, use fstat()
	to check whether it's really a directory.
	* lib/fopen.c: Include fcntl.h, unistd.h.
	(rpl_fopen): When the filename ends in a slash, use open(), fstat(),
	and fdopen().
	* modules/fopen (Depends-on): Add unistd.
	* tests/test-open.c (main): Try to open "/dev/null/" as a directory.
	* tests/test-fopen.c (main): Likewise.
	* doc/posix-functions/open.texi: Mention the HP-UX, Solaris bug.
	* doc/posix-functions/fopen.texi: Likewise.
	Reported by Eric Blake.

2008-09-23  Eric Blake  <ebb9@byu.net>

	c-stack: avoid compiler optimizations when provoking overflow
	* m4/c-stack.m4 (AC_SYS_XSI_STACK_OVERFLOW_HEURISTIC): Make
	recursion harder to optimize, to ensure a stack overflow occurs.
	* tests/test-c-stack.c (recurse): Likewise.
	Borrowed from libsigsegv.

	c-stack: work around Irix sigaltstack bug
	* m4/c-stack.m4 (AC_SYS_XSI_STACK_OVERFLOW_HEURISTIC): Check
	whether sigaltstack uses wrong end of stack_t (copied in part from
	libsigsegv).
	* lib/c-stack.c (c_stack_action) [!HAVE_LIBSIGSEGV]: Work around
	Irix bug, without requiring an over-allocation.
	* doc/posix-functions/sigaltstack.texi (sigaltstack): Document the
	bug.

	fopen: document mingw bug on directories
	* doc/posix-functions/fopen.texi (fopen): Mention mingw bug for
	not allowing a stream visiting a directory, even though reading
	from such a stream is not portable.

2008-09-23  Paolo Bonzini  <bonzini@gnu.org>

	* lib/poll.c: Rewrite.
	* modules/poll: Depend on alloca.

2008-09-23  Paolo Bonzini  <bonzini@gnu.org>

	* lib/sys_socket.in.h: Do not implement rpl_setsockopt here,
	instead define prototypes for a full set of wrappers.  Ensure
	that Cygwin does not use the compatibility code, which is only
	for MinGW.
	* lib/winsock.c: New.
	* m4/sys_socket_h.m4: Compile lib/winsock.c if WinSock is being used.
	* modules/sys_socket: Add lib/winsock.c.

	* modules/poll-tests: Add errno and perror.
	* tests/test-poll.c: Use ioctl, not ioctlsocket.

2008-09-23  Paolo Bonzini  <bonzini@gnu.org>

	* tests/test-poll.c: Downgrade minimum needed Winsock version.

2008-09-23  Bruno Haible  <bruno@clisp.org>

	* doc/posix-functions/*: Add info about functions missing on IRIX 5.3.
	* doc/glibc-functions/*: Likewise.

2008-09-23  Simon Josefsson  <simon@josefsson.org>

	* tests/test-perror.sh (tmpfiles): Cleanup temporary files on
	success.

2008-09-22  Eric Blake  <ebb9@byu.net>
	    Bruno Haible  <bruno@clisp.org>

	vasnprintf: fix x86/glibc regression on printf("%La", 0.0L)
	* lib/vasnprintf.c (VASNPRINTF): Support 0.0 on platforms that
	supply %A but mishandle pseudo-NaN.
	Reported by Simon Josefsson.

2008-09-21  Bruno Haible  <bruno@clisp.org>

	* tests/test-lock.c (main): Tweak skip message.
	* tests/test-tls.c (main): Likewise.

2008-09-21  Bruno Haible  <bruno@clisp.org>

	* m4/sigaction.m4 (gl_SIGACTION): Remove unnecessary AC_SUBST. Check
	whether 'struct sigaction' has sa_sigaction here...
	(gl_PREREQ_SIG_HANDLER_H): ... not here.
	(gl_PREREQ_SIGACTION): Remove unnecessary AC_SUBST.

2008-09-21  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Support for obsolete systems lacking ANSI C 89): New
	section.
	(Support for systems lacking ANSI C 89): Move stdlib, exit, strtol,
	strtoul, memchr, memcmp, memcpy, memmove, memset, strcspn, strpbrk to
	the new section.
	(Support for obsolete systems lacking POSIX:2001): New section.
	(String handling <string.h>): Move strdup to the new section.
	Suggested by Simon Josefsson and Paolo Bonzini.

2008-09-21  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (test_function): Allow 3-digit
	exponents in %e and %g results on 'long double'. Needed for mingw's
	improved *printf functions.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	Reported by Eric Blake.

2008-09-21  Bruno Haible  <bruno@clisp.org>

	* tests/test-snprintf-posix.h (test_function): Remove useless ASSERTs.
	* tests/test-sprintf-posix.h (test_function): Likewise.

2008-09-21  Bruno Haible  <bruno@clisp.org>

	* modules/getpass (Depends-on): Add strdup-posix.

	New module 'strdup-posix'.
	* modules/strdup-posix: New file.
	* m4/strdup.m4 (gl_FUNC_STRDUP_POSIX): New macro.
	* lib/string.in.h (strdup): Replace if REPLACE_STRDUP is 1.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Initialize
	REPLACE_STRDUP.
	* modules/string (Makefile.am): Substitute REPLACE_STRDUP.
	* doc/posix-functions/strdup.texi: Mention module strdup-posix.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add
	strdup-posix.

	* modules/strdup (Depends-on): Remove malloc-posix.

2008-09-20  Bruno Haible  <bruno@clisp.org>

	* lib/fstrcmp.c: Add data about branch probabilities, from Ralf
	Wildenhues.

2008-09-20  Bruno Haible  <bruno@clisp.org>

	Ensure that wint_t gets defined on IRIX 5.3.
	* lib/wchar.in.h (wint_t): Define if not defined by the system.
	* lib/wctype.in.h (wint_t): Likewise.
	(__wctype_wint_t): Remove type.
	(isw*): Use wint_t instead of __wctype_wint_t.
	* m4/wchar.m4 (gl_WCHAR_H): Invoke gt_TYPE_WINT_T and set HAVE_WINT_T.
	* modules/wchar (Files): Add m4/wint_t.m4.
	(Makefile.am): Substitute HAVE_WINT_T.
	* tests/test-wchar.c: Check that wchar_t and wint_t are defined.
	* tests/test-wctype.c: Check that wint_t is defined.
	* doc/posix-headers/wchar.texi: Mention the IRIX 5 problem.
	* doc/posix-headers/wctype.texi: Likewise.
	Reported by Tom G. Christensen <tgc@jupiterrise.com>.

2008-09-18  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_exit): Update comment.

2008-09-18  Simon Josefsson  <simon@josefsson.org>

	* modules/getaddrinfo (Depends-on): Remove strdup, this module
	assumes strdup exists and does not depend on strdup to return
	ENOMEM on out of memory conditions.

2008-09-18  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): When printing ±0.0L in
	NEED_PRINTF_INFINITE_LONG_DOUBLE case with 'e' format, always use two
	digits for the exponent.

2008-09-18  Jim Meyering  <meyering@redhat.com>
	    Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (decimal_point_char): Define also if
	NEED_PRINTF_INFINITE_LONG_DOUBLE.

2008-09-16  Bruno Haible  <bruno@clisp.org>
	and Eric Blake  <ebb9@byu.net>

	vasnprintf: support Irix 5.3
	* lib/vasnprintf.c (VASNPRINTF): Also handle -0.0L on platforms
	that mishandle long double infinity.
	Reported by Tom G. Christensen.

2008-09-16  Bruno Haible  <bruno@clisp.org>

	* doc/glibc-functions/scandir.texi: Mention the function is missing on
	Solaris 9.
	* doc/glibc-functions/alphasort.texi: Likewise.
	Reported by Michael Haubenwallner <michael.haubenwallner@salomon.at>.

2008-09-16  Jim Meyering  <meyering@redhat.com>

	posix-shell.m4: reject opensolaris's "sh (AT&T Research) 1993-12-28 s+"
	* m4/posix-shell.m4 (gl_POSIX_SHELL): Reject a shell that lets
	a umask modification leak out of a subshell.  Otherwise, the
	opensolaris /bin/sh would be accepted and thus cause unwarranted
	failures in the coreutils test suite.

2008-09-16  Paolo Bonzini  <bonzini@gnu.org>

	* tests/test-poll.c (connect_to_socket): Allow non-blocking connect
	to succeed.

2008-09-16  Jim Meyering  <meyering@redhat.com>

	avoid spurious test failure when library is built without ACL support
	* m4/acl.m4 (USE_ACL): Define as a shell variable, too, for...
	* modules/acl-tests (Makefile.am) [TESTS_ENVIRONMENT]: Add USE_ACL.
	* tests/test-file-has-acl.sh: Skip if USE_ACL == 0.
	* tests/test-copy-acl.sh: Likewise.

2008-09-15  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/fstrcmp.c (fstrcmp_bounded): Use a second, less quick upper bound
	based on character occurrence counts.

2008-09-15  Eric Blake  <ebb9@byu.net>

	tests: avoid some compiler warnings
	* tests/test-memchr.c (main): Pass NULL indirectly.
	* tests/test-closein.c (main): Avoid unused variable.

2008-09-15  Bruno Haible  <bruno@clisp.org>

	* m4/errno_h.m4 (gl_HEADER_ERRNO_H_BODY): Test for all the macros that
	are missing on OpenBSD 4.0 individually.
	Reported by Yoann Vandoorselaere <yoann.v@prelude-ids.com>.

2008-09-15  Bruno Haible  <bruno@clisp.org>

	* doc/posix-headers/errno.texi: Mention the Cygwin problem.
	* doc/posix-functions/strerror.texi: Mention also Cygwin.
	* doc/posix-functions/perror.texi: Likewise.
	* m4/errno_h.m4 (gl_HEADER_ERRNO_H_BODY): Test also whether ECANCELED
	is missing.
	Reported by Eric Blake.

	* lib/errno.in.h: Use replacement values >= 2000.
	Reported by Eric Blake.

2008-09-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/fstrcmp.c (EXTRA_CONTEXT_FIELDS): Add field 'edit_count_limit'.
	(EARLY_ABORT): Return true when the edit_count has grown too beyond the
	limit.
	(fstrcmp_bounded): Initialize the edit_count_limit. Return 0 when
	compareseq was aborted.

2008-09-14  Bruno Haible  <bruno@clisp.org>

	* lib/fstrcmp.c (EXTRA_CONTEXT_FIELDS): Combine xvec_edit_count and
	yvec_edit_count.
	(NOTE_DELETE, NOTE_INSERT): Increment the combined edit count.
	(fstrcmp_bounded): Simplify result computation accordingly.

2008-09-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/fstrcmp.h (fstrcmp_bounded): New declaration.
	(fstrcmp): Define in terms of fstrcmp_bounded.
	* lib/fstrcmp.c (fstrcmp_bounded): Renamed from fstrcmp. Add
	lower_bound argument.
	Return quickly if the result is certainly < lower_bound.
	* tests/test-fstrcmp.c (check_fstrcmp): Test also fstrcmp_bounded.

2008-09-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/diffseq.h (EARLY_ABORT): New macro.
	(compareseq): Change return type to bool. Return true when EARLY_ABORT
	evaluates to true.

2008-09-14  Bruno Haible  <bruno@clisp.org>

	* modules/perror-tests: New file.
	* tests/test-perror.sh: New file.
	* tests/test-perror.c: New file.

	New module 'perror'.
	* lib/stdio.in.h (perror): New declaration.
	* lib/perror.c: New file.
	* m4/perror.m4: New file.
	* modules/perror: New file.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add perror.
	* doc/posix-functions/perror.texi: Mention the perror module.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Initialize GNULIB_PERROR,
	REPLACE_PERROR.
	* modules/stdio (Makefile.am): Substitute GNULIB_PERROR,
	REPLACE_PERROR.

2008-09-14  Bruno Haible  <bruno@clisp.org>

	* modules/stdio (Makefile.am): Reorder to match the order in
	lib/stdio.in.h.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Likewise.

2008-09-13  Bruno Haible  <bruno@clisp.org>

	* lib/sys_socket.in.h (EINPROGRESS, ...): Remove definitions.

2008-09-13  Bruno Haible  <bruno@clisp.org>

	Extend strerror to cover the added errno values.
	* lib/strerror.c: Include errno.h and winsock2.h if it exists.
	(rpl_strerror): Provide error messages for the added errno values and
	for the WSA* values.
	* m4/strerror.m4 (gl_FUNC_STRERROR): Test REPLACE_STRERROR.
	(gl_FUNC_STRERROR_SEPARATE): If errno.h is replaced, always replace
	strerror.
	(gl_PREREQ_STRERROR): Test whether winsock2.h exists.
	* modules/strerror (Depends-on): Add errno.
	* doc/posix-functions/strerror.texi: Document the change.
	* tests/test-strerror.c (main): Check also the string for ETIMEDOUT
	and EOVERFLOW.

2008-09-13  Bruno Haible  <bruno@clisp.org>

	* modules/EOVERFLOW: Remove file.
	* m4/eoverflow.m4: Remove file.
	* modules/EOVERFLOW-tests: Remove file.
	* tests/test-EOVERFLOW.c: Remove file.
	* modules/fprintf-posix (Depends-on): Replace EOVERFLOW with errno.
	* modules/ftell (Depends-on): Likewise.
	* modules/getdelim (Depends-on): Likewise.
	* modules/getugroups (Depends-on): Likewise.
	* modules/poll (Depends-on): Likewise.
	* modules/snprintf (Depends-on): Likewise.
	* modules/sprintf-posix (Depends-on): Likewise.
	* modules/vasnprintf (Depends-on): Likewise.
	* modules/vasprintf (Depends-on): Likewise.
	* modules/vfprintf-posix (Depends-on): Likewise.
	* modules/vsnprintf (Depends-on): Likewise.
	* modules/vsprintf-posix (Depends-on): Likewise.
	* modules/xvasprintf (Depends-on): Likewise.
	* modules/unistdio/u8-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u8-vasprintf (Depends-on): Likewise.
	* modules/unistdio/u8-vsnprintf (Depends-on): Likewise.
	* modules/unistdio/u8-vsprintf (Depends-on): Likewise.
	* modules/unistdio/u8-u8-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u8-u8-vasprintf (Depends-on): Likewise.
	* modules/unistdio/u8-u8-vsnprintf (Depends-on): Likewise.
	* modules/unistdio/u8-u8-vsprintf (Depends-on): Likewise.
	* modules/unistdio/u16-u16-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u16-u16-vasprintf (Depends-on): Likewise.
	* modules/unistdio/u16-u16-vsnprintf (Depends-on): Likewise.
	* modules/unistdio/u16-u16-vsprintf (Depends-on): Likewise.
	* modules/unistdio/u16-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u16-vasprintf (Depends-on): Likewise.
	* modules/unistdio/u16-vsnprintf (Depends-on): Likewise.
	* modules/unistdio/u16-vsprintf (Depends-on): Likewise.
	* modules/unistdio/u32-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u32-vasprintf (Depends-on): Likewise.
	* modules/unistdio/u32-vsnprintf (Depends-on): Likewise.
	* modules/unistdio/u32-vsprintf (Depends-on): Likewise.
	* modules/unistdio/u32-u32-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u32-u32-vasprintf (Depends-on): Likewise.
	* modules/unistdio/u32-u32-vsnprintf (Depends-on): Likewise.
	* modules/unistdio/u32-u32-vsprintf (Depends-on): Likewise.
	* modules/unistdio/ulc-fprintf (Depends-on): Likewise.
	* modules/unistdio/ulc-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/ulc-vasprintf (Depends-on): Likewise.
	* modules/unistdio/ulc-vfprintf (Depends-on): Likewise.
	* modules/unistdio/ulc-vsnprintf (Depends-on): Likewise.
	* modules/unistdio/ulc-vsprintf (Depends-on): Likewise.
	* MODULES.html.sh: Remove EOVERFLOW.
	* NEWS: Mention the change.

2008-09-13  Bruno Haible  <bruno@clisp.org>

	* modules/errno-tests: New file.
	* tests/test-errno.c: New file, incorporating tests/test-EOVERFLOW.c.

	* lib/errno.in.h: New file.
	* m4/errno_h.m4: New file, borrowing from m4/eoverflow.m4.
	* modules/errno: New file.
	* doc/posix-headers/errno.texi: Update documentation.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add errno.

2008-09-13  Bruno Haible  <bruno@clisp.org>

	* tests/test-poll.c: Use #if for native Windows, rather than testing
	__MSVCRT__.

2008-09-13  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>
	    Bruno Haible  <bruno@clisp.org>

	* lib/glob.c: Don't include <pwd.h> on native Windows.
	(WINDOWS32): New macro.
	(glob) [WINDOW32]: Provide a reasonable replacement for getenv("HOME").

2008-09-13  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/cond.h [USE_SOLARIS_THREADS]
	(ETIMEDOUT): Remove macro.
	(glthread_cond_timedwait_multithreaded): New declaration.
	(glthread_cond_timedwait): Use it.
	* lib/glthread/cond.c [USE_SOLARIS_THREADS]
	(glthread_cond_timedwait_multithreaded): New function.

2008-09-12  Paolo Bonzini  <bonzini@gnu.org>

	* modules/poll-tests: Do not check for io.h.
	* tests/test-poll.c: Check for __MSVCRT__ instead.

2008-09-12  Paolo Bonzini  <bonzini@gnu.org>

	* lib/sys_socket.in.h (EINPROGRESS): Define for Winsock case.
	* modules/poll-tests: Add inet_pton, stdbool, sockets.
	* tests/test-poll.c: Use them.  Use _pipe on Windows.

2008-09-12  Paolo Bonzini  <bonzini@gnu.org>

	* modules/poll-tests: New.
	* tests/test-poll.c: New.

2008-09-12  Eric Blake  <ebb9@byu.net>

	frexp: test for NetBSD failure on -0.0
	* m4/frexp.m4 (gl_FUNC_FREXP_WORKS): Enhance test, since some, but
	not all, bugs from NetBSD 3.0 have been fixed.
	* doc/posix-functions/frexp.texi (frexp): Document bug.
	Reported by Thomas Klausner.

	signbit: work around bug of HP-UX 10.20 cc with -0.0 literal
	* m4/signbit.m4 (gl_SIGNBIT_TEST_PROGRAM): Rewrite test to avoid
	literal -0.0.
	Reported by Jonathan C. Patschke <jp@centtech.com>.

2008-09-11  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* lib/glthread/cond.h: Use dummy implementation also if
	USE_WIN32_THREADS.

2008-09-11  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* modules/fnmatch-posix (License): Change to LGPLv2+.
	* modules/fnmatch-gnu (License): Likewise.

2008-09-11  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* lib/poll.c (poll): Fix polling unconnected server sockets on WIN32.

2008-09-11  Jim Meyering  <meyering@redhat.com>

	* users.txt: Add gtk-vnc.

2008-09-08  Simon Josefsson  <simon@josefsson.org>

	* tests/test-bitrotate.c: Test 8/16-bit rotates with 0 and maximum
	rotate amounts.

	* lib/bitrotate.h: Doc fix, mention that N can be wider than minimally
	required for 16-bit and 8-bit rotates.
	* lib/bitrotate.h (rotl64, rotr64, rotl32, rotl32, rotl16, rotr16,
	rotl8, rotr8): Use UINT64_MAX, UINT32_MAX, UINT16_MAX, and
	UINT8_MAX instead of hard-coded constants.
	Suggested by Paul Eggert.

2008-09-07  Bruno Haible  <bruno@clisp.org>

	* tests/test-striconveh.c (main): Check behaviour when converting from
	UTF-7.

	Make striconveh work better with stateful encodings.
	* lib/striconveh.c (iconv_carefully, iconv_carefully_1): Don't assume
	that iconv does not increment the inptr when returning -1/EINVAL.

2008-09-07  Bruno Haible  <bruno@clisp.org>

	* build-aux/config.rpath: Update according to libtool-2.2.6.
	* build-aux/config.libpath: Likewise.

2008-09-06  Bruno Haible  <bruno@clisp.org>

	* lib/freadahead.c (freadahead): Add conditional for SLOW_BUT_NO_HACKS.
	* lib/freadptr.c (freadptr): Likewise.
	* lib/freadseek.c (freadptrinc): Likewise.
	Reported by Simon Josefsson.

2008-09-06  Bruno Haible  <bruno@clisp.org>

	* modules/freadptr (License): Change to LGPLv2+.
	* modules/freadseek (License): Likewise.
	Suggested by Eric Blake.

	* modules/memchr2 (License): Change to LGPLv2+.
	Approved by Eric Blake.

2008-09-04  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Bruno Haible  <bruno@clisp.org>

	Make gnulib-tool work with native 'sed' on AIX.
	* gnulib-tool (sed_noop): New variable.
	(func_emit_lib_Makefile_am, func_emit_tests_Makefile_am, func_import,
	func_add_or_update, func_create_testdir): Use it to initialize sed
	script variables.
	Reported by Albert Chin <bug-gnulib@mlists.thewrittenword.com>.

2008-09-04  Albert Chin  <bug-gnulib@mlists.thewrittenword.com>
	    Bruno Haible  <bruno@clisp.org>

	* m4/include_next.m4 (gl_INCLUDE_NEXT): Add check whether #include_next
	also works after #include directives.

2008-09-04  Ondřej Vašík  <ovasik@redhat.com>

	getdate.y: reject an out-of-range timezone value
	* lib/getdate.y (time_zone_hhmm): Reject any TZ offset that is outside
	the range [-24...+24].  When specified with only one or two digits,
	* tests/test-getdate.c: Tests for the fix.
	* doc/getdate.texi: Document this change.

2008-09-03  Bruno Haible  <bruno@clisp.org>

	* doc/glibc-functions/strverscmp.texi: Mention the strverscmp module.

2008-09-02  Simon Josefsson  <simon@josefsson.org>

	* lib/bitrotate.h (rotl64, rotr64): Add.  Suggested by Bruce Korb
	<bruce.korb@gmail.com> with ideas from Ben Pfaff
	<blp@cs.stanford.edu>, Bruno Haible <bruno@clisp.org> and Eric
	Blake <ebb9@byu.net>.

	* tests/test-bitrotate.c: Add more test vectors.

2008-09-02  Eric Blake  <ebb9@byu.net>

	vasnprintf-posix: handle large precision via %.*d
	* lib/vasnprintf.c (VASNPRINTF): Don't pass precision to snprintf
	when handling it ourselves.
	* tests/test-vasnprintf-posix.c (test_function): Add test.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	Reported by Alain Guibert.

2008-09-01  Eric Blake  <ebb9@byu.net>

	c-stack: make configure-time check more robust
	* m4/c-stack.m4 (AC_SYS_XSI_STACK_OVERFLOW_HEURISTIC): Check for
	successful sigaction call.
	Reported by Tom G. Christensen.

2008-09-01  Bruno Haible  <bruno@clisp.org>

	New module 'findprog-lgpl'.
	* modules/findprog-lgpl: New file.
	* lib/findprog-lgpl.c: New file.
	* lib/findprog.c: Compile nothing in findprog.c if findprog-lgpl.c is
	also compiled. Consider the possibly defined symbol IN_FINDPROG_LGPL
	to decide whether to use strdup or xstrdup, concatenated_filename or
	xconcatenated_filename.

2008-09-01  Bruno Haible  <bruno@clisp.org>

	Split module 'concat-filename' into 'concat-filename' (LGPL) and
	'xconcat-filename' (GPL).
	* modules/concat-filename (Depends-on): Add malloc-posix, remove xalloc.
	(License): Change to LGPLv2+.
	* modules/xconcat-filename: New file.
	* lib/concat-filename.h (concatenated_filename): Change specification.
	(xconcatenated_filename): New declaration.
	* lib/concat-filename.c: Include errno.h, stdlib.h, not xalloc.h.
	(concatenated_filename): Use malloc instead of xalloc. Handle out-of-
	memory situations.
	* lib/xconcat-filename.c: New file.
	* NEWS: Mention the change.
	* lib/findprog.c: Include concat-filename.h, not filename.h.
	(find_in_path): Use xconcatenated_filename instead of
	concatenated_filename.
	* lib/javacomp.c: Include concat-filename.h, not filename.h.
	(is_envjavac_gcj43_usable, is_envjavac_oldgcj_14_14_usable,
	is_envjavac_oldgcj_14_13_usable, is_envjavac_nongcj_usable,
	is_gcj_present, is_gcj43_usable, is_oldgcj_14_14_usable,
	is_oldgcj_14_13_usable, is_javac_usable): Use xconcatenated_filename
	instead of concatenated_filename.
	* lib/javaexec.c: Include concat-filename.h, not filename.h.
	(execute_java_class): Use xconcatenated_filename instead of
	concatenated_filename.
	* modules/findprog (Depends-on): Add xconcat-filename, remove filename.
	* modules/javacomp (Depends-on): Likewise.
	* modules/javaexec (Depends-on): Likewise.

2008-09-01  Bruno Haible  <bruno@clisp.org>

	Split module 'filename' into 'filename' and 'concat-filename'.
	* modules/filename: Keep only lib/filename.h.
	(License): Change to LGPLv2+.
	* modules/concat-filename: New file, extracted from modules/filename.
	* lib/filename.h (concatenated_filename): Remove declaration.
	* lib/concat-filename.h: New file, extracted from lib/filename.h.
	* lib/concat-filename.c: Include concat-filename.h.
	* NEWS: Mention the change.

2008-09-01  Simon Josefsson  <simon@josefsson.org>

	* lib/bitrotate.h (rotl8, rotr8): Add.

	* modules/bitrotate (configure.ac): Need
	AC_REQUIRE([AC_C_INLINE]).
	(Description): Mention stdint.h.  Reported by Bruno Haible
	<bruno@clisp.org>.

	* lib/bitrotate.h (rotr16, rotl16): Fix mask value.  Reported by
	Paolo Bonzini <bonzini@gnu.org>.

2008-08-31  Bruno Haible  <bruno@clisp.org>

	Assume Solaris specific bi-arch conventions on Solaris systems.
	* m4/lib-prefix.m4 (AC_LIB_PREPARE_MULTILIB): On Solaris in 64-bit
	mode, set acl_libdirstem to lib/64. Also set acl_libdirstem2.
	* m4/lib-link.m4 (AC_LIB_LINKFLAGS_BODY): If acl_libdirstem does not
	work, try acl_libdirstem2 as fallback. Otherwise treat acl_libdirstem2
	like acl_libdirstem.
	(AC_LIB_LINKFLAGS_FROM_LIBS): Treat acl_libdirstem2 like
	acl_libdirstem.
	* NEWS: Mention the change.
	Reported by Ben Taylor <bentaylor.solx86@gmail.com>.

2008-08-31  Jim Meyering  <meyering@redhat.com>

	* lib/strftime.h: Add comments describing the two added arguments.

	remove duplicate #include directives
	* lib/chdir-long.c [TEST_CHDIR]: Remove duplicate #include <stdio.h>.
	* lib/putenv.c: Remove duplicate #include <stdlib.h>.

2008-08-31  Bruno Haible  <bruno@clisp.org>

	New module 'sigpipe-die'.
	* modules/sigpipe-die: New file.
	* lib/sigpipe-die.h: New file.
	* lib/sigpipe-die.c: New file.
	* MODULES.html.sh (Signal handling): Add sigpipe-die.

2008-08-31  Bruno Haible  <bruno@clisp.org>

	Don't override previously installed signal handlers.
	* lib/fatal-signal.c (saved_sigactions): New variable.
	(uninstall_handlers): Reset the signal to the saved handler, not
	to SIG_DFL (except when ignored).
	(install_handlers): Save the previous handlers.

2008-08-30  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_reset_sigpipe): New function.
	(func_get_automake_snippet, func_modules_transitive_closure,
	func_import): Invoke it before a join command that reads from stdin,
	to avoid "echo: write error: Broken pipe" error messages on stderr.
	Reported by Sam Steingold <sds@gnu.org>.

2008-08-30  Bruno Haible  <bruno@clisp.org>

	* m4/fopen.m4 (gl_FUNC_FOPEN): Test against bug with trailing slash.
	Code copied from m4/open.m4.
	* lib/fopen.c (rpl_fopen): Return NULL if the mode specifies write
	access and the filename ends in a slash. Code copied from lib/open.c.
	* doc/posix-functions/fopen.texi: Document bug with trailing slash.
	* tests/test-fopen.c (main): Check against bug with trailing slash.

2008-08-29  Bruno Haible  <bruno@clisp.org>

	Avoid some "gcc -pedantic" warnings.
	* m4/include_next.m4 (gl_INCLUDE_NEXT): Set also PRAGMA_SYSTEM_HEADER.
	* lib/arpa_inet.in.h: Use PRAGMA_SYSTEM_HEADER.
	* lib/dirent.in.h: Likewise.
	* lib/fcntl.in.h: Likewise.
	* lib/float.in.h: Likewise.
	* lib/iconv.in.h: Likewise.
	* lib/inttypes.in.h: Likewise.
	* lib/locale.in.h: Likewise.
	* lib/math.in.h: Likewise.
	* lib/netinet_in.in.h: Likewise.
	* lib/search.in.h: Likewise.
	* lib/signal.in.h: Likewise.
	* lib/stdarg.in.h: Likewise.
	* lib/stdint.in.h: Likewise.
	* lib/stdio.in.h: Likewise.
	* lib/stdlib.in.h: Likewise.
	* lib/string.in.h: Likewise.
	* lib/strings.in.h: Likewise.
	* lib/sys_select.in.h: Likewise.
	* lib/sys_socket.in.h: Likewise.
	* lib/sys_stat.in.h: Likewise.
	* lib/sys_time.in.h: Likewise.
	* lib/sysexits.in.h: Likewise.
	* lib/time.in.h: Likewise.
	* lib/unistd.in.h: Likewise.
	* lib/wchar.in.h: Likewise.
	* lib/wctype.in.h: Likewise.
	* modules/arpa_inet (Makefile.am): Also substitute PRAGMA_SYSTEM_HEADER.
	* modules/fchdir (Makefile.am): Likewise.
	* modules/fcntl (Makefile.am): Likewise.
	* modules/float (Makefile.am): Likewise.
	* modules/iconv_open (Makefile.am): Likewise.
	* modules/inttypes (Makefile.am): Likewise.
	* modules/locale (Makefile.am): Likewise.
	* modules/math (Makefile.am): Likewise.
	* modules/netinet_in (Makefile.am): Likewise.
	* modules/search (Makefile.am): Likewise.
	* modules/signal (Makefile.am): Likewise.
	* modules/stdarg (Makefile.am): Likewise.
	* modules/stdint (Makefile.am): Likewise.
	* modules/stdio (Makefile.am): Likewise.
	* modules/stdlib (Makefile.am): Likewise.
	* modules/string (Makefile.am): Likewise.
	* modules/strings (Makefile.am): Likewise.
	* modules/sys_select (Makefile.am): Likewise.
	* modules/sys_socket (Makefile.am): Likewise.
	* modules/sys_stat (Makefile.am): Likewise.
	* modules/sys_time (Makefile.am): Likewise.
	* modules/sysexits (Makefile.am): Likewise.
	* modules/time (Makefile.am): Likewise.
	* modules/unistd (Makefile.am): Likewise.
	* modules/wchar (Makefile.am): Likewise.
	* modules/wctype (Makefile.am): Likewise.
	Reported by Reuben Thomas <rrt@sc3d.org>.

2008-08-29  Bruno Haible  <bruno@clisp.org>

	* m4/include_next.m4 (gl_INCLUDE_NEXT): Don't define HAVE_INCLUDE_NEXT
	any more.

2008-08-29  Simon Josefsson  <simon@josefsson.org>

	* MODULES.html.sh (Misc): Add bitrotate.

	* modules/bitrotate: New file.

	* lib/bitrotate.h: New file.

	* modules/bitrotate-tests: New file.

	* tests/test-bitrotate.c: New file.

	* modules/crypto/gc-arctwo, modules/crypto/arctwo: Add dependency
	on the bitrotate module.

	* lib/arctwo.c: Use new bitrotate module.

2008-08-29  Jim Meyering  <meyering@redhat.com>

	bootstrap: merge changes from coreutils
	* build-aux/bootstrap (cp_mark_as_generated): Preserve perms
	of copied files.  Remove a kludge, now that this is fixed.
	* build-aux/bootstrap: Fix unportable expr usage. (by Ralf Wildenhues)
	* build-aux/bootstrap: Remove $bt and $bt2 also when not using gettext.
	* build-aux/bootstrap: Remove coreutils-specific SUBDIRS-related code.

2008-08-29  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh: Remove --cvs-urls option.

2008-08-28  Jose E. Marchesi  <jemarch@gnu.org>  (tiny change)

	maint.mk: adjust to file name change
	* top/maint.mk: s/Makefile.cfg/cfg.mk/.

2008-08-28  Jim Meyering  <meyering@redhat.com>

	* modules/getndelim2 (License): Relicense to LGPLv2+.
	Approved by Richard Stallman for the version of 1995, and by
	Paul Eggert, Bruno Haible, Eric Blake for their contributions.

2008-08-27  Paolo Bonzini  <bonzini@gnu.org>

	* lib/getdelim.c (flockfile, funlockfile): Make all of them
	dummy if one is not available.  Do not touch them if
	USE_UNLOCKED_IO, instead letting unlocked-io.h do that.
	(getc_maybe_unlocked): New.
	* m4/getdelim.m4 (gl_PREREQ_GETDELIM): Check for getc_unlocked.

2008-08-26  Eric Blake  <ebb9@byu.net>

	doc/INSTALL: resync from autoconf
	* doc/Makefile (INSTALL, INSTALL.ISO, INSTALL.UTF-8): Simplify.
	(INSTALL_PRELUDE): Delete; this is done more efficiently by
	moving...
	* install.texi [!autoconf]: ...here.  Resync from autoconf.
	* INSTALL: Regenerate.
	* INSTALL.ISO: New file.
	* INSTALL.UTF-8: Likewise.

2008-08-26  Jim Meyering  <meyering@redhat.com>

	GNUmakefile: cfg.mk definitions override default autoreconf-rerun policy
	* top/GNUmakefile (_is-dist-target, _is-install-target): Make
	these definitions conditional, so that they may be overridden, too.

2008-08-26  Bruno Haible  <bruno@clisp.org>

	Generate INSTALL file variants with prettier quotes.
	* doc/Makefile (INSTALL_PRELUDE): New macro.
	(INSTALL): Use it.
	(INSTALL.ISO, INSTALL.UTF-8): New rules.

2008-08-26  Bruno Haible  <bruno@clisp.org>

	Run makeinfo in an English locale.
	* doc/Makefile (MAKEINFO): New variable.

2008-08-26  Bruno Haible  <bruno@clisp.org>

	* doc/Makefile (INSTALL): Use --no-validate instead of --no-warn.
	Suggested by Eric Blake.

2008-08-25  Bruno Haible  <bruno@clisp.org>

	* doc/Makefile (INSTALL): Generate with @firstparagraphindent set.

2008-08-25  Eric Blake  <ebb9@byu.net>

	c-stack: test that stack overflow can be caught
	* m4/c-stack.m4 (AC_SYS_XSI_STACK_OVERFLOW_HEURISTIC): Also check
	that platform allows handling stack overflow; at least OS/2 EMX
	has sigaltstack, but crashes before transferring control to
	handler on stack overflow.
	* lib/c-stack.c [HAVE_SIGALTSTACK]: Adjust conditions to also
	check for HAVE_STACK_OVERFLOW_HANDLING.
	Reported by Elbert Pol.

2008-08-25  Bruno Haible  <bruno@clisp.org>

	* doc/posix-functions/strftime.texi: Fix description of strftime
	module.

2008-08-24  Bruno Haible  <bruno@clisp.org>

	* tests/uniwidth/test-uc_width2.c: New file.
	* tests/uniwidth/test-uc_width2.sh: New file.
	* modules/uniwidth/width-tests (Files): Add the new files.
	(TESTS): Add uniwidth/test-uc_width2.sh.
	(TESTS_ENVIRONMENT): New variable.
	(check_PROGRAMS): Add test-uc_width2.
	(test_uc_width2_SOURCES): New variable.

	Fix uc_width(0x00AB) bug, introduced on 2007-07-08.
	* lib/uniwidth/width.c (nonspacing_table_data): Set bit for 0x00AD,
	not 0x00AB.
	Reported by Alexander V. Lukyanov <lav@netis.ru>.

2008-08-22  Eric Blake  <ebb9@byu.net>

	test-lock, test-tls: mention why a test is skipped
	* tests/test-lock.c (main) [!USE_*_THREADS]: Print why test is
	skipped.
	* tests/test-tls.c (main) [!USE_*_THREADS]: Likewise.

	count-one-bits: relax license
	* modules/count-one-bits (License): Relicense to LGPLv2+.
	Suggested by Ludovic Courtès, approved by Ben Pfaff.

2008-08-22  Andreas Schwab  <schwab@suse.de>

	* m4/obstack-printf-posix.m4 (gl_FUNC_OBSTACK_PRINTF_POSIX):
	Remove spurious space in assignment.

2008-08-21  Simon Josefsson  <simon@josefsson.org>

	* m4/autobuild.m4: Use TZ=UTC0 instead of TZ=UTC.  Reported by
	Paul Eggert <eggert@CS.UCLA.EDU>.

2008-08-20  Paolo Bonzini  <bonzini@gnu.org>

	* modules/gettext: Add m4/threadlib.m4.

2008-08-19  Eric Blake  <ebb9@byu.net>

	test-c-stack: fix compilation failure on FreeBSD 5.0
	* tests/test-c-stack.c [HAVE_SETRLIMIT]: Include prerequisite
	headers before <sys/resource.h>.
	* doc/posix-headers/sys_resource.texi (sys/resource.h): Document
	the bug.
	Reported by Nelson H. F. Beebe.

	strverscmp: migrate from "strverscmp.h" to <string.h>
	* modules/string (Makefile.am): Add new hooks.
	* modules/strverscmp (Files): Remove strverscmp.h.
	(Depends-on): Add string.
	(configure.ac): Add indicator.
	(Include): Mention new header.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Provide new
	defaults.
	* m4/strverscmp.m4 (gl_FUNC_STRVERSCMP): Inform string module of
	results.
	* lib/strverscmp.h: Delete.
	* lib/string.in.h (strverscmp): Provide declaration, when needed.
	* tests/test-strverscmp.c (includes): Adjust client.
	* lib/check-version.c (includes): Likewise.
	* NEWS: Document the change.

	strverscmp: add unit test
	* modules/strverscmp-tests: New file.
	* tests/test-strverscmp.c: Likewise.

2008-08-19  Simon Josefsson  <simon@josefsson.org>

	* lib/gc-gnulib.c: Indentation cleanup.  Add some comments
	regarding Windows crypto stuff, from Mono.

2008-08-19  Adam Strzelecki <ono@java.pl>  (tiny change)

	* lib/gc-gnulib.c: Use CRYPT_VERIFY_CONTEXT.  Try to use Intel CSP
	if present, for intel RND.  Return error on failures.

2008-08-18  Ben Pfaff  <blp@gnu.org>

	gitlog-to-changelog: give better diagnostic for failed pipe-open
	* build-aux/gitlog-to-changelog: Improve error message: suggest
	that the version of Git may be too old.

2008-08-18  Simon Josefsson  <simon@josefsson.org>

	* m4/autobuild.m4: Use TZ=UTC to avoid time zone complexity.  Use
	ISO 8601 format.  Suggested by Greg Troxel <gdt@ir.bbn.com>.

2008-08-18  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/thread.h [USE_SOLARIS_THREADS]: Use thread_in_use(), not
	pthread_in_use().

2008-08-18  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/threadlib.c: Include <pthread.h>.

2008-08-18  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/lock.h [USE_SOLARIS_THREADS]: Fix
	glthread_recursive_lock_* macros.
	* lib/glthread/lock.c (glthread_recursive_lock_destroy_multithreaded):
	Fix syntax error.

2008-08-18  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/thread.c: Avoid forcing a context switch right after
	thread creation.

2008-08-17  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/thread.c: New file, based on code from tests/test-lock.c.
	* lib/glthread/thread.h: Provide Win32 specific implementation.
	* modules/thread (Files): Add lib/glthread/thread.c.
	(Depends-on): Add lock.
	(Makefile.am): Add glthread/thread.c to lib_SOURCES.

2008-08-17  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	New module 'yield'.
	* modules/yield: New file.
	* lib/glthread/yield.h: New file.
	* m4/yield.m4: New file.
	* MODULES.html.sh (Multithreading): Add yield.

2008-08-17  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	New module 'thread'.
	* modules/thread: New file.
	* lib/glthread/thread.h: New file.
	* m4/thread.m4: New file.
	* MODULES.html.sh (Multithreading): Add thread.

2008-08-17  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/lock.h: Include <stdlib.h> always.
	* lib/glthread/tls.h: Likewise.
	* lib/glthread/cond.h: Likewise.

2008-08-17  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	New module 'cond'.
	* modules/cond: New file.
	* lib/glthread/cond.h: New file.
	* lib/glthread/cond.c: New file.
	* m4/cond.m4: New file.
	* MODULES.html.sh (Multithreading): Add cond.

2008-08-16  Eric Blake  <ebb9@byu.net>

	c-stack: fix regression on Irix 5.3 from 2008-06-21
	* m4/c-stack.m4 (gl_PREREQ_C_STACK): Move check for
	sa_sigaction...
	* m4/sigaction.m4 (gl_PREREQ_SIG_HANDLER_H): ...here.
	(gl_PREREQ_SIGACTION): Depend on sig-handler.h prereq's.
	* m4/signal_h.m4 (gl_SIGNAL_H_DEFAULTS): Set the default.
	* modules/signal (Makefile.am): Use the value.
	* lib/signal.in.h (sa_sigaction) [HAVE_SIGACTION
	&& !HAVE_STRUCT_SIGACTION_SA_SIGACTION]: Define.
	* doc/posix-headers/signal.texi (signal.h): Document this
	portability issue.
	* doc/posix-functions/sigaction.texi (sigaction): Likewise.
	Reported by Tom G. Christensen.

2008-08-17  Bruno Haible  <bruno@clisp.org>

	New module 'threadlib'.
	* modules/threadlib: New file.
	* lib/glthread/threadlib.c: New file, extracted from
	lib/glthread/lock.c.
	* lib/glthread/lock.c (dummy_thread_func, glthread_in_use): Remove
	functions.
	* m4/threadlib.m4: New file, from m4/lock.m4, renaming gl_LOCK to
	gl_THREADLIB and gl_LOCK_EARLY to gl_THREADLIB_EARLY.
	* m4/lock.m4 (gl_LOCK_EARLY, gl_LOCK_EARLY_BODY, gl_LOCK_BODY): Remove
	macros.
	(gl_LOCK): Just require gl_THREADLIB and perform checks for lock.h.
	(gl_DISABLE_THREADS): Remove macro.
	* modules/lock (Files): Remove build-aux/config.rpath.
	(Depends-on): Remove havelib. Add threadlib.
	(configure.ac-early): Remove section.
	* m4/tls.m4 (gl_TLS): Require gl_THREADLIB instead of gl_LOCK.
	* modules/tls (Depends-on): Remove lock. Add threadlib.
	(Link): New section, copied from threadlib.
	* MODULES.html.sh (Multithreading): Add threadlib.

2008-08-14  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/lock.h (glthread_lock_lock, glthread_lock_unlock,
	glthread_lock_destroy, glthread_rwlock_rdlock, glthread_rwlock_wrlock,
	glthread_rwlock_unlock, glthread_rwlock_destroy,
	glthread_recursive_lock_lock, glthread_recursive_lock_unlock,
	glthread_recursive_lock_destroy): Define as macros always.
	* lib/glthread/lock.c (glthread_lock_lock_func): Renamed from
	glthread_lock_lock.
	(glthread_lock_unlock_func): Renamed from glthread_lock_unlock.
	(glthread_lock_destroy_func): Renamed from glthread_lock_destroy.
	(glthread_rwlock_rdlock_func): Renamed from glthread_rwlock_rdlock.
	(glthread_rwlock_wrlock_func): Renamed from glthread_rwlock_wrlock.
	(glthread_rwlock_unlock_func): Renamed from glthread_rwlock_unlock.
	(glthread_rwlock_destroy_func): Renamed from glthread_rwlock_destroy.
	(glthread_recursive_lock_lock_func): Renamed from
	glthread_recursive_lock_lock.
	(glthread_recursive_lock_unlock_func): Renamed from
	glthread_recursive_lock_unlock.
	(glthread_recursive_lock_destroy_func): Renamed from
	glthread_recursive_lock_destroy.

2008-08-14  Bruno Haible  <bruno@clisp.org>

	* lib/glthread/lock.h: Renamed from lib/lock.h.
	* lib/glthread/lock.c: Renamed from lib/lock.c. Update includes.
	* lib/glthread/tls.h: Renamed from lib/tls.h.
	* lib/glthread/tls.c: Renamed from lib/tls.c. Update includes.
	* lib/fstrcmp.c: Update includes.
	* lib/strsignal.c: Update includes.
	* modules/lock (Files, Makefile.am): Update.
	(Include): Change to "glthread/lock.h".
	* modules/tls (Files, Makefile.am): Update.
	(Include): Change to "glthread/tls.h".
	* tests/test-lock.c: Update includes.
	* tests/test-tls.c: Update includes.
	* NEWS: Mention the renamed header files.

2008-08-11  Jim Meyering  <meyering@redhat.com>

	* lib/fts_.h: Fix grammar (insert a missing "is") in a comment.

2008-08-11  Eric Blake  <ebb9@byu.net>

	test-c-stack: avoid C99-ism
	* tests/test-c-stack.c (main): Fix whitespace, move declaration
	before statement.
	Reported by Alain Guibert.

2008-08-10  Jim Meyering  <meyering@redhat.com>

	ensure that return value of uinttostr et al are not ignored
	* lib/inttostr.h (__GNUC_PREREQ): Define.
	(__attribute_warn_unused_result__): Define.
	(offtostr, imaxtostr, umaxtostr, uinttostr): Apply the attribute.

2008-08-07  Paolo Bonzini  <bonzini@gnu.org>

	* lib/lock.c (glthread_recursive_lock_init_multithreaded)
	[!PTHREAD_RECURSIVE_MUTEX_INITIALIZER]: Fix typo.

2008-08-07  Jim Meyering  <meyering@redhat.com>

	* m4/inet_pton.m4: Fix typo in comment: s/inet_ntop/inet_pton/.

	* modules/mkstemp (License): Relicense under LGPLv2+.
	* modules/tempname (License): Likewise.

2008-08-06  Bruno Haible  <bruno@clisp.org>

	* lib/poll.c (poll): Further micro-optimization.

2008-08-06  Jim Meyering  <meyering@redhat.com>

	inet_pton.c: use locale-independent tolower
	* lib/inet_pton.c: Include <c-ctype.h> rather than <ctype.h>.
	(inet_pton6): Use c_tolower rather than tolower.
	* modules/inet_pton (Depends-on): Add c-ctype.

2008-08-06  Paolo Bonzini  <bonzini@gnu.org>

	* lib/poll.c (poll): Avoid division when timeout is 0, cache
	_SC_OPEN_MAX, avoid repeated access to errno.  Check for nfd < 0.

2008-08-06  Jim Meyering  <meyering@redhat.com>

	* modules/inet_pton (License): Relicense under LGPLv2+.

2008-08-03  Bruno Haible  <bruno@clisp.org>

	Additional non-aborting API for lock and tls.
	* lib/lock.h: Include <errno.h>.
	(glthread_lock_init): New macro/function.
	(gl_lock_init): Define as wrapper around glthread_lock_init.
	(glthread_lock_lock): New macro/function.
	(gl_lock_lock): Define as wrapper around glthread_lock_lock.
	(glthread_lock_unlock): New macro/function.
	(gl_lock_unlock): Define as wrapper around glthread_lock_unlock.
	(glthread_lock_destroy): New macro/function.
	(gl_lock_destroy): Define as wrapper around glthread_lock_destroy.
	(glthread_rwlock_init): New macro/function.
	(gl_rwlock_init): Define as wrapper around glthread_rwlock_init.
	(glthread_rwlock_rdlock): New macro/function.
	(gl_rwlock_rdlock): Define as wrapper around glthread_rwlock_rdlock.
	(glthread_rwlock_wrlock): New macro/function.
	(gl_rwlock_wrlock): Define as wrapper around glthread_rwlock_wrlock.
	(glthread_rwlock_unlock): New macro/function.
	(gl_rwlock_unlock): Define as wrapper around glthread_rwlock_unlock.
	(glthread_rwlock_destroy): New macro/function.
	(gl_rwlock_destroy): Define as wrapper around glthread_rwlock_destroy.
	(glthread_recursive_lock_init): New macro/function.
	(gl_recursive_lock_init): Define as wrapper around
	glthread_recursive_lock_init.
	(glthread_recursive_lock_lock): New macro/function.
	(gl_recursive_lock_lock): Define as wrapper around
	glthread_recursive_lock_lock.
	(glthread_recursive_lock_unlock): New macro/function.
	(gl_recursive_lock_unlock): Define as wrapper around
	glthread_recursive_lock_unlock.
	(glthread_recursive_lock_destroy): New macro/function.
	(gl_recursive_lock_destroy): Define as wrapper around
	glthread_recursive_lock_destroy.
	(glthread_once): New macro/function.
	(gl_once): Define as wrapper around glthread_once.
	Update function declarations.
	* lib/lock.c (glthread_rwlock_init_multithreaded): Renamed from
	glthread_rwlock_init. Return error code.
	(glthread_rwlock_rdlock_multithreaded): Renamed from
	glthread_rwlock_rdlock. Return error code.
	(glthread_rwlock_wrlock_multithreaded): Renamed from
	glthread_rwlock_wrlock. Return error code.
	(glthread_rwlock_unlock_multithreaded): Renamed from
	glthread_rwlock_unlock. Return error code.
	(glthread_rwlock_destroy_multithreaded): Renamed from
	glthread_rwlock_destroy. Return error code.
	(glthread_recursive_lock_init_multithreaded): Renamed from
	glthread_recursive_lock_init. Return error code.
	(glthread_recursive_lock_lock_multithreaded): Renamed from
	glthread_recursive_lock_lock. Return error code.
	(glthread_recursive_lock_unlock_multithreaded): Renamed from
	glthread_recursive_lock_unlock. Return error code.
	(glthread_recursive_lock_destroy_multithreaded): Renamed from
	glthread_recursive_lock_destroy. Return error code.
	(glthread_once_call): Make static.
	(glthread_once_multithreaded): Renamed from glthread_once.
	* lib/tls.h: Include <errno.h>.
	(glthread_tls_key_init): New macro/function.
	(gl_tls_key_init): Define as wrapper around glthread_tls_key_init.
	(glthread_tls_set): New macro/function.
	(gl_tls_set): Define as wrapper around glthread_tls_set.
	(glthread_tls_key_destroy): New macro/function.
	(gl_tls_key_destroy): Define as wrapper around glthread_tls_key_destroy.
	Update function declarations.
	* lib/tls.c (glthread_tls_get_multithreaded): Renamed from
	glthread_tls_get.
	Suggested by Yoann Vandoorselaere <yoann@prelude-ids.org>.

2008-08-04  Eric Blake  <ebb9@byu.net>

	gnumakefile: use space, not TAB, outside of targets
	* top/GNUmakefile (_dummy): Fix whitespace error in prior edit.

2008-08-02  Jim Meyering  <meyering@redhat.com>

	getdate.y: avoid locale-dependent date parsing failure
	In Turkish locales, getdate would fail to recognize keywords
	containing a lowercase "i".  The solution is not to rely on
	locale-sensitive case-conversion.
	* lib/getdate.y: Include <c-ctype.h> rather than <ctype.h>.
	(lookup_word): Use c_toupper in place of toupper.
	(yylex, get_date): Use c_ prefixed variants of isspace and isalpha, too.
	Reported by Vefa Bicakci <bicave@superonline.com> in
	<http://thread.gmane.org/gmane.comp.gnu.coreutils.bugs/14184>.
	* modules/getdate (Depends-on): Add c-ctype.

2008-08-02  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): When updating or creating a .gitignore
	file, prepend each added line with a slash, and ignore leading slashes
	from the existing lines.
	Reported by Joel E. Denny <jdenny@ces.clemson.edu>.

2008-08-02  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Portability fix for GNU make 3.79.1.
	* top/GNUmakefile: Avoid 'else COND', which older GNU make
	versions do not understand.

2008-08-01  Bruno Haible  <bruno@clisp.org>

	Work around bug of HP-UX 10.20 cc with -0.0 literal.
	* tests/test-isnanf.h (zero): New variable.
	(main): Avoid literal -0.0f.
	* tests/test-isnand.h (zero): New variable.
	(main): Avoid literal -0.0.
	* tests/test-isnanl.h (zero): New variable.
	(main): Avoid literal -0.0L.
	* tests/test-isnan.c (zerof, zerod, zerol): New variables.
	(test_float, test_double, test_long_double): Avoid literals -0.0f,
	-0.0, -0.0L.
	* tests/test-signbit.c (test_signbitf): Avoid literal -0.0f.
	(test_signbitd): Avoid literal -0.0.
	(test_signbitl): Avoid literal -0.0L.
	* tests/test-ceilf1.c (zero): New variable.
	(main): Avoid literal -0.0f.
	* tests/test-ceill.c (zero): New variable.
	(main): Avoid literal -0.0L.
	* tests/test-floorf1.c (zero): New variable.
	(main): Avoid literal -0.0f.
	* tests/test-floorl.c (zero): New variable.
	(main): Avoid literal -0.0L.
	* tests/test-roundf1.c (zero): New variable.
	(main): Avoid literal -0.0f.
	* tests/test-round1.c (zero): New variable.
	(main): Avoid literal -0.0.
	* tests/test-roundl.c (zero): New variable.
	(main): Avoid literal -0.0L.
	* tests/test-truncf1.c (zero): New variable.
	(main): Avoid literal -0.0f.
	* tests/test-trunc1.c (zero): New variable.
	(main): Avoid literal -0.0.
	* tests/test-truncl.c (zero): New variable.
	(main): Avoid literal -0.0L.
	* tests/test-frexp.c (zero): New variable.
	(main): Avoid literal -0.0.
	* tests/test-frexpl.c (zero): New variable.
	(main): Avoid literal -0.0L.
	* tests/test-ldexpl.c (zero): New variable.
	(main): Avoid literal -0.0L.
	* tests/test-snprintf-posix.h (have_minus_zero): Avoid literal -0.0.
	(zerod, zerol): New variables.
	(test_function): Avoid literals -0.0, -0.0L.
	* tests/test-sprintf-posix.h (have_minus_zero): Avoid literal -0.0.
	(zerod, zerol): New variables.
	(test_function): Avoid literals -0.0, -0.0L.
	* tests/test-vasnprintf-posix.c (have_minus_zero): Avoid literal -0.0.
	(zerod, zerol): New variables.
	(test_function): Avoid literals -0.0, -0.0L.
	* tests/test-vasprintf-posix.c (have_minus_zero): Avoid literal -0.0.
	(zerod, zerol): New variables.
	(test_function): Avoid literals -0.0, -0.0L.
	* tests/test-strtod.c (zero): New variable.
	(main): Avoid literal -0.0.
	Reported by Jonathan C. Patschke <jp@centtech.com>.

2008-07-31  Jim Meyering  <meyering@redhat.com>

	sha256.h: correct definition of SHA224_DIGEST_SIZE
	* lib/sha256.h (SHA224_DIGEST_SIZE): Define to 28, not 24.
	Reported by Paulie Pena IV <paulie4@gmail.com>.
	Define as 224 / 8, rather than as a literal.
	(SHA256_DIGEST_SIZE): Define as 256/8 rather than equivalent literal.
	* lib/sha512.h (SHA384_DIGEST_SIZE): Likewise, define as equiv: 384/8.
	(SHA512_DIGEST_SIZE): Likewise, define as equivalent quotient: 512/8.

2008-07-31  Bruno Haible  <bruno@clisp.org>

	* lib/regex_internal.h (BITSET_WORD_BITS): Make first conditional work
	on HP-UX 10.20 with "cc -Ae". Fix second conditional.
	Reported by Jonathan Patschke <jp@centtech.com>.

2008-07-31  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Make change from 2008-06-23 more robust.
	Reported by Paolo Bonzini <bonzini@gnu.org>.

2008-07-30  Eric Blake  <ebb9@byu.net>

	test-strtod: allow compilation without -lm
	* tests/test-strtod.c (main): Avoid link dependence on fabs.
	Reported by Dennis Clarke <blastwave@gmail.com>.

2008-07-28  Jim Meyering  <meyering@redhat.com>

	bootstrap: work also when there are no .po files in po/
	* build-aux/bootstrap (update_po_files): Complete the change
	that I began in bc960df8c789c878f1c1c54a28a3c2648dead8d9.

2008-07-27  Jim Meyering  <meyering@redhat.com>

	* users.txt: Add zile.

2008-07-26  Ben Pfaff  <blp@gnu.org>

	Add missing dependencies on new m4/exponent[fdl].m4 files.
	* modules/isnanf-nolibm: Add m4/exponentf.m4.
	* modules/isnand-nolibm: Add m4/exponentd.m4.
	* modules/isnanl-nolibm: Add m4/exponentl.m4.
	* modules/signbit-tests: Use m4/exponent[fdl].m4 instead of
	m4/isnan[fdl].m4, because the macros actually used moved.
	Reported by Jim Meyering.

2008-07-14  Ben Pfaff  <blp@gnu.org>

	Add isinf module.
	* lib/isinf.c: New file.
	* lib/math.in.h: Define isinf macro if we have decided to replace
	it.
	* m4/isinf.m4: New file.
	* m4/math_h.m4: Initialize and substitute variables for isinf
	module.
	* modules/isinf: New file.
	* modules/isinf-tests: New file.
	* modules/math: Add substitutions for new module.
	* tests/test-isinf.c: New file.
	* doc/posix-functions/isinf.texi: Mention new module.
	* MODULES.html.sh: Mention new module.

2008-07-14  Ben Pfaff  <blp@gnu.org>

	Factor out some macros for use by additional modules.
	* m4/isnanf.m4 (gl_FLOAT_EXPONENT_LOCATION): Move into new file
	exponentf.m4.
	* m4/isnand.m4 (gl_DOUBLE_EXPONENT_LOCATION): Move into new file
	exponentd.m4.
	* m4/isnanl.m4 (gl_LONG_DOUBLE_EXPONENT_LOCATION): Move into new
	file exponentl.m4.
	* m4/exponentf.m4: New file.
	* m4/exponentd.m4: New file.
	* m4/exponentl.m4: New file.
	* modules/isnanf: Use new file m4/exponentf.m4.
	* modules/isnand: Use new file m4/exponentd.m4.
	* modules/isnanl: Use new file m4/exponentl.m4.

2008-07-23  Ulrich Drepper  <drepper@redhat.com>

	mktime.c: normalize tp->tm_isdst value to -1/0/1.
	* lib/mktime.c (__mktime_internal): Normalize tp->tm_isdst value.
	Reported by Michael Ringe <Michael.Ringe@gmx.de> in
	<http://sourceware.org/bugzilla/show_bug.cgi?id=6723>.

	* lib/canonicalize-lgpl.c (__realpath): Avoid buffer overflow after
	readlink on platforms without PATH_MAX.

2008-07-21  Eric Blake  <ebb9@byu.net>

	Warn, not fail, on stale version.
	* top/GNUmakefile (_curr-ver): Tone down previous patch.

	Don't allow installation with stale devel version number.
	* top/GNUmakefile (_is-install-target): New macro.
	(_curr-ver): Forbid installation with stale version number.

2008-07-20  Bruno Haible  <bruno@clisp.org>

	* modules/c-stack-tests (Makefile.am): Add LIBSIGSEGV to
	TESTS_ENVIRONMENT.
	* tests/test-c-stack2.sh: React differently if LIBSIGSEGV is in use.

2008-07-20  Bruno Haible  <bruno@clisp.org>

	* lib/c-stack.h (c_stack_action): Add documentation.
	* lib/c-stack.c (c_stack_action): Remove incomplete documentation.

2008-07-20  Bruno Haible  <bruno@clisp.org>

	* modules/canonicalize-lgpl (License): Relicense under LGPLv2+.
	* modules/readlink (License): Likewise.

2008-07-17  Eric Blake  <ebb9@byu.net>

	* modules/c-stack (Link): Fix typo.

	Make c-stack use libsigsegv, when available.
	* modules/c-stack (Depends-on): Add libsigsegv.
	* modules/c-stack-tests (Makefile.am): Link with libsigsegv, if
	needed.
	* lib/c-stack.c (SIGSTKSZ): Define fallback.
	(segv_handler, overflow_handler, c_stack_action)
	[HAVE_LIBSIGSEGV && !HAVE_XSI_STACK_OVERFLOW_HEURISTIC]: Add new
	implementation when libsigsegv is available, but only when using
	the library is necessary.
	* m4/c-stack.m4 (AC_SYS_XSI_STACK_OVERFLOW_HEURISTIC): Add
	comment, explaining why XSI check fails on Linux.
	(gl_PREREQ_C_STACK): Supply LIBCSTACK, LTLIBCSTACK.
	* tests/test-c-stack2.sh: Tweak skip message.
	* NEWS: Document new link-time requirements.

2008-07-16  Eric Blake  <ebb9@byu.net>

	c-stack: Expose false positives when not using libsigsegv.
	* modules/c-stack-tests (Files): Expand test.
	* tests/test-c-stack.c (main): Add means to conditionally trigger
	non-overflow SIGSEGV.
	* tests/test-c-stack2.sh: New file.

2008-07-14  Bruno Haible  <bruno@clisp.org>

	* m4/libsigsegv.m4: Remove unneeded AC_PREREQ.
	Reported by Eric Blake.

2008-07-14  Sam Steingold  <sds@gnu.org>
	    Bruno Haible  <bruno@clisp.org>

	New module libsigsegv.
	* modules/libsigsegv: New file.
	* m4/libsigsegv.m4: New file, from GNU clisp sigsegv.m4 with
	modifications.
	* MODULES.html.sh (Signal handling): New section.

2008-07-14  Bruno Haible  <bruno@clisp.org>

	* modules/unictype/ctype-* (Description): Add the word "function".
	Improves the resulting doc in MODULES.html.

2008-07-12  Ben Pfaff  <blp@gnu.org>

	Add longlong module.
	* modules/longlong: New file.

2008-07-12  Bruno Haible  <bruno@clisp.org>

	* m4/isnan.m4 (gl_ISNAN): When the replacement is used, set ISNAN_LIBM
	to empty.

2008-07-10  Ben Pfaff  <blp@gnu.org>

	Add isnan module.
	* doc/posix-functions/isnan.texi: Mention new module.
	* lib/math.in.h: Define isnan macro if we have decided to replace
	it.
	* m4/isnan.m4: New file.
	* m4/isnanl.m4 (gl_FUNC_ISNANL): Factor out some code into new
	macro gl_BUILD_ISNANL so that isnan.m4 can use that functionality
	also.
	(gl_FUNC_ISNANL_NO_LIBM): Factor out same code, to reduce
	redundancy.
	* m4/math_h.m4: Initialize and substitute variables for isnan
	module.
	* modules/isnan: New file.
	* modules/isnan-tests: New file.
	* modules/math: Add substitutions for new module.
	* tests/test-isnan.c: New file.
	* MODULES.html.sh: Mention new module.

2008-07-10  Ben Pfaff  <blp@gnu.org>

	Add isnanf module.
	* lib/isnanf.m4: New file.
	* m4/isnanf.m4 (gl_FUNC_ISNANF): New macro.
	(gl_HAVE_ISNANF_IN_LIBM): New macro.
	(gl_BUILD_ISNANF): New macro used by gl_FUNC_ISNANF,
	gl_FUNC_ISNANF_NO_LIBM, and gl_FUNC_ISNAN.
	* modules/isnanf: New file.
	* modules/isnanf-tests: New file.
	* modules/isnanf-nolibm-tests: Add tests/test-isnanf.h to list of
	files.
	* tests/test-isnanf-nolibm.c: factored most of its contents into
	new file tests/test-isnanf.h.
	* tests/test-isnanf.h: New file.
	* tests/test-isnanf.c: New file.
	* MODULES.html.sh: Mention new module.
	* doc/glibc-functions/isnanf.texi: Mention new module.

2008-07-10  Ben Pfaff  <blp@gnu.org>

	Add isnand module.
	* lib/isnand.h: New file.
	* m4/isnand.m4 (gl_FUNC_ISNAND): New macro.
	(gl_FUNC_ISNAND_NO_LIBM): Split partially into new macro
	gl_HAVE_ISNAND_NO_LIBM so that gl_FUNC_ISNAND can use that
	functionality also.
	(gl_BUILD_ISNAND): New macro used by gl_FUNC_ISNAND,
	gl_FUNC_ISNAND_NO_LIBM, and gl_FUNC_ISNAN.
	(gl_HAVE_ISNAND_IN_LIBM): New macro.
	* modules/isnand: New file.
	* modules/isnand-tests: New file.
	* modules/isnand-nolibm-tests: Add tests/test-isnand.h to list of
	files.
	* tests/test-isnand-nolibm.c: factored most of its contents into
	new file tests/test-isnand.h.
	* tests/test-isnand.h: New file.
	* tests/test-isnand.c: New file.
	* MODULES.html.sh: Mention new module.

2008-07-10  Ben Pfaff  <blp@gnu.org>

	* lib/isnanf.h: Rename lib/isnanf-nolibm.h.
	* lib/isnand.h: Rename lib/isnand-nolibm.h.
	* tests/test-isnanf.c: Rename tests/test-isnanf-nolibm.c.
	* tests/test-isnand.c: Rename tests/test-isnand-nolibm.c.
	* modules/isnanf-nolibm: Update references to renamed files.
	* modules/isnand-nolibm: Likewise.
	* modules/isnanf-nolibm-tests: Likewise.
	* modules/isnand-nolibm-tests: Likewise.
	* lib/frexp.c: Likewise.
	* lib/isfinite.c: Likewise.
	* lib/signbitd.c: Likewise.
	* lib/signbitf.c: Likewise.
	* lib/vasnprintf.c: Likewise.
	* tests/test-ceilf1.c: Likewise.
	* tests/test-ceilf2.c: Likewise.
	* tests/test-floorf1.c: Likewise.
	* tests/test-floorf2.c: Likewise.
	* tests/test-frexp.c: Likewise.
	* tests/test-round1.c: Likewise.
	* tests/test-round2.c: Likewise.
	* tests/test-roundf1.c: Likewise.
	* tests/test-strtod.c: Likewise.
	* tests/test-trunc1.c: Likewise.
	* tests/test-trunc2.c: Likewise.
	* tests/test-truncf1.c: Likewise.
	* tests/test-truncf2.c: Likewise.
	* NEWS: Mention the renamed header files.

2008-07-11  Jim Meyering  <meyering@redhat.com>

	vc-list-files: make the last-resort awk code more portable
	* build-aux/vc-list-files: Don't rely on awk's "sub" command.
	/bin/awk from OpenSolaris 11's SUNWesu version 2008.03.22.10.56
	does not support it.

2008-07-10  Eric Blake  <ebb9@byu.net>

	Work with tar's bootstrap.
	* gnulib-tool (func_emit_initmacro_end): Use m4_defn in the case
	where LIBSOURCES_DIR contains .#bootmp but must not be treated as
	an m4 comment.

2008-07-09  Jim Meyering  <meyering@redhat.com>

	posix-shell.m4: fix typo that made this test malfunction
	* m4/posix-shell.m4: Remove capitalization in variable name.

2008-07-08  Bruno Haible  <bruno@clisp.org>

	* m4/onceonly.m4: Update comments.
	Reported by Ben Pfaff <blp@cs.stanford.edu>.

2008-07-04  Jim Meyering  <meyering@redhat.com>

	* users.txt: Add vc-dwim.
	(bison, coreutils): Use the gitweb URL.

2008-07-03  Jim Meyering  <meyering@redhat.com>

	* users.txt: Add libffcall.  From Sam Steingold.

2008-07-03  Ondřej Vašík  <ovasik@redhat.com>

	getdate.y: do not ignore TZ with relative day, month or year offset
	* lib/getdate.y (get_date): Move the tz-handling block to follow the
	relative-date-handling, since otherwise, the latter would clobber the
	sole output (an updated Start value) of the tz-handling block.
	* tests/test-getdate.c: Tests for the fix

2008-07-03  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Recognize 'foo_LIBRARIES += libgnu.a'.
	* gnulib-tool (func_emit_lib_Makefile_am): Recognize if a
	makefile snippet has already specified an installation location,
	also using '+='.

2008-07-02  Ondřej Vašík  <ovasik@redhat.com>

	getdate.y: factor out common actions
	* lib/getdate.y (apply_relative_time, set_hhmmss): New functions.
	Use them in place of open-coded actions.

2008-07-01  Simon Josefsson  <simon@josefsson.org>

	Add self-test for getdate module.
	* modules/getdate-tests: New file.
	* tests/test-getdate.c: New file.

2008-06-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Put gnulib-comp.m4 into .cvsignore or
	.gitignore.
	Reported by Sylvain Beucler <beuc@beuc.net>.

2008-06-29  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (VCS Issues): Mention --no-vc-files option.
	* m4/gnulib-tool.m4: Update to match current gnulib-tool.

2008-06-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Recommend to put gnulib-cache.m4 into
	EXTRA_DIST.
	Reported by Sylvain Beucler <beuc@beuc.net>.

2008-06-26  Jim Meyering  <meyering@redhat.com>

	make several modules depend on the "open" module
	This provides slightly increased consistency when opening-for-write
	the name of a non-directory spelled with a trailing slash.
	* modules/chdir-safer: Likewise.
	* modules/chown: Likewise.
	* modules/clean-temp: Likewise.
	* modules/copy-file: Likewise.
	* modules/fchdir: Likewise.
	* modules/fcntl-safer: Likewise.
	* modules/pipe: Likewise.
	* modules/utime: Likewise.
	Prompted by Eric Blake and Bruno Haible.

2008-06-24  Andreas Schwab  <schwab@suse.de>

	* m4/getdate.m4 (gl_C_COMPOUND_LITERALS): Don't test whether compound
	literals can be used as initializers for global variables.

2008-06-23  Eric Blake  <ebb9@byu.net>

	Make gnulib-cache.m4 easier to diff.
	* gnulib-tool (func_import): Allow newlines when reading cached
	gl_MODULES, and generate newlines when creating gnulib-cache.m4.

2008-06-23  Bruno Haible  <bruno@clisp.org>

	* m4/signalblocking.m4 (gl_PREREQ_SIG_HANDLER_H): Remove macro.
	(gl_PREREQ_SIGPROCMASK): Don't invoke it.
	* m4/sigaction.m4 (gl_PREREQ_SIG_HANDLER_H): New macro, moved here from
	m4/signalblocking.m4.
	(gl_PREREQ_SIGACTION): Don't invoke it.
	* m4/nanosleep.m4 (gl_PREREQ_NANOSLEEP): Invoke
	gl_PREREQ_SIG_HANDLER_H.
	* m4/fatal-signal.m4 (gl_FATAL_SIGNAL): Likewise.
	Don't check for sigaction here.

2008-06-23  Bruno Haible  <bruno@clisp.org>

	* lib/fatal-signal.c (fatal_signal_handler): Update comment.
	(install_handlers): Don't set the SA_RESETHAND flag.

2008-06-23  Bruno Haible  <bruno@clisp.org>

	* m4/sigaction.m4: Comment fixes.
	* lib/signal.in.h: Likewise.

2008-06-23  Eric Blake  <ebb9@byu.net>

	Fix typo.
	* tests/test-sigaction.c (MASK_SA_FLAGS): Add missing operator.

	Avoid SA_ namespace.
	* tests/test-sigaction.c (MASK_SA_FLAGS): Rename from SA_MASK.
	Reported by Ralf Wildenhues.

	Avoid test failure due to SA_RESTORER.
	* tests/test-sigaction.c (SA_MASK): New macro.
	(main): Avoid failing due to extension flags being set.
	Reported by Jim Meyering.

	Revert use of sig-handler.h in sigprocmask.c.
	* modules/sigprocmask (Files): Don't rely on sig-handler.h, since
	it requires the existence of struct sigaction.
	* lib/sigprocmask.c (handler_t): Restore typedef.
	(rpl_signal, old_handlers): Use local type.

2008-06-22  Bruno Haible  <bruno@clisp.org>

	* tests/test-stdint.c: Disable the INTMAX_MAX preprocessor test
	conditionally.
	Reported by Albert Chin <bug-gnulib@mlists.thewrittenword.com>.

2008-06-22  Bruno Haible  <bruno@clisp.org>

	* doc/posix-functions/siginterrupt.texi: Move note.

	* lib/signal.in.h (SA_RESTART): New macro.
	* lib/sigaction.c: Update comment.

	* m4/sigaction.m4 (gl_SIGACTION): Require gl_SIGNAL_H_DEFAULTS.

	* m4/signalblocking.m4 (gl_PREREQ_SIG_HANDLER_H): New macro.
	(gl_PREREQ_SIGPROCMASK): Invoke it.
	* m4/sigaction.m4 (gl_PREREQ_SIGACTION): Likewise.

	* lib/nanosleep.c (rpl_nanosleep): Setup newact only when it is needed.

	* lib/sigprocmask.c: Update a comment.

2008-06-21  Eric Blake  <ebb9@byu.net>

	Use sigaction module rather than signal().
	* modules/c-stack (Depends-on): Add sigaction.
	* modules/fatal-signal (Depends-on): Likewise.
	* modules/nanosleep (Depends-on): Likewise.
	* modules/sigprocmask (Files): Add sig-handler.h.
	* modules/sigaction (Files): Likewise.
	* lib/sig-handler.h (get_handler): New file, suggested by Paul
	Eggert.
	* lib/c-stack.c (SIGACTION_WORKS): Simplify conditions.
	(c_stack_action) [!SIGACTION_WORKS]: Use sigaction, not signal.
	* lib/fatal-signal.c (uninstall_handlers, install_handlers)
	(init_fatal_signals): Likewise.
	* lib/nanosleep.c (rpl_nanosleep): Likewise.
	(siginterrupt): Delete fallback.
	* lib/sigprocmask.c (handler_t, old_handlers): Use sa_handler_t
	instead.
	* m4/nanosleep.m4 (gl_PREREQ_NANOSLEEP): Drop check for
	siginterrupt.

	New module sigaction, for mingw.
	* modules/sigaction: New module...
	* modules/sigaction-tests: ...and its test.
	* m4/sigaction.m4: New file.
	* lib/sigaction.c: Likewise.
	* tests/test-sigaction.c: Likewise.
	* m4/signal_h.m4 (gl_SIGNAL_H_DEFAULTS): Add sigaction variables.
	* modules/signal (Makefile.am): Likewise.
	* lib/signal.in.h (!@HAVE_SIGACTION@): Define replacements when
	needed.
	* doc/posix-headers/signal.texi (signal.h): Mention provided
	types.
	* doc/posix-functions/siginterrupt.texi (siginterrupt): Mention
	that sigaction is preferable.
	* doc/posix-functions/sigaction.texi (sigaction): Mention new
	module.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add
	sigaction.

	Improve robustness of sigprocmask by overriding signal.
	* lib/signal.in.h (rpl_signal): Override signal when sigprocmask
	is in use.
	* lib/sigprocmask.c (blocked_handler): Reinstall block handler.
	(SIGKILL, SIGSTOP): Provide fallbacks.
	(rpl_signal): Implement.
	(old_handlers, blocked_set): Mark volatile, since sigprocmask and
	signal can be called inside handlers.

	Fix nanosleep module on mingw.
	* modules/nanosleep (Depends-on): Add sys_select.
	* lib/nanosleep.c (HAVE_SYS_SELECT_H): Rely on gnulib module.

	Fix licensing of sigprocmask.
	* modules/raise (License): Relicense as LGPL.

2008-06-21  Bruno Haible  <bruno@clisp.org>

	* lib/propername.c (proper_name_utf8): Don't use the transliterated
	result if it contains question marks.
	Reported by Michael Geng <linux@michaelgeng.de>.

2008-06-19  Bruno Haible  <bruno@clisp.org>

	Fix CVS-ism.
	* doc/gnulib.texi: Include updated-stamp.texi.
	* doc/Makefile (GNULIB_TEXI_FILES): New variable.
	(updated-stamp.texi): New rule.
	(gnulib.info): Depend on it.
	* doc/.gitignore: Add updated-stamp.texi.
	Based on a patch by Thien-Thi Nguyen <ttn@gnuvola.org>.

2008-06-19  Bruno Haible  <bruno@clisp.org>

	* doc/Makefile (gnulib.info): Update and simplify dependencies.
	Reported by Thien-Thi Nguyen <ttn@gnuvola.org>.

2008-06-19  Eric Blake  <ebb9@byu.net>

	Fix VPATH 'make dist' with GNU make and non-VCS tarball.
	* top/GNUmakefile (_curr-ver): Don't use $(srcdir) unnecessarily.
	Reported by Stepan Kasal.

2008-06-18  Bruno Haible  <bruno@clisp.org>

	* lib/fatal-signal.c (init_fatal_signals): Add comment.
	Reported by Eric Blake.

2008-06-18  Eric Blake  <ebb9@byu.net>

	Work around cygwin 1.5.25 strsignal bug.
	* tests/test-strsignal.c: Allow for const char *.
	* doc/glibc-functions/strsignal.texi (strsignal): Document the bug.

2008-06-18  Simon Josefsson  <simon@josefsson.org>

	* users.txt: Update URL to article and add author/date
	information.

2008-06-17  Bruno Haible  <bruno@clisp.org>

	New macro gl_DISABLE_THREADS.
	* m4/lock.m4 (gl_LOCK_EARLY_BODY): Use value gl_use_threads_default
	if the user did not pass --enable-threads or --disable-threads option.
	(gl_DISABLE_THREADS): New macro.
	Reported by Eric Blake <ebb9@byu.net>.

2008-06-17  Bruno Haible  <bruno@clisp.org>

	* lib/tls.h (gl_tls_key_init): Evaluate the destructor argument also
	when the macro ignores it.
	Based on a patch by Eric Blake <ebb9@byu.net>.

2008-06-17  Bruno Haible  <bruno@clisp.org>

	* modules/tls (License): Change to LGPLv2+.
	Reported by Eric Blake.

2008-06-17  Eric Blake  <ebb9@byu.net>

	Simplify c-stack prerequisites.
	* lib/c-stack.c (includes): Remove unused <sys/resource.h>.
	* m4/c-stack.m4 (AC_SYS_XSI_STACK_OVERFLOW_HEURISTIC): Posix 200x
	no longer requires <ucontext.h> to exist.  Optimize setrlimit
	check.
	(gl_PREREQ_C_STACK): Remove check for unused getcontext and
	<sys/resource.h>.

	Move c-stack test into testsuite.
	* modules/c-stack-tests: New file.
	* lib/c-stack.c [DEBUG]: Move test program...
	* tests/test-c-stack.c: ...into this new file.  Skip rather than
	fail test if sigaltstack is lacking.
	* tests/test-c-stack.sh: New driver file.

2008-06-16  Eric Blake  <ebb9@byu.net>

	Use raise module consistently.
	* modules/fatal-signal (Depends-on): Add raise.
	* modules/sigprocmask (Depends-on): Likewise.
	* lib/fatal-signal.c (fatal_signal_handler): Rely on raise.
	* lib/sigprocmask.c (sigprocmask): Likewise.
	* m4/fatal-signal.m4 (gl_FATAL_SIGNAL): Likewise.
	* m4/signalblocking.m4 (gl_PREREQ_SIGPROCMASK): Likewise.

	Fix compliance bug in sigpending.
	* lib/sigprocmask.c (sigpending): Return pending array via
	parameter, not return value.

2008-06-14  Eric Blake  <ebb9@byu.net>

	Improve obstack-printf test code.
	* tests/test-obstack-printf.c (test_function): Fix comment, and
	simplify usage of obstack_* in macros.  Add a test for coverage.
	Reported by Bruno Haible.

2008-06-14  Bruno Haible  <bruno@clisp.org>

	* lib/obstack_printf.c (obstack_vprintf): Define the stack-allocated
	array size as a constant, not as a const variable.
	* m4/obstack-printf.m4 (gl_FUNC_OBSTACK_PRINTF): Require
	AC_USE_SYSTEM_EXTENSIONS.
	* m4/obstack-printf-posix.m4 (gl_FUNC_OBSTACK_PRINTF_POSIX): Likewise.
	Test whether the obstack_printf function actually exists.
	* modules/obstack-printf (Depends-on): Add extensions.
	(Include): Remove obstack.h.
	* modules/obstack-printf-posix (Depends-on): Add extensions.
	(Include): Remove obstack.h.

2008-06-13  Eric Blake  <ebb9@byu.net>

	Add obstack-printf and obstack-printf-posix modules.
	* modules/obstack-printf: New file.
	* modules/obstack-printf-posix: Likewise.
	* MODULES.html.sh (Misc): Mention them.
	* doc/glibc-functions/obstack_printf.texi (obstack_printf):
	Likewise.
	* doc/glibc-functions/obstack_vprintf.texi (obstack_vprintf):
	Likewise.
	* modules/stdio (Makefile.am): Accomodate new modules.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Likewise.
	* lib/stdio.in.h (rpl_obstack_printf, rpl_obstack_vprintf):
	Declare.
	* lib/obstack_printf.c (obstack_printf, obstack_vprintf): New
	functions.
	* m4/obstack-printf.m4 (gl_OBSTACK_PRINTF)
	(gl_REPLACE_OBSTACK_PRINTF): New macros
	* m4/obstack-printf-posix.m4 (gl_OBSTACK_PRINTF_POSIX): Likewise.
	* tests/test-obstack-printf.c: New file.
	* modules/obstack-printf-tests: Likewise.
	* modules/obstack-printf-posix-tests: Likewise.

2008-06-11  Bruno Haible  <bruno@clisp.org>

	* m4/open.m4 (gl_FUNC_OPEN): Add test against trailing slash bug.
	* lib/open.c: Include errno.h.
	(open): Fail when attempting to write to a file that has a trailing
	slash.
	* tests/test-open.c (main): Test against trailing slash bug.
	* doc/posix-functions/open.texi: Mention the trailing slash bug.

2008-06-10  Bruno Haible  <bruno@clisp.org>

	* tests/test-vc-list-files-git.sh: Make double use of 'exit'. Needed
	for $? to work inside the trap command, with various /bin/sh-s.
	* tests/test-vc-list-files-cvs.sh: Likewise.

2008-06-10  Bruno Haible  <bruno@clisp.org>

	* lib/acl-internal.h: Don't include gettext.h here.
	* lib/set-mode-acl.c: Include gettext.h here.
	* lib/copy-acl.c: Likewise.

2008-06-10  Bruno Haible  <bruno@clisp.org>

	* lib/wait-process.h (wait_subprocess): Add termsigp argument.
	* lib/wait-process.c (wait_subprocess): Likewise.
	* lib/execute.h (execute): Add termsigp argument.
	* lib/execute.c (execute): Likewise.
	* lib/csharpcomp.c (compile_csharp_using_pnet,
	compile_csharp_using_mono, compile_csharp_using_sscli): Update.
	* lib/csharpexec.c (execute_csharp_using_pnet,
	execute_csharp_using_mono, execute_csharp_using_sscli): Update.
	* lib/javacomp.c (compile_using_envjavac, compile_using_gcj,
	compile_using_javac, compile_using_jikes, is_envjavac_gcj,
	is_envjavac_gcj43, is_gcj_present, is_gcj_43, is_javac_present,
	is_jikes_present): Update.
	* lib/javaexec.c (execute_java_class): Update.
	* lib/javaversion.c (execute_and_read_line): Update.
	* NEWS: Document the changes.
	Reported by Eric Blake.

2008-06-10  Eric Blake  <ebb9@byu.net>

	Add missing include.
	* tests/test-strstr.c (includes): Add <signal.h>.
	* tests/test-strcasestr.c (includes): Likewise.
	* tests/test-memmem.c (includes): Likewise.

2008-06-10  Bruno Haible  <bruno@clisp.org>

	* lib/wait-process.c (wait_subprocess): Add an assertion.

2008-06-10  Bruno Haible  <bruno@clisp.org>

	* lib/wait-process.c (wait_subprocess): Try to fix waitid() based code.

2008-06-10  Bruno Haible  <bruno@clisp.org>

	* tests/test-memmem.c (main): Reset SIGALRM to default handling before
	using alarm().
	* tests/test-strcasestr.c (main): Likewise.
	* tests/test-strstr.c (main): Likewise.

2008-06-09  Bruno Haible  <bruno@clisp.org>

	Work around the Solaris 10 ACE ACLs ABI change.
	* lib/acl-internal.h (acl_nontrivial, acl_ace_nontrivial): Don't
	declare if ACL_NO_TRIVIAL is present.
	(ACE_ACCESS_ALLOWED_ACE_TYPE, ACE_ACCESS_DENIED_ACE_TYPE,
	NEW_ACE_OWNER, NEW_ACE_GROUP, NEW_ACE_IDENTIFIER_GROUP, ACE_EVERYONE,
	NEW_ACE_READ_DATA, NEW_ACE_WRITE_DATA, NEW_ACE_EXECUTE): New macros.
	* lib/file-has-acl.c (acl_nontrivial, acl_ace_nontrivial): Don't
	define if ACL_NO_TRIVIAL is present.
	(acl_ace_nontrivial): Detect whether the old or new ABI is in use,
	and use the current ABI.
	(file_has_acl): Use same #if condition as elsewhere.
	* lib/set-mode-acl.c (qset_acl): Detect whether the old or new ABI is
	in use, and use the current ABI.
	* doc/acl-resources.txt: More doc about newer Solaris 10 versions.
	Reported by Jim Meyering.

2008-06-09  Eric Blake  <ebb9@byu.net>

	Work around environments that (stupidly) ignore SIGALRM.
	* m4/strstr.m4 (gl_FUNC_STRSTR): Reset SIGALRM to default handling
	before using alarm().
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR): Likewise.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): Likewise.
	Reported by Ian Beckwith <ianb@erislabs.net>.

	Produce autobuild blurb earlier in log.
	* modules/autobuild (configure.ac-early): Move AB_INIT here.

2008-06-09  Jim Meyering  <meyering@redhat.com>
	and Ondřej Vašík  <ovasik@redhat.com>

	utimens.c: correct kernel bug work-around
	Ondřej Vašík found that the invalid return value of 280 indicates
	failure, not success, and the kernel bug we're trying to work
	around affects not just the utimensat call, but also the fallback
	futimens call.
	* lib/utimens.c (gl_futimens) [HAVE_UTIMENSAT]: Simulate failure,
	not success.
	[HAVE_FUTIMENS]: Use the same work-around, here.

2008-06-09  Jim Meyering  <meyering@redhat.com>

	add more guards around definition of ACE_-related code
	* lib/file-has-acl.c (acl_ace_nontrivial): Define only if
	ALLOW and ACE_OWNER are also defined.

2008-06-08  Bruno Haible  <bruno@clisp.org>

	* lib/acl-internal.h: Add me as co-author.
	* lib/file-has-acl.c: Likewise.
	* lib/set-mode-acl.c: Likewise.
	* lib/copy-acl.c: Likewise.

2008-06-08  Bruno Haible  <bruno@clisp.org>

	Add support for AIX ACLs.
	* lib/acl-internal.h (acl_nontrivial): New declaration.
	* lib/file-has-acl.c (acl_nontrivial): New function.
	(file_has_acl): Add implementation using AIX 4 ACL API.
	* lib/set-mode-acl.c (qset_acl): Likewise.
	* lib/copy-acl.c (qcopy_acl): Likewise.

2008-06-08  Bruno Haible  <bruno@clisp.org>

	Add support for HP-UX ACLs.
	* lib/acl-internal.h (acl_nontrivial): New declaration.
	* lib/file-has-acl.c (acl_nontrivial): New function.
	(file_has_acl): Add implementation using HP-UX 11 ACL API.
	* lib/set-mode-acl.c (qset_acl): Likewise.
	* lib/copy-acl.c (qcopy_acl): Likewise.

2008-06-08  Bruno Haible  <bruno@clisp.org>

	Add support for Cygwin ACLs.
	* lib/acl-internal.h (MODE_INSIDE_ACL): New macro for Solaris-like API.
	* lib/set-mode-acl.c (qset_acl) [!MODE_INSIDE_ACL]: Don't optimize away
	the chmod_or_fchmod call.
	* lib/copy-acl.c (qcopy_acl) [!MODE_INSIDE_ACL]: Likewise.

2008-06-08  Bruno Haible  <bruno@clisp.org>

	Fix bug with setuid modes in Solaris 10+ code.
	* lib/set-mode-acl.c (qset_acl): Call chmod_or_fchmod when acl_set
	succeeded, when the mode contains some special bits.

2008-06-08  Bruno Haible  <bruno@clisp.org>

	Add support for Solaris 7..10 ACLs.
	* lib/acl-internal.h (acl_nontrivial, acl_ace_nontrivial): New
	declarations.
	* lib/file-has-acl.c (acl_nontrivial, acl_ace_nontrivial): New
	functions.
	(file_has_acl): Add implementation using Solaris 7..10 ACL API.
	* lib/set-mode-acl.c (qset_acl): Likewise.
	* lib/copy-acl.c (qcopy_acl): Likewise.

2008-06-08  Bruno Haible  <bruno@clisp.org>

	* lib/acl-internal.h (acl_extended_nontrivial) [MacOS X]: New
	declaration.
	* lib/file-has-acl.c (acl_extended_nontrivial) [MacOS X]: New function.
	(acl_access_nontrivial): Remove MacOS X case.
	(file_has_acl): Use acl_extended_nontrivial.
	* lib/copy-acl.c (qcopy_acl): Likewise.

2008-06-08  Bruno Haible  <bruno@clisp.org>

	* lib/set-mode-acl.c (qset_acl): Trivial code simplifications.

2008-06-08  Jim Meyering  <meyering@redhat.com>

	* modules/acl (Maintainer): Add Bruno Haible.

2008-06-07  Bruno Haible  <bruno@clisp.org>

	Improve support for Tru64 ACLs.
	* lib/file-has-acl.c (file_has_acl): Don't test the ACL_TYPE_DEFAULT
	ACL on OSF/1.

2008-06-07  Bruno Haible  <bruno@clisp.org>

	Add support for MacOS X ACLs.
	* lib/file-has-acl.c (file_has_acl): Use ACL_TYPE_EXTENDED instead of
	ACL_TYPE_ACCESS and ACL_TYPE_DEFAULT.
	* lib/set-mode-acl.c (qset_acl): Likewise.
	* lib/copy-acl.c (qcopy_acl): Likewise.

2008-06-07  Bruno Haible  <bruno@clisp.org>

	Fix memory leak introduced on 2008-05-22.
	* lib/set-mode-acl.c (qset_acl) [!MODE_INSIDE_ACL]: Free ACLs after
	use.

2008-06-07  Bruno Haible  <bruno@clisp.org>

	* lib/set-mode-acl.c (qset_acl): Use acl_init(), not acl_from_text(),
	to construct an empty ACL.

2008-06-07  Bruno Haible  <bruno@clisp.org>

	* lib/set-mode-acl.c (chmod_or_fchmod): Document return value
	precisely.
	* lib/copy-acl.c (qcopy_acl): Trivial code simplifications.

2008-06-07  Bruno Haible  <bruno@clisp.org>

	* lib/copy-acl.c (qcopy_acl): Make the #if branches independent.
	* lib/set-mode-acl.c (qset_acl): Choose better local variable names.

2008-06-07  Bruno Haible  <bruno@clisp.org>

	* doc/posix-functions/_setjmp.texi: Explain the use of this function
	regardless of POSIX.
	* doc/posix-functions/_longjmp.texi: Likewise.
	* doc/posix-functions/setjmp.texi: Mention HP-UX as not counting as a
	SystemV platform in this case.

2008-06-06  Eric Blake  <ebb9@byu.net>

	Document abort() bugs.
	* doc/posix-functions/abort.texi (abort): Mention anomalies.

	* doc/posix-functions/setjmp.texi (setjmp): Mingw has setjmp.
	* doc/posix-functions/sigsetjmp.texi (sigsetjmp): Cygwin has
	sigsetjmp.
	* doc/posix-functions/siglongjmp.texi (siglongjmp): Cygwin has
	siglongjmp, but only as a macro.
	* doc/posix-functions/_longjmp.texi (_longjmp): Mention that this
	is obsolete.
	* doc/posix-functions/_setjmp.texi (_setjmp): Likewise.

	Tweak documentation to cover cygwin argz bugs.
	* m4/argz.m4 (gl_FUNC_ARGZ): Mention date of last known cygwin
	argz bug fix; no code change needed since no cygwin releases
	occurred between the last fix and the bug being tested.
	* doc/glibc-functions/argz_add.texi (argz_add): Document the argz
	module and recently fixed cygwin bugs.
	* doc/glibc-functions/argz_add_sep.texi (argz_add_sep): Likewise.
	* doc/glibc-functions/argz_append.texi (argz_append): Likewise.
	* doc/glibc-functions/argz_count.texi (argz_count): Likewise.
	* doc/glibc-functions/argz_create.texi (argz_create): Likewise.
	* doc/glibc-functions/argz_create_sep.texi (argz_create_sep):
	Likewise.
	* doc/glibc-functions/argz_delete.texi (argz_delete): Likewise.
	* doc/glibc-functions/argz_extract.texi (argz_extract): Likewise.
	* doc/glibc-functions/argz_insert.texi (argz_insert): Likewise.
	* doc/glibc-functions/argz_next.texi (argz_next): Likewise.
	* doc/glibc-functions/argz_replace.texi (argz_replace): Likewise.
	* doc/glibc-functions/argz_stringify.texi (argz_stringify):
	Likewise.

	Avoid gcc warning on cygwin.
	* lib/copy-acl.c (qcopy_acl) [!HAVE_ACL_GET_FILE &&
	!ACL_NO_TRIVIAL]: Avoid unused variable.

2008-06-05  Eric Blake  <ebb9@byu.net>

	Be tolerant of UNKNOWN version in gnulib-tool test dir.
	* top/GNUmakefile (_dummy): Warn rather than reconfigure if
	git-version-gen fails to come up with a version.
	Reported by Simon Josefsson.

2008-06-05  Jim Meyering  <meyering@redhat.com>
	    Paul Eggert  <eggert@cs.ucla.edu>

	utimens.c: work around a probable Linux kernel bug
	* lib/utimens.c (gl_futimens) [HAVE_UTIMENSAT]: Work around what
	appears to be a kernel bug that causes utimensat to return 280
	instead of 0, indicating success.

2008-06-04  Bruno Haible  <bruno@clisp.org>

	* lib/copy-acl.c (qcopy_acl): Call qset_acl, not set_acl. Fixes
	2008-06-01 commit.

2008-06-04  Bruno Haible  <bruno@clisp.org>

	* lib/acl-internal.h (acl_access_nontrivial): New declaration.
	* lib/file-has-acl.c (acl_access_nontrivial): New function.
	(file_has_acl): Use it. Save errno afterwards.
	* lib/copy-acl.c (qcopy_acl): Use acl_access_nontrivial.

2008-06-03  Bruno Haible  <bruno@clisp.org>

	* lib/file-has-acl.c (file_has_acl): Put Solaris 10 code after POSIX-
	draft code. Simplify #ifs.
	* lib/set-mode-acl.c (qset_acl): Don't test for symlink if !USE_ACL.
	Put Solaris code after POSIX-draft code. Fix comments regarding
	Solaris 10, HP-UX. Mention Cygwin.
	* lib/copy-acl.c (qcopy_acl): Simplify #ifs.

2008-06-03  Eric Blake  <ebb9@byu.net>

	Provide fallback for older kernels.
	* lib/utimens.c (gl_futimens) [HAVE_UTIMENSAT, HAVE_FUTIMENS]:
	Provide runtime fallback if kernel lacks support.
	Reported by Mike Frysinger.

2008-06-02  Bruno Haible  <bruno@clisp.org>

	* lib/acl-internal.h (ACL_NOT_WELL_SUPPORTED): Include EOPNOTSUPP if
	it exists.

2008-06-02  Bruno Haible  <bruno@clisp.org>

	* lib/acl_entries.c (acl_entries): Rewrite to use acl_get_entry.
	* lib/copy-acl.c (qcopy_acl): Update comment.

2008-06-02  Bruno Haible  <bruno@clisp.org>

	* lib/acl-entries.h: Enclose most definitions in #ifs for POSIX-draft
	like ACL APIs.

2008-06-02  Bruno Haible  <bruno@clisp.org>

	* tests/test-file-has-acl.sh: Use different code for Cygwin.
	* tests/test-set-mode-acl.sh: Likewise.
	* tests/test-copy-acl.sh: Likewise.
	* tests/test-copy-file.sh: Likewise.

2008-06-02  Bruno Haible  <bruno@clisp.org>

	* tests/test-file-has-acl.sh: Remove unused code.

2008-06-01  Bruno Haible  <bruno@clisp.org>

	* lib/copy-acl.c (qcopy_acl): New function, extracted from copy_acl.
	(copy_acl): Just a wrapper around qcopy_acl that emits the error
	messages.
	* lib/set-mode-acl.c (qset_acl): Document return value precisely.

2008-06-01  Bruno Haible  <bruno@clisp.org>

	* m4/acl.m4 (gl_FUNC_ACL): Separate the POSIX-like and the Solaris
	tests. Test for libpacl, needed for OSF/1. Test for extended ACLs,
	needed for MacOS X. Test for HP-UX API. Test for newer and older AIX
	APIs.
	* modules/acl-tests (configure.ac): Remove tests now contained in
	m4/acl.m4.

2008-06-02  Jim Meyering  <meyering@redhat.com>

	announce-gen: use a better key-server host name
	* build-aux/announce-gen (main): Recommend keys.gnupg.net, since
	it may be more consistently reliable.  Suggested by Werner Koch
	in <http://thread.gmane.org/gmane.comp.lib.gnulib.bugs/13717>.

2008-06-01  Bruno Haible  <bruno@clisp.org>

	* lib/stdio-impl.h (fp_ub): Use fp_. Needed for DragonFly BSD.
	Reported by Voroskoi Andras <voroskoi@gmail.com>.

2008-06-01  Voroskoi Andras  <voroskoi@gmail.com>  (tiny change)

	* lib/stdio-impl.h [__DragonFly__]: Fix typo.

2008-06-01  Bruno Haible  <bruno@clisp.org>

	New ACL tests.
	* tests/test-file-has-acl.sh: New file.
	* tests/test-file-has-acl.c: New file.
	* tests/test-set-mode-acl.sh: New file.
	* tests/test-set-mode-acl.c: New file.
	* tests/test-copy-acl.sh: New file, based on tests/test-copy-file.sh.
	* tests/test-copy-acl.c: New file.
	* modules/acl-tests: New file, based on modules/copy-file-tests.
	* modules/copy-file-tests (Files): Remove tests/test-sameacls.c.
	(Depends-on): Add acl-tests.
	(configure.ac): Remove checks.
	(Makefile.am): Don't create test-sameacls program here any more.

2008-06-01  Bruno Haible  <bruno@clisp.org>

	* tests/test-copy-file.sh: Portability fixes for Solaris, HP-UX, IRIX.
	* tests/test-sameacls.c: Include progname.h.
	(main): Invoke set_program_name. Portability fixes for MacOS X,
	Solaris, HP-UX.

2008-06-01  Bruno Haible  <bruno@clisp.org>

	* lib/freadahead.c (freadahead) [__DragonFly__]: Use the __sreadahead
	function.
	Reported by VOROSKOI Andras <voroskoi@gmail.com>.

2008-06-01  Bruno Haible  <bruno@clisp.org>

	* modules/rpmatch (Depends-on): Add strdup.

2008-06-01  Bruno Haible  <bruno@clisp.org>

	* lib/pipe.c: Include unistd-safer.h.
	(create_pipe): Ensure the returned file descriptors are not in {0,1,2}.
	* modules/pipe (Depends-on): Add unistd-safer.

2008-05-30  Simon Josefsson  <simon@josefsson.org>

	* modules/autobuild (configure.ac): Call AB_INIT.

2008-05-30  Simon Josefsson  <simon@josefsson.org>

	* tests/test-getaddrinfo.c: Don't print debug messages by default.
	Suggested by Bruno Haible <bruno@clisp.org>.

2008-05-30  Simon Josefsson  <simon@josefsson.org>

	* tests/test-base64.c: Cast size_t to unsigned long when invoking
	printf.  Use %lu instead of %d.  Reported by Bruno Haible
	<bruno@clisp.org>.

2008-05-29  Eric Blake  <ebb9@byu.net>

	Prefer new POSIX 200x interfaces over futimesat.
	* m4/utimens.m4 (gl_UTIMENS): Check for futimens, utimensat.
	* lib/utimens.c (gl_futimens): Use them for nanosecond resolution
	when available.
	[HAVE_BUGGY_NFS_TIME_STAMPS]: Allow C89 compilation.

2008-05-28  Bruno Haible  <bruno@clisp.org>

	* modules/stpcpy (License): Change to LGPLv2+.
	Requested by David Lutterkort <dlutter@redhat.com>.

2008-05-27  Bruno Haible  <bruno@clisp.org>

	* lib/localename.c (SUBLANG_TIBETAN_BHUTAN): Force value 2. Needed for
	current mingw.
	Reported by Jose E. Marchesi <jemarch@gnu.org>.

2008-05-27  Bruno Haible  <bruno@clisp.org>

	* modules/iconv_open (Link): New section, from module 'iconv'.
	* modules/striconv (Link): Likewise.
	* modules/striconveh (Link): Likewise.
	* modules/xstriconv (Link): Likewise.
	* modules/unicodeio (Link): Likewise.
	* modules/propername (Link): Likewise.
	Reported by Jim Meyering.

2008-05-26  Jim Meyering  <meyering@redhat.com>

	sha256: do not artificially restrict buffer length to be < 2^32
	* lib/sha256.h (struct sha256_ctx) [buflen]: Change type from
	uint32_t to size_t.
	* lib/sha256.c (sha256_conclude_ctx): Change type of a local
	to match.

	avoid unaligned access errors, e.g., on sparc
	* lib/sha512.c (sha512_conclude_ctx): Use set_uint64 rather than
	direct access through a possibly-unaligned uint64* pointer.
	* lib/sha256.c (sha256_conclude_ctx): Use set_uint32 rather than
	direct access through a possibly-unaligned uint32* pointer.
	Prompted by this patch from Tom "spot" Callaway:
	http://thread.gmane.org/gmane.comp.gnu.coreutils.bugs/13638

	sha512.c: fix typo in comment
	* lib/sha512.c (sha512_conclude_ctx): Length is 128-bit, not 64-bit.

2008-05-25  Bruno Haible  <bruno@clisp.org>

	* lib/set-mode-acl.c: Renamed from lib/acl.c.
	* modules/acl (Files): Add lib/set-mode-acl.c, remove lib/acl.c.
	(Makefile.am): Update lib_SOURCES.

2008-05-25  Bruno Haible  <bruno@clisp.org>

	* m4/acl.m4 (gl_FUNC_ACL): Don't set LIB_ACL_TRIVIAL.

2008-05-25  Jim Meyering  <meyering@redhat.com>

	useless-if-before-free: freed expr may have white-space differences
	* build-aux/useless-if-before-free: Recognize cases in which the
	freed expression differs from the tested one in embedded white
	space, e.g., if (p[i + 1]) free(p[i+1]).  Correct thinko in prev:
	$1 was used, so we can't make any regexp shy.  Improved tests now
	detect this.

	useless-if-before-free: accept white space in the expression.
	* build-aux/useless-if-before-free: For now, any white space
	in the expression must be identical in the free argument.

	useless-if-before-free: efficiency tweak
	* build-aux/useless-if-before-free: Make the expression-matching
	regexp "shy".
	Make the *outer* regexp shy, not the expr-matching one.

	update code-in-comment to accept cast of free arg
	* build-aux/useless-if-before-free: Update regexp.

2008-05-25  Bruno Haible  <bruno@clisp.org>

	* tests/test-sameacls.c: Renamed from tests/test-copy-file-sameacls.c.
	* modules/copy-file-tests (Files, Makefile.am): Update.
	* tests/test-copy-file.c (func_test_copy): Update.

2008-05-24  Andreas Färber  <andreas.faerber@web.de>  (tiny change)

	* lib/stdbool.in.h [__HAIKU__]: Disable __BEOS__ workarounds.

2008-05-23  Bruno Haible  <bruno@clisp.org>

	Improve support for ACLs on OSF/1.
	* lib/acl.c (qset_acl): For OSF/1, use a string that ends in a comma.
	Remove fallback for unknown flavors of ACLs.

2008-05-22  Bruno Haible  <bruno@clisp.org>

	Add support for ACLs on OSF/1.
	* lib/acl-internal.h (acl_get_fd, acl_set_fd): New inline function
	replacements.
	(acl_free_text): New macro fallback.
	* lib/acl_entries.c (acl_entries): Use acl_free_text instead of
	acl_free.
	* m4/acl.m4 (gl_FUNC_ACL): Look also in libpacl library. Test for
	acl_free_text function. Require AC_C_INLINE.

2008-05-22  Bruno Haible  <bruno@clisp.org>

	Make copy_acl work on MacOS X 10.5.
	* lib/acl-internal.h (MODE_INSIDE_ACL): New macro.
	(ACL_NOT_WELL_SUPPORTED): On MacOS X, also handle ENOENT.
	* lib/acl.c (qset_acl): Add different code branch for !MODE_INSIDE_ACL.
	If MODE_INSIDE_ACL, don't assume that every system has the same text
	representation for ACLs as FreeBSD.
	* lib/copy-acl.c (copy_acl): Add support for platforms with
	!MODE_INSIDE_ACL.
	* lib/file-has-acl.c (file_has_acl): Likewise.
	* m4/acl.m4 (gl_FUNC_ACL): Test for some functions that are witness of
	FreeBSD, MacOS X, or IRIX, respectively.

2008-05-22  Bruno Haible  <bruno@clisp.org>

	* lib/acl.h: Don't include <sys/acl.h>.
	(GETACLCNT): Move fallback to lib/acl-internal.h.
	* lib/acl-internal.h: Include <sys/acl.h> here.
	(GETACLCNT): New macro fallback, moved here from lib/acl.h.

2008-05-22  Bruno Haible  <bruno@clisp.org>

	Split off copy_acl function to separate file.
	* lib/copy-acl.c: New file, extracted from lib/acl.c.
	* lib/acl.c (copy_acl): Moved function to separate file.
	* m4/acl.m4 (gl_FUNC_ACL): Remove unconditional AC_LIBOBJs.
	* modules/acl (Files): Add lib/copy-acl.c.
	(Makefiles.am): Augment lib_SOURCES.

2008-05-22  Bruno Haible  <bruno@clisp.org>

	* modules/copy-file-tests: New file.
	* tests/test-copy-file.sh: New file.
	* tests/test-copy-file.c: New file.
	* tests/test-copy-file-sameacls.c: New file.

2008-05-22  Eric Blake  <ebb9@byu.net>

	Avoid gcc warning.
	* tests/test-memcmp.c (main): Pass NULL indirectly.

2008-05-21  Bruno Haible  <bruno@clisp.org>

	Add reference doc about ACLs.
	* doc/acl-resources.txt: New file.
	* doc/acl-cygwin.txt: New file.

2008-05-21  Bruno Haible  <bruno@clisp.org>

	Avoid one more warning from gcc.
	* lib/vasnprintf.c (IF_LINT): Update comments.
	(VASNPRINTF): Use it also for the 'prefix' array initializer.

2008-05-21  Jim Meyering  <meyering@redhat.com>

	avoid a warning from gcc
	* lib/vasnprintf.c (IF_LINT): Define.
	(scale10_round_decimal_long_double):
	Use it to avoid a "may be used uninitialized" warning.
	(scale10_round_decimal_double): Likewise.

2008-05-21  Simon Josefsson  <simon@josefsson.org>

	* m4/memcmp.m4: When cross-compiling, assume memcmp works if it is
	declared.

2008-05-20  Bruno Haible  <bruno@clisp.org>

	* tests/test-memcmp.c (main): Test also the sign of the result. Test
	against two known bugs; code taken from autoconf's AC_FUNC_MEMCMP.

2008-05-20  Simon Josefsson  <simon@josefsson.org>

	* modules/memcmp-tests: New file.
	* tests/test-memcmp.c: New file.

2008-05-19  Bruno Haible  <bruno@clisp.org>

	* modules/propername (Notice, configure.ac): Put quoted "..." into
	--keyword option.
	* lib/propername.h: Update comments accordingly.
	Reported by Eric Blake.

2008-05-19  Martin Lambers  <marlam@marlam.de>  (tiny change)

	* modules/getpass-gnu (Depends-on): Add fseeko.

2008-05-19  Simon Josefsson  <simon@josefsson.org>

	* modules/base64-tests: New file.

2008-05-19  Bo Borgerson <gigabo@gmail.com>

	* lib/base64.c (base64_decode_ctx): If a decode context structure
	was passed in use it to ignore newlines.  If a context structure
	was _not_ passed in, continue to treat newlines as garbage (this
	is the historical behavior).  Formerly base64_decode.
	(base64_decode_alloc_ctx): Formerly base64_decode_alloc.  Now
	takes a decode context structure.
	* lib/base64.h (base64_decode): Macro for four-argument calls.
	(base64_decode_alloc): Likewise.
	* lib/base64.c (base64_decode_ctx): If a decode context structure
	was passed in use it to ignore newlines.  If a context structure
	was _not_ passed in, continue to treat newlines as garbage (this
	is the historical behavior).  Formerly base64_decode.
	(base64_decode_alloc_ctx): Formerly base64_decode_alloc.  Now
	takes a decode context structure.
	* lib/base64.h (base64_decode): Macro for four-argument calls.
	(base64_decode_alloc): Likewise.

2008-05-19  Jim Meyering  <meyering@redhat.com>

	avoid a warning from gcc
	* lib/trim.c (IF_LINT): Define.
	(trim2): Use it to avoid a "may be used uninitialized" warning.

	Fix doc typo.
	* doc/glibc-functions/getpass.texi (getpass): s/PATH_MAX/PASS_MAX/.

2008-05-19  Bruno Haible  <bruno@clisp.org>

	* doc/glibc-functions/getpass.texi: Document limits of other
	implementations.

2008-05-19  Simon Josefsson  <simon@josefsson.org>
	    Bruno Haible <bruno@clisp.org>

	* doc/glibc-functions/getpass.texi: Document gnulib implementation.

2008-05-18  Bruno Haible  <bruno@clisp.org>

	* modules/propername: New file, from GNU gettext.
	* lib/propername.h: New file, from GNU gettext.
	* lib/propername.c: New file, from GNU gettext.
	* MODULES.html.sh (Internationalization functions): Add propername.

2008-05-16  Jim Meyering  <meyering@redhat.com>
	    Bruno Haible  <bruno@clisp.org>

	Avoid some warnings from "gcc -Wshadow".
	* lib/vasnprintf.c (exp, remainder): Define to different identifiers.

2008-05-15  Eric Blake  <ebb9@byu.net>

	Extend previous patch to cygwin 1.7.0.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): When cross-compiling, assume a
	fast implementation in cygwin >= 1.7.0.
	* m4/strstr.m4 (gl_FUNC_STRSTR): Likewise.
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR): Likewise.

2008-05-15  Bruno Haible  <bruno@clisp.org>

	* m4/memmem.m4 (gl_FUNC_MEMMEM): When cross-compiling, assume a fast
	implementation in glibc >= 2.9.
	* m4/strstr.m4 (gl_FUNC_STRSTR): Likewise.
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR): Likewise.

2008-05-15  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Internationalization functions): Remove linebreak.
	(Unicode string functions): Add unilbrk/*.
	Reported by Karl Berry.

2008-05-15  Eric Blake  <ebb9@byu.net>

	Fix violation of <stdbool.h> replacement in regex.
	* lib/regcomp.c (re_compile_internal): Avoid implicit cast to bool.
	* lib/regexec.c (re_search_internal): Likewise.
	Reported by Heinrich Mislik <Heinrich.Mislik@univie.ac.at>.

2008-05-15  Jim Meyering  <meyering@redhat.com>

	avoid distracting test output when git or cvs is not found
	* tests/test-vc-list-files-cvs.sh: Suppress 'init' error output.
	* tests/test-vc-list-files-git.sh: Likewise.

2008-05-15  Eric Blake  <ebb9@byu.net>

	Glibc finally accepted the memmem speedup code, bugzilla #5514.
	* doc/glibc-functions/memmem.texi (memmem): Mention last broken
	glibc version.
	* doc/glibc-functions/strcasestr.texi (strcasestr): Likewise.
	* doc/posix-functions/strstr.texi (strstr): Likewise.
	* lib/str-two-way.h (MAX): Sychronize with glibc.

2008-05-15  Paolo Bonzini  <bonzini@gnu.org>

	* lib/regcomp.c (optimize_utf8): Add a note on why we test
	opr.ctx_type.
	(calc_first): Initialize constraint field.
	(duplicate_node_closure): Use it instead of special casing ANCHORS.
	Fix grammar.
	(duplicate_node): Merge constraint field for all node types.
	(calc_eclosure_iter): Look at constraint field for all node types.
	* lib/regex_internal.c (create_cd_newstate): Don't look at
	opr.ctx_type.

2008-05-14  Bruno Haible  <bruno@clisp.org>

	Help GCC to do better code generation.
	* lib/eealloc.h (eemalloc) [GCC >= 3]: Declare with attribute 'malloc'.
	* lib/pagealign_alloc.h (pagealign_alloc, pagealign_xalloc): Likewise.
	* lib/xalloc.h (ATTRIBUTE_MALLOC): New macro.
	(xmalloc, xzalloc, xcalloc, xmemdup, xstrdup, xnmalloc, xcharalloc):
	Declare with attribute 'malloc' if supported.

2008-05-14  Lasse Collin  <lasse.collin@tukaani.org>

	use "echo STR|wc -c" rather than unportable "expr length STR"
	* build-aux/mktempd (mktempd): Vendor-supplied expr from at least
	OpenBSD 4.3 and Solaris 10 do not honor expr's "length" function.

2008-05-14  Jim Meyering  <meyering@redhat.com>

	use dd ibs=$n count=1 ... rather than less-portable head -c$n
	* build-aux/mktempd (rand_bytes): head's -cN option is not accepted
	by Solaris 10's /bin/head or by the one from HP-UX 11.x.
	Reported in http://sourceforge.net/forum/message.php?msg_id=4960334
	via Collin Lasse.

2008-05-14  Eric Blake  <ebb9@byu.net>

	Avoid quadratic growth in gl_LIBSOURCES.
	* gnulib-tool (func_emit_initmacro_done): s/\(m4_append\)_uniq/\1/.
	Suggested by Bruno Haible.

	Test xmemdup0.
	* modules/xmemdup0-tests: New file.
	* tests/test-xmemdup0.c: Likewise.

2008-05-13  Eric Blake  <ebb9@byu.net>

	Split xmemdup0 into its own module.
	* modules/xmemdup0: New file.
	* lib/xmemdup0.h: Likewise.
	* lib/xmemdup0.c: Likewise.
	* MODULES.html.sh (Memory management functions): Add xmemdup0.
	* lib/xalloc.h (xmemdup0): Remove.
	* lib/xmalloc.c (xmemdup0): Likewise.

2008-05-13  Eric Blake  <ebb9@byu.net>
	    Bruno Haible  <bruno@clisp.org>

	Reduce number of forks required during autoconf.
	* gnulib-tool (func_emit_initmacro_start): Prepare gl_LIBSOURCES_LIST
	and gl_LIBSOURCES_DIR.
	(func_emit_initmacro_end): Use them here in a single m4_syscmd...
	(func_emit_initmacro_done) <gl_LIBSOURCES>: ...rather than in one
	m4_syscmd per file.
	<m4_foreach_w>: Move...
	* m4/gnulib-common.m4 (m4_foreach_w): ...here.

2008-05-13  Eric Blake  <ebb9@byu.net>

	* gnulib-tool: Fix various comment typos.

2008-05-12  Bruno Haible  <bruno@clisp.org>

	Tailor the linebreaking algorithm.
	* lib/unilbrk/tables.c (unilbrk_table): Change (IS,AL) entry.

2008-05-12  Bruno Haible  <bruno@clisp.org>

	Update to Unicode 5.0.0.
	* lib/unilbrk/tables.h (LBP_*): Add LBP_WJ, LBP_H2, LBP_H3, LBP_JL,
	LBP_JV, LBP_JT. Redistribute values.
	(unilbrk_table): Change size.
	* lib/unilbrk/tables.c (unilbrk_table): Change size. Update to match
	Unicode TR#14 rev. 22.
	* lib/unilbrk/gen-lbrk.c (LBP_*): Add LBP_WJ, LBP_H2, LBP_H3, LBP_JL,
	LBP_JV, LBP_JT. Redistribute values.
	(get_lbp): Update to match Unicode TR#14 rev. 21/22 and Unicode 5.0.0.
	(debug_output_lbp, fill_org_lbp, debug_output_org_lbp, output_lbp):
	Update.
	* lib/unilbrk/lbrkprop1.h: Regenerated.
	* lib/unilbrk/lbrkprop2.h: Regenerated.
	* lib/unilbrk/u8-possible-linebreaks.c (u8_possible_linebreaks):
	Change handling of LBP_CM after LBP_ZW. Update for new value of LBP_BK.
	* lib/unilbrk/u16-possible-linebreaks.c (u16_possible_linebreaks):
	Likewise.
	* lib/unilbrk/u32-possible-linebreaks.c (u32_possible_linebreaks):
	Likewise.
	* tests/unilbrk/test-u8-possible-linebreaks.c (main): Update expected
	result.
	* tests/unilbrk/test-u16-possible-linebreaks.c (main): Likewise.
	* tests/unilbrk/test-u32-possible-linebreaks.c (main): Likewise.
	* tests/unilbrk/test-ulc-possible-linebreaks.c (main): Likewise.
	* tests/unilbrk/test-u8-width-linebreaks.c (main): Likewise.
	* tests/unilbrk/test-u16-width-linebreaks.c (main): Likewise.
	* tests/unilbrk/test-u32-width-linebreaks.c (main): Likewise.

2008-05-11  Bruno Haible  <bruno@clisp.org>

	* lib/unilbrk/gen-lbrk.c (output_lbp): Fix whitespace.

2008-05-11  Bruno Haible  <bruno@clisp.org>

	* lib/unilbrk/gen-lbrk.c: New file, from GNU gettext (gen-lbrkprop.c).
	* modules/unilbrk/gen-lbrk: New file.

2008-05-11  Bruno Haible  <bruno@clisp.org>

	* m4/sha256.m4 (gl_SHA256): Require AC_C_INLINE.
	* m4/sha512.m4 (gl_SHA512): Likewise.

2008-05-11  Jim Meyering  <meyering@redhat.com>

	New modules: crypto/sha256, crypto/sha512 (from coreutils)
	* modules/crypto/sha256: New file.
	* modules/crypto/sha512: Likewise.
	* lib/sha256.c: Likewise.
	* lib/sha256.h: Likewise.
	* lib/sha512.c: Likewise.
	* lib/sha512.h: Likewise.
	* lib/u64.h: Likewise.
	* m4/sha256.m4: Likewise.
	* m4/sha512.m4: Likewise.
	* MODULES.html.sh (Cryptographic computations (low-level)): List them.

2008-05-10  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Environment variables <stdlib.h>): Add unsetenv.
	(Input/Output <stdio.h>): Add xprintf.
	(Signal handling <signal.h>): Add strsignal.
	(Cryptographic computations (high-level)): Add crypto/gc-camellia.
	(Core language properties): Add func.
	(Mathematics <math.h>): Add ceil, floor, frexp-nolibm.
	(Support for systems lacking POSIX:2001): Add environ, EOVERFLOW,
	strings.
	(Enhancements for POSIX:2001 functions): Add iconv_open-utf.
	(Input/output): New section.
	(File system functions): Add openat-die, stat-macros.
	(Networking functions): Add sockets.
	(Unicode string functions): Add unictype/*.
	(Support for building libraries and executables): Add gperf.
	(Support for building documentation): Add agpl-3.0.
	(Misc): Add nocrash.

2008-05-10  Bruno Haible  <bruno@clisp.org>

	* modules/unictype/gen-ctype: New file.

2008-05-10  Jim Meyering  <meyering@redhat.com>

	Make chdir-safer.c more efficient on a system with no symlinks.
	* lib/chdir-safer.c (chdir_no_follow): Skip lstat and fstat calls
	also if ELOOP is zero.  Suggested by Bruno Haible.

	Make chdir-safer.c slightly safer.
	* lib/chdir-safer.c (chdir_no_follow): Test HAVE_WORKING_O_NOFOLLOW,
	not O_NOFOLLOW, in case the latter is nonzero and open ignores it.

	Avoid compile failure on systems without ELOOP (like mingw).
	* lib/chdir-safer.c (ELOOP): Define if not already defined.
	Reported by Bruno Haible.

2008-05-10  Bruno Haible  <bruno@clisp.org>

	* lib/unilbrk/ulc-common.c: Include c-strcaseeq.h instead of streq.h.
	(is_utf8_encoding): Use a case-insensitive comparison.
	* modules/unilbrk/ulc-common (Depends-on): Add c-strcaseeq. Remove
	streq.

2008-05-10  Bruno Haible  <bruno@clisp.org>

	* lib/unilbrk/ulc-common.c: Don't include <stdlib.h>.
	(iconv_string_length, iconv_string_keeping_offsets): Remove functions.
	* lib/unilbrk/ulc-common.h (iconv_string_length,
	iconv_string_keeping_offsets): Remove declarations.
	* lib/unilbrk/ulc-possible-linebreaks.c: Include <string.h>, uniconv.h.
	Don't include <iconv.h>, streq.h, xsize.h.
	(ulc_possible_linebreaks): Use u8_conv_from_encoding for doing the
	conversion.
	* lib/unilbrk/ulc-width-linebreaks.c: Include uniconv.h. Don't include
	<iconv.h>, streq.h, xsize.h.
	(ulc_width_linebreaks): Use u8_conv_from_encoding for doing the
	conversion.
	* modules/unilbrk/ulc-common (Depends-on): Remove iconv.
	* modules/unilbrk/ulc-possible-linebreaks (Depends-on): Add
	uniconv/u8-conv-from-enc. Remove iconv_open, streq, xsize.
	* modules/unilbrk/ulc-width-linebreaks (Depends-on): Likewise.

2008-05-10  Bruno Haible  <bruno@clisp.org>

	* modules/unilbrk/ulc-width-linebreaks-tests: New file.
	* tests/unilbrk/test-ulc-width-linebreaks.c: New file.

	* modules/unilbrk/u32-width-linebreaks-tests: New file.
	* tests/unilbrk/test-u32-width-linebreaks.c: New file.

	* modules/unilbrk/u16-width-linebreaks-tests: New file.
	* tests/unilbrk/test-u16-width-linebreaks.c: New file.

	* modules/unilbrk/u8-width-linebreaks-tests: New file.
	* tests/unilbrk/test-u8-width-linebreaks.c: New file.

	* modules/unilbrk/ulc-possible-linebreaks-tests: New file.
	* tests/unilbrk/test-ulc-possible-linebreaks.c: New file.

	* modules/unilbrk/u32-possible-linebreaks-tests: New file.
	* tests/unilbrk/test-u32-possible-linebreaks.c: New file.

	* modules/unilbrk/u16-possible-linebreaks-tests: New file.
	* tests/unilbrk/test-u16-possible-linebreaks.c: New file.

	* modules/unilbrk/u8-possible-linebreaks-tests: New file.
	* tests/unilbrk/test-u8-possible-linebreaks.c: New file.

2008-05-10  Bruno Haible  <bruno@clisp.org>

	Split up 'linebreak' module.
	* lib/unilbrk.h: New file, based on lib/linebreak.h.
	* lib/unilbrk/lbrkprop1.h: New file, extracted from lib/lbrkprop.h.
	* lib/unilbrk/lbrkprop2.h: New file, renamed from lib/lbrkprop.h with
	modifications.
	* lib/unilbrk/tables.h: New file, extracted from lib/linebreak.c.
	* lib/unilbrk/tables.c: New file, extracted from lib/linebreak.c.
	* lib/unilbrk/u8-possible-linebreaks.c: New file, extracted from
	lib/linebreak.c.
	* lib/unilbrk/u16-possible-linebreaks.c: New file, extracted from
	lib/linebreak.c.
	* lib/unilbrk/u32-possible-linebreaks.c: New file, extracted from
	lib/linebreak.c.
	* lib/unilbrk/ulc-common.h: New file, extracted from lib/linebreak.c.
	* lib/unilbrk/ulc-common.c: New file, extracted from lib/linebreak.c.
	* lib/unilbrk/ulc-possible-linebreaks.c: New file, extracted from
	lib/linebreak.c.
	* lib/unilbrk/u8-width-linebreaks.c: New file, extracted from
	lib/linebreak.c.
	* lib/unilbrk/u16-width-linebreaks.c: New file, extracted from
	lib/linebreak.c.
	* lib/unilbrk/u32-width-linebreaks.c: New file, extracted from
	lib/linebreak.c.
	* lib/unilbrk/ulc-width-linebreaks.c: New file, extracted from
	lib/linebreak.c.
	* modules/unilbrk/base: New file.
	* modules/unilbrk/tables: New file.
	* modules/unilbrk/u8-possible-linebreaks: New file.
	* modules/unilbrk/u16-possible-linebreaks: New file.
	* modules/unilbrk/u32-possible-linebreaks: New file.
	* modules/unilbrk/ulc-common: New file.
	* modules/unilbrk/ulc-possible-linebreaks: New file.
	* modules/unilbrk/u8-width-linebreaks: New file.
	* modules/unilbrk/u16-width-linebreaks: New file.
	* modules/unilbrk/u32-width-linebreaks: New file.
	* modules/unilbrk/ulc-width-linebreaks: New file.
	* lib/linebreak.h: Remove file.
	* lib/linebreak.c: Remove file.
	* m4/linebreak.m4: Remove file.
	* modules/linebreak: Remove file.
	* NEWS: Mention the changes.

2008-05-09  Eric Blake  <ebb9@byu.net>

	Add xmemdup0.
	* lib/xalloc.h (xmemdup0): New prototype and C++ typesafe
	implementation.
	* lib/xmalloc.c (xmemdup0): New C implementation.

2008-05-08  Bruno Haible  <bruno@clisp.org>

	* m4/wctype.m4 (gl_WCTYPE_H): Correct indentation.

2008-05-07  Eric Blake  <ebb9@byu.net>

	Support cross-compilation of <wctype.h>.
	* m4/wctype.m4 (gl_WCTYPE_H): Fix improper nesting in
	AC_CACHE_CHECK.

2008-05-06  Soren Hansen  <soren@ubuntu.com>  (tiny change)

	* build-aux/vc-list-files: Add support for bzr.

2008-05-03  Jim Meyering  <meyering@redhat.com>

	avoid failed assertion with tight malloc
	* tests/test-getndelim2.c: Correct an off-by-one assertion.

2008-05-03  Simon Josefsson  <simon@josefsson.org>

	* m4/inet_pton.m4: Set HAVE_DECL_INET_PTON to 0 when declarations
	are needed from arpa/inet.h.
	* m4/inet_ntop.m4: Likewise, for HAVE_DECL_INET_NTOP.
	Reported by Bruno Haible.

2008-05-02  Jim Meyering  <meyering@redhat.com>

	avoid compilation error on FreeBSD 6
	* tests/test-getaddrinfo.c [!defined EAI_NODATA] (EAI_NODATA): Define.

2008-05-01  Jim Meyering  <meyering@redhat.com>

	useless-if-before-free: correct --help's exit status description
	* build-aux/useless-if-before-free (usage): Like grep, exit 0
	for one or more matches, etc.  Reported by Bruno Haible.

	vc-list-files: make the stand-alone gnulib test work
	* modules/vc-list-files-tests (configure.ac):
	Define and AC_SUBST abs_aux_dir.
	(Makefile.am) [TESTS_ENVIRONMENT]: Rather than passing
	$(abs_top_srcdir) to each script and having each of them
	duplicate the work of setting PATH, set PATH here, using
	the new variable, abs_aux_dir instead.
	* tests/test-vc-list-files-cvs.sh: Don't set PATH here.
	* tests/test-vc-list-files-git.sh: Likewise.
	Reported by Bruno Haible.

2008-05-01  Bruno Haible  <bruno@clisp.org>

	* lib/getndelim2.c (getndelim2): Fix newsize computation during
	reallocation. Rename 'done' to 'found_delimiter'.

2008-05-01  Jim Meyering  <meyering@redhat.com>

	vc-list-files: accommodate /bin/sh like the one from Solaris 10
	* build-aux/vc-list-files: Use `...`, not $(...).

2008-04-30  Jim Meyering  <meyering@redhat.com>

	add tests for vc-list-files
	* modules/vc-list-files-tests: New module.
	* tests/test-vc-list-files-cvs.sh: New file.
	* tests/test-vc-list-files-git.sh: New file.

	avoid a warning from gcc
	* lib/getndelim2.c (IF_LINT): Define.
	(getndelim2): Use it to avoid a "may be used uninitialized" warning.

	vc-list-files: work properly with build-aux/cvsu, too
	* build-aux/vc-list-files: Hoist the "./"-removing code to apply
	to all cvs-based clauses.

	vc-list-files: work properly in the CVS+awk case, too
	* build-aux/vc-list-files: In the CVS+awk case, remove "./" prefix.

	vc-list-files: avoid use of ${*-*} that fails when /bin/sh is dash
	* build-aux/vc-list-files: Simplify ${*-*} to $dir, since we no longer
	take more than one file argument, so .  Add quotes, just in case $dir
	ever contains a shell meta-character.  Prompted by Soren Hansen in
	<http://thread.gmane.org/gmane.comp.emulators.libvirt/6221/focus=6240>.

2008-04-29  Eric Blake  <ebb9@byu.net>

	Optimize getndelim2 to use block operations when possible.
	* modules/getndelim2 (Depends-on): Add stdbool, freadptr,
	freadseek, and memchr2.
	* lib/getndelim2.c (getndelim2): Use them for block reads.

2008-04-29  Bruno Haible  <bruno@clisp.org>

	* m4/inet_ntop.m4 (gl_INET_NTOP): Require gl_USE_SYSTEM_EXTENSIONS.
	* m4/inet_pton.m4 (gl_INET_PTON): Likewise.
	* modules/inet_ntop (Depends-on): Add extensions.
	* modules/inet_pton (Depends-on): Likewise.
	Reported by Simon Josefsson.

2008-04-29  Jim Meyering  <meyering@redhat.com>

	When the is more than one match in a block, match all of them.
	* build-aux/useless-if-before-free: Iterate through each block
	until there are no more matches.

	Fix broken useless-if-before-free script.
	* build-aux/useless-if-before-free: Fix typo: missing "?" after
	the expression to match cast of argument to free-like function.

2008-04-29  Eric Blake  <ebb9@byu.net>

	Use new header.
	* lib/getaddrinfo.c (includes): s/"inet_ntop.h"/<arpa/inet.h>/.

2008-04-29  Jim Meyering  <meyering@redhat.com>

	Avoid test segfault on x86_64 due to lack of inet_ntop declaration.
	* tests/test-getaddrinfo.c: Include <arpa/inet.h>, now guaranteed
	by gnulib to exist and to declare e.g., inet_ntop.
	Don't include "inet_ntop.h", now removed.

	* m4/arpa_inet_h.m4: Remove trailing blanks.

2008-04-29  Eric Blake  <ebb9@byu.net>

	Silence valgrind on safe reads beyond potential array bounds.
	* lib/rawmemchr.valgrind: New file.
	* lib/strchrnul.valgrind: Likewise.
	* modules/rawmemchr (Files): Distribute new file.
	* modules/strchrnul (Files): Likewise.
	Suggested by Bruno Haible.

2008-04-29  Bruno Haible  <bruno@clisp.org>

	* lib/arpa_inet.in.h: Include system's <arpa/inet.h> if it exists.
	(inet_ntop, inet_pton): Change portability warning's wording.
	* m4/arpa_inet_h.m4 (gl_HEADER_ARPA_INET): Set HAVE_ARPA_INET_H.
	Invoke gl_CHECK_NEXT_HEADERS.
	(gl_ARPA_INET_H_DEFAULTS): Initialize ARPA_INET_H.
	* m4/inet_ntop.m4 (gl_INET_NTOP): Require gl_ARPA_INET_H_DEFAULTS and
	set ARPA_INET_H.
	* m4/inet_pton.m4 (gl_INET_PTON): Likewise.
	* modules/arpa_inet (Description): No longer only for systems that
	lack it.
	(Depends-on): Add include_next.
	(Makeile.am): Substitute INCLUDE_NEXT, NEXT_ARPA_INET_H,
	HAVE_ARPA_INET_H.

2008-04-29  Jim Meyering  <meyering@redhat.com>

	* modules/mkdir (License): Re-license as LGPLv2+.

2008-04-29  Bruno Haible  <bruno@clisp.org>

	* modules/rawmemchr (Maintainer): Set to Eric.
	* modules/strchrnul (Maintainer): Likewise.

2008-04-29  Simon Josefsson  <simon@josefsson.org>

	* m4/arpa_inet_h.m4 (gl_ARPA_INET_H_DEFAULTS): Set
	HAVE_DECL_INET_NTOP and HAVE_DECL_INET_PTON.

	* modules/arpa_inet (arpa/inet.h): Use them.

2008-04-28  Eric Blake  <ebb9@byu.net>

	Test getndelim2.
	* modules/getndelim2-tests: New file.
	* tests/test-getndelim2.c: Likewise.
	* lib/getndelim2.c (getndelim2): Never return 0.  Lock the
	stream.
	* m4/getndelim2.m4 (gl_GETNDELIM2): Check for lock functions.

	* MODULES.html.sh: Document new module.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* lib/c-stack.c (die): Use raise.
	* modules/c-stack (Depends-on): Add raise.

2008-04-28  Bruno Haible  <bruno@clisp.org>

	Expect rpmatch to be declared.
	* lib/yesno.c (rpmatch): Remove declaration.

	Declare rpmatch.
	* lib/stdlib.in.h (rpmatch): New declaration.
	* lib/rpmatch.c: Include <stdlib.h> first.
	* m4/rpmatch.m4 (gl_FUNC_RPMATCH): Require AC_USE_SYSTEM_EXTENSIONS and
	gl_STDLIB_H_DEFAULTS. Set HAVE_RPMATCH.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Initialize GNULIB_RPMATCH,
	HAVE_RPMATCH.
	* modules/rpmatch (Depends-on): Add stdlib, extensions.
	(configure.ac): Invoke gl_STDLIB_MODULE_INDICATOR.
	(Include): Set to <stdlib.h>.
	* modules/stdlib (Makefile.am): Substitute GNULIB_RPMATCH and
	HAVE_RPMATCH.
	* NEWS: Document the change.

2008-04-28  Bruno Haible  <bruno@clisp.org>

	Change rpmatch to use nl_langinfo when appropriate.
	* lib/rpmatch.c: Include stdbool.h, string.h, langinfo.h.
	(N_): New macro.
	(localized_pattern): New function/macro.
	(try): Remove match, nomatch arguments. Copy the pattern into safe
	memory before caching it.
	(rpmatch): Use localized_pattern. Add translator comments.
	* m4/rpmatch.m4 (gl_PREREQ_RPMATCH): Test for nl_langinfo and YESEXPR.
	Suggested by Eric Blake.
	* modules/rpmatch (Depends-on): Add stdbool.

2008-04-28  Eric Blake  <ebb9@byu.net>

	Add rawmemchr module, matching glibc.
	* modules/string (Makefile.am): New indicator.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Set it.
	* lib/string.in.h (rawmemchr): Declare when appropriate.
	* modules/rawmemchr: New file.
	* m4/rawmemchr.m4: Likewise.
	* lib/rawmemchr.c: Likewise.
	* modules/rawmemchr-tests: Likewise.
	* tests/test-rawmemchr.c: Likewise.
	* doc/glibc-functions/rawmemchr.texi (rawmemchr): Document
	module.
	* modules/strchrnul (Depends-on): Add rawmemchr.
	* lib/strchrnul.c (strchrnul): Optimize a corner case.

	Whitespace cleanup.
	* tests/test-strchrnul.c: Reindent.
	* lib/strchrnul.c: Likewise.

	Optimize and test strchrnul.
	* lib/strchrnul.c (strchrnul): Rewrite to do parallel search.
	* modules/strchrnul-tests: New file.
	* tests/test-strchrnul.c: Likewise.

	Remove intprops dependency.
	* modules/memchr (Depends-on): Remove intprops.
	* modules/memrchr (Depends-on): Likewise.
	* modules/memchr2 (Depends-on): Likewise.
	* lib/memchr.c (__memchr): Hand-inline the TYPE_MAXIMUM check.
	* lib/memrchr.c (__memrchr): Likewise.
	* lib/memrchr2.c (memchr2): Likewise.
	Reported by Simon Josefsson.

2008-04-28  Simon Josefsson  <simon@josefsson.org>

	* m4/sys_socket_h.m4: Move AC_REQUIRE([AC_C_INLINE]) to top.
	Suggested by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2008-04-28  Simon Josefsson  <simon@josefsson.org>

	* lib/inet_ntop.h, lib/inet_pton.h: Remove files.

	* lib/inet_ntop.c: Include arpa/inet.h instead of inet_ntop.h.

	* lib/inet_pton.c: Include arpa/inet.h instead of inet_pton.h.

	* lib/arpa_inet.in.h [@GNULIB_INET_NTOP@]: Inline inet_ntop.h
	declarations.
	[@GNULIB_INET_PTON@]: Inline inet_pton.h declarations.

	* m4/inet_pton.m4: Don't check for header files.

	* m4/inet_ntop.m4: Don't check for header files.

2008-04-28  Simon Josefsson  <simon@josefsson.org>

	* m4/sys_socket_h.m4: Require AC_C_INLINE when necessary.
	* lib/sys_socket.in.h (setsockopt): Use proper win32 tests (don't
	trigger for cygwin).
	Reported by Bruno Haible  <bruno@clisp.org>.

2008-04-28  Bruno Haible  <bruno@clisp.org>

	* doc/posix-functions/strdup.texi: Mention mingw problem.

2008-04-27  Bruno Haible  <bruno@clisp.org>

	* modules/stat-time-tests (Depends-on): Add sleep.
	* tests/test-stat-time.c (force_unlink): New function.
	(cleanup): Use it.
	(test_mtime): Remove the ctime related tests.
	(test_ctime): New function, containing the ctime related tests.
	(main): Call test_ctime, except on native Windows platforms.

2008-04-27  Bruno Haible  <bruno@clisp.org>

	* lib/rpmatch.c (rpmatch): Add some comments.
	Reported by James Youngman <jay@gnu.org>.

2008-04-27  Bruno Haible  <bruno@clisp.org>

	* m4/isnanl.m4 (gl_FUNC_ISNANL_WORKS): Also test the behaviour on
	quiet NaNs.

2008-04-27  Bruno Haible  <bruno@clisp.org>

	Make test-yesno.sh work on mingw.
	* tests/test-yesno.sh: Postprocess the output to convert CR/LF to LF.
	* tests/test-yesno.c: Include yesno.h first. Include binary-io.h.
	(main): Set stdin to binary mode.
	* modules/yesno-tests (Depends-on): Add binary-io.

2008-04-27  Bruno Haible  <bruno@clisp.org>

	Fix 'isfinite' on x86, x86_64, ia64 platforms.
	* tests/test-isfinite.c (test_isfinitel): Also test the behavior on
	argument that lie outside the IEEE 854 domain.
	* m4/isfinite.m4 (gl_ISFINITEL_WORKS): New macro.
	(gl_ISFINITE): Use it.
	* doc/posix-functions/isfinite.texi: Document the fixed bugs.

2008-04-27  Bruno Haible  <bruno@clisp.org>

	Allow local renaming in config.h.
	* lib/memrchr.c (memrchr): Don't undefine outside libc.

2008-04-27  Bruno Haible  <bruno@clisp.org>

	* lib/memchr.c (__memchr): Change type of 'i'.
	* lib/memchr2.c (memchr2): Likewise.

2008-04-26  Eric Blake  <ebb9@byu.net>
	and Bruno Haible  <bruno@clisp.org>

	Optimize and test memrchr.
	* modules/memrchr (Depends-on): Add intprops.
	* lib/memrchr.c (__memrchr): Avoid false positives in loop.
	* modules/memrchr-tests: New file.
	* tests/test-memrchr.c: New file.

2008-04-26  Bruno Haible  <bruno@clisp.org>

	Add tentative support for DragonFly BSD.
	* lib/stdio-impl.h: Add macros for DragonFly BSD.
	* lib/fbufmode.c (fbufmode): Update conditionals. Use fp_ instead of
	fp.
	* lib/fflush.c (clear_ungetc_buffer, disable_seek_optimization,
	restore_seek_optimization, update_fpos_cache, rpl_fflush: Likewise.
	* lib/fpurge.c (fpurge): Likewise.
	* lib/freadable.c (freaadable): Likewise.
	* lib/freadahead.c (freadahead): Likewise.
	* lib/freading.c (freading): Likewise.
	* lib/freadptr.c (freadptr): Likewise.
	* lib/freadseek.c (freadptrinc): Likewise.
	* lib/fseeko.c (fseeko): Likewise.
	* lib/fseterr.c (fseterr): Likewise.
	* lib/fwritable.c (fwritable): Likewise.
	* lib/fwriting.c (fwriting): Likewise.

2008-04-26  Bruno Haible  <bruno@clisp.org>

	* lib/stdio-impl.h: New file.
	* lib/fbufmode.c: Include stdio-impl.h.
	(fbufmode): Use fp_, remove redundant #defines.
	* lib/fflush.c: Include stdio-impl.h.
	(clear_ungetc_buffer): Remove redundant #defines.
	* lib/fpurge.c: Include stdio-impl.h.
	(fpurge): Remove redundant #defines.
	* lib/freadable.c: Include stdio-impl.h.
	(freadable): Remove redundant #defines.
	* lib/freadahead.c: Include stdio-impl.h.
	(freadahead): Remove redundant #defines.
	* lib/freading.c: Include stdio-impl.h.
	(freading): Remove redundant #defines.
	* lib/freadptr.c: Include stdio-impl.h.
	(freadptr): Remove redundant #defines.
	* lib/freadseek.c: Include stdio-impl.h.
	(freadptrinc): Remove redundant #defines.
	* lib/fseeko.c: Include stdio-impl.h.
	(rpl_fseeko): Remove redundant #defines.
	* lib/fseterr.c: Include stdio-impl.h.
	(fseterr): Remove redundant #defines.
	* lib/fwritable.c: Include stdio-impl.h.
	(fwritable: Remove redundant #defines.
	* lib/fwriting.c: Include stdio-impl.h.
	(fwriting): Remove redundant #defines.
	* modules/fbufmode (Files): Add lib/stdio-impl.h.
	* modules/fflush (Files): Likewise.
	* modules/fpurge (Files): Likewise.
	* modules/freadable (Files): Likewise.
	* modules/freadahead (Files): Likewise.
	* modules/freading (Files): Likewise.
	* modules/freadptr (Files): Likewise.
	* modules/freadseek (Files): Likewise.
	* modules/fseeko (Files): Likewise.
	* modules/fseterr (Files): Likewise.
	* modules/fwritable (Files): Likewise.
	* modules/fwriting (Files): Likewise.

2008-04-26  Bruno Haible  <bruno@clisp.org>

	* lib/fflush.c (clear_ungetc_buffer, disable_seek_optimization,
	restore_seek_optimization, update_fpos_cache): New functions, extracted
	from rpl_fflush.
	(rpl_fflush): Use them.
	* m4/fflush.m4 (gl_PREREQ_FFLUSH): New macro.
	(gl_REPLACE_FFLUSH): Use it.

2008-04-26  Bruno Haible  <bruno@clisp.org>

	* tests/test-xstrtol.sh: Work around limitation of an old 'tr' program
	on Solaris.
	* tests/test-xstrtoimax.sh: Likewise.
	* tests/test-xstrtoumax.sh: Likewise.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2008-04-26  Bruno Haible  <bruno@clisp.org>

	* modules/memchr-tests: New file.
	* tests/test-memchr.c; New file, based on tests/test-memchr2.c.

2008-04-26  Eric Blake  <ebb9@byu.net>
	    Bruno Haible  <bruno@clisp.org>

	* lib/memchr.c: Include intprops.h.
	(__memchr): Optimize parallel detection of matching bytes. Rename local
	variables. Add explanatory comments.

2008-04-26  Bruno Haible  <bruno@clisp.org>

	Fix module 'memchr', broken since 2000-10-28.
	* lib/memchr.c: Outside glibc, define memchr, not __memchr.

2008-04-26  Bruno Haible  <bruno@clisp.org>

	* lib/memchr2.c (memchr2): Rename local variables. Add explanatory
	comments.

2008-04-25  Eric Blake  <ebb9@byu.net>

	Use native fstatat on cygwin 1.7.0.
	* m4/openat.m4 (gl_FUNC_OPENAT): Make sure lstat check is made
	first.

2008-04-23  Eric Blake  <ebb9@byu.net>

	Improve memchr2 performance.
	* lib/memchr2.c (memchr2): Further optimize parallel detection of
	NUL bytes.
	* modules/memchr2 (Depends-on): Use intprops.h.

2008-04-23  Simon Josefsson  <simon@josefsson.org>

	* lib/sys_socket.in.h (setsockopt): Be more type safe by declaring
	an inline function instead of a CPP macro.  Patch by Ben Pfaff
	<blp@cs.stanford.edu>.

2008-04-23  Simon Josefsson  <simon@josefsson.org>

	* lib/arpa_inet.in.h: New file.

	* modules/arpa_inet (Files): Add lib/arpa_inet.in.h.
	(Makefile.am): Sed in substitute header file.

	* m4/arpa_inet_h.m4: Add gl_ARPA_INET_H_DEFAULTS and
	gl_ARPA_INET_MODULE_INDICATOR.  Use them.

	* modules/inet_ntop (configure.ac): Use
	gl_ARPA_INET_MODULE_INDICATOR.

	* modules/inet_pton (configure.ac): Use
	gl_ARPA_INET_MODULE_INDICATOR.

2008-04-22  Jim Meyering  <meyering@redhat.com>

	* modules/verify (License): Re-license as LGPLv2+.

2008-04-22  Simon Josefsson  <simon@josefsson.org>

	* lib/sys_socket.in.h: Define setsockopt macro to cast fourth
	parameter to void* as per POSIX standard (MinGW uses char*).

2008-04-21  Bruno Haible  <bruno@clisp.org>

	* lib/wctype.in.h (iswalnum, iswalpha, iswblank, iswcntrl, iswdigit,
	iswgraph, iswlower, iswprint, iswpunct, iswspace, iswupper, iswxdigit):
	Define to replacements if REPLACE_ISWCNTRL is 1.
	* m4/wctype.m4 (gl_WCTYPE_H): Test whether the isw* functions work.
	If not, set WCTYPE_H to nonempty and REPLACE_ISWCNTRL to 1.
	* modules/wctype (Makefile.am): Substitute REPLACE_ISWCNTRL.
	* doc/posix-functions/iswalnum.texi: Mention the 'wctype' module and
	what it fixes.
	* doc/posix-functions/iswalpha.texi: Likewise.
	* doc/posix-functions/iswblank.texi: Likewise.
	* doc/posix-functions/iswcntrl.texi: Likewise.
	* doc/posix-functions/iswdigit.texi: Likewise.
	* doc/posix-functions/iswgraph.texi: Likewise.
	* doc/posix-functions/iswlower.texi: Likewise.
	* doc/posix-functions/iswprint.texi: Likewise.
	* doc/posix-functions/iswpunct.texi: Likewise.
	* doc/posix-functions/iswspace.texi: Likewise.
	* doc/posix-functions/iswupper.texi: Likewise.
	* doc/posix-functions/iswxdigit.texi: Likewise.
	Reported by Alain Guibert.

2008-04-21  Bruno Haible  <bruno@clisp.org>

	* m4/vsnprintf.m4 (gl_FUNC_VSNPRINTF): Fix typo in last commit.
	Patch by Alain Guibert.

2008-04-21  Bruno Haible  <bruno@clisp.org>

	Fix test failures on mingw.
	* tests/test-xstrtol.c (print_no_progname): New function.
	(main): Install it in error_print_progname hook.
	* tests/test-xstrtol.sh: Convert CR/LF to NL in output.
	* tests/test-xstrtoimax.sh: Likewise.
	* tests/test-xstrtoumax.sh: Likewise.

2008-04-21  Bruno Haible  <bruno@clisp.org>

	Fix test failure on mingw.
	* tests/test-argp-2.sh (func_compare): Remove CRs from sed's output.

2008-04-21  Bruno Haible  <bruno@clisp.org>

	* lib/localename.c (SUBLANG_TIBETAN_PRC, SUBLANG_TIBETAN_BHUTAN):
	Actually assign a value.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	Fix conflict between modules 'canonicalize' and 'canonicalize-lgpl',
	take 2.
	* lib/canonicalize.c (canonicalize_file_name): Elide if the
	'canonicalize-lgpl' module is also used.
	* lib/canonicalize-lgpl.c: Undo last change.
	* modules/canonicalize-lgpl (configure.ac): Invoke gl_MODULE_INDICATOR.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* lib/mkdir.c (mkdir): Undefine after the includes, not right after
	config.h. Provide _mkdir based fallback for mingw.
	* lib/sys_stat.in.h (mkdir): Define through an 'extern' declaration
	if REPLACE_MKDIR is 1. Otherwise, test for mingw directly.
	* m4/mkdir-slash.m4 (gl_FUNC_MKDIR_TRAILING_SLASH): Require
	gl_SYS_STAT_H_DEFAULTS. When doing the replacement, set REPLACE_MKDIR
	rather than defining mkdir in config.h.
	* m4/sys_stat_h.m4 (gl_SYS_STAT_MODULE_INDICATOR): New macro.
	(gl_SYS_STAT_H_DEFAULTS): New macro.
	(gl_HEADER_SYS_STAT_H): Require it. Don't set HAVE_DECL_MKDIR and
	HAVE_IO_H any more.
	* modules/sys_stat (Makefile.am): Substitute REPLACE_MKDIR instead of
	HAVE_DECL_MKDIR and HAVE_IO_H.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* lib/isapipe.c: Port to native Windows platforms.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* lib/gc-gnulib.c: Include <windows.h> before <wincrypt.h>.

2008-04-21  Eric Blake  <ebb9@byu.net>

	Work around preprocessors that don't handle UINTMAX_MAX.
	* lib/memchr2.c (memchr2): Avoid embedded #if.
	Reported by Alain Guibert, fix suggested by Bruno Haible.

2008-04-21  Simon Josefsson  <simon@josefsson.org>

	* doc/posix-functions/strftime.texi (strftime): Explain better
	Windows incompatibility.  Suggested by Micah Cowan
	<micah@cowan.name>.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* modules/uniconv/u32-conv-to-enc (Depends-on): Add unistr/u32-mblen,
	unistr/u8-mblen.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	Fix test failure on platforms with non-GNU iconv.
	* lib/uniconv/u16-conv-to-enc.c (u16_to_u8_lenient): New function.
	(U_TO_U8): Use it, rather than u16_to_u8.
	* lib/uniconv/u-conv-to-enc.h (FUNC): Allow an incomplete sequence of
	units at the end of the input string.
	* modules/uniconv/u16-conv-to-enc (Depends-on): Update.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* tests/uniconv/test-u8-conv-to-enc.c (main): Accept result == NULL
	when the resulting length is 0.
	* tests/uniconv/test-u16-conv-to-enc.c (main): Likewise.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* m4/roundf.m4 (gl_FUNC_ROUNDF): Add test whether roundf actually
	works.
	* doc/posix-functions/roundf.texi: Mention roundf bug on mingw.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* tests/test-tsearch.c (main): Don't use initstate if it is missing.
	* modules/tsearch-tests (configure.ac): Test for initstate function.

2008-04-20  Bruno Haible  <bruno@clisp.org>

	* m4/sys_stat_h.m4 (gl_HEADER_SYS_STAT_H): Also provided a substitute
	for nlink_t if missing.
	* tests/test-sys_stat.c: Check the existence of the nlink_t type.

2008-04-19  Bruno Haible  <bruno@clisp.org>

	Work around snprintf bug on Linux libc5.
	* m4/printf.m4 (gl_SNPRINTF_SIZE1): New macro.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Invoke
	gl_SNPRINTF_SIZE1.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/snprintf.m4 (gl_FUNC_SNPRINTF): Likewise. Replace snprintf if
	that test failed.
	* m4/vsnprintf.m4 (gl_FUNC_VSNPRINTF): Likewise.
	* lib/vasnprintf.c (USE_SNPRINTF): Set to 0 on Linux libc5 systems.
	* modules/snprintf (Files): Add m4/printf.m4.
	* modules/vsnprintf (Files): Likewise.
	* doc/posix-functions/snprintf.texi: Document Linux libc5 problem.
	* doc/posix-functions/vsnprintf.texi: Likewise.

2008-04-19  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (floorlog10l, floorlog10): Reduce maximum error
	from 0.0058 to less than 10^-7.

2008-04-19  Bruno Haible  <bruno@clisp.org>

	Fix rounding when a precision is given.
	* lib/vasnprintf.c (is_borderline): New function.
	(VASNPRINTF): For %e and %g, consider replacing the digits 10....0 with
	9...9x.
	* tests/test-vasnprintf-posix.c (test_function): Test rounding with %f,
	%e, %g.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-fprintf-posix.h (test_function): Test rounding with %f.
	* tests/test-printf-posix.h (test_function): Likewise.
	* tests/test-printf-posix.output: Update.
	Reported by John Darrington <john@darrington.wattle.id.au> via
	Ben Pfaff <blp@cs.stanford.edu>.

2008-04-18  Simon Josefsson  <simon@josefsson.org>

	* doc/posix-functions/strftime.texi (strftime): Clarify platform.
	Suggested by Bruno Haible <bruno@clisp.org>.

2008-04-17  Bruno Haible  <bruno@clisp.org>

	* lib/lock.h (gl_lock_destroy, gl_rwlock_destroy,
	gl_recursive_lock_destroy): Provide no-op definitions for the dummy
	implementation.
	Patch by Bruce Merry <bmerry@gmail.com>.

2008-04-17  Simon Josefsson  <simon@josefsson.org>

	* doc/posix-functions/strftime.texi (strftime): Mention that %e
	doesn't work under Windows.

2008-04-16  Bruno Haible  <bruno@clisp.org>

	* lib/localename.c (LANG_MAORI, LANG_QUECHUA, LANG_SOTHO, LANG_UIGHUR):
	New macros.
	(SUBLANG_BOSNIAN_BOSNIA_HERZEGOVINA_LATIN,
	SUBLANG_BOSNIAN_BOSNIA_HERZEGOVINA_CYRILLIC,
	SUBLANG_CROATIAN_CROATIA, SUBLANG_CROATIAN_BOSNIA_HERZEGOVINA_LATIN,
	SUBLANG_MONGOLIAN_CYRILLIC_MONGOLIA, SUBLANG_MONGOLIAN_PRC,
	SUBLANG_QUECHUA_BOLIVIA, SUBLANG_QUECHUA_ECUADOR, SUBLANG_QUECHUA_PERU,
	SUBLANG_RUSSIAN_RUSSIA, SUBLANG_RUSSIAN_MOLDAVIA, SUBLANG_SPANISH_US,
	SUBLANG_TIBETAN_PRC, SUBLANG_TIBETAN_BHUTAN, SUBLANG_UIGHUR_PRC): New
	macros.
	(gl_locale_name_from_win32_LANGID): Refine code for Croatian/Bosnian,
	Mongolian, Russian, Spanish, Tibetan. Add code for Maori, Quechua,
	Northern Sotho, Uighur.

2008-04-16  Bruno Haible  <bruno@clisp.org>

	* lib/localename.c (SUBLANG_SINDHI_INDIA): New macro.
	(SUBLANG_SINDHI_PAKISTAN): Change value from 1 to 2.
	(gl_locale_name_from_win32_LANGID): Fix code for Sindhi.
	Reported by Daniel Bergström <daniel@octocode.com>.

2007-12-25  KJK::Hyperion  <hackbunny@reactos.com>
	    Bruno Haible  <bruno@clisp.org>

	* lib/localename.c (gl_locale_name_canonicalize) [WIN32_NATIVE]: New
	function.
	(gl_locale_name_from_win32_LANGID, gl_locale_name_from_win32_LCID):
	New functions, mostly extracted from gl_locale_name_default.
	(gl_locale_name_default): Use gl_locale_name_from_win32_LCID.

2008-04-16  Eric Blake  <ebb9@byu.net>

	Adjust strtod detection to catch glibc 2.7 bug.
	* m4/strtod.m4 (gl_FUNC_STRTOD): Test "nan()" behavior.
	Reported by John Gatewood Ham.

2008-04-16  Bruno Haible  <bruno@clisp.org>

	Add tentative support for Linux libc5.
	* lib/fbufmode.c (fbufmode) [__GNU_LIBRARY__==1]: Reuse glibc2 code.
	* lib/fpurge.c (fpurge): Likewise.
	* lib/freadable.c (freadable): Likewise.
	* lib/freadahead.c (freadahead): Likewise.
	* lib/freading.c (freading): Likewise.
	* lib/freadptr.c (freadptr): Likewise.
	* lib/freadseek.c (freadptrinc): Likewise.
	* lib/fseeko.c (rpl_fseeko): Likewise.
	* lib/fseterr.c (fseterr): Likewise.
	* lib/fwritable.c (fwritable): Likewise.
	* lib/fwriting.c (fwriting): Likewise.
	Reported by Alain Guibert <alguibert+bts@free.fr>.

2008-04-15  Bruno Haible  <bruno@clisp.org>

	* modules/mathl (configure.ac): Define module indicator.

2008-04-15  Bruno Haible  <bruno@clisp.org>

	* lib/logl.c (logl): Remove unused variables.

2008-04-15  Bruno Haible  <bruno@clisp.org>

	* lib/uniconv/u-conv-to-enc.h (FUNC): Fix return value when U_TO_U8
	fails.

2008-04-15  Bruno Haible  <bruno@clisp.org>

	* lib/trim.c (trim2): Fix argument of isspace() macro.

2008-04-15  Paolo Bonzini  <bonzini@gnu.org>

	* lib/tanl.c (kernel_tanl): Rename flag to invert, initialize it
	to 0.
	* lib/trigl.c (ieee754_rem_pio2l): Fix range checks.

2008-04-14  Bruno Haible  <bruno@clisp.org>

	* m4/calloc.m4 (_AC_FUNC_CALLOC_IF): Fix underquoting of
	AC_LANG_PROGRAM argument.
	* m4/extensions.m4 (AC_USE_SYSTEM_EXTENSIONS): Likewise.
	* m4/gethrxtime.m4 (gl_ARITHMETIC_HRTIME_T): Likewise.
	* m4/getopt.m4 (gl_GETOPT_CHECK_HEADERS): Likewise.
	* m4/inttypes.m4 (gl_INTTYPES_H): Likewise.
	* m4/math_h.m4 (gl_MATH_H): Likewise.
	* m4/mbstate_t.m4 (AC_TYPE_MBSTATE_T): Likewise.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): Likewise.
	* m4/netinet_in_h.m4 (gl_HEADER_NETINET_IN): Likewise.
	* m4/physmem.m4 (gl_SYS__SYSTEM_CONFIGURATION): Likewise.
	* m4/putenv.m4 (gl_FUNC_PUTENV): Likewise.
	* m4/regex.m4 (gl_REGEX): Likewise.
	* m4/stdint.m4 (gl_INTEGER_TYPE_SUFFIX): Likewise.
	* m4/stdio_h.m4 (gl_STDIN_LARGE_OFFSET): Likewise.
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR): Likewise.
	* m4/strerror.m4 (gl_FUNC_STRERROR_SEPARATE): Likewise.
	* m4/strndup.m4 (gl_FUNC_STRNDUP): Likewise.
	* m4/strstr.m4 (gl_FUNC_STRSTR): Likewise.
	* m4/sys_select_h.m4 (gl_HEADER_SYS_SELECT): Likewise.
	* m4/sys_socket_h.m4 (gl_HEADER_SYS_SOCKET): Likewise.

2008-04-14  Jim Meyering  <meyering@redhat.com>

	test-strtod: fix typos: s/abs/fabs/
	* tests/test-strtod.c (main): Use fabs, not narrowing-to-int "abs".

2008-04-13  Bruno Haible  <bruno@clisp.org>

	Fix conflict between modules 'canonicalize' and 'canonicalize-lgpl'.
	* lib/canonicalize-lgpl.c: Elide the contents if the 'canonicalize'
	module is also used and while not building the reloc-wrapper.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* tests/test-getaddrinfo.c (simple): Ignore EAI_NODATA error.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	Fix AIX compilation failure introduced on 2008-04-02.
	* tests/test-frexp.c (exp): Undefine before redefining.
	* tests/test-frexpl.c (exp): Likewise.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	Work around a HP-UX stdio bug.
	* tests/test-ftell.c (main): Disable the fseek/ftell test on HP-UX.
	* tests/test-ftello.c (main): Likewise.
	* doc/posix-functions/ftell.texi: Mention HP-UX bug.
	* doc/posix-functions/ftello.texi: Likewise.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	Make test-signbit pass on HP-UX/hppa.
	* tests/test-signbit.c (minus_zerol): New variable.
	(test_signbitl): Use it.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	Make truncl work on OSF/1 4.0.
	* m4/truncl.m4 (gl_FUNC_TRUNCL): Test whether truncl actually works.
	Set REPLACE_TRUNCL, not HAVE_DECL_TRUNCL.
	* lib/math.in.h (truncl): Test REPLACE_TRUNCL, not HAVE_DECL_TRUNCL.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize REPLACE_TRUNCL, not
	HAVE_DECL_TRUNCL.
	* modules/math (Makefile.am): Substitute REPLACE_TRUNCL, not
	HAVE_DECL_TRUNCL.
	* doc/posix-functions/truncl.texi: Document the OSF/1 4.0 problem.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* lib/unictype.h: Remove trailing comma from enumeration definitions.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* lib/count-one-bits.h (COUNT_ONE_BITS): Rewrite verification
	expression, so as to avoid HP-UX 11 cc compiler bug.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* m4/regex.m4 (gl_PREREQ_REGEX): Also check for <libintl.h>.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* lib/git-merge-changelog.c: Remove empty declaration outside of
	functions.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* modules/quotearg-tests (Makefile.am): Define test_quotearg_LDADD.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* doc/posix-headers/sys_socket.texi: Document the problem on EMX.
	* lib/sys_socket.in.h (SHUT_RD, SHUT_WR, SHUT_RDWR): Define if missing.
	* m4/sys_socket_h.m4 (gl_HEADER_SYS_SOCKET): Replace <sys/socket.h>
	also if it exists but lacks definitions of the SHUT_* macros.
	* modules/sys_socket (Description): Update.
	Reported by Elbert Pol <e.pol@chello.nl>.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* lib/localcharset.c (OS2): Don't redefine if already defined.
	Reported by Elbert Pol <e.pol@chello.nl>.

2008-04-13  Bruno Haible  <bruno@clisp.org>

	* lib/binary-io.h [__EMX__]: Include <io.h>.
	Reported by Elbert Pol <e.pol@chello.nl>.

2008-04-12  Bruno Haible  <bruno@clisp.org>

	* lib/fpucw.h: Enable the definitions also for x86_64.
	Needed for NetBSD/x86_64.
	Reported by Thomas Klausner <tk@giga.or.at>.

2008-04-12  Bruno Haible  <bruno@clisp.org>

	* tests/test-strtod.c: Include isnand.h.
	(main): Use isnand instead of isnan.
	Reported by Jim Meyering.

2008-04-12  Bruno Haible  <bruno@clisp.org>

	* m4/isnanf.m4 (gl_ISNANF_WORKS): Add a test for a special NaN.
	Reported by Nelson H. F. Beebe <beebe@math.utah.edu>.

2008-04-12  Jim Meyering  <meyering@redhat.com>

	* m4/math_h.m4 (gl_MATH_H): Fix typos.

2008-04-12  Bruno Haible  <bruno@clisp.org>

	* lib/freadptr.c (freadptr) [__EMX__]: Fix wrong assertion.
	Reported by Elbert Pol <e.pol@chello.nl>.

2008-04-12  Eric Blake  <ebb9@byu.net>

	Work around Solaris 10 math.h bug.
	* m4/math_h.m4 (gl_MATH_H): Check for bug.
	(gl_MATH_H_DEFAULTS): Set up default.
	* modules/math (Makefile.am): Replace new indicators.
	* lib/math.in.h (NAN, HUGE_VAL): Provide replacements.
	* tests/test-math.c (main): Test this.
	* m4/strtod.m4 (gl_FUNC_STRTOD): Don't rely on HUGE_VAL.
	* doc/posix-headers/math.texi (math.h): Mention bug.
	Reported by Nelson H. F. Beebe and Jim Meyering.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	Adapt to future versions of Apple GCC.
	* lib/argp-fmtstream.h (ARGP_FS_EI): Don't test __GNUC_GNU_INLINE__.
	Reported by Peter O'Gorman <peter@pogma.com>.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	* tests/test-getaddrinfo.c (simple): Ignore EAI_NONAME error.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	* modules/strsignal-tests (Makefile.am): Define test_strsignal_LDADD.

	* modules/getaddrinfo-tests (Makefile.am): Define
	test_getaddrinfo_LDADD.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	* lib/strsignal.c (_sys_siglist): Don't declare if already declared.
	(init): Fix syntax error.
	* m4/strsignal.m4 (gl_PREREQ_STRSIGNAL): Check whether _sys_siglist
	is declared.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	* lib/glob.c: Include <stdbool.h>. Needed at least with IRIX cc.
	* modules/glob (Depends-on): Add stdbool.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	* lib/trim.c: Include <string.h>.

2008-04-11  Eric Blake  <ebb9@byu.net>

	Avoid compile failure on OS/2.
	* lib/regex_internal.h (internal_function): Disable optimization
	on OS/2 (__EMX__), where it caused compiler error.
	Reported by Elbert Pol.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	Flush the standard error stream before aborting. Needed on mingw.
	* tests/test-argmatch.c (ASSERT): Call fflush(stderr) before abort().
	* tests/test-array_list.c (ASSERT): Likewise.
	* tests/test-array_oset.c (ASSERT): Likewise.
	* tests/test-avltree_list.c (ASSERT): Likewise.
	* tests/test-avltree_oset.c (ASSERT): Likewise.
	* tests/test-avltreehash_list.c (ASSERT): Likewise.
	* tests/test-binary-io.c (ASSERT): Likewise.
	* tests/test-byteswap.c (ASSERT): Likewise.
	* tests/test-c-ctype.c (ASSERT): Likewise.
	* tests/test-c-strcasecmp.c (ASSERT): Likewise.
	* tests/test-c-strcasestr.c (ASSERT): Likewise.
	* tests/test-c-strncasecmp.c (ASSERT): Likewise.
	* tests/test-c-strstr.c (ASSERT): Likewise.
	* tests/test-canonicalize-lgpl.c (ASSERT): Likewise.
	* tests/test-canonicalize.c (ASSERT): Likewise.
	* tests/test-carray_list.c (ASSERT): Likewise.
	* tests/test-ceilf1.c (ASSERT): Likewise.
	* tests/test-ceilf2.c (ASSERT): Likewise.
	* tests/test-ceill.c (ASSERT): Likewise.
	* tests/test-count-one-bits.c (ASSERT): Likewise.
	* tests/test-fbufmode.c (ASSERT): Likewise.
	* tests/test-fflush2.c (ASSERT): Likewise.
	* tests/test-floorf1.c (ASSERT): Likewise.
	* tests/test-floorf2.c (ASSERT): Likewise.
	* tests/test-floorl.c (ASSERT): Likewise.
	* tests/test-fopen.c (ASSERT): Likewise.
	* tests/test-fpending.c (ASSERT): Likewise.
	* tests/test-fprintf-posix.c (ASSERT): Likewise.
	* tests/test-fpurge.c (ASSERT): Likewise.
	* tests/test-freadable.c (ASSERT): Likewise.
	* tests/test-freadahead.c (ASSERT): Likewise.
	* tests/test-freading.c (ASSERT): Likewise.
	* tests/test-freadptr.c (ASSERT): Likewise.
	* tests/test-freadptr2.c (ASSERT): Likewise.
	* tests/test-freadseek.c (ASSERT): Likewise.
	* tests/test-freopen.c (ASSERT): Likewise.
	* tests/test-frexp.c (ASSERT): Likewise.
	* tests/test-frexpl.c (ASSERT): Likewise.
	* tests/test-fseek.c (ASSERT): Likewise.
	* tests/test-fseeko.c (ASSERT): Likewise.
	* tests/test-fstrcmp.c (ASSERT): Likewise.
	* tests/test-ftell.c (ASSERT): Likewise.
	* tests/test-ftello.c (ASSERT): Likewise.
	* tests/test-func.c (ASSERT): Likewise.
	* tests/test-fwritable.c (ASSERT): Likewise.
	* tests/test-fwriting.c (ASSERT): Likewise.
	* tests/test-getdelim.c (ASSERT): Likewise.
	* tests/test-getline.c (ASSERT): Likewise.
	* tests/test-i-ring.c (ASSERT): Likewise.
	* tests/test-iconv-utf.c (ASSERT): Likewise.
	* tests/test-iconv.c (ASSERT): Likewise.
	* tests/test-isfinite.c (ASSERT): Likewise.
	* tests/test-isnand.c (ASSERT): Likewise.
	* tests/test-isnanf.c (ASSERT): Likewise.
	* tests/test-isnanl.h (ASSERT): Likewise.
	* tests/test-ldexpl.c (ASSERT): Likewise.
	* tests/test-linked_list.c (ASSERT): Likewise.
	* tests/test-linkedhash_list.c (ASSERT): Likewise.
	* tests/test-localename.c (ASSERT): Likewise.
	* tests/test-lseek.c (ASSERT): Likewise.
	* tests/test-mbscasecmp.c (ASSERT): Likewise.
	* tests/test-mbscasestr1.c (ASSERT): Likewise.
	* tests/test-mbscasestr2.c (ASSERT): Likewise.
	* tests/test-mbscasestr3.c (ASSERT): Likewise.
	* tests/test-mbscasestr4.c (ASSERT): Likewise.
	* tests/test-mbschr.c (ASSERT): Likewise.
	* tests/test-mbscspn.c (ASSERT): Likewise.
	* tests/test-mbsncasecmp.c (ASSERT): Likewise.
	* tests/test-mbspbrk.c (ASSERT): Likewise.
	* tests/test-mbspcasecmp.c (ASSERT): Likewise.
	* tests/test-mbsrchr.c (ASSERT): Likewise.
	* tests/test-mbsspn.c (ASSERT): Likewise.
	* tests/test-mbsstr1.c (ASSERT): Likewise.
	* tests/test-mbsstr2.c (ASSERT): Likewise.
	* tests/test-mbsstr3.c (ASSERT): Likewise.
	* tests/test-memchr2.c (ASSERT): Likewise.
	* tests/test-memmem.c (ASSERT): Likewise.
	* tests/test-open.c (ASSERT): Likewise.
	* tests/test-printf-frexp.c (ASSERT): Likewise.
	* tests/test-printf-frexpl.c (ASSERT): Likewise.
	* tests/test-printf-posix.c (ASSERT): Likewise.
	* tests/test-quotearg.c (ASSERT): Likewise.
	* tests/test-rbtree_list.c (ASSERT): Likewise.
	* tests/test-rbtree_oset.c (ASSERT): Likewise.
	* tests/test-rbtreehash_list.c (ASSERT): Likewise.
	* tests/test-round1.c (ASSERT): Likewise.
	* tests/test-roundf1.c (ASSERT): Likewise.
	* tests/test-roundl.c (ASSERT): Likewise.
	* tests/test-signbit.c (ASSERT): Likewise.
	* tests/test-sleep.c (ASSERT): Likewise.
	* tests/test-snprintf-posix.c (ASSERT): Likewise.
	* tests/test-snprintf.c (ASSERT): Likewise.
	* tests/test-sprintf-posix.c (ASSERT): Likewise.
	* tests/test-stat-time.c (ASSERT): Likewise.
	* tests/test-strcasestr.c (ASSERT): Likewise.
	* tests/test-strerror.c (ASSERT): Likewise.
	* tests/test-striconv.c (ASSERT): Likewise.
	* tests/test-striconveh.c (ASSERT): Likewise.
	* tests/test-striconveha.c (ASSERT): Likewise.
	* tests/test-strsignal.c (ASSERT): Likewise.
	* tests/test-strstr.c (ASSERT): Likewise.
	* tests/test-strtod.c (ASSERT): Likewise.
	* tests/test-trunc1.c (ASSERT): Likewise.
	* tests/test-trunc2.c (ASSERT): Likewise.
	* tests/test-truncf1.c (ASSERT): Likewise.
	* tests/test-truncf2.c (ASSERT): Likewise.
	* tests/test-truncl.c (ASSERT): Likewise.
	* tests/test-vasnprintf-posix.c (ASSERT): Likewise.
	* tests/test-vasnprintf-posix2.c (ASSERT): Likewise.
	* tests/test-vasnprintf.c (ASSERT): Likewise.
	* tests/test-vasprintf-posix.c (ASSERT): Likewise.
	* tests/test-vasprintf.c (ASSERT): Likewise.
	* tests/test-vfprintf-posix.c (ASSERT): Likewise.
	* tests/test-vprintf-posix.c (ASSERT): Likewise.
	* tests/test-vsnprintf-posix.c (ASSERT): Likewise.
	* tests/test-vsnprintf.c (ASSERT): Likewise.
	* tests/test-vsprintf-posix.c (ASSERT): Likewise.
	* tests/test-wcwidth.c (ASSERT): Likewise.
	* tests/test-xfprintf-posix.c (ASSERT): Likewise.
	* tests/test-xprintf-posix.c (ASSERT): Likewise.
	* tests/test-xvasprintf.c (ASSERT): Likewise.
	* tests/uniconv/test-u16-conv-from-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u16-conv-to-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u16-strconv-from-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u16-strconv-to-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u32-conv-from-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u32-conv-to-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u32-strconv-from-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u32-strconv-to-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u8-conv-from-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u8-conv-to-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u8-strconv-from-enc.c (ASSERT): Likewise.
	* tests/uniconv/test-u8-strconv-to-enc.c (ASSERT): Likewise.
	* tests/unictype/test-bidi_byname.c (ASSERT): Likewise.
	* tests/unictype/test-bidi_name.c (ASSERT): Likewise.
	* tests/unictype/test-bidi_of.c (ASSERT): Likewise.
	* tests/unictype/test-bidi_test.c (ASSERT): Likewise.
	* tests/unictype/test-block_list.c (ASSERT): Likewise.
	* tests/unictype/test-block_of.c (ASSERT): Likewise.
	* tests/unictype/test-block_test.c (ASSERT): Likewise.
	* tests/unictype/test-categ_and.c (ASSERT): Likewise.
	* tests/unictype/test-categ_and_not.c (ASSERT): Likewise.
	* tests/unictype/test-categ_byname.c (ASSERT): Likewise.
	* tests/unictype/test-categ_name.c (ASSERT): Likewise.
	* tests/unictype/test-categ_none.c (ASSERT): Likewise.
	* tests/unictype/test-categ_of.c (ASSERT): Likewise.
	* tests/unictype/test-categ_or.c (ASSERT): Likewise.
	* tests/unictype/test-categ_test_withtable.c (ASSERT): Likewise.
	* tests/unictype/test-combining.c (ASSERT): Likewise.
	* tests/unictype/test-decdigit.c (ASSERT): Likewise.
	* tests/unictype/test-digit.c (ASSERT): Likewise.
	* tests/unictype/test-mirror.c (ASSERT): Likewise.
	* tests/unictype/test-numeric.c (ASSERT): Likewise.
	* tests/unictype/test-pr_byname.c (ASSERT): Likewise.
	* tests/unictype/test-pr_test.c (ASSERT): Likewise.
	* tests/unictype/test-predicate-part1.h (ASSERT): Likewise.
	* tests/unictype/test-scripts.c (ASSERT): Likewise.
	* tests/unictype/test-sy_c_ident.c (ASSERT): Likewise.
	* tests/unictype/test-sy_java_ident.c (ASSERT): Likewise.
	* tests/unistdio/test-u16-asnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u16-vasnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u16-vasnprintf2.c (ASSERT): Likewise.
	* tests/unistdio/test-u16-vasnprintf3.c (ASSERT): Likewise.
	* tests/unistdio/test-u16-vasprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u16-vsnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u16-vsprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u32-asnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u32-vasnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u32-vasnprintf2.c (ASSERT): Likewise.
	* tests/unistdio/test-u32-vasnprintf3.c (ASSERT): Likewise.
	* tests/unistdio/test-u32-vasprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u32-vsnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u32-vsprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u8-asnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u8-vasnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u8-vasnprintf2.c (ASSERT): Likewise.
	* tests/unistdio/test-u8-vasnprintf3.c (ASSERT): Likewise.
	* tests/unistdio/test-u8-vasprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u8-vsnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-u8-vsprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-ulc-asnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-ulc-vasnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-ulc-vasnprintf2.c (ASSERT): Likewise.
	* tests/unistdio/test-ulc-vasnprintf3.c (ASSERT): Likewise.
	* tests/unistdio/test-ulc-vasprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-ulc-vsnprintf1.c (ASSERT): Likewise.
	* tests/unistdio/test-ulc-vsprintf1.c (ASSERT): Likewise.
	* tests/uniwidth/test-u16-strwidth.c (ASSERT): Likewise.
	* tests/uniwidth/test-u16-width.c (ASSERT): Likewise.
	* tests/uniwidth/test-u32-strwidth.c (ASSERT): Likewise.
	* tests/uniwidth/test-u32-width.c (ASSERT): Likewise.
	* tests/uniwidth/test-u8-strwidth.c (ASSERT): Likewise.
	* tests/uniwidth/test-u8-width.c (ASSERT): Likewise.
	* tests/uniwidth/test-uc_width.c (ASSERT): Likewise.
	Reported by Eric Blake.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	* lib/wchar.in.h: Tweak comment.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	Fix __GNUC_STDC_INLINE__ predefine with Apple GCC on MacOS X 10.5.
	* gnulib-tool (func_emit_initmacro_start): Emit an invocation of
	gl_COMMON.
	* m4/gnulib-common.m4 (gl_COMMON, gl_COMMON_BODY): New macros.

2008-04-11  Bruno Haible  <bruno@clisp.org>

	* modules/git-merge-changelog (git_merge_changelog_LDADD): Add LIBINTL.

2008-04-11  Simon Josefsson  <simon@josefsson.org>

	* lib/gc-gnulib.c: On Windows, use CryptGenRandom from CSP instead
	of attempting to use non-existing /dev/*random.  Based on patch
	from Adam Strzelecki <ono@java.pl> in
	<http://lists.gnu.org/archive/html/help-gsasl/2008-02/msg00000.html>.

2008-04-08  Bruno Haible  <bruno@clisp.org>

	Add tentative support for emx+gcc.
	* lib/fbufmode.c (fbufmode) [__EMX__]: Add conditional code.
	* lib/fpurge.c (fpurge): Likewise.
	* lib/freadable.c (freadable): Likewise.
	* lib/freadahead.c (freadahead): Likewise.
	* lib/freading.c (freading): Likewise.
	* lib/freadptr.c (freadptr): Likewise.
	* lib/freadseek.c (freadptrinc): Likewise.
	* lib/fseeko.c (rpl_fseeko): Likewise.
	* lib/fseterr.c (fseterr): Likewise.
	* lib/fwritable.c (fwritable): Likewise.
	* lib/fwriting.c (fwriting): Likewise.
	* m4/fpending.m4 (gl_FUNC_FPENDING): Add a variant for emx+gcc.

2008-04-09  Eric Blake  <ebb9@byu.net>

	Avoid some autoconf warnings.
	* m4/regex.m4 (gl_REGEX): s/AC_HELP_STRING/AS_HELP_STRING/.
	* m4/acl.m4 (gl_FUNC_ACL): Likewise.
	* m4/afs.m4 (gl_AFS): Likewise.
	* m4/gc-random.m4 (gl_GC_RANDOM): Likewise.
	* m4/include_next.m4 (gl_INCLUDE_NEXT): s/AC_FOREACH/m4_foreach_w/.
	* m4/absolute-header.m4 (gl_ABSOLUTE_HEADER): Likewise.
	* m4/stdint.m4 (gl_STDINT_BITSIZEOF, gl_CHECK_TYPES_SIGNED)
	(gl_INTEGER_TYPE_SUFFIX): Likewise.
	* m4/onceonly_2_57.m4 (AC_CHECK_HEADERS_ONCE, AC_CHECK_FUNCS_ONCE)
	(AC_CHECK_DECLS_ONCE): Likewise.
	Rename file...
	* m4/onceonly.m4: ...to this, and delete 2.54 variant, now that
	gnulib-tool requires autoconf 2.59 or better.
	* gnulib-tool (func_get_filelist): s/\(onceonly\)_2_57.m4/\1.m4/.

2008-04-08  Eric Blake  <ebb9@byu.net>

	Use 'git describe --match' if present (added in git 1.5.5).
	* build-aux/git-version-gen: Limit result to tags that match 'v*'
	if possible.

2008-04-08  Bruno Haible  <bruno@clisp.org>

	Add tentative support for OpenServer.
	* lib/fbufmode.c (fbufmode): Add conditional define for _flag, _base,
	_ptr, _cnt.
	* lib/fpurge.c (fpurge): Likewise.
	* lib/freadable.c (freadable): Likewise.
	* lib/freadahead.c (freadahead): Likewise.
	* lib/freading.c (freading): Likewise.
	* lib/freadptr.c (freadptr): Likewise.
	* lib/freadseek.c (freadptrinc): Likewise.
	* lib/fseeko.c (rpl_fseeko): Likewise.
	* lib/fseterr.c (fseterr): Likewise.
	* lib/fwritable.c (fwritable): Likewise.
	* lib/fwriting.c (fwriting): Likewise.
	Reported by Roger Cornelius <rac@tenzing.org> and
	Brian K. White <brian@aljex.com>.

2008-04-06  Jim Meyering  <meyering@redhat.com>

	* gnulib-tool (func_add_or_update): s/backuped/backed up/ in diagnostic

2008-04-06  Bruno Haible  <bruno@clisp.org>

	Avoid possible error with non-ASCII bytes in UTF-8 locales.
	* tests/test-fprintf-posix.sh: Use "LC_ALL=C tr" instead of "tr".
	* tests/test-printf-posix.sh: Likewise.
	* tests/test-vfprintf-posix.sh: Likewise.
	* tests/test-vprintf-posix.sh: Likewise.
	* tests/test-xprintf-posix.sh: Likewise.

2008-04-06  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/double-slash-root.m4 (gl_DOUBLE_SLASH_ROOT): Fix quoting,
	hide error from 'ls', needed on OS/2.
	Report by Elbert Pol <elbert.pol@gmail.com>.

2008-04-04  Eric Blake  <ebb9@byu.net>

	Make test-fseeko.c failures meaningful.
	* tests/test-fseeko.c: Print line number on failure.
	* tests/test-fseek.c: Likewise.
	Reported by Nelson H. F. Beebe.

	Improve strtod bug detection check.
	* m4/strtod.m4 (gl_FUNC_STRTOD): Also check for hex-float parsing,
	required for Solaris 10.
	Reported by Bob Friesenhahn and Nelson H. F. Beebe.

2008-04-04  Bruno Haible  <bruno@clisp.org>

	* modules/relocatable-prog-wrapper (Files): Add m4/environ.m4. Needed
	by m4/setenv.m4.

2008-04-03  Eric Blake  <ebb9@byu.net>

	Ensure sane .version contents.
	* top/GNUmakefile (_dummy): Also delete .version when rebuilding
	version string.
	* build-aux/git-version-gen: Improve documentation.

	Make GNU make output nicer.
	* top/GNUmakefile [!_have-Makefile]: Add dependency on
	MAKECMDGOALS to enforce message for all command line targets.  Set
	srcdir for use in maint.mk.

	Another maintainer tweak.
	* top/GNUmakefile (_is-dist-target): Allow maintainer-distcheck as
	a target that regenerates version.

2008-04-03  Jim Meyering  <meyering@redhat.com>

	vc-list-files: don't cause coreutils "make po-check" failure
	* build-aux/vc-list-files: Skip postprocessing when $2 is '.'

2008-04-03  Eric Blake  <ebb9@byu.net>

	Allow VPATH usage of vc-list-files.
	* build-aux/vc-list-files (scriptversion): Add timestamp.
	(options): Add --help, --version, -C.
	(CVS): Support installed cvsu.

2008-04-02  Bruno Haible  <bruno@clisp.org>

	Avoid some "statement with no effect" warnings from gcc.
	* tests/test-wctype.c (main): Explicitly ignore unused values.
	Reported by Jim Meyering.

2008-04-02  Jim Meyering  <meyering@redhat.com>

	Avoid some warnings from "gcc -Wshadow".
	* tests/test-frexp.c (exp): Define to a different identifier.
	* tests/test-frexpl.c (exp): Likewise.

2008-04-03  Jim Meyering  <meyering@redhat.com>

	bootstrap: remove dangling *.[ch] symlinks from lib
	* build-aux/bootstrap [dangling symlink removal]: Move find's
	-depth option to precede all others, to avoid a warning.
	Remove *.[ch] files too, and from "$source_base" (usually lib/).

2008-04-02  Bruno Haible  <bruno@clisp.org>

	Avoid some warnings from "gcc -Wshadow".
	* tests/tests-vfprintf-posix.c (my_fprintf): Move after test_function.
	* tests/tests-vprintf-posix.c (my_printf): Move after test_function.
	* tests/tests-vsnprintf-posix.c (my_snprintf): Move after test_function.
	* tests/tests-vsprintf-posix.c (my_sprintf): Move after test_function.
	Reported by Jim Meyering.

2008-04-01  Bruno Haible  <bruno@clisp.org>

	Fix test to work on IRIX 6.5 with cc.
	* tests/test-math.c (numeric_equal): New function.
	(main): Use it.

2008-04-01  Bruno Haible  <bruno@clisp.org>

	* doc/posix-headers/math.texi: Refine documentation of NAN problem.

2008-04-01  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c: Include nan.h instead of <math.h>.
	(test_function): Use NaNd, NaNl instead of NAN or 0.0L/0.0L.
	* modules/vasnprintf-posix-tests (Files): Add tests/nan.h.
	(Depends-on): Remove math.

	* tests/test-vasprintf-posix.c: Include nan.h instead of <math.h>.
	(test_function): Use NaNd, NaNl instead of NAN or 0.0L/0.0L.
	* modules/vasprintf-posix-tests (Files): Add tests/nan.h.
	(Depends-on): Remove math.

	* tests/test-snprintf-posix.h: Include nan.h instead of <math.h>.
	(test_function): Use NaNd, NaNl instead of NAN or 0.0L/0.0L.
	* modules/snprintf-posix-tests (Files): Add tests/nan.h.
	(Depends-on): Remove math.
	* modules/vsnprintf-posix-tests (Files): Add tests/nan.h.
	(Depends-on): Remove math.

	* tests/test-sprintf-posix.h: Include nan.h instead of <math.h>.
	(test_function): Use NaNd, NaNl instead of NAN or 0.0L/0.0L.
	* modules/sprintf-posix-tests (Files): Add tests/nan.h.
	(Depends-on): Remove math.
	* modules/vsprintf-posix-tests (Files): Add tests/nan.h.
	(Depends-on): Remove math.

	* tests/test-round1.c: Include nan.h.
	(main): Use NaNd instead of NAN.
	* modules/round-tests (Files): Add tests/nan.h.

	* tests/test-trunc1.c: Include nan.h.
	(main): Use NaNd instead of NAN.
	* modules/trunc-tests (Files): Add tests/nan.h.

	* tests/test-roundf1.c: Include nan.h.
	(main): Use NaNf instead of NAN.
	* modules/roundf-tests (Files): Add tests/nan.h.

	* tests/test-truncf1.c: Include nan.h.
	(main): Use NaNf instead of NAN.
	* modules/truncf-tests (Files): Add tests/nan.h.

	* tests/test-ceilf1.c: Include nan.h.
	(main): Use NaNf instead of NAN.
	* modules/ceilf-tests (Files): Add tests/nan.h.

	* tests/test-floorf1.c: Include nan.h.
	(main): Use NaNf instead of NAN.
	* modules/floorf-tests (Files): Add tests/nan.h.

	* tests/test-isnanf.c: Include nan.h instead of <math.h>.
	(main): Use NaNf instead of NAN.
	* modules/isnanf-nolibm-tests (Files): Add tests/nan.h.

	* tests/test-isnand.c: Include nan.h instead of <math.h>.
	(main): Use NaNd instead of NAN.
	* modules/isnand-nolibm-tests (Files): Add tests/nan.h.

	* tests/test-frexp.c: Include nan.h.
	(main): Use NaNd instead of NAN.
	* modules/frexp-tests (Files): Add tests/nan.h.

	* lib/isnan.c: Don't include <math.h>.
	(FUNC): Don't use NAN macro.
	* modules/isnand-nolibm (Depends-on): Remove math.
	* modules/isnanf-nolibm (Depends-on): Remove math.
	* modules/isnanl (Depends-on): Remove math.
	* modules/isnanl-nolibm (Depends-on): Remove math.

	* tests/nan.h: New file.

2008-04-01  Eric Blake  <ebb9@byu.net>

	Fix typos.
	* tests/test-strtod.c (main): s/FLT_/DBL_/ for minimum and epsilon
	values to be the right type.

	For now, cater to gnulib strtod inaccuracies.
	* tests/test-strtod.c (main): Allow 1-ulp error on expected
	fractional results.  While not as nice from a QoI perspective, it
	is a quicker patch than correctly implementing decimal to binary
	rounding.

2008-03-31  Eric Blake  <ebb9@byu.net>

	Guarantee a definition of NAN.
	* lib/math.in.h (NAN): Define if missing.
	* tests/test-math.c (main): Test it.
	* doc/posix-headers/math.texi (math.h): Document this.
	* lib/isnan.c (rpl_isnand): Use it.
	* tests/test-ceilf1.c (NaN): Delete, and use NAN instead.
	* tests/test-floorf1.c (NaN): Likewise.
	* tests/test-frexp.c (NaN): Likewise.
	* tests/test-isnand.c (NaN): Likewise.
	* tests/test-isnanf.c (NaN): Likewise.
	* tests/test-round1.c (NaN): Likewise.
	* tests/test-roundf1.c (NaN): Likewise.
	* tests/test-snprintf-posix.h (NaN): Likewise.
	* tests/test-sprintf-posix.h (NaN): Likewise.
	* tests/test-trunc1.c (NaN): Likewise.
	* tests/test-truncf1.c (NaN): Likewise.
	* tests/test-vasnprintf-posix.c (NaN): Likewise.
	* tests/test-vasprintf-posix.c (NaN): Likewise.
	* modules/isnand-nolibm (Depends-on): Add math.
	* modules/isnanf-nolibm (Depends-on): Likewise.
	* modules/isnanl (Depends-on): Likewise.
	* modules/isnanl-nolibm (Depends-on): Likewise.
	* modules/snprintf-posix-tests (Depends-on): Likewise.
	* modules/sprintf-posix-tests (Depends-on): Likewise.
	* modules/vsnprintf-posix-tests (Depends-on): Likewise.
	* modules/vsprintf-posix-tests (Depends-on): Likewise.
	* modules/vasnprintf-posix-tests (Depends-on): Likewise.
	* modules/vasprintf-posix-tests (Depends-on): Likewise.

2008-03-31  Bruno Haible  <bruno@clisp.org>

	* tests/test-strtod.c (main): Update results for OSF/1 platforms.
	* doc/posix-functions/strtod.texi: Likewise.

2008-03-31  Bruno Haible  <bruno@clisp.org>

	* tests/test-strtod.c (main): Don't use C99 syntax.

2008-03-31  Bruno Haible  <bruno@clisp.org>

	* tests/test-strtod.c (main): Don't test NAN macro. Needed for Solaris.
	Reported by Eric Blake.

2008-03-31  Jim Meyering  <meyering@redhat.com>

	Don't compare actual signbit return values.
	* tests/test-strtod.c (main): Rather, compare only their
	zero/non-zero nature.

2008-03-31  Eric Blake  <ebb9@byu.net>

	More strtod documentation.
	* doc/posix-functions/strtod.texi (strtod): Interpret more test
	failures as distinct bugs.

2008-03-30  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/wchar.in.h [defined __need_mbstate_t]: Just include <wchar.h>.
	Problem reported by Erik Benada in
	<http://lists.gnu.org/archive/html/bug-gnulib/2008-03/msg00249.html>.

2008-03-30  Bruno Haible  <bruno@clisp.org>

	* tests/test-strtod.c: Add comments about which assertion fails on which
	platform.
	* doc/posix-functions/strtod.texi: Add info about many more platforms.

2008-03-30  Eric Blake  <ebb9@byu.net>

	Test signbit behavior on zeros.
	* tests/test-signbit.c (test_signbitf): Add tests for zero.
	(test_signbitd, test_signbitl): Likewise.

	More strtod touchups.
	* tests/test-strtod.c (main): Ignore tests for signbit on NaN, and
	sign of negative underflow, for now.  Use .5, not .1.
	* doc/posix-functions/strtod.texi (strtod): Mention these
	limitations.
	Reported by Jim Meyering.

2008-03-30  Bruno Haible  <bruno@clisp.org>

	* lib/striconveh.h (mem_iconveh, str_iconveh): Optimize the conversion
	from UTF-8 to UTF-8//TRANSLIT in the same way as from UTF-8 to UTF-8.

2008-03-30  Bruno Haible  <bruno@clisp.org>

	Avoid failure when attempting to return empty iconv results on some
	platforms.
	* lib/striconveh.c (mem_cd_iconveh_internal): In the final memory
	allocation, don't report ENOMEM when the resulting string is empty.

2008-03-30  Bruno Haible  <bruno@clisp.org>

	Fix buffer overrun.
	* lib/vasnprintf.c (VASNPRINTF): If !USE_SNPRINTF && pad_ourselves:
	Don't consider the width for tmp_length. Check count against tmp_length
	before doing the padding. Ensure enough allocation during padding.

2008-03-30  Eric Blake  <ebb9@byu.net>

	strtod touchups.
	* lib/strtod.c (strtod): Avoid compiler warnings.
	Reported by Jim Meyering.

2008-03-30  Bruno Haible  <bruno@clisp.org>

	* lib/unistdio/u-vsprintf.h (EOVERFLOW): Remove fallback.
	* modules/unistdio/ulc-vsprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u8-vsprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u8-u8-vsprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u16-vsprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u16-u16-vsprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u32-vsprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u32-u32-vsprintf (Depends-on): Add EOVERFLOW.

	* lib/unistdio/u-vsnprintf.h (EOVERFLOW): Remove fallback.
	* modules/unistdio/ulc-vsnprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u8-vsnprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u8-u8-vsnprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u16-vsnprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u16-u16-vsnprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u32-vsnprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u32-u32-vsnprintf (Depends-on): Add EOVERFLOW.

	* lib/unistdio/u-vasprintf.h (EOVERFLOW): Remove fallback.
	* modules/unistdio/ulc-vasprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u8-vasprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u8-u8-vasprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u16-vasprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u16-u16-vasprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u32-vasprintf (Depends-on): Add EOVERFLOW.
	* modules/unistdio/u32-u32-vasprintf (Depends-on): Add EOVERFLOW.

	* lib/unistdio/ulc-vfprintf.c (EOVERFLOW): Remove fallback.
	* modules/unistdio/ulc-vfprintf (Depends-on): Add EOVERFLOW.

	* lib/unistdio/ulc-fprintf.c (EOVERFLOW): Remove fallback.
	* modules/unistdio/ulc-fprintf (Depends-on): Add EOVERFLOW.

	* lib/xvasprintf.c (EOVERFLOW): Remove fallback.
	* modules/xvasprintf (Depends-on): Add EOVERFLOW.

	* lib/vsprintf.c (EOVERFLOW): Remove fallback.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Drop gl_EOVERFLOW.
	* modules/vsprintf-posix (Depends-on): Add EOVERFLOW.

	* lib/vsnprintf.c (EOVERFLOW): Remove fallback.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Drop gl_EOVERFLOW.
	* modules/vsnprintf (Depends-on): Add EOVERFLOW.

	* lib/vfprintf.c (EOVERFLOW): Remove fallback.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Drop gl_EOVERFLOW.
	* modules/vfprintf-posix (Depends-on): Add EOVERFLOW.

	* lib/vasprintf.c (EOVERFLOW): Remove fallback.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Drop gl_EOVERFLOW.
	* modules/vasprintf (Depends-on): Add EOVERFLOW.

	* lib/vasnprintf.c (EOVERFLOW): Remove fallback.
	* m4/vasnprintf.m4 (gl_FUNC_VASNPRINTF): Drop gl_EOVERFLOW.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Drop gl_EOVERFLOW.
	* modules/vasnprintf (Files): Remove m4/eoverflow.m4.
	(Depends-on): Add EOVERFLOW.
	* modules/unistdio/ulc-vasnprintf (Files): Remove m4/eoverflow.m4.
	(Depends-on): Add EOVERFLOW.
	* modules/unistdio/u8-vasnprintf (Files): Remove m4/eoverflow.m4.
	(Depends-on): Add EOVERFLOW.
	* modules/unistdio/u8-u8-vasnprintf (Files): Remove m4/eoverflow.m4.
	(Depends-on): Add EOVERFLOW.
	* modules/unistdio/u16-vasnprintf (Files): Remove m4/eoverflow.m4.
	(Depends-on): Add EOVERFLOW.
	* modules/unistdio/u16-u16-vasnprintf (Files): Remove m4/eoverflow.m4.
	(Depends-on): Add EOVERFLOW.
	* modules/unistdio/u32-vasnprintf (Files): Remove m4/eoverflow.m4.
	(Depends-on): Add EOVERFLOW.
	* modules/unistdio/u32-u32-vasnprintf (Files): Remove m4/eoverflow.m4.
	(Depends-on): Add EOVERFLOW.

	* lib/sprintf.c (EOVERFLOW): Remove fallback.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Drop gl_EOVERFLOW.
	* modules/sprintf-posix (Depends-on): Add EOVERFLOW.

	* lib/snprintf.c (EOVERFLOW): Remove fallback.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Drop gl_EOVERFLOW.
	* modules/snprintf (Depends-on): Add EOVERFLOW.

	* lib/poll.c (EOVERFLOW): Remove fallback.
	* modules/poll (Depends-on): Add EOVERFLOW.

	* lib/getugroups.c (EOVERFLOW): Remove fallback.
	* modules/getugroups (Depends-on): Add EOVERFLOW.

	* lib/getdelim.c (EOVERFLOW): Remove fallback.
	* modules/getdelim (Depends-on): Add EOVERFLOW.

	* lib/ftell.c (EOVERFLOW): Remove fallback.
	* modules/ftell (Depends-on): Add EOVERFLOW.

	* lib/fprintf.c (EOVERFLOW): Remove fallback.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Drop gl_EOVERFLOW.
	* modules/fprintf-posix (Depends-on): Add EOVERFLOW.

	* lib/c-stack.c (EOVERFLOW): Remove unused fallback.

	* modules/EOVERFLOW-tests: New file.
	* tests/test-EOVERFLOW.c: New file.

	* modules/EOVERFLOW: New file.
	* doc/posix-headers/errno.texi: Mention EOVERFLOW portability problem.

2008-03-30  Bruno Haible  <bruno@clisp.org>

	Fix bug introduced on 2007-06-10.
	* lib/vasnprintf.c (VASNPRINTF): When performing zero-padding, use
	spaces instead of 0 digits for 's' also when ENABLE_UNISTDIO.

2008-03-30  Bruno Haible  <bruno@clisp.org>

	Improve freadseek's efficiency after ungetc.
	* lib/freadseek.c: Include freadahead.h.
	(freadptrinc): New function, extracted from freadseek.
	(freadseek): Use it in a loop. Use freadahead to determine the number
	of loop iterations.
	* modules/freadseek (Depends-on): Add freadahead.
	(configure.ac): Require AC_C_INLINE.

2008-03-30  Bruno Haible  <bruno@clisp.org>

	* lib/freadseek.c (freadseek): Don't ignore the return value of
	freadptr.

2008-03-29  Eric Blake  <ebb9@byu.net>

	Add hex float support.
	* modules/strtod (Depends-on): Add c-ctype.
	(Link): Mention POW_LIB.
	* lib/strtod.c (strtod): Recognize hex floats.  Don't allow
	whitespace between 'e' and exponent.
	* tests/test-strtod.c (main): Enable hex float tests.
	* doc/posix-functions/strtod.texi (strtod): Document what gnulib
	now provides.

	Document various strtod bugs, with some fixes.
	* doc/posix-functions/strtod.texi (strtod): Document bugs with
	"-0x", "inf", "nan", and hex constants.
	* doc/posix-functions/atof.texi (atof): Likewise.
	* modules/stdlib (Makefile.am): Support strtod.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Likewise.
	* m4/strtod.m4 (gl_FUNC_STRTOD): Fit in stdlib framework, and
	detect additional strtod bugs.
	* lib/stdlib.in.h (rpl_strtod): Add declarations.
	* lib/strtod.c (strtod): Return -0.0 on negative underflow.  Use
	bool where appropriate.  Parse 'inf' and 'nan'.
	* tests/test-strtod.c: New file.
	* modules/strtod (Depends-on): Add stdbool, stdlib.
	(configure.ac): Turn on module indicator.
	* modules/strtod-tests: New module.

2008-03-29  Eric Blake  <ebb9@byu.net>

	Fix ftell on mingw.
	* lib/ftell.c (EOVERFLOW): Define if the system lacks it.
	* modules/ftell-tests (Depends-on): Add binary-io.
	* modules/ftello-tests (Depends-on): Likewise.
	* tests/test-ftell.c (main): Enhance test to cover behavior after
	ungetc.  Enforce binary mode.
	* tests/test-ftello.c (main): Likewise.

	Pass test-freadseek on cygwin.
	* modules/freadseek (Depends-on): Use freadptr, not freadahead.
	* lib/freadseek.c (freadseek): Don't increment beyond bounds of
	ungetc buffer.

	* tests/test-fflush2.c (main): Fix typo.

2008-03-29  Bruno Haible  <bruno@clisp.org>

	* tests/test-fflush2.c (main): Temporarily disable the contents of
	this test.
	* m4/fflush.m4 (gl_FUNC_FFLUSH): Add a TODO.
	Reported by Eric Blake.

2008-03-28  Simon Josefsson  <simon@josefsson.org>

	* lib/gc.h (enum Gc_hash): Add GC_SHA224.
	(GC_SHA224_DIGEST_SIZE): Add.

	* lib/gc-libgcrypt.c (gc_hash_open): Handle SHA-224.
	(gc_hash_digest_length): Likewise.
	(gc_hash_buffer): Likewise.

2008-03-25  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (gettextize and autopoint): Explain in more
	detail which gettext release to use.
	Reported by Simon Josefsson.

2008-03-26  Jim Meyering  <meyering@redhat.com>

	gnumakefile: remove file from $(top_builddir), not from $(top_srcdir)
	* modules/gnumakefile (clean-GNUmakefile): Also, use
	test ... && ... || : syntax rather than if-then ... fi.

	gnumakefile: Don't double-quote-expand $(VPATH) value.
	* modules/gnumakefile (clean-GNUmakefile): Use single quotes.

2008-03-24  Eric Blake  <ebb9@byu.net>

	Alter GNUmakefile to install into top directory.
	* modules/maintainer-makefile: Split, and add dependency...
	* modules/gnumakefile: to this new module.
	* build-aux/GNUmakefile: Move...
	* top/GNUmakefile: ...here.
	* build-aux/maint.mk: Move...
	* top/maint.mk: ...here.
	* MODULES.html.sh (Support for maintaining...): Document new
	module.

2008-03-23  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: New options --vc-files, --no-vc-files.
	(func_usage): Document them.
	(vc_files): New variable.
	(func_import): Consider vc_files.
	(func_create_testdir): Set vc_files to empty.
	Suggested by Jim Meyering and Karl Berry.

2008-03-23  Bruno Haible  <bruno@clisp.org>

	Fix regex compilation error on HP-UX 11.
	* m4/regex.m4 (gl_PREREQ_REGEX): Require AC_TYPE_MBSTATE_T.
	* modules/regex (Files): Add m4/mbstate_t.m4.
	Reported by Ton Voon <ton.voon@altinity.com>.

2008-03-23  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (gettextize and autopoint): New section.

2008-03-23  Eric Blake  <ebb9@byu.net>
	    Bruno Haible  <bruno@clisp.org>

	Install files from top/ in the destination directory.
	* gnulib-tool (func_get_automake_snippet): Synthesize an EXTRA_DIST
	augmentation also for the files from top/.
	(func_import, func_create_testdir): Rewrite file names:
	top/filename -> filename.

2008-03-23  Bruno Haible  <bruno@clisp.org>

	Tweak "gnulib --version" output.
	* gnulib-tool (func_version): Replace "-dirty" suffix with "-modified".

2008-03-23  Bruno Haible  <bruno@clisp.org>

	Tweak "gnulib --version" output.
	* gnulib-tool (func_version): Use date of last commit to ChangeLog,
	rather than contents of ChangeLog, when possible.

2008-03-21  Eric Blake  <ebb9@byu.net>

	More --version tweaks.
	* gnulib-tool (func_version): Obey GNU Coding Standards.  Output
	date of last ChangeLog entry.

2008-03-21  Jim Meyering  <meyering@redhat.com>

	* build-aux/GNUmakefile (_have-git-version-gen): Split long line.

2008-03-20  Eric Blake  <ebb9@byu.net>

	VPATH fix.
	* build-aux/GNUmakefile (_have_git-version-gen): Look in correct dir.

2008-03-20  Simon Josefsson  <simon@josefsson.org>

	* build-aux/GNUmakefile: Make git-version-gen optional.  Add
	_build-aux variable.  Suggested by Eric Blake <ebb9@byu.net>.

2008-03-20  Eric Blake  <ebb9@byu.net>

	Sync GNUmakefile with coreutils.
	* build-aux/GNUmakefile (have-Makefile): Rename...
	(_have-Makefile): ...to this, for namespace consideration.
	(GNUmakefile.cfg): Include, if present.
	(_autoreconf): Define a default.
	(_is-dist-target): New rule for rebuilds to pick up intra-release
	version.
	(maint-cfg.mk): Rename...
	(cfg.mk): ...to this.

2008-03-18  Jim Meyering  <meyering@redhat.com>

	New script and module: mktempd
	* MODULES.html.sh (maint+release support): Add mktempd.
	* build-aux/mktempd: New file.
	* modules/mktempd: New file.

2008-03-15  Jim Meyering  <meyering@redhat.com>

	Undo last change.
	* lib/sha1.c, lib/md5.c: 63 != ~63.
	Reported by Andreas Schwab.

	sha1.c, md5.c: Hoist a redundant expression.
	* lib/sha1.c (sha1_process_bytes): AND-off the low bits in
	"ctx->buflen" only once, before calling *_process_block.
	* lib/md5.c (md5_process_bytes): Likewise.

2008-03-14  Eric Blake  <ebb9@byu.net>

	Bump copyright year in files generated by gnulib-tool.
	* gnulib-tool (func_emit_copyright_notice): Extract copyright from
	gnulib-tool, rather than hard-coding it.

	Fix 'gnulib-tool --version' output to work with git.
	* gnulib-tool (func_gnulib_dir): New function, extracted from...
	(startup): ...here.
	(func_version): Use it to invoke git-version-gen, rather than
	relying on CVS keyword expansion.  Modernize wording.
	(cvsdatestamp, last_checkin_date, version): Kill unused
	variables.

2008-03-12  Jim Meyering  <meyering@redhat.com>

	Recognize optional cast of the argument to free.
	* build-aux/useless-if-before-free: Update regexps.

	* build-aux/bootstrap (gnulib_tool): Remove trailing blanks.

2008-03-11  Bruno Haible  <bruno@clisp.org>

	Extend AC_LIB_LINKFLAGS to the situation of several libraries provided
	by a single package.
	* m4/lib-link.m4 (AC_LIB_FROMPACKAGE): New macro.
	(AC_LIB_LINKFLAGS_BODY): Use the information stored by
	AC_LIB_FROMPACKAGE. Use AC_ARG_WITH instead of AC_LIB_ARG_WITH.
	Reported by Sam Steingold <sds@gnu.org>.

2008-03-12  Sergey Poznyakoff  <gray@gnu.org.ua>

	* build-aux/bootstrap (version_controlled_file): Adapt for SVN
	repositories.

2008-03-11  Bruno Haible  <bruno@clisp.org>

	Avoid conflicts between local macro definitions.
	* m4/lib-link.m4 (AC_LIB_LINKFLAGS, AC_LIB_HAVE_LINKFLAGS,
	AC_LIB_LINKFLAGS_BODY): Use pushdef/popdef instead of define/undefine.

2008-03-10  Peter O'Gorman  <bug-gnulib@mlists.thewrittenword.com>
	    Bruno Haible  <bruno@clisp.org>

	Make va_copy work with some version of xlc on AIX 5.1.
	* lib/stdarg.in.h: New file.
	* m4/stdarg.m4 (gl_STDARG_H): Initialize STDARG_H and NEXT_STDARG_H.
	On AIX, use a <stdarg.h> file substitute.
	* modules/stdarg (Files): Add lib/stdarg.in.h.
	(Depends-on): Add include_next.
	(Makefile.am): Build a stdarg.h substitute if requested.
	* doc/posix-functions/va_copy.texi: Document the platforms lacking it.

2008-03-10  Bruno Haible  <bruno@clisp.org>

	* m4/include_next.m4 (gl_CHECK_NEXT_HEADERS): Document a restriction.
	* m4/absolute-header.m4 (gl_ABSOLUTE_HEADER): Likewise.
	Reported by Peter O'Gorman <bug-gnulib@mlists.thewrittenword.com>.

2008-03-10  Bruno Haible  <bruno@clisp.org>

	* modules/stdlib (Depends-on): Add include_next, remove
	absolute-header.

2008-03-09  Bruno Haible  <bruno@clisp.org>

	* lib/freadahead.h (freadahead): Document more precisely.
	* lib/freadahead.c (freadahead): When an ungetc is in effect, return
	the sum of both buffer sizes.
	* tests/test-freadahead.c (main): Also test behaviour after ungetc.
	* NEWS: Document the change.

2008-03-09  Bruno Haible  <bruno@clisp.org>

	Extend freadptr to return also the buffer size.
	* lib/freadptr.h (freadptr): Add sizep argument.
	* lib/freadptr.c: Include freadptr.h, not freadahead.h.
	(freadptr): Add sizep argument. Determine buffer size like freadahead
	does.
	* tests/test-freadptr.c: Don't include freadahead.h.
	(main): Adapt for new calling convention of freadptr.
	* tests/test-freadptr2.c: New file, based on tests/test-freadahead.c.
	* tests/test-freadptr2.sh: New file, based on tests/test-freadahead.sh.
	* modules/freadptr-tests (Files): Add tests/test-freadptr2.c,
	tests/test-freadptr2.sh.
	(Depends): Remove freadahead.
	(TESTS): Add test-freadptr2.sh.
	(check_PROGRAMS): Add test-freadptr2.

2008-03-09  Bruno Haible  <bruno@clisp.org>

	* doc/Makefile (%.pdf): Explain how to remedy the save_size error.
	Report and solution by Simon Josefsson.

2008-03-06  Bruno Haible  <bruno@clisp.org>

	Make fflush after ungetc work on BSD platforms.
	* lib/fflush.c (rpl_fflush): Discard ungetc buffer if possible.
	* tests/test-fflush2.c: New file.
	* tests/test-fflush2.sh: New file.
	* modules/fflush-tests (Files): Add tests/test-fflush2.sh,
	tests/test-fflush2.c.
	(Makefile.am): Build test-fflush2 and run test-fflush2.sh.
	* doc/posix-functions/fflush.texi: Document fflush after ungetc bug.

2008-03-06  Eric Blake  <ebb9@byu.net>

	Likewise for ftello.
	* modules/ftello (Dependencies): Add extensions.
	* m4/ftello.m4 (gl_FUNC_FTELLO): Require AC_USE_SYSTEM_EXTENSIONS.

2008-03-06  Bruno Haible  <bruno@clisp.org>

	* modules/fseeko (Dependencies): Add extensions.
	* m4/fseeko.m4 (gl_FUNC_FSEEKO): Require AC_USE_SYSTEM_EXTENSIONS.
	Needed on glibc systems.

2008-03-06  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (@nosuchmodulenote): Avoid line break inside
	email address.
	Reported by Thien-Thi Nguyen <ttn@gnuvola.org>.

2008-03-06  Bruno Haible  <bruno@clisp.org>

	* users.txt: Add libgnupdf.

2008-03-06  Thien-Thi Nguyen  <ttn@gnuvola.org>  (tiny change)

	* doc/gnulib-tool.texi (@nosuchmodulenote): New macro.
	(Header File Substitutes, Function Substitutes,
	Glibc Header File Substitutes, Glibc Function Substitutes): Use it.
	(Build robot for gnulib): Fix typo.

2008-03-06  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (VCS Issues): Small updates.
	Reported by Thien-Thi Nguyen <ttn@gnuvola.org>.

2008-03-06  Bruno Haible  <bruno@clisp.org>

	* doc/func.texi: New file, extracted from doc/gnulib.texi.
	* doc/gnulib.texi: Include it.

2008-03-06  Simon Josefsson  <simon@josefsson.org>

	* modules/func (License): Change license to unlimited; there was
	no LGPL parts in the module anyway.

2008-03-06  Simon Josefsson  <simon@josefsson.org>

	* modules/__func__: Renamed to modules/func.
	* modules/__func__-tests: Renamed to modules/func-tests.
	* tests/test-__func__.c: Renamed to tests/test-func.c.
	* m4/__func__.m4: Renamed to m4/func.m4.
	* doc/gnulib.texi (__func__): Section renamed to func.
	Suggested by Eric Blake <ebb9@byu.net>.

2008-03-06  Simon Josefsson  <simon@josefsson.org>

	* doc/gnulib.texi (__func__): Use C99 terminology when talking
	about __func__.  Make example self-contained.  Suggested by Eric
	Blake <ebb9@byu.net>.

	* tests/test-__func__.c (main): Avoid extraneous () around __func.
	Suggested by Eric Blake <ebb9@byu.net>.

2008-03-06  Simon Josefsson  <simon@josefsson.org>

	* modules/__func__: New file.
	* modules/__func__-tests: New file.
	* tests/test-__func__.c: New file.
	* m4/__func__.m4: New file.
	* doc/gnulib.texi (__func__): Document __func__ module.

2008-03-05  Simon Josefsson  <simon@josefsson.org>

	* modules/byteswap (License): Re-license as LGPLv2+.

2008-03-05  Simon Josefsson  <simon@josefsson.org>

	* doc/Makefile: Add pdf target.

2008-03-05  Simon Josefsson  <simon@josefsson.org>

	* modules/inline (License): Use 'unlimited', since there are only
	*.m4 files in this module.

2008-03-03  John E. Malmberg  <wb8tyw@qsl.net>  (tiny change)
	    Bruno Haible  <bruno@clisp.org>

	Add support for HP C 7.1 on OpenVMS 8.3.
	* lib/alloca.in.h (alloca): Define as alias for DEC C on VMS.

2008-03-03  John E. Malmberg  <wb8tyw@qsl.net>  (tiny change)

	Update VMS specifics.
	* lib/getopt.c [VMS]: Remove include of unixlib.h.

2008-03-02  Jim Meyering  <meyering@redhat.com>

	Remove the last dependency on the "free" module.
	* m4/readutmp.m4 (gl_READUTMP): Don't require gl_FUNC_FREE.
	Reported by Bob Proulx.

	* lib/getdelim.c (getdelim): Don't leak memory upon failed realloc.

	Remove useless "if" tests before free.  Deprecate "free" module.
	* doc/posix-functions/free.texi: Mention that this
	module is no longer useful.
	* modules/free (Notice): Say this module is obsolete.
	* modules/readutmp (Depends-on): Remove free.
	* lib/save-cwd.c (free_cwd): Remove useless "if" before free.
	* lib/putenv.c (putenv): Likewise.
	* lib/gc-gnulib.c (gc_cipher_close): Likewise.
	* lib/getaddrinfo.c (freeaddrinfo): Likewise.
	* tests/test-c-strcasestr.c (main): Likewise.
	* tests/test-c-strstr.c (main): Likewise.
	* tests/test-mbscasestr1.c (main): Likewise.
	* tests/test-mbscasestr2.c (main): Likewise.
	* tests/test-mbsstr1.c (main): Likewise.
	* tests/test-mbsstr2.c (main): Likewise.
	* tests/test-memmem.c (main): Likewise.
	* tests/test-strcasestr.c (main): Likewise.
	* tests/test-striconv.c (main): Likewise.
	* tests/test-striconveh.c (main): Likewise.
	* tests/test-striconveha.c (main): Likewise.
	* tests/test-strstr.c (main): Likewise.

	* build-aux/git-version-gen: Adjust a comment and the Usage string.

	bootstrap: sync from coreutils again
	* build-aux/bootstrap: Remove dangling m4/*.m4 symlinks.

2008-03-01  Jim Meyering  <meyering@redhat.com>

	bootstrap: sync from coreutils
	* build-aux/bootstrap (update_po_files): Copy a .po file into place
	also when the target doesn't exist.

2008-03-01  Eric Blake  <ebb9@byu.net>

	Fix bugs in last patch.
	* lib/memchr2.c (memchr2): Fix typo.
	* tests/test-memchr2.c: Test previous bug, and don't use GNU
	extension.
	Reported by Bruce Korb.

	New module 'memchr2'.
	* modules/memchr2: New file.
	* modules/memchr2-tests: Likewise.
	* lib/memchr2.h: Likewise.
	* lib/memchr2.c: Likewise, based on memchr.c.
	* tests/test-memchr2.c: New test.
	* MODULES.html.sh (String handling): Add memchr2.

2008-02-29  Bruno Haible  <bruno@clisp.org>

	* modules/freadseek-tests: New file.
	* tests/test-freadseek.sh: New file.
	* tests/test-freadseek.c: New file.

	New module 'freadseek'.
	* modules/freadseek: New file.
	* lib/freadseek.h: New file.
	* lib/freadseek.c: New file.
	* MODULES.html.sh (File stream based Input/Output): Add freadseek.

2008-02-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* users.txt: Add anubis, cpio, mailfromd, mailutils, radius,
	wydawca.

	* m4/argp.m4 (gl_ARGP): Use AC_TRY_LINK to test if
	program_invocation_name and program_invocation_short_name are
	present.

2008-02-28  Bruno Haible  <bruno@clisp.org>

	* tests/test-freadptr.c: Add a test for behaviour after ungetc.
	* tests/test-freadptr.sh: Also test non-seekable stdin.

2008-02-28  Sergey Poznyakoff  <gray@gnu.org.ua>

	* build-aux/bootstrap (source_base, m4_base)
	(doc_base, tests_base): New variables.
	(gnulib_tool_options): Do not hardcode base directories, use
	the above variables instead.

2008-02-28  Atsushi SAKAI  <sakaia@jp.fujitsu.com>

	* lib/xsize.h: Fix typo in comment: s/tupe/type/.

2008-02-28  Bruno Haible  <bruno@clisp.org>

	* modules/freadptr-tests: New file.
	* tests/test-freadptr.sh: New file.
	* tests/test-freadptr.c: New file.

	New module 'freadptr'.
	* modules/freadptr: New file.
	* lib/freadptr.h: New file.
	* lib/freadptr.c: New file.
	* MODULES.html.sh (File stream based Input/Output): Add freadptr.

2008-02-26  Karl Berry  <karl@freefriends.org>

	Sync from Libtool:
	* libltdl/argz.c (argz_add, argz_count): New functions.
	* libltdl/argz.in.h: Declare them.
	Report by Juan Manuel Guerrero <juan.guerrero@gmx.de>.

2008-02-22  Bruno Haible  <bruno@clisp.org>

	* m4/time_r.m4 (gl_TIME_R): Also check that localtime_r's return type
	is a pointer type.  Needed for HP-UX 10.
	* doc/posix-functions/localtime_r.texi: Mention HP-UX 10.
	* doc/posix-functions/gmtime_r.texi: Likewise.
	Reported by Peter O'Gorman <bug-gnulib@mlists.thewrittenword.com>.

2008-02-24  Bruno Haible  <bruno@clisp.org>

	* modules/environ-tests: New file.
	* tests/test-environ.c: New file.

	New module 'environ'.
	* modules/environ: New file.
	* lib/unistd.in.h (environ): New declaration.
	* m4/environ.m4: New file.
	(gt_CHECK_VAR_DECL): Moved here from m4/setenv.m4. Undefine gt_cv_var
	after use.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize GNULIB_ENVIRON and
	HAVE_DECL_ENVIRON.
	* modules/unistd (Makefile.am): Substitute also GNULIB_ENVIRON and
	HAVE_DECL_ENVIRON.
	* doc/posix-functions/environ.texi: Mention module 'environ'. Remove
	wrong claim that 'environ' is missing on some systems.
	* modules/execute (Depends-on): Add environ.
	* lib/execute.c (environ): Remove fallback declaration.
	* modules/pipe (Depends-on): Add environ.
	* lib/pipe.c (environ): Remove fallback declaration.
	* modules/setenv (Depends-on): Add environ.
	* lib/setenv.c (environ): Remove fallback declaration.
	* modules/unsetenv (Depends-on): Add environ.
	* lib/unsetenv.c (environ): Remove fallback declaration.
	* m4/setenv.m4 (gt_CHECK_VAR_DECL): Remove macro. Moved to
	m4/environ.m4.
	(gl_PREREQ_SETENV): Require gl_ENVIRON instead of testing for environ.
	(gl_PREREQ_UNSETENV): Likewise.

2008-02-24  Bruno Haible  <bruno@clisp.org>

	* doc/posix-functions/environ.texi: Document the MacOS X problem.

2008-02-20  Bob Proulx  <bob@proulx.com>

	Enable use of older two part flavor 'git describe'.
	* build-aux/git-version-gen: If using the older two part flavor of
	git version then recreate the third part now present in the
	newer three part flavor of git describe.

2008-02-20  Martin Buchholz  <martin@xemacs.org>  (tiny change)

	* lib/fts.c (fts_build): Typo correction to comment.

2008-02-17  Bruno Haible  <bruno@clisp.org>

	* lib/git-merge-changelog.c (main) [split_merged_entry]: Avoid
	generating no-op conflicts.

2008-02-17  Bruno Haible  <bruno@clisp.org>

	Speed up by 10%.
	* lib/git-merge-changelog.c (main): Use the iterator to iterate through
	result_entries, rather than an index-based loop.

2008-02-17  Bruno Haible  <bruno@clisp.org>

	Speed up by 25%.
	* lib/git-merge-changelog.c (struct entry): New fields 'hashcode',
	'hashcode_cached'.
	(entry_create): New function.
	(entry_hashcode): Use the cached hashcode if possible.
	(read_changelog_file, try_split_merged_entry): Use entry_create.

2008-02-17  Bruno Haible  <bruno@clisp.org>

	Speed up from O(n^2) to O(n) for long ChangeLog files.
	* lib/git-merge-changelog.c: Include gl_rbtreehash_list.h.
	(read_changelog_file): Change implementation of entries_reversed list
	to rbtreehash.
	* modules/git-merge-changelog (Depends-on): Add rbtreehash-list.

2008-02-17  Bruno Haible  <bruno@clisp.org>

	New option --split-merged-entry.
	* lib/git-merge-changelog.c (FSTRCMP_STRICTER_THRESHOLD): New macro.
	(find_paragraph_end, try_split_merged_entry): New functions.
	(long_options): Add option --split-merged-entry.
	(usage): Document option --split-merged-entry.
	(main): Implement option --split-merged-entry.
	Reported by Eric Blake.

2008-02-17  Bruno Haible  <bruno@clisp.org>

	* lib/git-merge-changelog.c: Include c-strstr.h.
	(main): Support the "git pull --rebase" situation.
	* modules/git-merge-changelog (Depends-on): Add c-strstr.
	Reported by Eric Blake.

2008-02-16  Eric Blake  <ebb9@byu.net>

	Avoid doubling \ in common case of "c-maybe" quoting style.
	* lib/quotearg.c (quotearg_buffer_restyled): Don't escape \ when
	eliding outer quotes.
	* lib/quotearg.h: Document this.
	* tests/test-quotearg.c (result_strings, inputs, results_g)
	(flag_results, locale_results): Test it by adding a new string to
	each test group.
	(compare_strings): Test new string.

2008-02-13  Eric Blake  <ebb9@byu.net>

	Avoid trigraph quoting in default output.
	* lib/quotearg.h (enum quoting_flags): Add QA_SPLIT_TRIGRAPHS.
	* lib/quotearg.c (quotearg_buffer_restyled): Don't quote trigraphs
	unless explicitly requested.
	* tests/test-quotearg.c (flag_results, main): Add additional tests.

2008-02-13  Lasse Collin  <lasse.collin@tukaani.org>

	Don't rely on signed integer overflowing to negative value.
	* lib/getugroups.c (getugroups): Include <limits.h>.
	Instead, compare against INT_MAX, and increment only if the test passes.

2008-02-13  Jim Meyering  <meyering@redhat.com>
	and Eric Blake  <ebb9@byu.net>

	Avoid shadowing warning and compile errors on Linux.
	* tests/test-quotearg.c [ENABLE_NLS]: Disable <libintl.h>
	forwarding macros on Linux.
	(dcgettext): Define a stub, for Linux.
	(results_g, main): Avoid warnings.

2008-02-12  Eric Blake  <ebb9@byu.net>

	Silence warning in last patch.
	* lib/quotearg.c (quotearg_buffer_restyled): Add missing const.

	Quotearg part 4: add tests, fix c-maybe colon quoting.
	* lib/quotearg.h: Improve documentation.
	* lib/quotearg.c (quotearg_buffer_restyled): Don't add extra
	escapes when adding outer quotes.  When quoting trigraphs, use
	valid C notation.  When quoting NUL, omit extra characters if next
	character is not digit.  Alter prototype.
	(quotearg_buffer, quotearg_alloc_mem, quotearg_n_options): Adjust
	callers.
	* modules/quotearg-tests: New module.
	* tests/test-quotearg.c: New test.

2008-02-07  Eric Blake  <ebb9@byu.net>

	Quotearg part 3: add flag to control outer quote elision.
	* lib/quotearg.h (c_maybe_quoting_style): New style.
	(enum quoting_flags): Better documentation of flags.
	* lib/quotearg.c (quoting_style_args, quoting_style_vals): Add
	c-maybe style.
	(quotearg_buffer_restyled): Handle new flag to elide outer
	quotes.

	Quotearg part 2: add flag that can control NUL elision.
	* lib/quotearg.h (set_quoting_flags): New prototype.
	* lib/quotearg.c (struct quoting_options): Add flag field.
	(set_quoting_flags): New function.
	(quotearg_buffer_restyled): Add flags parameter.
	(quotearg_alloc_mem): Set the flag if length cannot be returned.
	(quotearg_n_options): Set the flag, since length cannot be
	returned.
	(quoting_options_from_style): Default flags correctly.

	Quotearg part 1: more wrappers, restore quotearg_char state.
	* lib/quotearg.h (quotearg_alloc_mem, quotearg_n_mem)
	(quotearg_mem, quotearg_style_mem, quotearg_char_mem)
	(quotearg_colon_mem): New wrappers.
	* lib/quotearg.c (quotearg_alloc, quotearg_char): Rewrite...
	(quotearg_alloc_mem, quotearg_char_mem): ...in terms of these new
	functions.
	(quotearg_n_mem, quotearg_mem, quotearg_style_mem)
	(quotearg_colon_mem): New functions.

2008-02-11  Bruno Haible  <bruno@clisp.org>

	* modules/git-merge-changelog (Makefile.am): Don't use -L and -l for a
	library in the current directory: it does not work with parallel make.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2008-02-11  Bruno Haible  <bruno@clisp.org>

	* .gitattributes: New file.

2008-02-11  Jim Meyering  <meyering@redhat.com>

	useless-if-before-free: Fix reversed exit values.
	* build-aux/useless-if-before-free: Use correct values
	for EXIT_MATCH and EXIT_NO_MATCH.

	* build-aux/useless-if-before-free: Close stdout carefully.

2008-02-10  Bruno Haible  <bruno@clisp.org>

	New module 'git-merge-changelog'.
	* modules/git-merge-changelog: New file.
	* lib/git-merge-changelog.c: New file.

2008-02-10  Jim Meyering  <meyering@redhat.com>

	useless-if-before-free: New option: --list (-l).

	useless-if-before-free: Don't exit immediately upon open failure.
	* build-aux/useless-if-before-free: Exit 2 for errors.
	Upon failure to open a file, don't exit immediately.
	Rather, just warn and continue with any remaining files.

2008-02-10  Bruno Haible  <bruno@clisp.org>

	New abstract list operation 'node_set_value'.
	* lib/gl_list.h (gl_list_node_set_value): New function.
	(struct gl_list_implementation): New field node_set_value.
	* lib/gl_list.c (gl_list_node_set_value): New function.
	* lib/gl_array_list.c (gl_array_node_set_value): New function.
	(gl_array_list_implementation): Update.
	* lib/gl_carray_list.c (gl_carray_node_set_value): New function.
	(gl_carray_list_implementation): Update.
	* lib/gl_anylinked_list2.h (gl_linked_node_set_value): New function.
	* lib/gl_linked_list.c (gl_linked_list_implementation): Update.
	* lib/gl_linkedhash_list.c (gl_linkedhash_list_implementation): Update.
	* lib/gl_anytree_list2.h (gl_tree_node_set_value): New function.
	* lib/gl_avltree_list.c (gl_avltree_list_implementation): Update.
	* lib/gl_rbtree_list.c (gl_rbtree_list_implementation): Update.
	* lib/gl_avltreehash_list.c (gl_avltreehash_list_implementation):
	Update.
	* lib/gl_rbtreehash_list.c (gl_rbtreehash_list_implementation): Update.
	* lib/gl_sublist.c (gl_sublist_node_set_value): New function.
	(gl_sublist_list_implementation): Update.

2008-02-10  Bruno Haible  <bruno@clisp.org>

	* lib/diffseq.h: Write "ELEMENT const" instead of "const ELEMENT".
	Needed when ELEMENT is #defined to 'some_type *'.

2008-02-10  Jim Meyering  <meyering@redhat.com>

	New script and module: useless-if-before-free
	* MODULES.html.sh (maint+release support): Add useless-if-before-free.
	* build-aux/useless-if-before-free: New file.
	* modules/useless-if-before-free: New file.

	* build-aux/gitlog-to-changelog: Use committer date, not author date.

	xstrtol_error: Fix typo.
	* lib/xstrtol-error.c (xstrtol_error): The parameter was unused:
	s/exit_failure/exit_status/.

2008-02-09  Jim Meyering  <meyering@redhat.com>

	New script and module: gitlog-to-changelog
	* MODULES.html.sh (maint+release support): Add gitlog-to-changelog.
	* modules/gitlog-to-changelog: New file.
	* build-aux/gitlog-to-changelog: New file.

2008-02-08  Jim Meyering  <meyering@redhat.com>

	Avoid two "parameter unused" warnings.
	* lib/stat-time.h (get_stat_birthtime_ns, get_stat_birthtime):
	Mark "st" as used.

	Use "git COMMAND", not "git-COMMAND".
	* build-aux/bootstrap (version_controlled_file): s/git-rm/git-rm/.
	* build-aux/announce-gen (get_tool_versions): Correct a diagnostic.
	* build-aux/git-version-gen: Use "git status", not "git-status".

2008-02-07  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Don't use %n on native Woe32 systems.
	Avoids a crash on Windows Vista.
	Reported by Adam Strzelecki <ono@java.pl> via
	Simon Josefsson <simon@josefsson.org>.

2008-02-06  Bruno Haible  <bruno@clisp.org>

	Fix *printf behaviour regarding the left-adjust flag on HP-UX 10.20.
	* m4/printf.m4 (gl_PRINTF_FLAG_LEFTADJUST): New macro.
	* lib/vasnprintf.c (VASNPRINTF): Handle NEED_PRINTF_FLAG_LEFTADJUST.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_FLAG_LEFTADJUST): New macro.
	(gl_PREREQ_VASNPRINTF_WITH_EXTRAS): Invoke it.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Invoke
	gl_PRINTF_FLAG_LEFTADJUST and test its result. Invoke
	gl_PREREQ_VASNPRINTF_FLAG_LEFTADJUST.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Likewise.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	* tests/test-vasnprintf-posix.c (test_function): Add testcases for the
	left-adjust flag.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* doc/posix-functions/fprintf.texi: Update.
	* doc/posix-functions/printf.texi: Update.
	* doc/posix-functions/snprintf.texi: Update.
	* doc/posix-functions/sprintf.texi: Update.
	* doc/posix-functions/vfprintf.texi: Update.
	* doc/posix-functions/vprintf.texi: Update.
	* doc/posix-functions/vsnprintf.texi: Update.
	* doc/posix-functions/vsprintf.texi: Update.
	Reported by Peter Fales <psfales@alcatel-lucent.com>.

2008-02-06  Bruno Haible  <bruno@clisp.org>

	Fix bug introduced on 2008-01-26.
	* lib/isnan.c (FUNC): Set to rpl_isnand, not rpl_isnan.

2008-02-06  Bruno Haible  <bruno@clisp.org>

	Fix bug introduced on 2007-06-10.
	* lib/vasnprintf.c (VASNPRINTF): Perform zero-padding also if
	!NEED_PRINTF_FLAG_ZERO.

2008-02-05  Peter O'Gorman <pogma@thewrittenword.com>

	getloadavg: use libperfstat on AIX5
	* lib/getloadavg.c, m4/getloadavg.m4 [aix]: Use libperfstat

2008-02-03  Bruno Haible  <bruno@clisp.org>

	* lib/diffseq.h: Add comments about required #includes.
	Reported by Michael Biggs <gnulib@doubleplum.net>.

2008-02-01  Bruno Haible  <bruno@clisp.org>

	* users.txt: Add gnuit.

2008-01-31  Bruno Haible  <bruno@clisp.org>

	* lib/md4.c (set_uint32): Mark as inline.
	* lib/md5.c (set_uint32): Likewise.
	* lib/sha1.c (set_uint32): Likewise.
	* m4/md4.m4 (gl_MD4): Require AC_C_INLINE.
	* m4/md5.m4 (gl_MD5): Likewise.
	* m4/sha1.m4 (gl_SHA1): Likewise.

2008-01-31  Jim Meyering  <meyering@redhat.com>

	Use "sizeof VAR", rather than a literal "4".
	* lib/md5.c (md5_read_ctx): Use sizeof ctx->A, not 4.
	* lib/md4.c (md4_read_ctx): Likewise.
	* lib/sha1.c (sha1_read_ctx): Likewise.

2008-01-31  Simon Josefsson  <simon@josefsson.org>

	* tests/test-sha1.c: New file, based on test-md5.c.

	* modules/crypto/sha1-tests: New file.

2008-01-31  Simon Josefsson  <simon@josefsson.org>

	* lib/sha1.h (SHA1_DIGEST_SIZE): Define.

2008-01-31  Jim Meyering  <meyering@redhat.com>

	Prefer "sizeof v" over the equivalent "4".
	* lib/md4.c (set_uint32): Use "sizeof v" as memcpy length, not 4.
	* lib/md5.c (set_uint32): Likewise.
	* lib/sha1.c (set_uint32): Likewise.

2008-01-31  Simon Josefsson  <simon@josefsson.org>

	* lib/sha1.c (set_uint32): Mark function as static.

2008-01-31  Simon Josefsson  <simon@josefsson.org>

	md2: clarify comments to say that alignment is not required.
	* lib/md2.h: Remove warning about alignment in comment.
	* lib/md2.c (md2_read_ctx, md2_finish_ctx): Doc fix, alignment has
	never been required.

2008-01-31  Simon Josefsson  <simon@josefsson.org>

	md4: adapt alignment constraint fix from sha1.
	* lib/md4.c (set_uint32): New function, from sha1.c
	(md4_read_ctx): Use it.
	(md4_finish_ctx): Doc fix.
	* lib/md4.h: Doc fix.

2008-01-31  Simon Josefsson  <simon@josefsson.org>

	md5: adapt alignment constraint fix from sha1.
	* lib/md5.c (set_uint32): New function, from sha1.c
	(md5_read_ctx): Use it.
	(md5_finish_ctx): Doc fix.
	* lib/md5.h: Doc fix.

2008-01-30  Peter Palfrader  <weasel@debian.org>

	sha1: remove the result buffer alignment constraint
	* lib/sha1.c (set_uint32): New function.
	(sha1_read_ctx): Rewrite to remove the result buffer alignment
	constraint.
	(sha1_finish_ctx): Remove comment warning about alignment constraint.
	* lib/sha1.h: Likewise.

2008-01-30  Andreas Schwab  <schwab@suse.de>
	    Bruno Haible  <bruno@clisp.org>

	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): Include <float.h> and ensure a
	correct definition of LDBL_MIN_EXP.

2008-01-30  Karl Berry  <karl@gnu.org>

	* config/srclist-update: try to preserve x bit on updates.
	* config/srclistvars.sh: update for karl.

2008-01-29  Jim Meyering  <meyering@redhat.com>

	vasnprintf.c: Avoid warning about unused label
	* lib/vasnprintf.c (VASNPRINTF) [!USE_SNPRINTF]: Guard the
	"overflow" label definition and associated code with the
	same cpp condition that guards the sole use of that label.

2008-01-26  Bruno Haible  <bruno@clisp.org>

	* m4/isnanl.m4 (gl_HAVE_ISNANL_NO_LIBM, gl_HAVE_ISNANL_IN_LIBM,
	gl_FUNC_ISNANL_WORKS): Test the GCC >= 4.0 built-in.
	* lib/isnanl.h (isnanl): Use the GCC >= 4.0 built-in.
	* lib/isnanl-nolibm.h (isnanl): Likewise.
	Reported by Paul Eggert <eggert@cs.ucla.edu>.

2008-01-26  Bruno Haible  <bruno@clisp.org>

	* m4/isnand.m4 (gl_FUNC_ISNAND_NO_LIBM): Test the GCC >= 4.0 built-in.
	* lib/isnand.h (isnand): Use the GCC >= 4.0 built-in.

2008-01-26  Bruno Haible  <bruno@clisp.org>

	* m4/isnanf.m4 (gl_HAVE_ISNANF_NO_LIBM, gl_ISNANF_WORKS): Test the
	GCC >= 4.0 built-in.
	* lib/isnanf.h (isnanf): Use the GCC >= 4.0 built-in.

2008-01-26  Bruno Haible  <bruno@clisp.org>

	Rename isnan, applicable to 'double' only, to isnand.
	* modules/isnand-nolibm: Renamed from modules/isnan-nolibm.
	(Files): Add lib/isnand.h, lib/isnand.c. Remove lib/isnan.h.
	(configure.ac): Update.
	(Include): Replace "isnan.h" with "isnand.h".
	* m4/isnand.m4: Renamed from m4/isnan.m4.
	(gl_FUNC_ISNAND_NO_LIBM): Renamed from gl_FUNC_ISNAN_NO_LIBM. Set
	HAVE_ISNAND_IN_LIBC instead of HAVE_ISNAN_IN_LIBC. Build isnand.c
	instead of isnan.c.
	* lib/isnand.h: Renamed from lib/isnan.h. Test HAVE_ISNAND_IN_LIBC
	instead of HAVE_ISNAN_IN_LIBC.
	(isnand): Renamed from isnan.
	* lib/isnand.c: New file.
	* modules/isnand-nolibm-tests: Renamed from modules/isnan-nolibm-tests.
	(Files): Add tests/test-isnand.c. Remove tests/test-isnan.c.
	(Makefile.am): Update.
	* tests/test-isnand.c: Renamed from tests/test-isnan.c.
	Include isnand.h instead of isnan.h.
	(main): Test isnand instead of isnan.
	* modules/fprintf-posix (Depends-on): Add isnand-nolibm, remove
	isnan-nolibm.
	* modules/frexp (Depends-on): Likewise.
	* modules/frexp-tests (Depends-on): Likewise.
	* modules/frexp-nolibm (Depends-on): Likewise.
	* modules/frexp-nolibm-tests (Depends-on): Likewise.
	* modules/isfinite (Depends-on): Likewise.
	* modules/round-tests (Depends-on): Likewise.
	* modules/signbit (Depends-on): Likewise.
	* modules/signbit-tests (Depends-on): Likewise.
	* modules/snprintf-posix (Depends-on): Likewise.
	* modules/sprintf-posix (Depends-on): Likewise.
	* modules/trunc-tests (Depends-on): Likewise.
	* modules/unistdio/u8-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u8-u8-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u16-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u16-u16-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u32-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u32-u32-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/ulc-vasnprintf (Depends-on): Likewise.
	* modules/vasnprintf-posix (Depends-on): Likewise.
	* modules/vasprintf-posix (Depends-on): Likewise.
	* modules/vfprintf-posix (Depends-on): Likewise.
	* modules/vsnprintf-posix (Depends-on): Likewise.
	* modules/vsprintf-posix (Depends-on): Likewise.
	* lib/frexp.c: Include isnand.h instead of isnan.h.
	(ISNAN): Set to isnand instead of isnan.
	* lib/isfinite.c: Include isnand.h instead of isnan.h.
	(gl_isfinited): Use isnand instead of isnan.
	* lib/signbitd.c: Include isnand.h instead of isnan.h.
	(gl_signbitd): Use isnand instead of isnan.
	* lib/vasnprintf.c: Include isnand.h instead of isnan.h.
	(is_infinite_or_zero, VASNPRINTF): Use isnand instead of isnan.
	* tests/test-frexp.c: Include isnand.h instead of isnan.h.
	(main): Use isnand instead of isnan.
	* tests/test-round1.c: Include isnand.h.
	(main): Use isnand instead of isnan.
	* tests/test-round2.c: Include isnand.h instead of isnan.h.
	(ISNAN): Set to isnand instead of isnan.
	* tests/test-trunc1.c: Include isnand.h.
	(main): Use isnand instead of isnan.
	* tests/test-trunc2.c: Include isnand.h instead of isnan.h.
	(equal): Use isnand instead of isnan.
	* MODULES.html.sh (Mathematics <math.h>): Replace isnan-nolibm with
	isnand-nolibm.
	* NEWS: Mention the change.

2008-01-25  Paul Eggert  <eggert@cs.ucla.edu>
	    Bruno Haible  <bruno@clisp.org>

	* m4/signbit.m4 (gl_SIGNBIT): Require a macro definition. Test whether
	the GCC builtins for signbits are present and set
	REPLACE_SIGNBIT_USING_GCC if so.
	* lib/math.in.h (signbit): Define using GCC builtins if
	REPLACE_SIGNBIT_USING_GCC is set.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize
	REPLACE_SIGNBIT_USING_GCC.
	* modules/math (Makefile.am): Substitute REPLACE_SIGNBIT_USING_GCC.

2008-01-25  Jim Meyering  <meyering@redhat.com>

	Prefer <config.h> over "config.h".  See autoconf doc for explanation.
	* lib/poll.c: Include <config.h>, not "config.h".
	* tests/test-getaddrinfo.c: Likewise.

2008-01-25  Simon Josefsson  <simon@josefsson.org>

	* modules/sockets-tests: New file.

2008-01-24  Simon Josefsson  <simon@josefsson.org>

	* modules/sockets: New module, can be used to call WSA_Startup and
	WSA_Cleanup when needed.

	* lib/sockets.h, lib/sockets.c: New files.

	* m4/sockets.m4: New file.

	* tests/test-sockets.c: New file.

2008-01-19  Bruno Haible  <bruno@clisp.org>

	* doc/posix-headers: Renamed from doc/headers.
	* doc/posix-functions: Renamed from doc/functions.
	* doc/gnulib.texi: Update.

2008-01-19  Bruno Haible  <bruno@clisp.org>

	* doc/glibc-functions/strcasestr.texi: Include contents of
	doc/functions/strcasestr.texi, fixing the list of platforms.
	* doc/functions/strcasestr.texi: Remove file.

2008-01-19  Bruno Haible  <bruno@clisp.org>

	* doc/glibc-functions/memmem.texi: Include contents of
	doc/functions/memmem.texi.
	* doc/functions/memmem.texi: Remove file.

2008-01-18  Bruno Haible  <bruno@clisp.org>

	* doc/glibc-functions/*.texi: New files.
	* doc/gnulib.texi (Glibc Function Substitutes): Completely rewritten
	to use the new files.

2008-01-17  Bruno Haible  <bruno@clisp.org>

	* tests/test-gethostname.c (main): Fix printf statement.

2008-01-17  Simon Josefsson  <simon@josefsson.org>

	* modules/gethostname-tests: New file.

	* tests/test-gethostname.c: New file.

2008-01-17  Simon Josefsson  <simon@josefsson.org>

	* lib/gethostname.c: Include string.h unconditionally, strncpy is
	used by the UNAME case.  Reported by Bruno Haible
	<bruno@clisp.org>.

2008-01-17  Eric Blake  <ebb9@byu.net>

	Convert c-strcasestr to be more efficient.
	* modules/c-strcasestr (Files): Use Two-Way, not KMP.
	(Depends-on): Add c-strcase, remove malloca, strnlen.
	* tests/test-c-strcasestr.c (main): Enhance test.
	* lib/c-strcasestr.c (c_strcasestr): Rewrite to new algorithm.

2007-01-16  Paolo Bonzini  <bonzini@gnu.org>

	* build-aux/bootstrap (MSGID_BUGS_ADDRESS): New overridable variable.
	Use it in creating po/Makevars.

2008-01-15  Simon Josefsson  <simon@josefsson.org>

	* lib/gc-libgcrypt.c (gc_init): Disable secure memory by default.
	Applications that requires it should initialize libgcrypt
	manually.

2008-01-16  Simon Josefsson  <simon@josefsson.org>

	* lib/gethostname.c [!HAVE_UNAME]: Need string.h for strcpy.

2008-01-15  Paul Eggert  <eggert@cs.ucla.edu>

	Fix problem with getdate on mingw32 reported by Simon Josefsson
	in <http://lists.gnu.org/archive/html/bug-gnulib/2008-01/msg00192.html>.
	* lib/getdate.y (get_date): Check "HAVE_DECL_TZNAME", not "defined
	tzname", when deciding whether to declare tzname.
	* lib/strftime.c (tzname): Likewise.

2008-01-15  Bruno Haible  <bruno@clisp.org>

	Work around a MacOS X 10.5 bug in frexpl().
	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): Also check denormalized numbers.
	* doc/functions/frexpl.texi: Document the bug.
	Reported by Elias Pipping <pipping@gentoo.org>.

2008-01-14  Eric Blake  <ebb9@byu.net>

	Touch up previous patch.
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR_SIMPLE): Fix typo.
	* doc/functions/strcasestr.texi (strcasestr): Document OpenBSD bug.

	Convert strcasestr module to use Two-Way algorithm.
	* modules/strcasestr-simple: New module, based on the old
	strcasestr, but with Two-Way rather than KMP.
	* modules/strcasestr (Depends-on): Change to strcasestr-simple.
	* lib/string.in.h (rpl_strcasestr): Declare.
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR): Check for linear
	performance.
	* lib/strcasestr.c (strcasestr): Simplify, and avoid malloc.
	* modules/string (Makefile.am): Support strcasestr.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Likewise.
	* modules/strcasestr-tests (Depends-on): Check for alarm.
	* tests/test-strcasestr.c: Augment test.
	* lib/str-two-way.h: Clean up stray macro.
	* NEWS: Document new module.
	* MODULES.html.sh (string handling): Likewise.
	* doc/functions/strcasestr.texi: New file.
	* doc/gnulib.texi (Function Substitutes): New node.  Move memmem
	here, since it is not a POSIX function.

2008-01-14  Colin Watson  <cjwatson@debian.org>
	    Bruno Haible  <bruno@clisp.org>

	* m4/strsignal.m4 (gl_FUNC_STRSIGNAL): Also check whether strsignal
	works fine; if not, set REPLACE_STRSIGNAL.
	(gl_PREREQ_STRSIGNAL): Require AC_DECL_SYS_SIGLIST.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Initialize
	REPLACE_STRSIGNAL.
	* lib/string.in.h (strsignal): Consider REPLACE_STRSIGNAL.
	* modules/string (Makefile.am): Substitute REPLACE_STRSIGNAL.
	* tests/test-strsignal.c (main): Check out-of-range signal numbers.

2008-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/strsignal (Include): Change to <string.h>.

2008-01-14  Colin Watson  <cjwatson@debian.org>

	* modules/argp (Notice): Add a notice recommending to change
	XGETTEXT_OPTIONS.
	(configure.ac): Invoke AM_XGETTEXT_OPTION if it exists.

2008-01-13  Colin Watson  <cjwatson@debian.org>

	* modules/strsignal-tests: New file.
	* tests/test-strsignal.c: New file.

	* lib/strsignal.c: New file, from glibc with modifications.
	* lib/siglist.h: New file, from glibc with modifications.
	* lib/string.in.h (strsignal): New declaration.
	* m4/strsignal.m4: New file.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Initialize
	GNULIB_STRSIGNAL and HAVE_DECL_STRSIGNAL.
	* modules/strsignal: New file.
	* modules/string (Makefile.am): Substitute GNULIB_STRSIGNAL and
	HAVE_DECL_STRSIGNAL.

2008-01-13  Bruno Haible  <bruno@clisp.org>

	* m4/locale-fr.m4 (gt_LOCALE_FR, gt_LOCALE_FR_UTF8): Check that the
	locale encoding is not ASCII. Needed for OpenBSD 4.0.
	* m4/locale-tr.m4 (gt_LOCALE_TR_UTF8): Likewise.
	* m4/locale-zh.m4 (gt_LOCALE_ZH_CN): Likewise.

2008-01-13  Bruno Haible  <bruno@clisp.org>

	* lib/argp-fmtstream.h (__attribute__): Don't redefine if
	__STRICT_ANSI__ is set: it's not needed by any version of gcc.
	* lib/argp.h (__attribute__): Likewise.
	* lib/c-stack.c (__attribute__): Likewise.
	* lib/error.h (__attribute__): Likewise.
	* lib/fts.c (__attribute__): Likewise.
	* lib/openat.h (__attribute__): Likewise.
	* lib/stdio.in.h (__attribute__): Likewise.
	* lib/string.in.h (__attribute__): Likewise.
	* lib/utimens.c (__attribute__): Likewise.
	* lib/vasnprintf.h (__attribute__): Likewise.
	* lib/xalloc.h (__attribute__): Likewise.
	* lib/xprintf.h (__attribute__): Likewise.
	* lib/xstrtol.h (__attribute__): Likewise.
	* lib/xvasprintf.h (__attribute__): Likewise.

2008-01-12  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib.texi (Glibc Header File Substitutes): New chapter.
	* doc/glibc-headers/a.out.texi: New file.
	* doc/glibc-headers/aliases.texi: New file.
	* doc/glibc-headers/alloca.texi: New file.
	* doc/glibc-headers/ar.texi: New file.
	* doc/glibc-headers/argp.texi: New file.
	* doc/glibc-headers/argz.texi: New file.
	* doc/glibc-headers/byteswap.texi: New file.
	* doc/glibc-headers/crypt.texi: New file.
	* doc/glibc-headers/endian.texi: New file.
	* doc/glibc-headers/envz.texi: New file.
	* doc/glibc-headers/err.texi: New file.
	* doc/glibc-headers/error.texi: New file.
	* doc/glibc-headers/execinfo.texi: New file.
	* doc/glibc-headers/fpu_control.texi: New file.
	* doc/glibc-headers/fstab.texi: New file.
	* doc/glibc-headers/fts.texi: New file.
	* doc/glibc-headers/getopt.texi: New file.
	* doc/glibc-headers/ieee754.texi: New file.
	* doc/glibc-headers/ifaddrs.texi: New file.
	* doc/glibc-headers/libintl.texi: New file.
	* doc/glibc-headers/mcheck.texi: New file.
	* doc/glibc-headers/mntent.texi: New file.
	* doc/glibc-headers/obstack.texi: New file.
	* doc/glibc-headers/paths.texi: New file.
	* doc/glibc-headers/printf.texi: New file.
	* doc/glibc-headers/pty.texi: New file.
	* doc/glibc-headers/resolv.texi: New file.
	* doc/glibc-headers/shadow.texi: New file.
	* doc/glibc-headers/sysexits.texi: New file.
	* doc/glibc-headers/ttyent.texi: New file.

2008-01-12  Jim Meyering  <meyering@redhat.com>

	announce-gen: emit Gnulib's git-based version string.
	* build-aux/announce-gen: Remove option: --gnulib-snapshot-time-stamp=S.
	New option --gnulib-version=V, where V is expected to be
	the output of running git describe in the gnulib directory.
	(get_tool_versions): Request feedback on xdelta.  I suspect it's
	not useful, and plan to stop publishing an xdelta file with each
	coreutils release.

	* build-aux/announce-gen: Also check for lzma-compressed files.

2008-01-11  Bruno Haible  <bruno@clisp.org>

	* tests/test-memmem.c (main): Increase maximum allowed time.
	* tests/test-strstr.c (main): Likewise.

2008-01-11  Bruno Haible  <bruno@clisp.org>

	* doc/functions/memmem.texi: Add more precisions about platforms.
	* doc/functions/strstr.texi: Likewise.

2008-01-10  Eric Blake  <ebb9@byu.net>

	* m4/strstr.m4: Delete cruft from copy-n-paste.
	Reported by Bruno Haible.

2008-01-10  Bruno Haible  <bruno@clisp.org>

	Make c-strstr rely on strstr.
	* lib/c-strstr.c: Don't include str-kmp.h.
	(c_strstr): Define in terms of strstr.
	* modules/c-strstr (Files): Remove lib/str-kmp.h.
	(Depends-on): Remove stdbool, malloca, strnlen. Add strstr.

2008-01-10  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib.texi (String Functions in C Locale): New section.
	* doc/c-ctype.texi: New file.
	* doc/c-strcase.texi: New file.
	* doc/c-strcaseeq.texi: New file.
	* doc/c-strcasestr.texi: New file.
	* doc/c-strstr.texi: New file.
	* doc/c-strtod.texi: New file.
	* doc/c-strtold.texi: New file.

2008-01-10  Eric Blake  <ebb9@byu.net>

	* lib/relocatable.h: Fix a comment.

2008-01-10  Eric Blake  <ebb9@byu.net>

	Share two-way algorithm.
	* lib/str-two-way.h: New file, merged from...
	* lib/memmem.c: ...here...
	* lib/strstr.c: ...and here.
	* modules/memmem (Files): Use it.
	* modules/strstr (Files): Likewise.

	Avoid quadratic strstr implementations.
	* lib/strstr.c: New file.
	* m4/strstr.m4: Likewise.
	* modules/strstr: Likewise.
	* modules/strstr-tests: Likewise.
	* tests/test-strstr.c: Likewise.
	* lib/string.in.h (rpl_strstr): Declare.
	(memmem) [GNULIB_POSIXCHECK]: Document speed issue.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Support strstr.
	* modules/string (Makefile.am): Likewise.
	* MODULES.html.sh (string handling): Mention new module.
	* doc/functions/strstr.texi (strstr): Document the bug.

2008-01-10  Bruno Haible  <bruno@clisp.org>

	* lib/relocatable.h (relocate): State whether result is freshly
	allocated or not.
	* lib/relocatable.c (relocate): Return a freshly allocated string
	instead of a pointer to a privately held string.
	Reported by Sylvain Beucler <beuc@gnu.org>.

2008-01-10  Colin Watson  <cjwatson@debian.org>

	* lib/canonicalize-lgpl.c [!_LIBC]: Fix typo in #if directive:
	s/S_ISNLK/S_ISLNK/.

2008-01-09  Bruno Haible  <bruno@clisp.org>

	* doc/functions/memmem.texi: Use the same structure as snprintf.texi
	and other files.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): Say "guessing no" instead of "no"
	if it's only a guess.
	* modules/memmem: Simplify by depending on memmem-simple.

2008-01-09  Bruno Haible  <bruno@clisp.org>

	Work around OpenBSD 4.0 tdelete() bug.
	* m4/tsearch.m4 (gl_FUNC_TSEARCH): Also check tdelete's return value.
	* lib/search.in.h: If REPLACE_TSEARCH is 1, define tsearch etc. as
	macros and don't redefine the enum values.
	* m4/search_h.m4 (gl_SEARCH_H_DEFAULTS): Initialize REPLACE_TSEARCH.
	* modules/search (Makefile.am): Also substitute REPLACE_TSEARCH.
	* doc/functions/tdelete.texi: Document the OpenBSD 4.0 bug.

2008-01-09  Bruno Haible  <bruno@clisp.org>

	* tests/test-wcwidth.c: Include <string.h> and localcharset.h.
	(main): Don't perform the tests if setlocale did not install a UTF-8
	locale. Needed on OpenBSD 4.0.
	* modules/wcwidth-tests (Depends-on): Add localcharset.

2008-01-09  Paul Eggert  <eggert@cs.ucla.edu>

	gl_FUNC_ALLOCA no longer defines HAVE_ALLOCA_H unconditionally.
	See <http://lists.gnu.org/archive/html/bug-gnulib/2007-12/msg00149.html>.
	* NEWS: announce this.
	* m4/alloca.m4 (gl_FUNC_ALLOCA): Don't define HAVE_ALLOCA_H.

2008-01-09  Simon Josefsson  <simon@josefsson.org>
	and Eric Blake  <ebb9@byu.net>

	Add memmem-simple module.
	* m4/memmem.m4 (gl_FUNC_MEMMEM_SIMPLE): New macro.
	(gl_FUNC_MEMMEM): Separate performance from presence checks.
	* modules/memmem-simple: New file.
	* modules/memmem (Description): Tweak.
	* MODULES.html.sh (string handling): Mention new module.
	* doc/functions/memmem.texi (memmem): Distinguish which flaws are
	addressed by memmem-simple.
	* NEWS: Document the difference.

2008-01-09  Eric Blake  <ebb9@byu.net>

	Give gcc some memmem optimization hints.
	* lib/string.in.h (memmem, memrchr, strchrnul, strnlen, strpbrk)
	(strcasestr): Declare as pure.
	* modules/memmem (Maintainer): Claim my implementation.

2008-01-09  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Support AIX 6.1 and higher.
	* build-aux/config.libpath: Likewise.
	* build-aux/config.rpath: Likewise.

2008-01-08  Jim Meyering  <meyering@redhat.com>
	    Bruno Haible  <bruno@clisp.org>

	* lib/printf-parse.c (PRINTF_PARSE): Handle a size specifier "q"
	on MacOS X and a size specifier "I64" on mingw. Needed for PRIdMAX.
	Reported by Peter Fales in
	<http://lists.gnu.org/archive/html/bug-coreutils/2007-12/msg00148.html>.

2008-01-08  Bruno Haible  <bruno@clisp.org>

	* modules/unictype/category-of (Depends-on): Add
	unictype/category-none.
	* modules/unictype/category-and-tests (Depends-on): Add
	unictype/category-{L,N,Lu,Nd}.
	* modules/unictype/category-and-not-tests (Depends-on): Likewise.
	* modules/unictype/category-or-tests (Depends-on): Add
	unictype/category-{L,N}.
	* modules/unictype/category-name-tests (Depends-on): Add
	unictype/category-{Z,Nl}.
	Reported by Simon Josefsson.

2008-01-08  Bruno Haible  <bruno@clisp.org>

	* lib/str-kmp.h (knuth_morris_pratt_unibyte): Document the calling
	convention better.
	* lib/mbsstr.c (knuth_morris_pratt_multibyte): Likewise.
	* lib/mbscasestr.c (knuth_morris_pratt_multibyte): Likewise.
	Reported by Peter Miller <millerp@canb.auug.org.au>.

2008-01-08  Eric Blake  <ebb9@byu.net>

	Rewrite memmem to guarantee linear complexity without malloc.
	* lib/memmem.c (memmem): Use Two-Way rather than
	Knuth-Morris-Pratt, to allow O(1) space usage.
	(critical_factorization, two_way_short_needle)
	(two_way_long_needle): New functions.
	(knuth_morris_pratt): Delete.
	* modules/memmem (Depends-on): No longer need malloca or stdbool.
	Add stdint.
	* tests/test-memmem.c (main): Add tests for periodic needle and
	sublinear performance.
	* doc/functions/memmem.texi (memmem): Document other deficiencies
	in cygwin and older glibc.

2008-01-08  Bruno Haible  <bruno@clisp.org>

	* modules/memmem-tests (Makefile.am): Remove TESTS_ENVIRONMENT
	augmentation.

2008-01-08  Mike Frysinger  <vapier@gentoo.org>

	Add a configure time option: --disable-acl.
	* m4/acl.m4 (gl_FUNC_ACL): Wrap all ACL logic in a call to
	AC_ARG_ENABLE(acl).

2008-01-06  Simon Josefsson  <simon@josefsson.org>

	* tests/test-localename.c: Don't include obsolete "setenv.h".

	* modules/localename-tests (Depends-on): Need unsetenv.

2008-01-08  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* DEPENDENCIES: Require Texinfo version 4.6 or newer.

2008-01-06  Colin Watson  <cjwatson@debian.org>

	* users.txt: Add man-db.

2008-01-07  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-intro.texi (Library vs Reusable Code): Restore the
	previous section name.

2008-01-07  Bruno Haible  <bruno@clisp.org>

	* lib/progname.c (set_program_name): Don't strip off a leading
	"lt-" prefix outside a .libs directory.
	Suggested by Paul Eggert.

2008-01-01  Sylvain Beucler  <beuc@gnu.org>
	    Bruno Haible  <bruno@clisp.org>

	Improve memory cleanup in 'relocatable' module.
	* lib/relocatable.h (compute_curr_prefix): Change return type to
	'char *'.
	* lib/relocatable.c (compute_curr_prefix): Change return type to
	'char *'. Free curr_installdir after use.
	(relocate): Free curr_prefix_better after use.
	* lib/progreloc.c (prepare_relocate): Free curr_prefix after use.

2008-01-01  Bruno Haible  <bruno@clisp.org>

	* tests/test-wcwidth.c (main): Relax test of U+2060. Avoids a test
	failure on older glibc systems.
	Reported by Peter Fales <psfales@alcatel-lucent.com>.

2008-01-05  Eric Blake  <ebb9@byu.net>

	Avoid quadratic system memmem.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): Check for quadratic memmem.
	Reported by Ralf Wildenhues.

	Fix memmem test for mingw.
	* modules/memmem-tests (configure.ac): Check for alarm.
	* tests/test-memmem.c (main): Avoid alarm on platforms that lack
	it.
	* doc/functions/memmem.texi: New file.
	* doc/gnulib.texi (Function Substitutes): Add memmem.
	Reported by Bruno Haible.

2008-01-04  Bruno Haible  <bruno@clisp.org>

	* m4/strcase.m4 (gl_FUNC_STRCASECMP, gl_FUNC_STRNCASECMP):
	Require gl_HEADER_STRINGS_H_DEFAULTS, not
	gl_HEADER_STRING_H_DEFAULTS.

2008-01-04  Eric Blake  <ebb9@byu.net>

	Shorten duration of memmem test.
	* tests/test-memmem.c (main): Use alarm to declare failure if test
	is taking too long.
	Reported by Ralf Wildenhues.

2007-12-21  Simon Josefsson  <simon@josefsson.org>

	* modules/relocatable-prog-wrapper (Depends-on): Add intprops and
	string, needed by strerror.

2008-01-03  Colin Watson  <cjwatson@debian.org>
	    Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (Localization): New section.

2008-01-02  Bruno Haible  <bruno@clisp.org>

	* lib/memmem.c (knuth_morris_pratt, memmem): Change all 'char *'
	variables to 'unsigned char *' type.
	Reported by Paul Eggert.

2008-01-02  Jim Meyering  <jim@meyering.net>

	* lib/version-etc.c (COPYRIGHT_YEAR): Increase for new year.

2007-12-31  Jim Meyering  <jim@meyering.net>

	Avoid use of private FTS type name.
	* lib/fts.c (fts_sort): Use FTSENT rather than "struct _ftsent".

2007-12-30  Karl Berry  <karl@gnu.org>

	* doc/gnulib.texi (Library vs. Reusable Code): remove period, to
	work around defect in Texinfo and/or the standalone Info browser.

2007-12-30  Bruno Haible  <bruno@clisp.org>

	Unify 5 copies of the KMP code.
	* lib/str-kmp.h: New file.
	* lib/c-strcasestr.c: Include str-kmp.h.
	(knuth_morris_pratt): Remove function.
	(c_strcasestr): Update.
	* lib/c-strstr.c: Include str-kmp.h.
	(knuth_morris_pratt): Remove function.
	(c_strcasestr): Update.
	* lib/mbscasestr.c: Include str-kmp.h.
	(knuth_morris_pratt_unibyte): Remove function.
	* lib/mbsstr.c: Include str-kmp.h.
	(knuth_morris_pratt_unibyte): Remove function.
	* lib/strcasestr.c: Include str-kmp.h.
	(knuth_morris_pratt): Remove function.
	(strcasestr): Update.
	* modules/c-strcasestr (Files): Add lib/str-kmp.h.
	* modules/c-strstr (Files): Likewise.
	* modules/mbscasestr (Files): Likewise.
	* modules/mbsstr (Files): Likewise.
	* modules/strcasestr (Files): Likewise.
	Suggested by Paul Eggert.

2007-12-30  Bruno Haible  <bruno@clisp.org>

	* lib/xmalloca.c (xmmalloca): Don't define if HAVE_ALLOCA is not
	defined.

2007-12-30  Bruno Haible  <bruno@clisp.org>

	* lib/xmalloca.h: Include xalloc.h.
	(xnmalloca): New macro.

2007-12-30  Bruno Haible  <bruno@clisp.org>

	* lib/malloca.h (nmalloca): New macro.
	* lib/c-strcasestr.c (knuth_morris_pratt): Use it.
	* lib/c-strstr.c (knuth_morris_pratt): Likewise.
	* lib/mbscasestr.c (knuth_morris_pratt_unibyte,
	knuth_morris_pratt_multibyte): Likewise.
	* lib/mbsstr.c (knuth_morris_pratt_unibyte,
	knuth_morris_pratt_multibyte): Likewise.
	* lib/memmem.c (knuth_morris_pratt): Likewise.
	* lib/strcasestr.c (knuth_morris_pratt): Likewise.

2007-12-25  Bruno Haible  <bruno@clisp.org>

	Fixup after 2007-10-17 commit. Ensure that 'glob' stays under LGPLv2+.
	* lib/glob.c: Don't include openat.h.
	(link_exists2_p): Add back the code that deals with the
	!GLOB_ALTDIRFUNC case.
	(link_exists_p) [!_LIBC && !HAVE_FSTATAT]: Just call link_exists2_p and
	let it do the filename concatenation.
	* m4/glob.m4 (gl_PREREQ_GLOB): Add check for fstatat.
	* modules/glob (Depends-on): Remove openat.

2007-12-31  Bruno Haible  <bruno@clisp.org>

	* modules/dirfd (License): Change to LGPLv2+.
	Approved by Jim Meyering.

2007-12-29  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/memmem.c (knuth_morris_pratt): Check for size_t overflow
	when multiplying M by sizeof (size_t).

2007-12-10  Martin Lambers  <marlam@marlam.de>

	Override getpagesize on mingw.
	* lib/getpagesize.c: New file.
	* m4/getpagesize.m4 (gl_FUNC_GETPAGESIZE): Enable replacement on mingw.
	* modules/getpagesize (Files): Add lib/getpagesize.c.
	* lib/unistd.in.h (getpagesize): Declare if we are using a replacement.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize
	REPLACE_GETPAGESIZE.
	* modules/unistd (Makefile.am): Substitute REPLACE_GETPAGESIZE.

2007-12-25  Bruno Haible  <bruno@clisp.org>

	* modules/localcharset (Notice): New field.
	(configure.ac): Define LOCALCHARSET_TESTS_ENVIRONMENT.
	Suggested by Ben Pfaff <blp@cs.stanford.edu>.

2007-12-25  Paul Eggert  <eggert@cs.ucla.edu>
	    Bruno Haible  <bruno@clisp.org>

	Avoid using the syntax symbol() in formatted documentation.
	* MODULES.html.sh (func_module): When replacing symbol() with a
	hyperlink, remove the parentheses. Show an error if some remain.
	Recognize and render the '...' syntax.
	* doc/alloca-opt.texi: Remove parentheses from symbol reference.
	Rework. Add paragraph about GCC's inlining.
	* doc/alloca.texi: Likewise.
	* doc/error.texi: Remove parentheses from symbol reference.
	* doc/gnulib-intro.texi: Likewise.
	* doc/gnulib.texi (alloca, alloca-opt): New nodes.
	* modules/fnmatch (Description): Reword to say "the ... function".
	* modules/full-read (Description): Likewise.
	* modules/full-write (Description): Likewise.
	* modules/safe-read (Description): Likewise.
	* modules/safe-write (Description): Likewise.
	* modules/strchrnul (Description): Likewise.
	* modules/trim (Description): Likewise.
	* modules/error (Description): Remove parentheses from symbol
	references.
	* modules/verror (Description): Likewise.
	Reported by Karl Berry.

2007-12-25  Bruno Haible  <bruno@clisp.org>

	Fixup after 2007-10-16 commit.
	* lib/glob.c (glob_in_dir): Don't use ISO C99 syntax.

2007-12-24  Bruno Haible  <bruno@clisp.org>

	Make --enable-relocatable work with DESTDIR.
	* build-aux/install-reloc: Accept another argument 'destdir'. Use it
	to compute installdir from destprog.
	* m4/relocatable.m4 (gl_RELOCATABLE_BODY): In INSTALL_PROGRAM_ENV,
	also set the RELOC_DESTDIR variable.
	Reported by Левашев Иван <octagram@bluebottle.com>.

2007-12-24  Bruno Haible  <bruno@clisp.org>

	Fix link error due to xalloc_die().
	* lib/progreloc.c: When NO_XMALLOC is defined, use areadlink instead
	of xreadlink.
	* lib/relocwrapper.c: Update comments.
	* build-aux/install-reloc: Remove xreadlink.c from file list.
	* modules/relocatable-prog-wrapper (Files): Remove xreadlink.h and
	xreadlink.c.
	Reported by Левашев Иван <octagram@bluebottle.com>.

2007-12-24  Bruno Haible  <bruno@clisp.org>

	Split setenv module into setenv and unsetenv. Get rid of setenv.h.
	* lib/setenv.h: Remove file.
	* lib/stdlib.in.h (setenv, unsetenv): New declarations, moved here from
	lib/setenv.h.
	* modules/setenv (Files): Remove lib/setenv.h, lib/unsetenv.c.
	(Depends-on): Add stdlib.
	(configure.ac): Invoke gl_STDLIB_MODULE_INDICATOR. Don't invoke
	gl_FUNC_UNSETENV.
	(Include): Replace setenv.h with <stdlib.h>.
	* modules/unsetenv: New file.
	* lib/setenv.c: Include <stdlib.h> first, after alloca.h.
	* lib/unsetenv.c: Include <stdlib.h> first.
	* m4/setenv.m4 (gl_FUNC_SETENV, gl_FUNC_SETENV_SEPARATE): Require
	gl_STDLIB_H_DEFAULTS. Conditionally set HAVE_SETENV to 0.
	(gl_FUNC_UNSETENV): Require gl_STDLIB_H_DEFAULTS. Conditionally set
	HAVE_UNSETENV to 0. Set VOID_UNSETENV as an AC_SUBSTed variable.
	* modules/stdlib (Makefile.am): Substitute also GNULIB_SETENV,
	HAVE_SETENV, GNULIB_UNSETENV, HAVE_UNSETENV, VOID_UNSETENV.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Initialize GNULIB_SETENV,
	HAVE_SETENV, GNULIB_UNSETENV, HAVE_UNSETENV, VOID_UNSETENV.
	* doc/functions/unsetenv.texi: Update.
	* modules/xsetenv (Depends-on): Add unsetenv.
	* modules/getdate (Depends-on): Likewise.
	* lib/xsetenv.h: Include <stdlib.h> instead of setenv.h.
	* lib/xsetenv.c: Don't include setenv.h.
	* lib/getdate.y: Likewise.
	* lib/relocwrapper.c: Likewise.
	* modules/relocatable-prog-wrapper (Files): Remove lib/setenv.h.
	(Depends-on): Add stdlib.
	* NEWS: Mention the changes.
	Reported by Левашев Иван <octagram@bluebottle.com>.

2007-12-23  Bruno Haible  <bruno@clisp.org>

	* lib/memmem.c (memmem): Use lowercase variable names. Tab
	indentation.

2007-12-23  Bruno Haible  <bruno@clisp.org>

	* lib/c-strcasestr.c: Add more comments.
	* lib/c-strstr.c: Likewise.
	* lib/mbscasestr.c: Likewise.
	* lib/mbsstr.c: Likewise.
	* lib/strcasestr.c: Likewise.
	* lib/memmem.c: Likewise.

2007-12-23  Bruno Haible  <bruno@clisp.org>

	* tests/test-memmem.c: Include <string.h> first.

2007-12-22  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Change $auxdir while generating
	the contents of $testsbase.
	Reported by Ralf Wildenhues.

2007-12-22  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_tests_Makefile_am): Replace local_ldadd with
	two variables local_ldadd_before, local_ldadd_last.

2007-12-20  Eric Blake  <ebb9@byu.net>

	Work around circular library issue when cross-compiling.
	* lib/progname.c (set_program_name): Use strncmp, not memcmp, so
	that progname.o does not need to pull in rpl_memcmp.

2007-12-19  Eric Blake  <ebb9@byu.net>

	Fix memmem to avoid O(n^2) worst-case complexity.
	* lib/memmem.c (knuth_morris_pratt): New function.
	(memmem): Use it if first few naive iterations fail.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): Detect cygwin bug.
	* modules/memcmp (License): Set to LGPLv2+, not LGPL.
	* modules/memchr (License): Likewise.
	* modules/memmem (Depends-on): Add memcmp, memchr, stdbool, and
	malloca.
	* tests/test-memmem.c: Rewrite, borrowing ideas from
	test-mbsstr1.c; the old version wouldn't even compile!
	* modules/memmem-tests: New file.
	* lib/string.in.h (rpl_memmem): Add declaration.
	* modules/string (Makefile.am): Substitute REPLACE_MEMMEM.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Default for
	REPLACE_MEMMEM.

2007-12-18  Paul Eggert  <eggert@cs.ucla.edu>

	Fix problem with _GL_JUST_INCLUDE_SYSTEM_INTTYPES_H on VMS.
	* lib/stdint.in.h (_GL_JUST_INCLUDE_SYSTEM_INTTYPES_H): Define
	before any system include files, and undef after them all.  This
	should fix a problem on VMS reported by John E. Malmberg in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-12/msg00118.html>.

2007-12-17  Eric Blake  <ebb9@byu.net>

	Revert addition of verify, for BSD/OS.
	* lib/fseeko.c [!HAVE_FSEEKO]: Allow off_t > long, even though it
	can't handle large files, for the sake of obsolete platforms.
	* modules/fseeko (Depends-on): Remove verify.
	* doc/functions/fseeko.texi (fseeko): Document BSD/OS limitation.
	* doc/functions/ftello.texi (ftello): Likewise.
	* doc/functions/fgetpos.texi (fgetpos): Likewise.
	Reported by Larry Jones.

2007-12-17  Petr Salinger  <Petr.Salinger@seznam.cz>

	getcwd.c: Use a more readable witness: HAVE_OPENAT_SUPPORT
	* lib/getcwd.c: Define and use HAVE_OPENAT_SUPPORT, in place of AT_FDCWD.

2007-12-17  Jim Meyering  <meyering@redhat.com>

	Port to GNU/kFreeBSD - FreeBSD kernel + GNU libc,
	which has no openat syscall, yet <fcntl.h> does define AT_FDCWD.
	* lib/getcwd.c: Undef AT_FDCWD if there is no openat function.
	* modules/getcwd (Depends-on): Add openat.
	Reported by Petr Salinger.

2007-12-17  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_INFINITE_LONG_DOUBLE): Use GL_NOCRASH to
	avoid a segmentation fault of the configure test on x86_64 systems.

2007-12-15  Jim Meyering  <meyering@redhat.com>

	* build-aux/gnupload (GPG): Don't hard-code absolute name of gpg binary.

2007-12-13  Eric Blake  <ebb9@byu.net>

	Another fseek test.
	* tests/test-fseek.c (main): Also test ungetc handling.
	* tests/test-fseeko.c (main): Likewise.
	* modules/fseeko (Depends-on): Add verify.
	* lib/fseeko.c [!HAVE_FSEEKO]: Verify that off_t is not too
	large.
	Reported by Larry Jones.

	Fix fseeko on mingw.
	* lib/fseeko.c (rpl_fseeko) [_IOERR]: Reset EOF flag on successful
	seek.

	Beef up fseek tests.
	* tests/test-fseek.c (main): Also test eof handling.
	* tests/test-fseeko.c (main): Likewise.
	Reported by Larry Jones.

2007-12-13  Larry Jones  <lawrence.jones@siemens.com>  (tiny change)

	Fix fseeko on BSD-based platforms.
	* lib/fseeko.c (rpl_fseeko) [__sferror]: Reset EOF flag on
	successful seek.

2007-12-12  Eric Blake  <ebb9@byu.net>

	Allow circular dependency of separate libtests.a
	* gnulib-tool (func_emit_tests_Makefile_am): Add AM_LIBTOOLFLAGS
	when use_libtests.

2007-12-11  Eric Blake  <ebb9@byu.net>

	Fix bug with -0.0L in previous patch.
	* lib/isnan.c (rpl_isnanl): Make robust to -0.0L and pad bits.
	* tests/test-isnan.c (main): Also test on zeroes.
	* tests/test-isnanf.c (main): Likewise.
	* tests/test-isnanl.h (main): Likewise.

	Detect pseudo-denormals on x86 even when cross-compiling.
	* lib/isnan.c (rpl_isnanl) [!KNOWN_EXPBIT0_LOCATION
	&& USE_LONG_DOUBLE && x86]: Add one more check to filter out
	invalid bit patterns that happen to satisfy ==.

	Avoid link failures with separate libtests.a.
	* gnulib-tool (func_emit_tests_Makefile_am): Also list local_ldadd
	last, to satisfy circular dependencies.

2007-12-11  Eric Blake  <ebb9@byu.net>
	and Bruno Haible  <bruno@clisp.org>

	Fix OpenBSD 4.0 <float.h> handling of long double.
	* m4/float_h.m4 (gl_FLOAT_H): Also claim OpenBSD is broken.
	* lib/float.in.h [__OpenBSD__]: Add fixes for OpenBSD.
	* doc/headers/float.texi (float.h): Document OpenBSD bug.

2007-12-11  Jim Meyering  <meyering@redhat.com>

	* users.txt: Add libvirt.

	Support versions of autoconf prior to 2.59c.
	* gnulib-tool (func_emit_initmacro_done): Define m4_foreach_w
	if it is not already defined.

2007-12-09  Bruno Haible  <bruno@clisp.org>

	Let 'gnulib-tool --import' collect sources needed for the tests in
	tests/ rather than in lib/.
	* gnulib-tool (func_emit_tests_Makefile_am): Accept use_libtests
	argument. If true, add rules to generate libtests.a, and put libtests.a
	into $(LDADD). Consider source files in subdirectories and set
	uses_subdirs.
	(func_emit_initmacro_start, func_emit_initmacro_end,
	func_emit_initmacro_done): Pass all arguments explicitly.
	(func_import): Determine two module lists main_modules,
	testsrelated_modules. Determine use_libtests. Determine two variables
	sed_transform_main_lib_file, sed_transform_testsrelated_lib_file
	instead of just sed_transform_lib_file. Determine two variables
	main_files and testsrelated_files. Compute 'files' as the union of
	both. Adjust sed_rewrite_old_files, sed_rewrite_new_files,
	func_add_or_update. In the generated gnulib-comp.m4, collect the
	object files for tests/ in different variables than those for lib/.
	Substitute LIBTESTS_LIBDEPS.
	(func_create_testdir): Combine the uses_subdirs results from
	func_emit_lib_Makefile_am and from func_emit_tests_Makefile_am.

2007-12-09  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_tests_Makefile_am): Expand references to
	the build-aux directory.

2007-12-09  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_tests_Makefile_am): Remove redundant code
	introduced on 2006-09-09.

2007-12-07  Jim Meyering  <meyering@redhat.com>

	Let these macros work also with autoconf-2.59.
	* m4/getline.m4 (gl_FUNC_GETLINE): Require only autoconf-2.59.  2.60
	is not needed, since gnulib now permits use of AC_CHECK_DECLS_ONCE.
	* m4/getdelim.m4 (gl_FUNC_GETDELIM): Likewise.

2007-12-06  Jim Meyering  <meyering@redhat.com>

	Avoid a configure-time syntax error in gl_FUNC_ACL.
	* m4/acl.m4 (gl_FUNC_ACL): Be careful to check for the acl_trivial
	function in each branch, before testing the cache variable.

2007-12-04  Eric Blake  <ebb9@byu.net>

	Make scripts executable.
	* build-aux/config.guess: Add execute permissions.
	* build-aux/config.sub: Likewise.
	* build-aux/gendocs.sh: Likewise.

	Fix frexp on mingw.
	* m4/frexp.m4 (gl_FUNC_FREXP_WORKS): Detect mingw bug when
	cross-compiling.
	* doc/functions/frexp.texi (frexp): Document the bug.

	Make cygwin fseeko check more reliable.
	* m4/stdio_h.m4 (gl_STDIN_LARGE_OFFSET) [__CYGWIN__]: Use cygwin
	version numbers, rather than unrelated feature check.
	* doc/functions/fseeko.texi (fseeko): Tweak failure report.
	* doc/functions/ftello.texi (ftello): Likewise.
	Reported by Bruno Haible.

	* m4/strerror.m4: Bump version number.

2007-12-03  Bruno Haible  <bruno@clisp.org>

	* doc/functions/mprotect.texi: Mention the mingw problem.

2007-12-03  Eric Blake  <ebb9@byu.net>

	* m4/strerror.m4 (gl_FUNC_STRERROR_SEPARATE): Ensure
	REPLACE_STRERROR is initialized before this macro.

2007-12-03  Paul Eggert  <eggert@cs.ucla.edu>

	Add support for Solaris 10 ACLs.  Also, ACLs are Gnulib, not Autoconf.
	* modules/acl (configure.ac): Rename AC_FUNC_ACL to gl_FUNC_ACL.
	* m4/acl.m4 (gl_FUNC_ACL): Renamed from AC_FUNC_ACL.  On Solaris,
	put -lsec in even for programs other than 'ls'.  This fixes a problem
	for gettext reported by Bruno Haible in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-12/msg00007.html>.
	* lib/acl.c (copy_acl, qset_acl) [USE_ACL && defined ACL_NO_TRIVIAL]:
	Add support for Solaris 10.  This isn't efficient, but should get the
	job done for now.

2007-12-03  James Youngman  <jay@gnu.org>

	* doc/regexprops-generic.texi: change "an close-group" to "a
	close-group" and "illegal" to "not allowed".

2007-11-23  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/unictype/pr_byname.c: Include unictype/pr_byname.h instead of
	pr_byname.h. Needed for the rare case when the maintainer has done
	"make maintainer-clean" in the source directory and then attempts a
	build outside the source directory.
	* lib/unictype/scripts.c: Include unictype/scripts_byname.h instead of
	scripts_byname.h.

2007-12-02  Martin Lambers <marlam@marlam.de>
	    Bruno Haible  <bruno@clisp.org>

	* lib/getpagesize.h: Remove file.
	* lib/unistd.in.h: Include declaration of getpagesize here.
	* m4/getpagesize.m4 (gl_FUNC_GETPAGESIZE): Renamed from gl_GETPAGESIZE.
	Invoke gl_UNISTD_H_DEFAULTS. Set HAVE_GETPAGESIZE, HAVE_OS_H,
	HAVE_SYS_PARAM_H.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize GNULIB_GETPAGESIZE,
	HAVE_GETPAGESIZE, HAVE_OS_H, HAVE_SYS_PARAM_H.
	* modules/getpagesize (Files): Remove lib/getpagesize.h.
	(Depends-on): Add unistd.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.
	(Include): Use <unistd.h> instead of getpagesize.h.
	* modules/unistd (Makefile.am): Substitute also GNULIB_GETPAGESIZE,
	HAVE_GETPAGESIZE, HAVE_OS_H, HAVE_SYS_PARAM_H.
	* m4/pagealign_alloc.m4 (gl_PREREQ_PAGEALIGN_ALLOC): Remove
	gl_GETPAGESIZE invocation, already handled by module dependency.
	* lib/pagealign_alloc.c: Don't include getpagesize.h.

2007-12-02  Bruno Haible  <bruno@clisp.org>

	* modules/strings-tests: New file.
	* tests/test-strings.c: New file.

	Move declarations of str{,n}casecmp from <string.h> to <strings.h>.
	* lib/strings.in.h: New file.
	* lib/string.in.h (strcasecmp, strncasecmp): Remove declarations.
	* m4/strings_h.m4: New file.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Remove initialization
	of HAVE_STRCASECMP, HAVE_DECL_STRNCASECMP.
	* modules/strings: New file.
	* modules/string (Makefile.am): Update.
	* modules/strcase (Include): Mention <strings.h>, not <string.h>.
	Reported by Karl Berry.

2007-12-01  Eric Blake  <ebb9@byu.net>

	* m4/stdio_h.m4 (gl_STDIN_LARGE_OFFSET) [__CYGWIN__]: Rewrite to
	accomodate fix in cygwin 1.5.25.

2007-12-01  Jim Meyering  <meyering@redhat.com>

	Fix a bug that inhibited much of the utf8-optimization in regcomp.c.
	* lib/regcomp.c (optimize_utf8): Fix a typo, s/idx/ctx_type/,
	that would inhibit utf8-optimization of a regexp containing line-
	or buffer-anchors, e.g., `^', `$'.

2007-11-30  Bruno Haible  <bruno@clisp.org>

	* lib/lock.h (gl_recursive_lock_init) [PTHREAD &&
	PTHREAD_RECURSIVE_MUTEX_INITIALIZER]: Call
	glthread_recursive_lock_init.
	* lib/lock.c (glthread_recursive_lock_init)
	[PTHREAD_RECURSIVE_MUTEX_INITIALIZER]: New function.
	Reported by Yoann Vandoorselaere <yoann.v@prelude-ids.com>.

2007-11-28  Paul Eggert  <eggert@cs.ucla.edu>

	New function qset_acl, like set_acl but with syscall semantics.
	* lib/acl.h (qset_acl): New decl.
	* lib/acl.c (qset_acl): New function.
	(set_acl): Use new function.  Use more-consistent diagnostics.

2007-11-28  Jim Meyering  <meyering@redhat.com>

	* modules/physmem (License): Change from GPL to LGPLv2+.

2007-11-26  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (decode_long_double): Don't abort if the
	'long double' type has excess precision.
	Reported by Jim Meyering in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-11/msg00120.html>.

2007-11-25  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* doc/fdl.texi, doc/gpl-3.0.texi, doc/lgpl-3.0.texi:
	Sync from <http://gnu.org/licenses>.
	* modules/agpl-3.0, doc/agpl-3.0.texi: New module,
	with license text from same location.
	* doc/maintain.texi, doc/standards.texi:  Sync from
	<http://savannah.gnu.org/projects/gnustandards>.

2007-11-22  Ondřej Vašík  <ovasik@redhat.com>
	and Jim Meyering  <meyering@redhat.com>

	Adjust getdate' grammar to accept a slightly more regular language.
	E.g., accept "YYYYMMDD +N days" as well as "YYYYMMDD N days".
	Before, the former was rejected.
	* lib/getdate.y (digits_to_date_time): New function, factored
	out of ...
	(number): ...here.  Just call digits_to_date_time.
	(hybrid): New non-terminal to handle an <unsigned number,
	signed relative offset> sequence consistently.

2007-11-18  Jim Meyering  <meyering@redhat.com>

	Pull my changes from coreutils:
	bootstrap: fix typo to enable use of $gnulib_tool_option_extras.
	* build-aux/bootstrap (gnulib_tool_options): Add a space before the
	use of $gnulib_tool_option_extras, so that it's separated from the
	preceding argument.

	Fix bootstrap failure to handle files like lib/uniwidth/cjk.h.
	* build-aux/bootstrap (cp_mark_as_generated): Create any required
	parent destination directories before copying a file into place.

2007-11-18  Sergey Poznyakoff  <gray@gnu.org.ua>

	bootstrap: work also with 4-argument variant of AC_INIT
	* build-aux/bootstrap (gnulib_extra_files): Adjust sed command.

2007-11-16  Paul Eggert  <eggert@cs.ucla.edu>

	Port test-getaddrinfo to Solaris.
	Problem reported by Bruno Haible in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-03/msg00171.html>.
	* tests/test-getaddrinfo.c (simple): Add a comment asking for an
	explanation of setting 'hints'.
	Don't reject an implementation merely because it returns EAI_SERVICE.
	(EAI_SERVICE): Define to 0 if not defined.

2007-11-15  Paul Eggert  <eggert@cs.ucla.edu>

	The license of gnu-make and posix-shell is now "GPLed build tool".
	* modules/gnu-make (License): Likewise.
	* modules/posix-shell (License): Likewise.

	New module posix-shell, for determining a POSIX shell
	or perhaps something that is close enough to a POSIX shell.
	* m4/posix-shell.m4: New file.
	* modules/posix-shell: New file.

	* MODULES.html.sh: Mention new module.

	New module gnu-make, for determining whether we're using GNU Make.
	* m4/gnu-make.m4: New file.
	* modules/gnu-make: New file.
	* MODULES.html.sh: Mention new module.

2007-11-14  Jim Meyering  <meyering@redhat.com>

	Define a sometimes-link-required function using ARGMATCH_DIE_DECL.
	* tests/test-argmatch.c (ARGMATCH_DIE_DECL): When defined,
	use this macro to create a function _definition_.
	Remove useless "#undef ARGMATCH_DIE".

2007-11-14  Bruno Haible  <bruno@clisp.org>

	* lib/config.charset: Update for OpenBSD 4.1.
	Reported and helped by Ben Pfaff <blp@cs.stanford.edu>.

2007-11-12  Paul Eggert  <eggert@cs.ucla.edu>

	Document 64-bit #if problems in stdint.texi.
	* doc/headers/stdint.texi (stdint.h): Mention problems with
	64-bit-#if, and how to work around them.

	Don't insist on 'long long int' support in the preprocessor.  It
	breaks too many things.  For example, PRIdMAX still uses a 'long
	long int' format with the latest Sun compiler, even though
	HAVE_LONG_LONG_INT isn't defined due to that compiler's
	preprocessor problem.  This causes the latest coreutils to dump
	core on Solaris 10 sparc with the Sun C compiler.
	Instead, fix the 2007-10-16 problem in a different way, by evaluating
	the troublesome expressions at configure-time, not at #if-time.
	* m4/longlong.m4 (_AC_TYPE_LONG_LONG_SNIPPET): Don't test the
	preprocessor.
	* m4/inttypes.m4 (gl_INTTYPES_H): Move the #if checks into
	compile-time C checks, done at 'configure'-time.
	(gl_INTTYPES_CHECK_LONG_LONG_INT_CONDITION): New macro.
	* modules/inttypes (Makefile): Substitute the new symbols that
	gl_INTTYPES_H now generates.
	* lib/inttypes.in.h: Don't use constants wider than 'long' in #if.

2007-11-12  Bruno Haible  <bruno@clisp.org>

	Tests for Unicode character classification functions.

	* modules/unictype/bidicategory-byname-tests: New file.
	* modules/unictype/bidicategory-name-tests: New file.
	* modules/unictype/bidicategory-of-tests: New file.
	* modules/unictype/bidicategory-test-tests: New file.
	* modules/unictype/block-list-tests: New file.
	* modules/unictype/block-of-tests: New file.
	* modules/unictype/block-test-tests: New file.
	* modules/unictype/category-C-tests: New file.
	* modules/unictype/category-Cc-tests: New file.
	* modules/unictype/category-Cf-tests: New file.
	* modules/unictype/category-Cn-tests: New file.
	* modules/unictype/category-Co-tests: New file.
	* modules/unictype/category-Cs-tests: New file.
	* modules/unictype/category-L-tests: New file.
	* modules/unictype/category-Ll-tests: New file.
	* modules/unictype/category-Lm-tests: New file.
	* modules/unictype/category-Lo-tests: New file.
	* modules/unictype/category-Lt-tests: New file.
	* modules/unictype/category-Lu-tests: New file.
	* modules/unictype/category-M-tests: New file.
	* modules/unictype/category-Mc-tests: New file.
	* modules/unictype/category-Me-tests: New file.
	* modules/unictype/category-Mn-tests: New file.
	* modules/unictype/category-N-tests: New file.
	* modules/unictype/category-Nd-tests: New file.
	* modules/unictype/category-Nl-tests: New file.
	* modules/unictype/category-No-tests: New file.
	* modules/unictype/category-P-tests: New file.
	* modules/unictype/category-Pc-tests: New file.
	* modules/unictype/category-Pd-tests: New file.
	* modules/unictype/category-Pe-tests: New file.
	* modules/unictype/category-Pf-tests: New file.
	* modules/unictype/category-Pi-tests: New file.
	* modules/unictype/category-Po-tests: New file.
	* modules/unictype/category-Ps-tests: New file.
	* modules/unictype/category-S-tests: New file.
	* modules/unictype/category-Sc-tests: New file.
	* modules/unictype/category-Sk-tests: New file.
	* modules/unictype/category-Sm-tests: New file.
	* modules/unictype/category-So-tests: New file.
	* modules/unictype/category-Z-tests: New file.
	* modules/unictype/category-Zl-tests: New file.
	* modules/unictype/category-Zp-tests: New file.
	* modules/unictype/category-Zs-tests: New file.
	* modules/unictype/category-and-not-tests: New file.
	* modules/unictype/category-and-tests: New file.
	* modules/unictype/category-byname-tests: New file.
	* modules/unictype/category-name-tests: New file.
	* modules/unictype/category-none-tests: New file.
	* modules/unictype/category-of-tests: New file.
	* modules/unictype/category-or-tests: New file.
	* modules/unictype/category-test-withtable-tests: New file.
	* modules/unictype/combining-class-tests: New file.
	* modules/unictype/ctype-alnum-tests: New file.
	* modules/unictype/ctype-alpha-tests: New file.
	* modules/unictype/ctype-blank-tests: New file.
	* modules/unictype/ctype-cntrl-tests: New file.
	* modules/unictype/ctype-digit-tests: New file.
	* modules/unictype/ctype-graph-tests: New file.
	* modules/unictype/ctype-lower-tests: New file.
	* modules/unictype/ctype-print-tests: New file.
	* modules/unictype/ctype-punct-tests: New file.
	* modules/unictype/ctype-space-tests: New file.
	* modules/unictype/ctype-upper-tests: New file.
	* modules/unictype/ctype-xdigit-tests: New file.
	* modules/unictype/decimal-digit-tests: New file.
	* modules/unictype/digit-tests: New file.
	* modules/unictype/mirror-tests: New file.
	* modules/unictype/numeric-tests: New file.
	* modules/unictype/property-alphabetic-tests: New file.
	* modules/unictype/property-ascii-hex-digit-tests: New file.
	* modules/unictype/property-bidi-arabic-digit-tests: New file.
	* modules/unictype/property-bidi-arabic-right-to-left-tests: New file.
	* modules/unictype/property-bidi-block-separator-tests: New file.
	* modules/unictype/property-bidi-boundary-neutral-tests: New file.
	* modules/unictype/property-bidi-common-separator-tests: New file.
	* modules/unictype/property-bidi-control-tests: New file.
	* modules/unictype/property-bidi-embedding-or-override-tests: New file.
	* modules/unictype/property-bidi-eur-num-separator-tests: New file.
	* modules/unictype/property-bidi-eur-num-terminator-tests: New file.
	* modules/unictype/property-bidi-european-digit-tests: New file.
	* modules/unictype/property-bidi-hebrew-right-to-left-tests: New file.
	* modules/unictype/property-bidi-left-to-right-tests: New file.
	* modules/unictype/property-bidi-non-spacing-mark-tests: New file.
	* modules/unictype/property-bidi-other-neutral-tests: New file.
	* modules/unictype/property-bidi-pdf-tests: New file.
	* modules/unictype/property-bidi-segment-separator-tests: New file.
	* modules/unictype/property-bidi-whitespace-tests: New file.
	* modules/unictype/property-byname-tests: New file.
	* modules/unictype/property-combining-tests: New file.
	* modules/unictype/property-composite-tests: New file.
	* modules/unictype/property-currency-symbol-tests: New file.
	* modules/unictype/property-dash-tests: New file.
	* modules/unictype/property-decimal-digit-tests: New file.
	* modules/unictype/property-default-ignorable-code-point-tests: New file.
	* modules/unictype/property-deprecated-tests: New file.
	* modules/unictype/property-diacritic-tests: New file.
	* modules/unictype/property-extender-tests: New file.
	* modules/unictype/property-format-control-tests: New file.
	* modules/unictype/property-grapheme-base-tests: New file.
	* modules/unictype/property-grapheme-extend-tests: New file.
	* modules/unictype/property-grapheme-link-tests: New file.
	* modules/unictype/property-hex-digit-tests: New file.
	* modules/unictype/property-hyphen-tests: New file.
	* modules/unictype/property-id-continue-tests: New file.
	* modules/unictype/property-id-start-tests: New file.
	* modules/unictype/property-ideographic-tests: New file.
	* modules/unictype/property-ids-binary-operator-tests: New file.
	* modules/unictype/property-ids-trinary-operator-tests: New file.
	* modules/unictype/property-ignorable-control-tests: New file.
	* modules/unictype/property-iso-control-tests: New file.
	* modules/unictype/property-join-control-tests: New file.
	* modules/unictype/property-left-of-pair-tests: New file.
	* modules/unictype/property-line-separator-tests: New file.
	* modules/unictype/property-logical-order-exception-tests: New file.
	* modules/unictype/property-lowercase-tests: New file.
	* modules/unictype/property-math-tests: New file.
	* modules/unictype/property-non-break-tests: New file.
	* modules/unictype/property-not-a-character-tests: New file.
	* modules/unictype/property-numeric-tests: New file.
	* modules/unictype/property-other-alphabetic-tests: New file.
	* modules/unictype/property-other-default-ignorable-code-point-tests: New file.
	* modules/unictype/property-other-grapheme-extend-tests: New file.
	* modules/unictype/property-other-id-continue-tests: New file.
	* modules/unictype/property-other-id-start-tests: New file.
	* modules/unictype/property-other-lowercase-tests: New file.
	* modules/unictype/property-other-math-tests: New file.
	* modules/unictype/property-other-uppercase-tests: New file.
	* modules/unictype/property-paired-punctuation-tests: New file.
	* modules/unictype/property-paragraph-separator-tests: New file.
	* modules/unictype/property-pattern-syntax-tests: New file.
	* modules/unictype/property-pattern-white-space-tests: New file.
	* modules/unictype/property-private-use-tests: New file.
	* modules/unictype/property-punctuation-tests: New file.
	* modules/unictype/property-quotation-mark-tests: New file.
	* modules/unictype/property-radical-tests: New file.
	* modules/unictype/property-sentence-terminal-tests: New file.
	* modules/unictype/property-soft-dotted-tests: New file.
	* modules/unictype/property-space-tests: New file.
	* modules/unictype/property-terminal-punctuation-tests: New file.
	* modules/unictype/property-test-tests: New file.
	* modules/unictype/property-titlecase-tests: New file.
	* modules/unictype/property-unassigned-code-value-tests: New file.
	* modules/unictype/property-unified-ideograph-tests: New file.
	* modules/unictype/property-uppercase-tests: New file.
	* modules/unictype/property-variation-selector-tests: New file.
	* modules/unictype/property-white-space-tests: New file.
	* modules/unictype/property-xid-continue-tests: New file.
	* modules/unictype/property-xid-start-tests: New file.
	* modules/unictype/property-zero-width-tests: New file.
	* modules/unictype/scripts-tests: New file.
	* modules/unictype/syntax-c-ident-tests: New file.
	* modules/unictype/syntax-c-whitespace-tests: New file.
	* modules/unictype/syntax-java-ident-tests: New file.
	* modules/unictype/syntax-java-whitespace-tests: New file.
	* tests/unictype/test-bidi_byname.c: New file.
	* tests/unictype/test-bidi_name.c: New file.
	* tests/unictype/test-bidi_of.c: New file.
	* tests/unictype/test-bidi_test.c: New file.
	* tests/unictype/test-block_list.c: New file.
	* tests/unictype/test-block_of.c: New file.
	* tests/unictype/test-block_test.c: New file.
	* tests/unictype/test-categ_and.c: New file.
	* tests/unictype/test-categ_and_not.c: New file.
	* tests/unictype/test-categ_byname.c: New file.
	* tests/unictype/test-categ_name.c: New file.
	* tests/unictype/test-categ_none.c: New file.
	* tests/unictype/test-categ_of.c: New file.
	* tests/unictype/test-categ_or.c: New file.
	* tests/unictype/test-categ_test_withtable.c: New file.
	* tests/unictype/test-combining.c: New file.
	* tests/unictype/test-decdigit.c: New file.
	* tests/unictype/test-digit.c: New file.
	* tests/unictype/test-mirror.c: New file.
	* tests/unictype/test-numeric.c: New file.
	* tests/unictype/test-pr_byname.c: New file.
	* tests/unictype/test-pr_test.c: New file.
	* tests/unictype/test-predicate-part1.h: New file.
	* tests/unictype/test-predicate-part2.h: New file.
	* tests/unictype/test-scripts.c: New file.
	* tests/unictype/test-sy_c_ident.c: New file.
	* tests/unictype/test-sy_java_ident.c: New file.

	* tests/unictype/test-categ_C.c: New file, generated by gen-ctype.c
	for Unicode 5.0.0.
	* tests/unictype/test-categ_Cc.c: Likewise.
	* tests/unictype/test-categ_Cf.c: Likewise.
	* tests/unictype/test-categ_Cn.c: Likewise.
	* tests/unictype/test-categ_Co.c: Likewise.
	* tests/unictype/test-categ_Cs.c: Likewise.
	* tests/unictype/test-categ_L.c: Likewise.
	* tests/unictype/test-categ_Ll.c: Likewise.
	* tests/unictype/test-categ_Lm.c: Likewise.
	* tests/unictype/test-categ_Lo.c: Likewise.
	* tests/unictype/test-categ_Lt.c: Likewise.
	* tests/unictype/test-categ_Lu.c: Likewise.
	* tests/unictype/test-categ_M.c: Likewise.
	* tests/unictype/test-categ_Mc.c: Likewise.
	* tests/unictype/test-categ_Me.c: Likewise.
	* tests/unictype/test-categ_Mn.c: Likewise.
	* tests/unictype/test-categ_N.c: Likewise.
	* tests/unictype/test-categ_Nd.c: Likewise.
	* tests/unictype/test-categ_Nl.c: Likewise.
	* tests/unictype/test-categ_No.c: Likewise.
	* tests/unictype/test-categ_P.c: Likewise.
	* tests/unictype/test-categ_Pc.c: Likewise.
	* tests/unictype/test-categ_Pd.c: Likewise.
	* tests/unictype/test-categ_Pe.c: Likewise.
	* tests/unictype/test-categ_Pf.c: Likewise.
	* tests/unictype/test-categ_Pi.c: Likewise.
	* tests/unictype/test-categ_Po.c: Likewise.
	* tests/unictype/test-categ_Ps.c: Likewise.
	* tests/unictype/test-categ_S.c: Likewise.
	* tests/unictype/test-categ_Sc.c: Likewise.
	* tests/unictype/test-categ_Sk.c: Likewise.
	* tests/unictype/test-categ_Sm.c: Likewise.
	* tests/unictype/test-categ_So.c: Likewise.
	* tests/unictype/test-categ_Z.c: Likewise.
	* tests/unictype/test-categ_Zl.c: Likewise.
	* tests/unictype/test-categ_Zp.c: Likewise.
	* tests/unictype/test-categ_Zs.c: Likewise.
	* tests/unictype/test-ctype_alnum.c: Likewise.
	* tests/unictype/test-ctype_alpha.c: Likewise.
	* tests/unictype/test-ctype_blank.c: Likewise.
	* tests/unictype/test-ctype_cntrl.c: Likewise.
	* tests/unictype/test-ctype_digit.c: Likewise.
	* tests/unictype/test-ctype_graph.c: Likewise.
	* tests/unictype/test-ctype_lower.c: Likewise.
	* tests/unictype/test-ctype_print.c: Likewise.
	* tests/unictype/test-ctype_punct.c: Likewise.
	* tests/unictype/test-ctype_space.c: Likewise.
	* tests/unictype/test-ctype_upper.c: Likewise.
	* tests/unictype/test-ctype_xdigit.c: Likewise.
	* tests/unictype/test-decdigit.h: Likewise.
	* tests/unictype/test-digit.h: Likewise.
	* tests/unictype/test-numeric.h: Likewise.
	* tests/unictype/test-pr_alphabetic.c: Likewise.
	* tests/unictype/test-pr_ascii_hex_digit.c: Likewise.
	* tests/unictype/test-pr_bidi_arabic_digit.c: Likewise.
	* tests/unictype/test-pr_bidi_arabic_right_to_left.c: Likewise.
	* tests/unictype/test-pr_bidi_block_separator.c: Likewise.
	* tests/unictype/test-pr_bidi_boundary_neutral.c: Likewise.
	* tests/unictype/test-pr_bidi_common_separator.c: Likewise.
	* tests/unictype/test-pr_bidi_control.c: Likewise.
	* tests/unictype/test-pr_bidi_embedding_or_override.c: Likewise.
	* tests/unictype/test-pr_bidi_eur_num_separator.c: Likewise.
	* tests/unictype/test-pr_bidi_eur_num_terminator.c: Likewise.
	* tests/unictype/test-pr_bidi_european_digit.c: Likewise.
	* tests/unictype/test-pr_bidi_hebrew_right_to_left.c: Likewise.
	* tests/unictype/test-pr_bidi_left_to_right.c: Likewise.
	* tests/unictype/test-pr_bidi_non_spacing_mark.c: Likewise.
	* tests/unictype/test-pr_bidi_other_neutral.c: Likewise.
	* tests/unictype/test-pr_bidi_pdf.c: Likewise.
	* tests/unictype/test-pr_bidi_segment_separator.c: Likewise.
	* tests/unictype/test-pr_bidi_whitespace.c: Likewise.
	* tests/unictype/test-pr_combining.c: Likewise.
	* tests/unictype/test-pr_composite.c: Likewise.
	* tests/unictype/test-pr_currency_symbol.c: Likewise.
	* tests/unictype/test-pr_dash.c: Likewise.
	* tests/unictype/test-pr_decimal_digit.c: Likewise.
	* tests/unictype/test-pr_default_ignorable_code_point.c: Likewise.
	* tests/unictype/test-pr_deprecated.c: Likewise.
	* tests/unictype/test-pr_diacritic.c: Likewise.
	* tests/unictype/test-pr_extender.c: Likewise.
	* tests/unictype/test-pr_format_control.c: Likewise.
	* tests/unictype/test-pr_grapheme_base.c: Likewise.
	* tests/unictype/test-pr_grapheme_extend.c: Likewise.
	* tests/unictype/test-pr_grapheme_link.c: Likewise.
	* tests/unictype/test-pr_hex_digit.c: Likewise.
	* tests/unictype/test-pr_hyphen.c: Likewise.
	* tests/unictype/test-pr_id_continue.c: Likewise.
	* tests/unictype/test-pr_id_start.c: Likewise.
	* tests/unictype/test-pr_ideographic.c: Likewise.
	* tests/unictype/test-pr_ids_binary_operator.c: Likewise.
	* tests/unictype/test-pr_ids_trinary_operator.c: Likewise.
	* tests/unictype/test-pr_ignorable_control.c: Likewise.
	* tests/unictype/test-pr_iso_control.c: Likewise.
	* tests/unictype/test-pr_join_control.c: Likewise.
	* tests/unictype/test-pr_left_of_pair.c: Likewise.
	* tests/unictype/test-pr_line_separator.c: Likewise.
	* tests/unictype/test-pr_logical_order_exception.c: Likewise.
	* tests/unictype/test-pr_lowercase.c: Likewise.
	* tests/unictype/test-pr_math.c: Likewise.
	* tests/unictype/test-pr_non_break.c: Likewise.
	* tests/unictype/test-pr_not_a_character.c: Likewise.
	* tests/unictype/test-pr_numeric.c: Likewise.
	* tests/unictype/test-pr_other_alphabetic.c: Likewise.
	* tests/unictype/test-pr_other_default_ignorable_code_point.c: Likewise.
	* tests/unictype/test-pr_other_grapheme_extend.c: Likewise.
	* tests/unictype/test-pr_other_id_continue.c: Likewise.
	* tests/unictype/test-pr_other_id_start.c: Likewise.
	* tests/unictype/test-pr_other_lowercase.c: Likewise.
	* tests/unictype/test-pr_other_math.c: Likewise.
	* tests/unictype/test-pr_other_uppercase.c: Likewise.
	* tests/unictype/test-pr_paired_punctuation.c: Likewise.
	* tests/unictype/test-pr_paragraph_separator.c: Likewise.
	* tests/unictype/test-pr_pattern_syntax.c: Likewise.
	* tests/unictype/test-pr_pattern_white_space.c: Likewise.
	* tests/unictype/test-pr_private_use.c: Likewise.
	* tests/unictype/test-pr_punctuation.c: Likewise.
	* tests/unictype/test-pr_quotation_mark.c: Likewise.
	* tests/unictype/test-pr_radical.c: Likewise.
	* tests/unictype/test-pr_sentence_terminal.c: Likewise.
	* tests/unictype/test-pr_soft_dotted.c: Likewise.
	* tests/unictype/test-pr_space.c: Likewise.
	* tests/unictype/test-pr_terminal_punctuation.c: Likewise.
	* tests/unictype/test-pr_titlecase.c: Likewise.
	* tests/unictype/test-pr_unassigned_code_value.c: Likewise.
	* tests/unictype/test-pr_unified_ideograph.c: Likewise.
	* tests/unictype/test-pr_uppercase.c: Likewise.
	* tests/unictype/test-pr_variation_selector.c: Likewise.
	* tests/unictype/test-pr_white_space.c: Likewise.
	* tests/unictype/test-pr_xid_continue.c: Likewise.
	* tests/unictype/test-pr_xid_start.c: Likewise.
	* tests/unictype/test-pr_zero_width.c: Likewise.
	* tests/unictype/test-sy_c_whitespace.c: Likewise.
	* tests/unictype/test-sy_java_whitespace.c: Likewise.

2007-11-12  Bruno Haible  <bruno@clisp.org>

	Unicode character classification functions.
	* lib/unictype.h: New file.
	* modules/unictype/base: New file.
	* modules/unictype/category-L: New file.
	* modules/unictype/category-Lu: New file.
	* modules/unictype/category-Ll: New file.
	* modules/unictype/category-Lt: New file.
	* modules/unictype/category-Lm: New file.
	* modules/unictype/category-Lo: New file.
	* modules/unictype/category-M: New file.
	* modules/unictype/category-Mn: New file.
	* modules/unictype/category-Mc: New file.
	* modules/unictype/category-Me: New file.
	* modules/unictype/category-N: New file.
	* modules/unictype/category-Nd: New file.
	* modules/unictype/category-Nl: New file.
	* modules/unictype/category-No: New file.
	* modules/unictype/category-P: New file.
	* modules/unictype/category-Pc: New file.
	* modules/unictype/category-Pd: New file.
	* modules/unictype/category-Ps: New file.
	* modules/unictype/category-Pe: New file.
	* modules/unictype/category-Pi: New file.
	* modules/unictype/category-Pf: New file.
	* modules/unictype/category-Po: New file.
	* modules/unictype/category-S: New file.
	* modules/unictype/category-Sm: New file.
	* modules/unictype/category-Sc: New file.
	* modules/unictype/category-Sk: New file.
	* modules/unictype/category-So: New file.
	* modules/unictype/category-Z: New file.
	* modules/unictype/category-Zs: New file.
	* modules/unictype/category-Zl: New file.
	* modules/unictype/category-Zp: New file.
	* modules/unictype/category-C: New file.
	* modules/unictype/category-Cc: New file.
	* modules/unictype/category-Cf: New file.
	* modules/unictype/category-Cs: New file.
	* modules/unictype/category-Co: New file.
	* modules/unictype/category-Cn: New file.
	* modules/unictype/category-or: New file.
	* modules/unictype/category-of: New file.
	* modules/unictype/category-test: New file.
	* modules/unictype/category-test-withtable: New file.
	* modules/unictype/category-byname: New file.
	* modules/unictype/category-none: New file.
	* modules/unictype/category-and: New file.
	* modules/unictype/category-and-not: New file.
	* modules/unictype/category-name: New file.
	* modules/unictype/combining-class: New file.
	* modules/unictype/category-all: New file.
	* modules/unictype/bidicategory-all: New file.
	* modules/unictype/bidicategory-byname: New file.
	* modules/unictype/bidicategory-name: New file.
	* modules/unictype/bidicategory-of: New file.
	* modules/unictype/bidicategory-test: New file.
	* modules/unictype/decimal-digit: New file.
	* modules/unictype/digit: New file.
	* modules/unictype/numeric: New file.
	* modules/unictype/mirror: New file.
	* modules/unictype/property-white-space: New file.
	* modules/unictype/property-alphabetic: New file.
	* modules/unictype/property-other-alphabetic: New file.
	* modules/unictype/property-not-a-character: New file.
	* modules/unictype/property-default-ignorable-code-point: New file.
	* modules/unictype/property-other-default-ignorable-code-point: New
	file.
	* modules/unictype/property-deprecated: New file.
	* modules/unictype/property-logical-order-exception: New file.
	* modules/unictype/property-variation-selector: New file.
	* modules/unictype/property-private-use: New file.
	* modules/unictype/property-unassigned-code-value: New file.
	* modules/unictype/property-uppercase: New file.
	* modules/unictype/property-other-uppercase: New file.
	* modules/unictype/property-lowercase: New file.
	* modules/unictype/property-other-lowercase: New file.
	* modules/unictype/property-titlecase: New file.
	* modules/unictype/property-soft-dotted: New file.
	* modules/unictype/property-id-start: New file.
	* modules/unictype/property-other-id-start: New file.
	* modules/unictype/property-id-continue: New file.
	* modules/unictype/property-other-id-continue: New file.
	* modules/unictype/property-xid-start: New file.
	* modules/unictype/property-xid-continue: New file.
	* modules/unictype/property-pattern-white-space: New file.
	* modules/unictype/property-pattern-syntax: New file.
	* modules/unictype/property-join-control: New file.
	* modules/unictype/property-grapheme-base: New file.
	* modules/unictype/property-grapheme-extend: New file.
	* modules/unictype/property-other-grapheme-extend: New file.
	* modules/unictype/property-grapheme-link: New file.
	* modules/unictype/property-bidi-control: New file.
	* modules/unictype/property-bidi-left-to-right: New file.
	* modules/unictype/property-bidi-hebrew-right-to-left: New file.
	* modules/unictype/property-bidi-arabic-right-to-left: New file.
	* modules/unictype/property-bidi-european-digit: New file.
	* modules/unictype/property-bidi-eur-num-separator: New file.
	* modules/unictype/property-bidi-eur-num-terminator: New file.
	* modules/unictype/property-bidi-arabic-digit: New file.
	* modules/unictype/property-bidi-common-separator: New file.
	* modules/unictype/property-bidi-block-separator: New file.
	* modules/unictype/property-bidi-segment-separator: New file.
	* modules/unictype/property-bidi-whitespace: New file.
	* modules/unictype/property-bidi-non-spacing-mark: New file.
	* modules/unictype/property-bidi-boundary-neutral: New file.
	* modules/unictype/property-bidi-pdf: New file.
	* modules/unictype/property-bidi-embedding-or-override: New file.
	* modules/unictype/property-bidi-other-neutral: New file.
	* modules/unictype/property-hex-digit: New file.
	* modules/unictype/property-ascii-hex-digit: New file.
	* modules/unictype/property-ideographic: New file.
	* modules/unictype/property-unified-ideograph: New file.
	* modules/unictype/property-radical: New file.
	* modules/unictype/property-ids-binary-operator: New file.
	* modules/unictype/property-ids-trinary-operator: New file.
	* modules/unictype/property-zero-width: New file.
	* modules/unictype/property-space: New file.
	* modules/unictype/property-non-break: New file.
	* modules/unictype/property-iso-control: New file.
	* modules/unictype/property-format-control: New file.
	* modules/unictype/property-dash: New file.
	* modules/unictype/property-hyphen: New file.
	* modules/unictype/property-punctuation: New file.
	* modules/unictype/property-line-separator: New file.
	* modules/unictype/property-paragraph-separator: New file.
	* modules/unictype/property-quotation-mark: New file.
	* modules/unictype/property-sentence-terminal: New file.
	* modules/unictype/property-terminal-punctuation: New file.
	* modules/unictype/property-currency-symbol: New file.
	* modules/unictype/property-math: New file.
	* modules/unictype/property-other-math: New file.
	* modules/unictype/property-paired-punctuation: New file.
	* modules/unictype/property-left-of-pair: New file.
	* modules/unictype/property-combining: New file.
	* modules/unictype/property-composite: New file.
	* modules/unictype/property-decimal-digit: New file.
	* modules/unictype/property-numeric: New file.
	* modules/unictype/property-diacritic: New file.
	* modules/unictype/property-extender: New file.
	* modules/unictype/property-ignorable-control: New file.
	* modules/unictype/property-test: New file.
	* modules/unictype/property-byname: New file.
	* modules/unictype/property-all: New file.
	* modules/unictype/scripts: New file.
	* modules/unictype/scripts-all: New file.
	* modules/unictype/block-of: New file.
	* modules/unictype/block-test: New file.
	* modules/unictype/block-list: New file.
	* modules/unictype/block-all: New file.
	* modules/unictype/syntax-c-whitespace: New file.
	* modules/unictype/syntax-java-whitespace: New file.
	* modules/unictype/syntax-c-ident: New file.
	* modules/unictype/syntax-java-ident: New file.
	* modules/unictype/ctype-alnum: New file.
	* modules/unictype/ctype-alpha: New file.
	* modules/unictype/ctype-cntrl: New file.
	* modules/unictype/ctype-digit: New file.
	* modules/unictype/ctype-graph: New file.
	* modules/unictype/ctype-lower: New file.
	* modules/unictype/ctype-print: New file.
	* modules/unictype/ctype-punct: New file.
	* modules/unictype/ctype-space: New file.
	* modules/unictype/ctype-upper: New file.
	* modules/unictype/ctype-xdigit: New file.
	* modules/unictype/ctype-blank: New file.
	* lib/unictype/bidi_byname.c: New file.
	* lib/unictype/bidi_name.c: New file.
	* lib/unictype/bidi_of.c: New file.
	* lib/unictype/bidi_test.c: New file.
	* lib/unictype/bitmap.h: New file.
	* lib/unictype/block_test.c: New file.
	* lib/unictype/blocks.c: New file.
	* lib/unictype/categ_C.c: New file.
	* lib/unictype/categ_Cc.c: New file.
	* lib/unictype/categ_Cf.c: New file.
	* lib/unictype/categ_Cn.c: New file.
	* lib/unictype/categ_Co.c: New file.
	* lib/unictype/categ_Cs.c: New file.
	* lib/unictype/categ_L.c: New file.
	* lib/unictype/categ_Ll.c: New file.
	* lib/unictype/categ_Lm.c: New file.
	* lib/unictype/categ_Lo.c: New file.
	* lib/unictype/categ_Lt.c: New file.
	* lib/unictype/categ_Lu.c: New file.
	* lib/unictype/categ_M.c: New file.
	* lib/unictype/categ_Mc.c: New file.
	* lib/unictype/categ_Me.c: New file.
	* lib/unictype/categ_Mn.c: New file.
	* lib/unictype/categ_N.c: New file.
	* lib/unictype/categ_Nd.c: New file.
	* lib/unictype/categ_Nl.c: New file.
	* lib/unictype/categ_No.c: New file.
	* lib/unictype/categ_P.c: New file.
	* lib/unictype/categ_Pc.c: New file.
	* lib/unictype/categ_Pd.c: New file.
	* lib/unictype/categ_Pe.c: New file.
	* lib/unictype/categ_Pf.c: New file.
	* lib/unictype/categ_Pi.c: New file.
	* lib/unictype/categ_Po.c: New file.
	* lib/unictype/categ_Ps.c: New file.
	* lib/unictype/categ_S.c: New file.
	* lib/unictype/categ_Sc.c: New file.
	* lib/unictype/categ_Sk.c: New file.
	* lib/unictype/categ_Sm.c: New file.
	* lib/unictype/categ_So.c: New file.
	* lib/unictype/categ_Z.c: New file.
	* lib/unictype/categ_Zl.c: New file.
	* lib/unictype/categ_Zp.c: New file.
	* lib/unictype/categ_Zs.c: New file.
	* lib/unictype/categ_and.c: New file.
	* lib/unictype/categ_and_not.c: New file.
	* lib/unictype/categ_byname.c: New file.
	* lib/unictype/categ_name.c: New file.
	* lib/unictype/categ_none.c: New file.
	* lib/unictype/categ_of.c: New file.
	* lib/unictype/categ_or.c: New file.
	* lib/unictype/categ_test.c: New file.
	* lib/unictype/combining.c: New file.
	* lib/unictype/ctype_alnum.c: New file.
	* lib/unictype/ctype_alpha.c: New file.
	* lib/unictype/ctype_blank.c: New file.
	* lib/unictype/ctype_cntrl.c: New file.
	* lib/unictype/ctype_digit.c: New file.
	* lib/unictype/ctype_graph.c: New file.
	* lib/unictype/ctype_lower.c: New file.
	* lib/unictype/ctype_print.c: New file.
	* lib/unictype/ctype_punct.c: New file.
	* lib/unictype/ctype_space.c: New file.
	* lib/unictype/ctype_upper.c: New file.
	* lib/unictype/ctype_xdigit.c: New file.
	* lib/unictype/decdigit.c: New file.
	* lib/unictype/digit.c: New file.
	* lib/unictype/identsyntaxmap.h: New file.
	* lib/unictype/mirror.c: New file.
	* lib/unictype/numeric.c: New file.
	* lib/unictype/pr_alphabetic.c: New file.
	* lib/unictype/pr_ascii_hex_digit.c: New file.
	* lib/unictype/pr_bidi_arabic_digit.c: New file.
	* lib/unictype/pr_bidi_arabic_right_to_left.c: New file.
	* lib/unictype/pr_bidi_block_separator.c: New file.
	* lib/unictype/pr_bidi_boundary_neutral.c: New file.
	* lib/unictype/pr_bidi_common_separator.c: New file.
	* lib/unictype/pr_bidi_control.c: New file.
	* lib/unictype/pr_bidi_embedding_or_override.c: New file.
	* lib/unictype/pr_bidi_eur_num_separator.c: New file.
	* lib/unictype/pr_bidi_eur_num_terminator.c: New file.
	* lib/unictype/pr_bidi_european_digit.c: New file.
	* lib/unictype/pr_bidi_hebrew_right_to_left.c: New file.
	* lib/unictype/pr_bidi_left_to_right.c: New file.
	* lib/unictype/pr_bidi_non_spacing_mark.c: New file.
	* lib/unictype/pr_bidi_other_neutral.c: New file.
	* lib/unictype/pr_bidi_pdf.c: New file.
	* lib/unictype/pr_bidi_segment_separator.c: New file.
	* lib/unictype/pr_bidi_whitespace.c: New file.
	* lib/unictype/pr_byname.c: New file.
	* lib/unictype/pr_byname.gperf: New file.
	* lib/unictype/pr_combining.c: New file.
	* lib/unictype/pr_composite.c: New file.
	* lib/unictype/pr_currency_symbol.c: New file.
	* lib/unictype/pr_dash.c: New file.
	* lib/unictype/pr_decimal_digit.c: New file.
	* lib/unictype/pr_default_ignorable_code_point.c: New file.
	* lib/unictype/pr_deprecated.c: New file.
	* lib/unictype/pr_diacritic.c: New file.
	* lib/unictype/pr_extender.c: New file.
	* lib/unictype/pr_format_control.c: New file.
	* lib/unictype/pr_grapheme_base.c: New file.
	* lib/unictype/pr_grapheme_extend.c: New file.
	* lib/unictype/pr_grapheme_link.c: New file.
	* lib/unictype/pr_hex_digit.c: New file.
	* lib/unictype/pr_hyphen.c: New file.
	* lib/unictype/pr_id_continue.c: New file.
	* lib/unictype/pr_id_start.c: New file.
	* lib/unictype/pr_ideographic.c: New file.
	* lib/unictype/pr_ids_binary_operator.c: New file.
	* lib/unictype/pr_ids_trinary_operator.c: New file.
	* lib/unictype/pr_ignorable_control.c: New file.
	* lib/unictype/pr_iso_control.c: New file.
	* lib/unictype/pr_join_control.c: New file.
	* lib/unictype/pr_left_of_pair.c: New file.
	* lib/unictype/pr_line_separator.c: New file.
	* lib/unictype/pr_logical_order_exception.c: New file.
	* lib/unictype/pr_lowercase.c: New file.
	* lib/unictype/pr_math.c: New file.
	* lib/unictype/pr_non_break.c: New file.
	* lib/unictype/pr_not_a_character.c: New file.
	* lib/unictype/pr_numeric.c: New file.
	* lib/unictype/pr_other_alphabetic.c: New file.
	* lib/unictype/pr_other_default_ignorable_code_point.c: New file.
	* lib/unictype/pr_other_grapheme_extend.c: New file.
	* lib/unictype/pr_other_id_continue.c: New file.
	* lib/unictype/pr_other_id_start.c: New file.
	* lib/unictype/pr_other_lowercase.c: New file.
	* lib/unictype/pr_other_math.c: New file.
	* lib/unictype/pr_other_uppercase.c: New file.
	* lib/unictype/pr_paired_punctuation.c: New file.
	* lib/unictype/pr_paragraph_separator.c: New file.
	* lib/unictype/pr_pattern_syntax.c: New file.
	* lib/unictype/pr_pattern_white_space.c: New file.
	* lib/unictype/pr_private_use.c: New file.
	* lib/unictype/pr_punctuation.c: New file.
	* lib/unictype/pr_quotation_mark.c: New file.
	* lib/unictype/pr_radical.c: New file.
	* lib/unictype/pr_sentence_terminal.c: New file.
	* lib/unictype/pr_soft_dotted.c: New file.
	* lib/unictype/pr_space.c: New file.
	* lib/unictype/pr_terminal_punctuation.c: New file.
	* lib/unictype/pr_test.c: New file.
	* lib/unictype/pr_titlecase.c: New file.
	* lib/unictype/pr_unassigned_code_value.c: New file.
	* lib/unictype/pr_unified_ideograph.c: New file.
	* lib/unictype/pr_uppercase.c: New file.
	* lib/unictype/pr_variation_selector.c: New file.
	* lib/unictype/pr_white_space.c: New file.
	* lib/unictype/pr_xid_continue.c: New file.
	* lib/unictype/pr_xid_start.c: New file.
	* lib/unictype/pr_zero_width.c: New file.
	* lib/unictype/scripts.c: New file.
	* lib/unictype/sy_c_ident.c: New file.
	* lib/unictype/sy_c_whitespace.c: New file.
	* lib/unictype/sy_java_ident.c: New file.
	* lib/unictype/sy_java_whitespace.c: New file.

	* lib/unictype/bidi_of.h: New file, generated by gen-ctype.c for
	Unicode 5.0.0.
	* lib/unictype/blocks.h: Likewise.
	* lib/unictype/categ_C.h: Likewise.
	* lib/unictype/categ_Cc.h: Likewise.
	* lib/unictype/categ_Cf.h: Likewise.
	* lib/unictype/categ_Cn.h: Likewise.
	* lib/unictype/categ_Co.h: Likewise.
	* lib/unictype/categ_Cs.h: Likewise.
	* lib/unictype/categ_L.h: Likewise.
	* lib/unictype/categ_Ll.h: Likewise.
	* lib/unictype/categ_Lm.h: Likewise.
	* lib/unictype/categ_Lo.h: Likewise.
	* lib/unictype/categ_Lt.h: Likewise.
	* lib/unictype/categ_Lu.h: Likewise.
	* lib/unictype/categ_M.h: Likewise.
	* lib/unictype/categ_Mc.h: Likewise.
	* lib/unictype/categ_Me.h: Likewise.
	* lib/unictype/categ_Mn.h: Likewise.
	* lib/unictype/categ_N.h: Likewise.
	* lib/unictype/categ_Nd.h: Likewise.
	* lib/unictype/categ_Nl.h: Likewise.
	* lib/unictype/categ_No.h: Likewise.
	* lib/unictype/categ_P.h: Likewise.
	* lib/unictype/categ_Pc.h: Likewise.
	* lib/unictype/categ_Pd.h: Likewise.
	* lib/unictype/categ_Pe.h: Likewise.
	* lib/unictype/categ_Pf.h: Likewise.
	* lib/unictype/categ_Pi.h: Likewise.
	* lib/unictype/categ_Po.h: Likewise.
	* lib/unictype/categ_Ps.h: Likewise.
	* lib/unictype/categ_S.h: Likewise.
	* lib/unictype/categ_Sc.h: Likewise.
	* lib/unictype/categ_Sk.h: Likewise.
	* lib/unictype/categ_Sm.h: Likewise.
	* lib/unictype/categ_So.h: Likewise.
	* lib/unictype/categ_Z.h: Likewise.
	* lib/unictype/categ_Zl.h: Likewise.
	* lib/unictype/categ_Zp.h: Likewise.
	* lib/unictype/categ_Zs.h: Likewise.
	* lib/unictype/categ_of.h: Likewise.
	* lib/unictype/combining.h: Likewise.
	* lib/unictype/ctype_alnum.h: Likewise.
	* lib/unictype/ctype_alpha.h: Likewise.
	* lib/unictype/ctype_blank.h: Likewise.
	* lib/unictype/ctype_cntrl.h: Likewise.
	* lib/unictype/ctype_digit.h: Likewise.
	* lib/unictype/ctype_graph.h: Likewise.
	* lib/unictype/ctype_lower.h: Likewise.
	* lib/unictype/ctype_print.h: Likewise.
	* lib/unictype/ctype_punct.h: Likewise.
	* lib/unictype/ctype_space.h: Likewise.
	* lib/unictype/ctype_upper.h: Likewise.
	* lib/unictype/ctype_xdigit.h: Likewise.
	* lib/unictype/decdigit.h: Likewise.
	* lib/unictype/digit.h: Likewise.
	* lib/unictype/mirror.h: Likewise.
	* lib/unictype/numeric.h: Likewise.
	* lib/unictype/pr_alphabetic.h: Likewise.
	* lib/unictype/pr_ascii_hex_digit.h: Likewise.
	* lib/unictype/pr_bidi_arabic_digit.h: Likewise.
	* lib/unictype/pr_bidi_arabic_right_to_left.h: Likewise.
	* lib/unictype/pr_bidi_block_separator.h: Likewise.
	* lib/unictype/pr_bidi_boundary_neutral.h: Likewise.
	* lib/unictype/pr_bidi_common_separator.h: Likewise.
	* lib/unictype/pr_bidi_control.h: Likewise.
	* lib/unictype/pr_bidi_embedding_or_override.h: Likewise.
	* lib/unictype/pr_bidi_eur_num_separator.h: Likewise.
	* lib/unictype/pr_bidi_eur_num_terminator.h: Likewise.
	* lib/unictype/pr_bidi_european_digit.h: Likewise.
	* lib/unictype/pr_bidi_hebrew_right_to_left.h: Likewise.
	* lib/unictype/pr_bidi_left_to_right.h: Likewise.
	* lib/unictype/pr_bidi_non_spacing_mark.h: Likewise.
	* lib/unictype/pr_bidi_other_neutral.h: Likewise.
	* lib/unictype/pr_bidi_pdf.h: Likewise.
	* lib/unictype/pr_bidi_segment_separator.h: Likewise.
	* lib/unictype/pr_bidi_whitespace.h: Likewise.
	* lib/unictype/pr_combining.h: Likewise.
	* lib/unictype/pr_composite.h: Likewise.
	* lib/unictype/pr_currency_symbol.h: Likewise.
	* lib/unictype/pr_dash.h: Likewise.
	* lib/unictype/pr_decimal_digit.h: Likewise.
	* lib/unictype/pr_default_ignorable_code_point.h: Likewise.
	* lib/unictype/pr_deprecated.h: Likewise.
	* lib/unictype/pr_diacritic.h: Likewise.
	* lib/unictype/pr_extender.h: Likewise.
	* lib/unictype/pr_format_control.h: Likewise.
	* lib/unictype/pr_grapheme_base.h: Likewise.
	* lib/unictype/pr_grapheme_extend.h: Likewise.
	* lib/unictype/pr_grapheme_link.h: Likewise.
	* lib/unictype/pr_hex_digit.h: Likewise.
	* lib/unictype/pr_hyphen.h: Likewise.
	* lib/unictype/pr_id_continue.h: Likewise.
	* lib/unictype/pr_id_start.h: Likewise.
	* lib/unictype/pr_ideographic.h: Likewise.
	* lib/unictype/pr_ids_binary_operator.h: Likewise.
	* lib/unictype/pr_ids_trinary_operator.h: Likewise.
	* lib/unictype/pr_ignorable_control.h: Likewise.
	* lib/unictype/pr_iso_control.h: Likewise.
	* lib/unictype/pr_join_control.h: Likewise.
	* lib/unictype/pr_left_of_pair.h: Likewise.
	* lib/unictype/pr_line_separator.h: Likewise.
	* lib/unictype/pr_logical_order_exception.h: Likewise.
	* lib/unictype/pr_lowercase.h: Likewise.
	* lib/unictype/pr_math.h: Likewise.
	* lib/unictype/pr_non_break.h: Likewise.
	* lib/unictype/pr_not_a_character.h: Likewise.
	* lib/unictype/pr_numeric.h: Likewise.
	* lib/unictype/pr_other_alphabetic.h: Likewise.
	* lib/unictype/pr_other_default_ignorable_code_point.h: Likewise.
	* lib/unictype/pr_other_grapheme_extend.h: Likewise.
	* lib/unictype/pr_other_id_continue.h: Likewise.
	* lib/unictype/pr_other_id_start.h: Likewise.
	* lib/unictype/pr_other_lowercase.h: Likewise.
	* lib/unictype/pr_other_math.h: Likewise.
	* lib/unictype/pr_other_uppercase.h: Likewise.
	* lib/unictype/pr_paired_punctuation.h: Likewise.
	* lib/unictype/pr_paragraph_separator.h: Likewise.
	* lib/unictype/pr_pattern_syntax.h: Likewise.
	* lib/unictype/pr_pattern_white_space.h: Likewise.
	* lib/unictype/pr_private_use.h: Likewise.
	* lib/unictype/pr_punctuation.h: Likewise.
	* lib/unictype/pr_quotation_mark.h: Likewise.
	* lib/unictype/pr_radical.h: Likewise.
	* lib/unictype/pr_sentence_terminal.h: Likewise.
	* lib/unictype/pr_soft_dotted.h: Likewise.
	* lib/unictype/pr_space.h: Likewise.
	* lib/unictype/pr_terminal_punctuation.h: Likewise.
	* lib/unictype/pr_titlecase.h: Likewise.
	* lib/unictype/pr_unassigned_code_value.h: Likewise.
	* lib/unictype/pr_unified_ideograph.h: Likewise.
	* lib/unictype/pr_uppercase.h: Likewise.
	* lib/unictype/pr_variation_selector.h: Likewise.
	* lib/unictype/pr_white_space.h: Likewise.
	* lib/unictype/pr_xid_continue.h: Likewise.
	* lib/unictype/pr_xid_start.h: Likewise.
	* lib/unictype/pr_zero_width.h: Likewise.
	* lib/unictype/scripts.h: Likewise.
	* lib/unictype/scripts_byname.gperf: Likewise.
	* lib/unictype/sy_c_ident.h: Likewise.
	* lib/unictype/sy_c_whitespace.h: Likewise.
	* lib/unictype/sy_java_ident.h: Likewise.
	* lib/unictype/sy_java_whitespace.h: Likewise.

	* lib/unictype/Makefile: New file.
	* lib/unictype/gen-ctype.c: New file, based on gen-unicode-ctype.c in
	glibc.
	* lib/unictype/3level.h: New file, copied from glibc.
	* lib/unictype/3levelbit.h: New file.

2007-11-11  Bruno Haible  <bruno@clisp.org>

	* modules/gperf: New file.
	* modules/iconv_open (Depends-on): Add it.
	(Makefile.am): Remove the GPERF definition.

2007-11-11  Bruno Haible  <bruno@clisp.org>

	* m4/round.m4 (gl_FUNC_ROUND): Test against NetBSD 3.0 bug.
	* doc/functions/round.texi: Mention the NetBSD 3.0 bug.

2007-11-11  Bruno Haible  <bruno@clisp.org>

	* tests/test-argmatch.c (ARGMATCH_DIE): Undefine.
	(usage): Remove function.

2007-11-11  Bruno Haible  <bruno@clisp.org>

	* m4/roundf.m4 (gl_FUNC_ROUNDF): Use gl_FUNC_FLOORF_LIBS and
	gl_FUNC_CEILF_LIBS.
	* m4/round.m4 (gl_FUNC_ROUND): Use gl_FUNC_FLOOR_LIBS and
	gl_FUNC_CEIL_LIBS.
	* m4/roundl.m4 (gl_FUNC_ROUNDL): Use gl_FUNC_FLOORL_LIBS and
	gl_FUNC_CEILL_LIBS.
	* modules/roundf (Files): Add m4/floorf.m4, m4/ceilf.m4.
	* modules/round (Files): Add m4/floor.m4, m4/ceil.m4.
	* modules/roundl (Files): Add m4/floorl.m4, m4/ceill.m4.

2007-11-11  Bruno Haible  <bruno@clisp.org>

	* m4/roundf.m4 (gl_FUNC_ROUNDF): Handle the case that floorf and
	roundf were declared but do not exist on functions.
	* m4/roundl.m4 (gl_FUNC_ROUNDL): Handle the case that floorl and
	roundl were declared but do not exist on functions.
	* lib/round.c (HAVE_FLOOR_AND_CEIL): Use HAVE_FLOORF_AND_CEILF and
	HAVE_FLOORL_AND_CEILL, respectively.
	Needed for Sun C on Solaris 10.

2007-11-11  Bruno Haible  <bruno@clisp.org>

	* m4/roundf.m4 (gl_FUNC_ROUNDF): Set REPLACE_ROUNDF instead of
	HAVE_DECL_ROUNDF. Remove redundant AC_SUBST.
	* m4/round.m4 (gl_FUNC_ROUND): Set REPLACE_ROUND instead of
	HAVE_DECL_ROUND. Remove redundant AC_SUBST.
	* m4/roundl.m4 (gl_FUNC_ROUNDL): Set REPLACE_ROUNDL instead of
	HAVE_DECL_ROUNDL. Remove redundant AC_SUBST.
	* lib/math.in.h (roundf): Use REPLACE_ROUNDF instead of
	HAVE_DECL_ROUNDF.
	(round): Use REPLACE_ROUND instead of HAVE_DECL_ROUND.
	(roundl): Use REPLACE_ROUNDL instead of HAVE_DECL_ROUNDL.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize REPLACE_ROUND* instead
	of HAVE_DECL_ROUND*.
	* modules/math (Makefile.am): Update.

2007-11-10  Bruno Haible  <bruno@clisp.org>

	* m4/vasnprintf.m4 (gl_PREREQ_PRINTF_PARSE): Use same check for
	ptrdiff_t as m4/intl.m4.

2007-11-10  Jim Meyering  <meyering@redhat.com>

	Avoid link failure for the argmatch test.
	* tests/test-argmatch.c (usage): Define function to avoid a link
	failure: argmatch_die requires a usage function.

2007-11-09  Bruno Haible  <bruno@clisp.org>

	* doc/functions/snprintf.texi: Mention BeOS deficiency.
	* doc/functions/vsnprintf.texi: Likewise.
	* lib/vasnprintf.c (VASNPRINTF): Ensure that we never call snprintf
	with a size argument < 2.

2007-11-09  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Increase reallocation of snprintf
	buffer. Fixes an inefficiency introduced on 2007-11-03.

2007-11-09  Bruno Haible  <bruno@clisp.org>

	* m4/locale-tr.m4 (gt_LOCALE_TR_UTF8) [BeOS]: Make this test return
	none instead of tr_TR. Fixes a failure of test-c-strcasecmp.c.

2007-11-08  Jim Meyering  <meyering@redhat.com>

	Change cache variable name prefix "jm_" to "gl_" everywhere.
	* m4/d-type.m4, m4/jm-winsz1.m4, m4/jm-winsz2.m4, m4/link-follow.m4:
	* m4/putenv.m4, m4/strtoimax.m4, m4/strtoumax.m4, m4/unlink-busy.m4:
	* m4/uptime.m4: s/gl_/jm_/

2007-11-07  Bruno Haible  <bruno@clisp.org>

	Update to GNU gettext 0.17.
	* m4/intl.m4: Update to GNU gettext 0.17.
	* m4/po.m4: Likewise.
	* modules/gettext (Files): Remove m4/ulonglong.m4.
	(configure.ac): Require gettext infrastructure from version 0.17.

2007-11-06  Bruno Haible  <bruno@clisp.org>

	* lib/fbufmode.c (fbufmode) [QNX]: Use numerical values for flags; the
	symbolic values are not defined in a public header.
	* lib/freadable.c (freadable) [QNX]: Likewise.
	* lib/freadahead.c (freadahead) [QNX]: Likewise.
	* lib/freading.c (freading) [QNX]: Likewise.
	* lib/fseterr.c (fseterr) [QNX]: Likewise.
	* lib/fwritable.c (fwritable) [QNX]: Likewise.
	* lib/fwriting.c (fwriting) [QNX]: Likewise.
	* lib/fpurge.c (fpurge) [QNX]: Likewise. Add a return statement.
	Reported by Alain Magloire.

	* m4/fpending.m4 (gl_FUNC_FPENDING): Add a variant for QNX.

2007-11-05  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Expand the NEED_PRINTF_DIRECTIVE_A
	code when NEED_PRINTF_LONG_DOUBLE or NEED_PRINTF_DOUBLE is set.
	Needed on Cygwin, where !NEED_PRINTF_DIRECTIVE_A && NEED_PRINTF_DOUBLE.
	Reported by Eric Blake.

2007-10-27  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Bruno Haible  <bruno@clisp.org>

	* modules/malloc (configure.ac): Define GNULIB_MALLOC_GNU always.
	* modules/realloc (configure.ac): Define GNULIB_REALLOC_GNU always.
	* lib/realloc.c (SYSTEM_MALLOC_GLIBC_COMPATIBLE): New macro.
	(malloc): Undefine also before including <stdlib.h>.
	(rpl_realloc): Turn malloc(0) into malloc(1) if necessary.
	Needed on OSF/1 4.0.

2007-11-05  Jim Meyering  <meyering@redhat.com>

	git-version-gen: sync from coreutils.
	* build-aux/git-version-gen: Add comments.
	Change the first '-' to '.' in the snapshot version string,
	e.g., 6.9-377-08144 -> 6.9.377-08144
	Remove first parameter.
	Don't declare a version "-dirty" merely because a time
	stamp has changed.

2007-11-04  Bruno Haible  <bruno@clisp.org>

	* lib/lock.h: Protect all macro definitions containing an 'if'
	statement through a "do { ... } while (0)".
	* lib/tls.h: Likewise.

2007-11-04  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (DCHAR_IS_TCHAR, DCHAR_CPY): Undefine at the end.

2007-11-04  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_ENOMEM): Use GL_NOCRASH.
	* modules/fprintf-posix (Depends-on): Add nocrash.
	* modules/snprintf-posix (Depends-on): Likewise.
	* modules/sprintf-posix (Depends-on): Likewise.
	* modules/vasnprintf-posix (Depends-on): Likewise.
	* modules/vasprintf-posix (Depends-on): Likewise.
	* modules/vfprintf-posix (Depends-on): Likewise.
	* modules/vsnprintf-posix (Depends-on): Likewise.
	* modules/vsprintf-posix (Depends-on): Likewise.
	* modules/unistdio/u8-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u8-u8-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u16-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u16-u16-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u32-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/u32-u32-vasnprintf (Depends-on): Likewise.
	* modules/unistdio/ulc-vasnprintf (Depends-on): Likewise.

2007-11-04  Bruno Haible  <bruno@clisp.org>

	* modules/nocrash: New file.
	* m4/nocrash.m4: New file, taken from GNU clisp. Code taken from
	GNU libsigsegv, with permission of GNU libsigsegv's copyright holders.

2007-11-04  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (test_function): Add some tests of
	precision handling.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.

	Fix *printf behaviour for large precisions on mingw and BeOS.
	* m4/printf.m4 (gl_PRINTF_PRECISION): New macro.
	* lib/vasnprintf.c (VASNPRINTF): Handle NEED_PRINTF_UNBOUNDED_PRECISION.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_PRECISION): New macro.
	(gl_PREREQ_VASNPRINTF_WITH_EXTRAS): Invoke it.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Invoke
	gl_PRINTF_PRECISION and test its result. Invoke
	gl_PREREQ_VASNPRINTF_PRECISION.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Likewise.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	* doc/functions/fprintf.texi: Update.
	* doc/functions/printf.texi: Update.
	* doc/functions/snprintf.texi: Update.
	* doc/functions/sprintf.texi: Update.
	* doc/functions/vfprintf.texi: Update.
	* doc/functions/vprintf.texi: Update.
	* doc/functions/vsnprintf.texi: Update.
	* doc/functions/vsprintf.texi: Update.

2007-11-04  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (scale10_round_decimal_decoded): Fix shift loop.

2007-11-04  Bruno Haible  <bruno@clisp.org>

	* modules/relocatable-prog (Files): Add m4/lib-ld.m4.
	Reported by Sylvain Beucler <beuc@gnu.org>.

2007-11-03  Bruno Haible  <bruno@clisp.org>

	* tests/test-fprintf-posix2.sh: New file.
	* tests/test-fprintf-posix2.c: New file.
	* modules/fprintf-posix-tests (Files): Add them.
	(TESTS): Add test-fprintf-posix2.sh.
	(configure.ac): Check for getrlimit and setrlimit.
	(check_PROGRAMS): Add test-fprintf-posix2.

	* tests/test-printf-posix2.sh: New file.
	* tests/test-printf-posix2.c: New file.
	* modules/printf-posix-tests (Files): Add them.
	(TESTS): Add test-printf-posix2.sh.
	(configure.ac): Check for getrlimit and setrlimit.
	(check_PROGRAMS): Add test-printf-posix2.

	Fix *printf behaviour in out-of-memory situations on MacOS X and *BSD.
	* m4/printf.m4 (gl_PRINTF_ENOMEM): New macro.
	* lib/vasnprintf.c: Implement NEED_PRINTF_DOUBLE.
	(decode_double): New function, copied from decode_long_double.
	(scale10_round_decimal_decoded): New function, extracted from
	scale10_round_decimal_long_double.
	(scale10_round_decimal_long_double): Use it.
	(scale10_round_decimal_double): New function.
	(floorlog10): New function.
	(VASNPRINTF): Handle NEED_PRINTF_DOUBLE case.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_ENOMEM): New macro.
	(gl_PREREQ_VASNPRINTF_WITH_EXTRAS): Invoke it.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Invoke
	gl_PRINTF_ENOMEM and test its result. Invoke
	gl_PREREQ_VASNPRINTF_ENOMEM.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Likewise.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	* modules/fprintf-posix (Depends-on): Add frexp-nolibm.
	* modules/snprintf-posix (Depends-on): Likewise.
	* modules/sprintf-posix (Depends-on): Likewise.
	* modules/vasnprintf-posix (Depends-on): Likewise.
	* modules/vasprintf-posix (Depends-on): Likewise.
	* modules/vfprintf-posix (Depends-on): Likewise.
	* modules/vsnprintf-posix (Depends-on): Likewise.
	* modules/vsprintf-posix (Depends-on): Likewise.
	* doc/functions/fprintf.texi: Update.
	* doc/functions/printf.texi: Update.
	* doc/functions/snprintf.texi: Update.
	* doc/functions/sprintf.texi: Update.
	* doc/functions/vfprintf.texi: Update.
	* doc/functions/vprintf.texi: Update.
	* doc/functions/vsnprintf.texi: Update.
	* doc/functions/vsprintf.texi: Update.

2007-11-03  Bruno Haible  <bruno@clisp.org>

	* modules/frexp-nolibm-tests: New file.

	* modules/frexp-nolibm: New file.
	* m4/frexp.m4 (gl_FUNC_FREXP_NO_LIBM): New macro.

2007-11-03  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Don't assume that snprintf's return
	value is C99 compliant.
	Needed for OSF/1 5.1.

2007-11-03  Bruno Haible  <bruno@clisp.org>

	Fix out-of-memory handling of vasnprintf.
	* lib/printf-parse.c: Include <errno.h>.
	(PRINTF_PARSE): When failing, set errno to EINVAL or ENOMEM.
	* lib/vasnprintf.c (VASNPRINTF): When PRINTF_PARSE fails, assume errno
	is already set.

2007-11-02  Eric Blake  <ebb9@byu.net>

	Fix tests on cygwin.
	* modules/xprintf-posix-tests (Makefile.am): Link against -lintl.

2007-11-01  Bruno Haible  <bruno@clisp.org>

	* lib/stdlib.in.h (putenv): Remove the "not POSIX compliant everywhere"
	warning.
	* doc/functions/putenv.texi: Clarify that the 'putenv' module is not
	needed for POSIX compatibility.

2007-11-01  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/putenv.m4 (gl_FUNC_PUTENV): Also mention that we're checking
	for compatibility with GNU.

2007-11-01  Bruno Haible  <bruno@clisp.org>

	* lib/putenv.c: Include <stdlib.h>. Remove rpl_putenv declaration.
	(putenv): Renamed from rpl_putenv. Change argument type from
	'const char *' to 'char *'.
	* m4/putenv.m4 (gl_FUNC_PUTENV): Require gl_STDLIB_H_DEFAULTS. Instead
	of defining putenv in config.h, just set REPLACE_PUTENV.
	* modules/putenv (Depends-on): Add stdlib.
	(configure.ac): Invoke gl_STDLIB_MODULE_INDICATOR.
	(Include): Use <stdlib.h>.
	* lib/stdlib.in.h (putenv): New declaration.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Initialize GNULIB_PUTENV and
	REPLACE_PUTENV.
	* modules/stdlib (Makefile.am): Substitute GNULIB_PUTENV and
	REPLACE_PUTENV.
	Needed for MacOS X 10.5.0.
	Reported by Peter O'Gorman <peter@pogma.com>.

2007-11-01  Jim Meyering  <meyering@redhat.com>

	Treat an empty date string exactly like "0".
	* lib/getdate.y (get_date): Once any isspace or TZ= prefix is consumed,
	if the remaining date string (to be parsed) is empty, use "0".
	Reported by Mischa Molhoek and discussed in this thread:
	<http://thread.gmane.org/gmane.comp.gnu.coreutils.bugs/11726>.

2007-10-31  Bruno Haible  <bruno@clisp.org>

	* m4/intmax_t.m4 (gl_AC_TYPE_INTMAX_T, gt_AC_TYPE_INTMAX_T): Use
	AC_TYPE_LONG_LONG_INT instead of gl_AC_TYPE_LONG_LONG.
	* m4/uintmax_t.m4 (gl_AC_TYPE_UINTMAX_T): Use
	AC_TYPE_UNSIGNED_LONG_LONG_INT instead of gl_AC_TYPE_UNSIGNED_LONG_LONG.
	* m4/longlong.m4 (gl_AC_TYPE_LONG_LONG): Remove macro.
	* m4/ulonglong.m4 (gl_AC_TYPE_UNSIGNED_LONG_LONG): Remove macro.

2007-10-31  Bruno Haible  <bruno@clisp.org>

	* m4/longlong.m4 (_AC_TYPE_LONG_LONG_SNIPPET): New macro, extracted
	from AC_TYPE_LONG_LONG_INT and AC_TYPE_UNSIGNED_LONG_LONG_INT.
	(AC_TYPE_LONG_LONG_INT): Use it.
	(AC_TYPE_UNSIGNED_LONG_LONG_INT): Moved here from m4/ulonglong.m4. Use
	it as well.
	* m4/ulonglong.m4 (AC_TYPE_UNSIGNED_LONG_LONG_INT): Remove macro; moved
	to m4/longlong.m4.
	* modules/stdint (Files): Remove m4/ulonglong.m4.
	* modules/strtoull (Files): Use m4/longlong.m4 instead of
	m4/ulonglong.m4.
	* modules/strtoumax (Files): Likewise.

2007-10-30  Bruno Haible  <bruno@clisp.org>

	* modules/xvasprintf-posix: New file.
	Suggested by Eric Blake.

2007-10-30  Bruno Haible  <bruno@clisp.org>

	* modules/xprintf-posix-tests: New file.
	* tests/test-xprintf-posix.sh: New file.
	* tests/test-xprintf-posix.c: New file.
	* tests/test-xfprintf-posix.c: New file.

	* modules/xprintf-posix: New file.

2007-10-30  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* modules/fbufmode-tests (MOSTLYCLEANFILES): Remove temp files.
	* modules/freadable-tests (MOSTLYCLEANFILES): Likewise.
	* modules/fwritable-tests (MOSTLYCLEANFILES): Likewise.

2007-10-29  Bruno Haible  <bruno@clisp.org>

	* m4/floorf.m4 (gl_FUNC_FLOORF_LIBS): Rename the cache variable to
	contain the special marker '_cv_'.
	* m4/floor.m4 (gl_FUNC_FLOOR_LIBS): Likewise.
	* m4/floorl.m4 (gl_FUNC_FLOORL_LIBS): Likewise.
	* m4/ceilf.m4 (gl_FUNC_CEILF_LIBS): Likewise.
	* m4/ceil.m4 (gl_FUNC_CEIL_LIBS): Likewise.
	* m4/ceill.m4 (gl_FUNC_CEILL_LIBS): Likewise.
	Reported by Ralf Wildenhues.

2007-10-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): When --lgpl is not specified, set
	sed_transform_lib_file to convert LGPL and GPLv2+ copyright headers to
	GPLv3.
	Reported by Simon Josefsson.

2007-10-28  Bruno Haible  <bruno@clisp.org>

	* lib/math.in.h: Test REPLACE_ISFINITE instead of HAVE_DECL_ISFINITE.
	* m4/isfinite.m4 (gl_ISFINITE): Initialize REPLACE_ISFINITE instead of
	HAVE_DECL_ISFINITE.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Update.
	* modules/math (Makefile.am): Substitute REPLACE_ISFINITE instead of
	HAVE_DECL_ISFINITE.

2007-10-28  Bruno Haible  <bruno@clisp.org>

	* lib/stdint.in.h (_STDINT_MAX): Subtract 1 from an unused signed
	integer shift in the signed case. Fixes warnings with OSF/1 5.1 cc.

2007-10-28  Bruno Haible  <bruno@clisp.org>

	Fix link errors with Sun C 5.0 on Solaris 10.
	* m4/floorf.m4 (gl_FUNC_FLOORF): Consider also the case that the
	function is declared but not present in the compiler's libm.
	* m4/floorl.m4 (gl_FUNC_FLOORL): Likewise.
	* m4/ceilf.m4 (gl_FUNC_CEILF): Likewise.
	* m4/ceill.m4 (gl_FUNC_CEILL: Likewise.
	* lib/math.in.h: Test REPLACE_CEILF instead of HAVE_DECL_CEILF.
	Test REPLACE_CEILL instead of HAVE_DECL_CEILL.
	Test REPLACE_FLOORF instead of HAVE_DECL_FLOORF.
	Test REPLACE_FLOORL instead of HAVE_DECL_FLOORL.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Update.
	* modules/math (Makefile.am): Substitute REPLACE_CEILF instead of
	HAVE_DECL_CEILF, REPLACE_CEILL instead of HAVE_DECL_CEILL,
	REPLACE_FLOORF instead of HAVE_DECL_FLOORF, REPLACE_FLOORL instead of
	HAVE_DECL_FLOORL.

2007-10-28  Bruno Haible  <bruno@clisp.org>

	* m4/floorl.m4 (gl_FUNC_FLOORL_LIBS): New macro, extracted from
	gl_FUNC_FLOORL. Cache the result.
	(gl_FUNC_FLOORL): Use it.
	* m4/ceill.m4 (gl_FUNC_CEILL_LIBS): New macro, extracted from
	gl_FUNC_CEILL. Cache the result.
	(gl_FUNC_CEILL): Use it.

	* m4/floor.m4 (gl_FUNC_FLOOR_LIBS): New macro, extracted from
	gl_FUNC_FLOOR. Cache the result.
	(gl_FUNC_FLOOR): Use it.
	* m4/ceil.m4 (gl_FUNC_CEIL_LIBS): New macro, extracted from
	gl_FUNC_CEIL. Cache the result.
	(gl_FUNC_CEIL): Use it.

	* m4/floorf.m4 (gl_FUNC_FLOORF_LIBS): New macro, extracted from
	gl_FUNC_FLOORF. Cache the result.
	(gl_FUNC_FLOORF): Use it.
	* m4/ceilf.m4 (gl_FUNC_CEILF_LIBS): New macro, extracted from
	gl_FUNC_CEILF. Cache the result.
	(gl_FUNC_CEILF): Use it.

2007-10-28  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: Allow specifying the LGPL version number through
	--lgpl=2 or --lgpl=3.
	(func_usage): Document --lgpl with argument.
	Handle --lgpl=... arguments.
	(func_import): Recognize also gl_LGPL calls with an argument. When
	--lgpl=2 is used and the module's license is just LGPL, report an
	error. Set sed_transform_lib_file according to the lgpl variable. In
	the generated files, use --lgpl or gl_LGPL invocations with argument,
	if necessary.
	* doc/gnulib-intro.texi (Copyright): Explain how to get modules under
	an LGPv2+ license.
	* doc/gnulib-tool.texi (Modified imports): Update explanation of
	gl_LGPL macro.

2007-10-28  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Bruno Haible  <bruno@clisp.org>

	* lib/unistr.h (u8_uctomb_aux): Declare also if !HAVE_INLINE.
	(u16_uctomb_aux): Likewise.
	* lib/unistr/u8-uctomb-aux.c (u8_uctomb_aux): Define also if
	!HAVE_INLINE.
	* lib/unistr/u16-uctomb-aux.c (u16_uctomb_aux): Likewise

2007-10-28  Bruno Haible  <bruno@clisp.org>

	* modules/error: Add a notice recommending to change XGETTEXT_OPTIONS.
	Invoke AM_GETTEXT_OPTION if it exists.
	* modules/vasprintf: Likewise.
	* modules/verror: Likewise.
	* modules/xprintf: Likewise.
	* modules/xvasprintf: Likewise.

2007-10-27  Ben Pfaff  <blp@gnu.org>

	* lib/math.in.h: Define isfinite macro and prototypes for
	gl_isfinitef, gl_isfinited, gl_isfinitel if we are providing
	implementations.
	* m4/math_h.m4: New substitutions for isfinite module.
	* lib/isfinite.c: New file.
	* m4/isfinite.m4: New file.
	* modules/math: Replace isfinite-related @VARS@ in math.in.h.
	* modules/isfinite: New file.
	* modules/isfinite-tests: New file.
	* tests/tests-isfinite.c: New file.
	* doc/functions/isfinite.texi: Mention isfinite module.
	* MODULES.html.sh: Mention new module.

2007-10-27  Ben Pfaff  <blp@gnu.org>

	Ralf Wildenhues reported that Tru64 4.0D declares the round
	functions but does not have definitions.
	* m4/check-math-lib.m4 (gl_CHECK_MATH_LIB): If the target function
	cannot be found in any library, set the output variable to
	"missing" instead of "".
	* m4/round.m4: Also use our substitute if we cannot find round in
	any library, even if it is declared.
	* m4/roundf.m4: Likewise for roundf.
	* m4/roundl.m4: Likewise for roundl.
	* lib/math.in.h: Undefine roundf, round, roundl before defining
	their replacements, to allow for hypothetical systems where these
	may be defined as macros but not available in libraries.

2007-10-27  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib.texi: Invoke @firstparagraphindent.
	* doc/gnulib-tool.texi (Simple update): Mention possible incompatible
	changes in gnulib.
	(Source changes): New section.

2007-10-26  Bruno Haible  <bruno@clisp.org>

	* m4/gnulib-common.m4 (AC_C_RESTRICT): New overriding definition,
	borrowed from autoconf.

2007-10-26  Bruno Haible  <bruno@clisp.org>

	* lib/strerror.c (rpl_strerror): Return "Unknown error ..." also if
	strerror returned the empty string. Needed on HP-UX 11.00.

2007-10-24  Micah Cowan  <micah@cowan.name>

	Remove vestiges of cvs-gnulib-checkout process.  Now we use git.
	* build-aux/bootstrap: Remove support for now-unnecessary option,
	--cvs-user, and envvars CVS_USER, CVS_RSH.

2007-10-24  Jim Meyering  <meyering@redhat.com>

	Avoid diagnostics from sha1sum when there is no cached checksum.
	* build-aux/bootstrap (update_po_files): Skip the sha1sum check
	if the po.s1 file hasn't been created yet.

	* build-aux/bootstrap: Sync from coreutils:
	2007-10-24  Jim Meyering  <meyering@redhat.com>
	Get gnulib from the git repository, not from an obsolete cvs one.
	* build-aux/bootstrap: Suggestion from Micah Cowan.
	2007-10-04  Jim Meyering  <jim@meyering.net>
	* build-aux/bootstrap (slurp): Adapt to _.h -> .in.h name change.
	(update_po_files): Work also when there are no .po files in po/.

2007-10-24  Paul Eggert  <eggert@cs.ucla.edu>

	* README: Append ".git" to git and cg examples.
	Problem reported by Benoit Sigoure.

2007-10-23  Micah Cowan  <micah@cowan.name>

	* users.txt: Add wget.

2007-10-23  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Fix linking of some unistdio tests on FreeBSD.
	* modules/unistdio/u16-vsnprintf-tests
	(test_u16_vsprintf1_LDADD): Add @LIBINTL@.
	* modules/unistdio/u16-vsprintf-tests
	(test_u16_vsnprintf1_LDADD): Likewise.
	* modules/unistdio/u32-vsnprintf-tests
	(test_u32_vsnprintf1_LDADD): Likewise.
	* modules/unistdio/u32-vsprintf-tests
	(test_u32_vsprintf1_LDADD): Likewise.
	* modules/unistdio/u8-vsnprintf-tests
	(test_u8_vsnprintf1_LDADD): Likewise.
	* modules/unistdio/u8-vsprintf-tests
	(test_u8_vsprintf1_LDADD): Likewise.
	* modules/unistdio/ulc-vsnprintf-tests
	(test_ulc_vsnprintf1_LDADD): Likewise.
	* modules/unistdio/ulc-vsprintf-tests
	(test_ulc_vsprintf1_LDADD): Likewise.

	Fix linking of some uniconv tests on FreeBSD.
	* modules/uniconv/u16-conv-from-enc-tests
	(test_u16_conv_from_enc_LDADD): Link $(LDADD) before @LIBICONV@.
	* modules/uniconv/u16-conv-to-enc-tests
	(test_u16_conv_to_enc_LDADD): Likewise.
	* modules/uniconv/u16-strconv-from-enc-tests
	(test_u16_strconv_from_enc_LDADD): Likewise.
	* modules/uniconv/u16-strconv-to-enc-tests
	(test_u16_strconv_to_enc_LDADD): Likewise.
	* modules/uniconv/u32-conv-from-enc-tests
	(test_u32_conv_from_enc_LDADD): Likewise.
	* modules/uniconv/u32-conv-to-enc-tests
	(test_u32_conv_to_enc_LDADD): Likewise.
	* modules/uniconv/u32-strconv-from-enc-tests
	(test_u32_strconv_from_enc_LDADD): Likewise.
	* modules/uniconv/u32-strconv-to-enc-tests
	(test_u32_strconv_to_enc_LDADD): Likewise.
	* modules/uniconv/u8-conv-from-enc-tests
	(test_u8_conv_from_enc_LDADD): Likewise.
	* modules/uniconv/u8-conv-to-enc-tests
	(test_u8_conv_to_enc_LDADD): Likewise.
	* modules/uniconv/u8-strconv-from-enc-tests
	(test_u8_strconv_from_enc_LDADD): Likewise.
	* modules/uniconv/u8-strconv-to-enc-tests
	(test_u8_strconv_to_enc_LDADD): Likewise.

2007-10-22  Bruno Haible  <bruno@clisp.org>

	* lib/stdint.in.h: Add check that intmax_t and uintmax_t have the same
	size.

2007-10-22  Eric Blake  <ebb9@byu.net>

	Tweak x*printf documentation.
	* lib/xprintf.c (xprintf, xvprintf, xfprintf, xvfprintf): Adjust
	variable name and comments.
	Suggested by Bruno Haible.

2007-10-22  Bruno Haible  <bruno@clisp.org>

	* lib/acl.c (copy_acl): Fix file name in comment.

2007-10-22  Paul Eggert  <eggert@cs.ucla.edu>

	Fix Tru64 problem with stdbool.h.
	* lib/stdbool.in.h (false, true):
	[! (defined __cplusplus || defined __BEOS__) && !defined __GNUC__]:
	Don't declare as an enum in this situation; it runs afoul of Tru64.
	Problem reported by Steven M. Schweda in
	<http://lists.gnu.org/archive/html/bug-autoconf/2007-10/msg00019.html>.

2007-10-22  Eric Blake  <ebb9@byu.net>

	Also wrap vf?printf.
	* lib/xprintf.h (xvprintf, xvfprintf): New declarations.
	* lib/xprintf.c (xprintf, xfprintf): Work for C89.
	(xvprintf, xvfprintf): New functions.

2007-10-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* modules/fstrcmp-tests (test_fstrcmp_LDADD): New, add
	@LIBINTL@ for FreeBSD 6.2, $(LIBTHREAD) for AIX 4.3.3.

	* lib/uniconv/u16-conv-to-enc.c (U_MBLEN): Define.
	* lib/uniconv/u32-conv-to-enc.c (U_MBLEN): Likewise.

2007-10-22  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/acl.c (copy_acl): Adjust to IRIX 6.5.  Problem reported
	by Bruno Haible.

2007-10-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/getloadavg.c
	[defined (__osf__) && (defined (__alpha) || defined (__alpha__)]:
	Undef `sys' after including sys/table.h, for Tru64 4.0D.

	* tests/test-i-ring.c: Work for C89.

2007-10-22  Bruno Haible  <bruno@clisp.org>

	* m4/ulonglong.m4 (AC_TYPE_UNSIGNED_LONG_LONG_INT): Use -1ull, not
	-1u, in preprocessor expression, so that we don't test for the bug
	in HP-UX 11.00 cpp.  Testing for this bug caused problems; see
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-10/msg00329.html>.

2007-10-22  Eric Blake  <ebb9@byu.net>

	* tests/test-yesno.sh: Silence stderr during test.

2007-10-22  Simon Josefsson  <simon@josefsson.org>

	* modules/crypto/gc-camellia: New file.

	* m4/gc-camellia.m4: New file.

	* lib/gc-libgcrypt.c (gc_cipher_open): Support Camellia.

	* lib/gc.h (enum Gc_cipher): Add GC_CAMELLIA128, GC_CAMELLIA256.

2007-10-22  Simon Josefsson  <simon@josefsson.org>

	* build-aux/maint.mk (gzip_rsyncable): Don't fail if gzip sends
	--help to stdout.  Reported by sms@antinode.org (Steven
	M. Schweda).

2007-10-22  Simon Josefsson  <simon@josefsson.org>

	* users.txt: Fix link to libksba.

2007-10-21  Ben Pfaff  <blp@gnu.org>

	* modules/roundf-tests: Add dependency on floorf, ceilf to allow
	round.c roundf implementation that depends on floorf and ceilf to
	be tested unconditionally.

2007-10-21  Ben Pfaff  <blp@gnu.org>

	* m4/check-libm-func.m4: Removed.
	* m4/check-math-lib.m4: New file.
	* m4/round.m4: Rewrite to use gl_CHECK_MATH_LIB.
	* m4/roundf.m4: Ditto, and fix lack of HAVE_DECL_ROUNDF
	definition and lack of AC_LIBOBJ([roundf]).
	* m4/roundl.m4: Ditto, and similarly for roundl.
	* modules/round: Reference new m4 file.
	* modules/roundf: Ditto.
	* modules/roundl: Ditto.
	* tests/test-round2.c (main): Use ROUND instead of round.
	Bug report from Bruno Haible.

2007-10-21  Bruno Haible  <bruno@clisp.org>

	* lib/printf-parse.c: Don't assume <stdint.h> exists in IN_LIBASPRINTF
	context.

2007-10-21  Bruno Haible  <bruno@clisp.org>

	* tests/test-wcwidth.c (main): Allow negative result for some control
	characters.

	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Check also the width of U+200B.
	Needed on OSF/1 5.1.

2007-10-21  Bruno Haible  <bruno@clisp.org>

	* tests/test-floorf1.c: Include isnanf.h.
	(main): Use isnanf() instead of isnan().
	* tests/test-ceilf1.c: Include isnanf.h.
	(main): Use isnanf() instead of isnan().
	* tests/test-truncf1.c: Include isnanf.h.
	(main): Use isnanf() instead of isnan().
	* tests/test-roundf1.c: Include isnanf.h.
	(main): Use isnanf() instead of isnan().

2007-10-21  Eric Blake  <ebb9@byu.net>

	* users.txt: Update URL for m4.

2007-10-21  Bruno Haible  <bruno@clisp.org>

	* users.txt: Add clisp. Update URLs to Simon Josefsson's projects.

2007-10-21  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_megatestdir): Determine the cvsdate from
	Git's management files if the CVS files are not present.

2007-10-20  Bruno Haible  <bruno@clisp.org>

	* lib/count-one-bits.h (COUNT_ONE_BITS): Use the builtin also for
	gcc-3.4.x.

2007-10-20  Ben Pfaff  <blp@gnu.org>

	* lib/math.in.h: Declare round, roundf, roundl if we are providing
	implementations.
	* m4/math_h.m4: New substitutions for round, roundf, roundl modules.
	* lib/round.c: New file.
	* lib/roundf.c: New file.
	* lib/roundl.c: New file.
	* m4/round.m4: New file.
	* m4/roundf.m4: New file.
	* m4/roundl.m4: New file.
	* m4/check-libm-func-m4: New file.
	* modules/math: Replace round, roundf, roundl related @VARS@ in
	math.in.h.
	* modules/round: New file.
	* modules/round-tests: New file.
	* modules/roundf: New file.
	* modules/roundf-tests: New file.
	* modules/roundl: New file.
	* modules/roundl-tests: New file.
	* tests/test-round1.c: New file.
	* tests/test-round2.c: New file.
	* tests/test-roundf1.c: New file.
	* tests/test-roundf2.c: New file.
	* tests/test-roundl.c: New file.
	* doc/functions/round.texi: Mention round module.
	* doc/functions/roundf.texi: Mention roundf module.
	* doc/functions/roundl.texi: Mention roundl module.
	* MODULES.html.sh: Mention new modules.
	Thanks to Bruno Haible for suggestions.

2007-10-20  Jim Meyering  <meyering@redhat.com>

	* lib/xprintf.c: Include <config.h> unconditionally.

	Change xprintf's license to GPL.
	* modules/xprintf (License): s/LGPL/GPL/, since this module
	depends on modules (exit and exitfail) which are GPL.
	Suggestion from Bruno Haible.

	xprintf fixes.
	* lib/xprintf.c (xprintf, xfprintf): Use va_end.
	Use a clearer diagnostic.
	Patch from Bruno Haible.

2007-10-20  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Don't report overflow if the available
	length is INT_MAX and sizeof (DCHAR_T) > sizeof (TCHAR_T).
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2007-10-20  Bruno Haible  <bruno@clisp.org>

	* tests/test-floorf2.c (correct_result_p): Don't rely on excess
	precision in the comparison result > x - 1 or similar.
	* tests/test-ceilf2.c (correct_result_p): Likewise.
	* tests/test-truncf2.c (correct_result_p): Likewise.
	* tests/test-trunc2.c (correct_result_p): Likewise.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2007-10-20  Bruno Haible  <bruno@clisp.org>

	* modules/ceil: New file.
	* m4/ceil.m4: New file.
	* doc/functions/ceil.texi: Mention the 'ceil' module.

2007-10-20  Bruno Haible  <bruno@clisp.org>

	* modules/floor: New file.
	* m4/floor.m4: New file.
	* doc/functions/floor.texi: Mention the 'floor' module.

2007-10-20  Bruno Haible  <bruno@clisp.org>

	* modules/ceilf-tests (Depends-on): Add fprintf-posix. Needed for use
	of %a.
	* modules/floorf-tests (Depends-on): Likewise.
	* modules/truncf-tests (Depends-on): Likewise.
	* modules/trunc-tests (Depends-on): Likewise.
	Reported by Ben Pfaff.

2007-10-19  Jim Meyering  <meyering@redhat.com>

	* lib/xprintf.c (xprintf, xfprintf): Test err < 0, not just "err".
	Don't bother testing specific errno values.  Just test ferror.

	New module: xprintf
	* modules/xprintf, lib/xprintf.c, lib/xprintf.h: New files.

2007-10-19  Bruno Haible  <bruno@clisp.org>

	* modules/csharpexec (Makefile.am): Use @FOO@ syntax instead of $(FOO)
	syntax.
	* modules/javaexec (Makefile.am): Likewise.
	* modules/relocatable-prog (Makefile.am): Likewise.
	Suggested by Jim Meyering.

2007-10-18  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Don't use %n on glibc >= 2.3 systems.
	Reported by Jim Meyering.

2007-10-18  Eric Blake  <ebb9@byu.net>

	* modules/filenamecat-tests (Makefile.am): Link against -lintl.

2007-10-18  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_DIRECTIVE_N, gl_SNPRINTF_DIRECTIVE_N): Put
	the format string into writable memory. Needed in Fortify conditions.

2007-10-18  Colin Watson <cjwatson@debian.org>  (tiny change)
	    Bruno Haible  <bruno@clisp.org>

	* lib/trim.c: Include config.h unconditionally. Include trim.h always.
	Include ctype.h always. Include stdlib.h, not mbuiter.h, for MB_CUR_MAX.
	* modules/trim (Depends-on): Add mbchar.
	(configure.ac): Add gl_FUNC_MBRTOWC.
	(Makefile.am): Augment lib_SOURCES.

2007-10-17  Paul Eggert  <eggert@cs.ucla.edu>

	Modify glob.c to use fstatat and dirfd, to simplify it.
	Suggested by Eric Blake.
	* lib/glob.c (__fxstatat64) [!_LIBC]: New macro.
	Don't include <stdbool.h>; not used.
	(link_exists2_p, glob_in_dir) [!_LIBC]: No longer a special case.
	(link_exists_p): Simplify implementation, since we can now assume
	dirfd and fstatat.
	* modules/glob (Depends-on): Add dirfd, openat.  Remove stdbool.

2007-10-17  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_get_dependencies): Fix sed script to
	match only tests.

2007-10-17  Bruno Haible  <bruno@clisp.org>

	* m4/locale-fr.m4 (gt_LOCALE_FR, gt_LOCALE_FR_UTF8): On Cygwin, don't
	allow locale names without encoding suffix.
	* m4/locale-tr.m4 (gt_LOCALE_TR_UTF8): Likewise.
	* m4/locale-zh.m4 (gt_LOCALE_ZH_CN): Likewise.

2007-10-16  Bruno Haible  <bruno@clisp.org>

	* lib/getcwd.c (__getcwd): Define with explicit rpl_ prefix.
	* lib/getgroups.c (getgroups): Likewise.
	* lib/gettimeofday.c (localtime, gmtime, tzset): Likewise.

2007-10-16  Bruno Haible  <bruno@clisp.org>

	* modules/absolute-header (License): Change from LGPL to LGPLv2+.
	* modules/malloc-posix (License): Likewise.
	* modules/realloc-posix (License): Likewise.
	* modules/calloc-posix (License): Likewise.
	* modules/intprops (License): Change from GPL to LGPL, with
	Paul Eggert's approval.

2007-10-16  Paul Eggert  <eggert@cs.ucla.edu>

	Merge glibc changes into lib/glob.c.

	* lib/glob.c (glob_in_dir): Sync with glibc/posix/glob.c, dated
	2007-10-15 04:59:03 UTC.  Here are the changes:

	2007-10-14  Ulrich Drepper  <drepper@redhat.com>

	* lib/glob.c: Reimplement link_exists_p to use fstatat64.

	* lib/glob.c: Add some branch prediction throughout.

	2007-10-07  Ulrich Drepper  <drepper@redhat.com>

	[BZ #5103]
	* lib/glob.c (glob): Recognize patterns starting \/.

	2007-02-14  Jakub Jelinek  <jakub@redhat.com>

	[BZ #3996]
	* lib/glob.c (attribute_hidden): Define if not defined.
	(glob): Unescape dirname, filename or username when needed and not
	GLOB_NOESCAPE.  Handle \/ correctly.  Handle GLOB_MARK if filename
	is NULL.  Handle unescaped [ in pattern without closing ].
	Don't pass GLOB_CHECK down to recursive glob for directories.
	(__glob_pattern_type): New function.
	(__glob_pattern_p): Implement using __glob_pattern_type.
	(glob_in_dir): Handle GLOB_NOCHECK patterns containing no meta
	characters and backslashes if not GLOB_NOESCAPE or unterminated [.
	Remove unreachable code.

	2006-09-30  Ulrich Drepper  <drepper@redhat.com>

	* lib/glob.c (glob_in_dir): Add some comments and asserts to
	explain why there are no leaks.

	2006-09-25  Jakub Jelinek  <jakub@redhat.com>

	[BZ #3253]
	* lib/glob.c (glob_in_dir): Don't alloca one struct globlink at a
	time, rather allocate increasingly bigger arrays of pointers, if
	possible with alloca, if too large with malloc.

2007-10-16  Paul Eggert  <eggert@cs.ucla.edu>

	Check for 64-bit int errors in HP-UX 10.20 preprocessor.
	Problem reported by H.Merijn Brand in
	<http://lists.gnu.org/archive/html/bug-tar/2007-10/msg00018.html>.
	* m4/longlong.m4 (AC_TYPE_LONG_LONG_INT): Check preprocessor too.
	* m4/ulonglong.m4 (AC_TYPE_UNSIGNED_LONG_LONG_INT): Likewise.

2007-10-15  Bruno Haible  <bruno@clisp.org>

	* lib/fchdir.c (close, open, closedir, opendir, dup, dup2): Define
	with explicit rpl_ prefix.
	* lib/fopen.c (fopen): Likewise.
	* lib/freopen.c (freopen): Likewise.
	* lib/iconv.c (iconv): Likewise.
	* lib/iconv_close.c (iconv_close): Likewise.

2007-10-15  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/iconv_open (gl_FUNC_ICONV_OPEN_UTF): Fix cache variable name.

2007-10-15  Bruno Haible  <bruno@clisp.org>

	* m4/getaddrinfo.m4 (gl_GETADDRINFO, gl_PREREQ_GETADDRINFO): Use
	<stddef.h> instead of <stdlib.h> since we only need NULL.
	Reported by Ben Pfaff <blp@cs.stanford.edu>.

2007-10-15  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (Initial import): Swap order of -I directives.
	Replace paragraph talking about LIBOBJS.
	Reported by Colin Watson <cjwatson@debian.org>.

2007-10-15  Bruno Haible  <bruno@clisp.org>

	* m4/getaddrinfo.m4 (gl_GETADDRINFO, gl_PREREQ_GETADDRINFO): Include
	<stdlib.h> before using NULL.

2007-10-15  Simon Josefsson  <simon@josefsson.org>

	* m4/getaddrinfo.m4: Use NULL rather than 0 for pointers.
	Reported by Albert Chin <china@thewrittenword.com>.

2007-10-14  Bruno Haible  <bruno@clisp.org>

	* modules/iconv_open-utf-tests: New file.
	* tests/test-iconv-utf.c: New file.

	Enhance iconv_open to support UTF-16BE, UTF-16LE, UTF-32BE, UTF-32LE.
	* modules/iconv_open-utf: New file.
	* lib/iconv.in.h (_ICONV_UTF8_UTF*, _ICONV_UTF*_UTF8): New macros.
	(iconv, iconv_close): New declarations.
	* lib/iconv_open.c: Include c-strcase.h. Don't require ICONV_FLAVOR to
	be defined.
	(iconv_open): Add special handling of conversion between UTF-8 and
	UTF-{16,32}{BE,LE}.
	* lib/iconv.c: New file, incorporating code from GNU libiconv 1.11.
	* lib/iconv_close.c: New file.
	* m4/iconv_open.m4 (gl_REPLACE_ICONV_OPEN): New macro, extracted from
	gl_FUNC_ICONV_OPEN.
	(gl_FUNC_ICONV_OPEN): Use it.
	(gl_FUNC_ICONV_OPEN_UTF): New macro.
	* m4/iconv_h.m4 (gl_ICONV_H_DEFAULTS): Initialize also REPLACE_ICONV
	and REPLACE_ICONV_UTF.
	* modules/iconv_open (Depends-on): Add c-strcase.
	(Makefile.am): Substitute also REPLACE_ICONV, REPLACE_ICONV_UTF,
	ICONV_CONST.
	* doc/functions/iconv_open.texi: Mention the iconv_open-utf module.

2007-10-13  Albert Chin  <china@thewrittenword.com>
	    Bruno Haible  <bruno@clisp.org>

	* m4/getaddrinfo.m4 (gl_GETADDRINFO): Perform the test for getaddrinfo
	through a link check that includes <netdb.h>. Needed for OSF/1 5.1.

2007-10-13  Bruno Haible  <bruno@clisp.org>

	* lib/argp-fmtstream.h (ARGP_FS_EI): If __GNUC_STDC_INLINE__ is
	defined, use the ISO C99 inline semantics.
	* lib/argp.h (ARGP_EI): Likewise.

2007-10-13  Bruno Haible  <bruno@clisp.org>

	Handle 'inline' change in gcc 4.3.0.
	* lib/argp-fmtstream.h (argp_fmtstream_putc, argp_fmtstream_puts,
	argp_fmtstream_write, argp_fmtstream_set_lmargin,
	argp_fmtstream_set_rmargin, argp_fmtstream_set_wmargin,
	argp_fmtstream_point): Disable 'extern' declaration if the function
	definition is going to be provided inline.
	(ARGP_FS_EI): If __GNUC_STDC_INLINE__ is defined, use the GNU C inline
	semantics, not the ISO C99 inline semantics.
	* lib/argp.h (argp_usage, _option_is_short, _option_is_end): Disable
	'extern' declaration if the function definition is going to be provided
	inline.
	(ARGP_EI): Don't assume GNU C. If __GNUC_STDC_INLINE__ is defined, use
	the GNU C inline semantics, not the ISO C99 inline semantics. With
	GCC 4.2, avoid a warning.

2007-10-13  Bruno Haible  <bruno@clisp.org>

	* lib/freading.h (freading): Enable the use of __freading for
	glibc >= 2.7.
	* lib/freading.c (freading): Likewise.

2007-10-12  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/argp-fmtstream.h (ARGP_FS_EI): Work around GCC 4.2.1 diagnostic
	"warning: C99 inline functions are not supported; using GNU89".

2007-10-12  Bruno Haible  <bruno@clisp.org>

	* lib/ceil.c (FUNC): Avoid rounding errors for values near a power
	of 2.
	* tests/test-ceilf2.c: New file.
	* modules/ceilf-tests: (Files, Depends-on, Makefile.am): Add new test.

	* tests/test-ceilf1.c: Renamed from tests/test-ceilf.c.
	* modules/ceilf-tests: Update.

2007-10-12  Bruno Haible  <bruno@clisp.org>

	* lib/floor.c (FUNC): Avoid rounding errors for values near a power
	of 2.
	* tests/test-floorf2.c: New file.
	* modules/floorf-tests: (Files, Depends-on, Makefile.am): Add new test.

	* tests/test-floorf1.c: Renamed from tests/test-floorf.c.
	* modules/floorf-tests: Update.

2007-10-12  Bruno Haible  <bruno@clisp.org>

	* tests/test-trunc2.c: New file.
	* modules/trunc-tests: (Files, Depends-on, Makefile.am): Add new test.

	* tests/test-trunc1.c: Renamed from tests/test-trunc.c.
	* modules/trunc-tests: Update.

2007-10-12  Bruno Haible  <bruno@clisp.org>

	* lib/trunc.c (FUNC): Avoid rounding errors for values near a power
	of 2.
	* tests/test-truncf2.c: New file.
	* modules/truncf-tests: (Files, Depends-on, Makefile.am): Add new test.

	* tests/test-truncf1.c: Renamed from tests/test-truncf.c.
	* modules/truncf-tests: Update.

2007-10-11  Eric Blake  <ebb9@byu.net>

	Don't claim strerror is broken on Interix.
	* doc/functions/strerror.texi (strerror): Known broken systems are
	now Solaris 8, and not Interix.
	* m4/strerror.m4 (gl_FUNC_STRERROR_SEPARATE): No longer filter out
	Interix on cross-compile.
	Reported by Martin Koeppe in
	http://lists.gnu.org/archive/html/bug-gnulib/2007-10/msg00005.html.

2007-10-11  Bruno Haible  <bruno@clisp.org>

	* modules/i-ring-tests: New file.
	* tests/test-i-ring.c: Renamed from lib/i-ring-test.c. Use ASSERT
	instead of assert.

2007-10-11  Bruno Haible  <bruno@clisp.org>

	* modules/filenamecat-tests: New file.
	* tests/test-filenamecat.c: New file, extracted from lib/filenamecat.c.
	* lib/filenamecat.c: Remove test code.

2007-10-11  Paul Eggert  <eggert@cs.ucla.edu>

	Simplify and modernize strerror substitute, partly to fix Solaris 8 bug.

	* lib/strerror.c: Include <string.h> always, to test interface,
	and to remove the need for the dummy.
	Include intprops.h to compute width instead of doing it ourselves
	and missing a CHAR_BIT declaration, which broke tar 1.19 on Solaris 8.
	(strerror): Define it to return NULL if there's no system strerror.
	(rpl_strerror): Use INT_STRLEN_BOUND to compute bound.
	Omit !HAVE_STRERROR code.  We don't need to worry about supporting
	ancient pre-strerror Unix systems well any more.  Saying "unknown
	system error" is enough.
	* lib/string.in.h (strerror): Simplify the ifdef to reflect the
	simpler strerror.c implementation.
	* m4/strerror.m4 (gl_FUNC_STRERROR_SEPARATE, gl_PREREQ_STDERROR):
	Simplify the tests to reflect the simpler strerror implementation.
	* modules/strerror (Depends-on): Add intprops.

2007-10-09  Eric Blake  <ebb9@byu.net>

	Silence test-fpending.
	* modules/fpending-tests (Files): Add wrapper script.
	* tests/test-fpending.sh: New file.

2007-10-09  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (func_module): Don't create a hyperlink for
	function names like 'printf_frexp'.
	(Misc): Add crc, memxor.
	(Characteristics of floating types): New section.
	(Mathematics): Add ceilf, ceill, floorf, floorl, frexpl-nolibm,
	isnanf-nolibm, signbit, trunc, truncf, truncl.
	(Enhancements for ISO C 99 functions): New subsection Input/output.
	(Support for systems lacking POSIX:2001): Add arpa_inet, calloc-posix,
	fcntl, fopen, freopen, fseek, fseeko, ftell, ftello, iconv_open,
	locale, malloc-posix, netinet_in, open, realloc-posix, signal, sleep.
	(Compatibility checks for POSIX:2001 functions): Add clock-time.
	(Enhancements for POSIX:2001 functions): Add chdir-long.
	(File system functions): Add areadlink, chdir-safer, read-file.
	Remove cycle-check.
	(File system as inode set): New section.
	(Date and time): Add gethrxtime.
	(Multithreading): Add openmp.
	(Internationalization functions): Add localename.
	(Unicode string functions): Add unistr/u*-mbsnlen.
	(Support for maintaining and releasing projects): Add git-version-gen.
	(Lone files): Remove directories.

2007-10-08  Ben Pfaff  <blp@gnu.org>

	* lib/xmalloca.h: Fix typo in comment.

2007-10-08  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/xnanosleep.c (xnanosleep): Don't assume GCC 4.3.0 behavior
	when avoiding problems with integer overflow.  Use a portable test
	instead.

2007-10-08  Simon Josefsson  <simon@josefsson.org>

	* modules/dummy (License): Change to LGPLv2+.
	* modules/float (License): Likewise
	* modules/realloc (License): Likewise
	* modules/stdlib (License): Likewise

2007-10-07  Bruno Haible  <bruno@clisp.org>

	* trunc.c (TWO_MANT_DIG): Change type to DOUBLE.
	* floor.c (TWO_MANT_DIG): Likewise.
	* ceil.c (TWO_MANT_DIG): Likewise.
	Reported by Ben Pfaff.

2007-10-07  Bruno Haible  <bruno@clisp.org>

	Avoid gcc warnings "declaration of 'exp' shadows a global declaration".
	* lib/math.in.h (frexp, frexpl): Change parameter name to 'expptr'.
	* lib/frexp.c (FUNC): Likewise.
	* lib/printf-frexp.h (printf_frexp): Likewise.
	* lib/printf-frexpl.h (printf_frexpl): Likewise.
	* lib/printf-frexp.c (FUNC): Likewise.
	Suggested by Jim Meyering.

2007-10-07  Jim Meyering  <meyering@redhat.com>

	Make xnanosleep's integer overflow test more robust.
	* lib/xnanosleep.c (xnanosleep): Declare a temporary to be "volatile",
	so that gcc-4.3.0 doesn't optimize away this test for overflow.

2007-10-07  Bruno Haible  <bruno@clisp.org>

	* NEWS: Mention the license change.

	* doc/gnulib-intro.texi (Copyright): Update the meaning of the license
	abbreviations in the modules files.

	Change copyright notice from GPLv2+ to GPLv3+.
	* README: Change copyright notice.
	* MODULES.html.sh: Likewise.
	* build-aux/bootstrap.conf: Likewise.
	* build-aux/config.libpath: Likewise.
	* build-aux/csharpcomp.sh.in: Likewise.
	* build-aux/csharpexec.sh.in: Likewise.
	* build-aux/install-reloc: Likewise.
	* build-aux/javacomp.sh.in: Likewise.
	* build-aux/javaexec.sh.in: Likewise.
	* build-aux/ldd.sh.in: Likewise.
	* build-aux/reloc-ldflags: Likewise.
	* build-aux/relocatable.sh.in: Likewise.
	* build-aux/x-to-1.in: Likewise.
	* check-module: Likewise.
	* config/srclistvars.sh: Likewise.
	* gnulib-tool: Likewise.
	* lib/acl-internal.h: Likewise.
	* lib/acl.c: Likewise.
	* lib/acl.h: Likewise.
	* lib/acl_entries.c: Likewise.
	* lib/areadlink-with-size.c: Likewise.
	* lib/areadlink.c: Likewise.
	* lib/areadlink.h: Likewise.
	* lib/argmatch.c: Likewise.
	* lib/argmatch.h: Likewise.
	* lib/argp-ba.c: Likewise.
	* lib/argp-eexst.c: Likewise.
	* lib/argp-fmtstream.c: Likewise.
	* lib/argp-fmtstream.h: Likewise.
	* lib/argp-fs-xinl.c: Likewise.
	* lib/argp-help.c: Likewise.
	* lib/argp-namefrob.h: Likewise.
	* lib/argp-parse.c: Likewise.
	* lib/argp-pin.c: Likewise.
	* lib/argp-pv.c: Likewise.
	* lib/argp-pvh.c: Likewise.
	* lib/argp-xinl.c: Likewise.
	* lib/argp.h: Likewise.
	* lib/at-func.c: Likewise.
	* lib/atanl.c: Likewise.
	* lib/backupfile.c: Likewise.
	* lib/backupfile.h: Likewise.
	* lib/basename.c: Likewise.
	* lib/binary-io.h: Likewise.
	* lib/byteswap.in.h: Likewise.
	* lib/c-stack.c: Likewise.
	* lib/c-stack.h: Likewise.
	* lib/c-strcasestr.c: Likewise.
	* lib/c-strcasestr.h: Likewise.
	* lib/c-strstr.c: Likewise.
	* lib/c-strstr.h: Likewise.
	* lib/c-strtod.c: Likewise.
	* lib/calloc.c: Likewise.
	* lib/canon-host.c: Likewise.
	* lib/canon-host.h: Likewise.
	* lib/canonicalize-lgpl.c: Likewise.
	* lib/canonicalize.c: Likewise.
	* lib/canonicalize.h: Likewise.
	* lib/ceil.c: Likewise.
	* lib/ceilf.c: Likewise.
	* lib/ceill.c: Likewise.
	* lib/chdir-long.c: Likewise.
	* lib/chdir-long.h: Likewise.
	* lib/chdir-safer.c: Likewise.
	* lib/chdir-safer.h: Likewise.
	* lib/chown.c: Likewise.
	* lib/classpath.c: Likewise.
	* lib/classpath.h: Likewise.
	* lib/clean-temp.c: Likewise.
	* lib/clean-temp.h: Likewise.
	* lib/cloexec.c: Likewise.
	* lib/close-stream.c: Likewise.
	* lib/closein.c: Likewise.
	* lib/closein.h: Likewise.
	* lib/closeout.c: Likewise.
	* lib/closeout.h: Likewise.
	* lib/concat-filename.c: Likewise.
	* lib/copy-file.c: Likewise.
	* lib/copy-file.h: Likewise.
	* lib/count-one-bits.h: Likewise.
	* lib/crc.c: Likewise.
	* lib/crc.h: Likewise.
	* lib/creat-safer.c: Likewise.
	* lib/csharpcomp.c: Likewise.
	* lib/csharpcomp.h: Likewise.
	* lib/csharpexec.c: Likewise.
	* lib/csharpexec.h: Likewise.
	* lib/cycle-check.c: Likewise.
	* lib/cycle-check.h: Likewise.
	* lib/diacrit.c: Likewise.
	* lib/diacrit.h: Likewise.
	* lib/diffseq.h: Likewise.
	* lib/dirchownmod.c: Likewise.
	* lib/dirent.in.h: Likewise.
	* lib/dirfd.c: Likewise.
	* lib/dirfd.h: Likewise.
	* lib/dirname.c: Likewise.
	* lib/dirname.h: Likewise.
	* lib/dummy.c: Likewise.
	* lib/dup-safer.c: Likewise.
	* lib/dup2.c: Likewise.
	* lib/eealloc.h: Likewise.
	* lib/error.c: Likewise.
	* lib/error.h: Likewise.
	* lib/euidaccess.c: Likewise.
	* lib/exclude.c: Likewise.
	* lib/exclude.h: Likewise.
	* lib/execute.c: Likewise.
	* lib/execute.h: Likewise.
	* lib/exitfail.c: Likewise.
	* lib/exitfail.h: Likewise.
	* lib/expl.c: Likewise.
	* lib/fatal-signal.c: Likewise.
	* lib/fatal-signal.h: Likewise.
	* lib/fbufmode.c: Likewise.
	* lib/fbufmode.h: Likewise.
	* lib/fchdir.c: Likewise.
	* lib/fchmodat.c: Likewise.
	* lib/fchownat.c: Likewise.
	* lib/fcntl--.h: Likewise.
	* lib/fcntl-safer.h: Likewise.
	* lib/fcntl.in.h: Likewise.
	* lib/fd-safer.c: Likewise.
	* lib/fflush.c: Likewise.
	* lib/file-has-acl.c: Likewise.
	* lib/file-set.c: Likewise.
	* lib/file-type.c: Likewise.
	* lib/file-type.h: Likewise.
	* lib/fileblocks.c: Likewise.
	* lib/filemode.c: Likewise.
	* lib/filemode.h: Likewise.
	* lib/filename.h: Likewise.
	* lib/filenamecat.c: Likewise.
	* lib/filenamecat.h: Likewise.
	* lib/findprog.c: Likewise.
	* lib/findprog.h: Likewise.
	* lib/float.in.h: Likewise.
	* lib/floor.c: Likewise.
	* lib/floorf.c: Likewise.
	* lib/floorl.c: Likewise.
	* lib/fopen-safer.c: Likewise.
	* lib/fopen.c: Likewise.
	* lib/fpending.c: Likewise.
	* lib/fpending.h: Likewise.
	* lib/fprintf.c: Likewise.
	* lib/fprintftime.h: Likewise.
	* lib/fpucw.h: Likewise.
	* lib/fpurge.c: Likewise.
	* lib/fpurge.h: Likewise.
	* lib/freadable.c: Likewise.
	* lib/freadable.h: Likewise.
	* lib/freadahead.c: Likewise.
	* lib/freadahead.h: Likewise.
	* lib/freading.c: Likewise.
	* lib/freading.h: Likewise.
	* lib/free.c: Likewise.
	* lib/freopen.c: Likewise.
	* lib/frexp.c: Likewise.
	* lib/frexpl.c: Likewise.
	* lib/fseek.c: Likewise.
	* lib/fseterr.c: Likewise.
	* lib/fseterr.h: Likewise.
	* lib/fstatat.c: Likewise.
	* lib/fstrcmp.c: Likewise.
	* lib/fstrcmp.h: Likewise.
	* lib/fsusage.c: Likewise.
	* lib/fsusage.h: Likewise.
	* lib/ftell.c: Likewise.
	* lib/ftello.c: Likewise.
	* lib/fts-cycle.c: Likewise.
	* lib/fts.c: Likewise.
	* lib/fts_.h: Likewise.
	* lib/full-read.c: Likewise.
	* lib/full-read.h: Likewise.
	* lib/full-write.c: Likewise.
	* lib/full-write.h: Likewise.
	* lib/fwritable.c: Likewise.
	* lib/fwritable.h: Likewise.
	* lib/fwriteerror.c: Likewise.
	* lib/fwriteerror.h: Likewise.
	* lib/fwriting.c: Likewise.
	* lib/fwriting.h: Likewise.
	* lib/gcd.c: Likewise.
	* lib/gcd.h: Likewise.
	* lib/getcwd.c: Likewise.
	* lib/getdate.h: Likewise.
	* lib/getdate.y: Likewise.
	* lib/getdomainname.c: Likewise.
	* lib/getdomainname.h: Likewise.
	* lib/getgroups.c: Likewise.
	* lib/gethostname.c: Likewise.
	* lib/gethrxtime.c: Likewise.
	* lib/gethrxtime.h: Likewise.
	* lib/getloadavg.c: Likewise.
	* lib/getndelim2.c: Likewise.
	* lib/getndelim2.h: Likewise.
	* lib/getnline.c: Likewise.
	* lib/getnline.h: Likewise.
	* lib/getopt.c: Likewise.
	* lib/getopt.in.h: Likewise.
	* lib/getopt1.c: Likewise.
	* lib/getopt_int.h: Likewise.
	* lib/getpagesize.h: Likewise.
	* lib/getsubopt.c: Likewise.
	* lib/gettime.c: Likewise.
	* lib/getugroups.c: Likewise.
	* lib/getugroups.h: Likewise.
	* lib/getusershell.c: Likewise.
	* lib/gl_anyavltree_list1.h: Likewise.
	* lib/gl_anyavltree_list2.h: Likewise.
	* lib/gl_anyhash_list1.h: Likewise.
	* lib/gl_anyhash_list2.h: Likewise.
	* lib/gl_anylinked_list1.h: Likewise.
	* lib/gl_anylinked_list2.h: Likewise.
	* lib/gl_anyrbtree_list1.h: Likewise.
	* lib/gl_anyrbtree_list2.h: Likewise.
	* lib/gl_anytree_list1.h: Likewise.
	* lib/gl_anytree_list2.h: Likewise.
	* lib/gl_anytree_oset.h: Likewise.
	* lib/gl_anytreehash_list1.h: Likewise.
	* lib/gl_anytreehash_list2.h: Likewise.
	* lib/gl_array_list.c: Likewise.
	* lib/gl_array_list.h: Likewise.
	* lib/gl_array_oset.c: Likewise.
	* lib/gl_array_oset.h: Likewise.
	* lib/gl_avltree_list.c: Likewise.
	* lib/gl_avltree_list.h: Likewise.
	* lib/gl_avltree_oset.c: Likewise.
	* lib/gl_avltree_oset.h: Likewise.
	* lib/gl_avltreehash_list.c: Likewise.
	* lib/gl_avltreehash_list.h: Likewise.
	* lib/gl_carray_list.c: Likewise.
	* lib/gl_carray_list.h: Likewise.
	* lib/gl_linked_list.c: Likewise.
	* lib/gl_linked_list.h: Likewise.
	* lib/gl_linkedhash_list.c: Likewise.
	* lib/gl_linkedhash_list.h: Likewise.
	* lib/gl_list.c: Likewise.
	* lib/gl_list.h: Likewise.
	* lib/gl_oset.c: Likewise.
	* lib/gl_oset.h: Likewise.
	* lib/gl_rbtree_list.c: Likewise.
	* lib/gl_rbtree_list.h: Likewise.
	* lib/gl_rbtree_oset.c: Likewise.
	* lib/gl_rbtree_oset.h: Likewise.
	* lib/gl_rbtreehash_list.c: Likewise.
	* lib/gl_rbtreehash_list.h: Likewise.
	* lib/gl_sublist.c: Likewise.
	* lib/gl_sublist.h: Likewise.
	* lib/group-member.c: Likewise.
	* lib/group-member.h: Likewise.
	* lib/hard-locale.c: Likewise.
	* lib/hard-locale.h: Likewise.
	* lib/hash-pjw.c: Likewise.
	* lib/hash-pjw.h: Likewise.
	* lib/hash-triple.c: Likewise.
	* lib/hash.c: Likewise.
	* lib/hash.h: Likewise.
	* lib/human.c: Likewise.
	* lib/human.h: Likewise.
	* lib/i-ring.c: Likewise.
	* lib/i-ring.h: Likewise.
	* lib/idcache.c: Likewise.
	* lib/imaxabs.c: Likewise.
	* lib/imaxdiv.c: Likewise.
	* lib/inet_pton.c: Likewise.
	* lib/inet_pton.h: Likewise.
	* lib/intprops.h: Likewise.
	* lib/inttostr.c: Likewise.
	* lib/inttostr.h: Likewise.
	* lib/inttypes.in.h: Likewise.
	* lib/isapipe.c: Likewise.
	* lib/isdir.c: Likewise.
	* lib/isnan.c: Likewise.
	* lib/isnan.h: Likewise.
	* lib/isnanf.c: Likewise.
	* lib/isnanf.h: Likewise.
	* lib/isnanl-nolibm.h: Likewise.
	* lib/isnanl.c: Likewise.
	* lib/isnanl.h: Likewise.
	* lib/javacomp.c: Likewise.
	* lib/javacomp.h: Likewise.
	* lib/javaexec.c: Likewise.
	* lib/javaexec.h: Likewise.
	* lib/javaversion.c: Likewise.
	* lib/javaversion.h: Likewise.
	* lib/javaversion.java: Likewise.
	* lib/lbrkprop.h: Likewise.
	* lib/lchmod.h: Likewise.
	* lib/lchown.c: Likewise.
	* lib/ldexpl.c: Likewise.
	* lib/linebreak.c: Likewise.
	* lib/linebreak.h: Likewise.
	* lib/linebuffer.c: Likewise.
	* lib/linebuffer.h: Likewise.
	* lib/locale.in.h: Likewise.
	* lib/logl.c: Likewise.
	* lib/long-options.c: Likewise.
	* lib/long-options.h: Likewise.
	* lib/lstat.c: Likewise.
	* lib/lstat.h: Likewise.
	* lib/math.in.h: Likewise.
	* lib/mbchar.c: Likewise.
	* lib/mbchar.h: Likewise.
	* lib/mbfile.h: Likewise.
	* lib/mbiter.h: Likewise.
	* lib/mbscasecmp.c: Likewise.
	* lib/mbscasestr.c: Likewise.
	* lib/mbschr.c: Likewise.
	* lib/mbscspn.c: Likewise.
	* lib/mbslen.c: Likewise.
	* lib/mbsncasecmp.c: Likewise.
	* lib/mbsnlen.c: Likewise.
	* lib/mbspbrk.c: Likewise.
	* lib/mbspcasecmp.c: Likewise.
	* lib/mbsrchr.c: Likewise.
	* lib/mbssep.c: Likewise.
	* lib/mbsspn.c: Likewise.
	* lib/mbsstr.c: Likewise.
	* lib/mbstok_r.c: Likewise.
	* lib/mbswidth.c: Likewise.
	* lib/mbswidth.h: Likewise.
	* lib/mbuiter.h: Likewise.
	* lib/memcasecmp.c: Likewise.
	* lib/memcasecmp.h: Likewise.
	* lib/memchr.c: Likewise.
	* lib/memcmp.c: Likewise.
	* lib/memcoll.c: Likewise.
	* lib/memcoll.h: Likewise.
	* lib/memcpy.c: Likewise.
	* lib/memrchr.c: Likewise.
	* lib/mkancesdirs.c: Likewise.
	* lib/mkdir-p.c: Likewise.
	* lib/mkdir-p.h: Likewise.
	* lib/mkdir.c: Likewise.
	* lib/mkdirat.c: Likewise.
	* lib/mkdtemp.c: Likewise.
	* lib/mkstemp-safer.c: Likewise.
	* lib/mkstemp.c: Likewise.
	* lib/modechange.c: Likewise.
	* lib/modechange.h: Likewise.
	* lib/mountlist.c: Likewise.
	* lib/mountlist.h: Likewise.
	* lib/mpsort.c: Likewise.
	* lib/nanosleep.c: Likewise.
	* lib/obstack.c: Likewise.
	* lib/obstack.h: Likewise.
	* lib/open-safer.c: Likewise.
	* lib/open.c: Likewise.
	* lib/openat-die.c: Likewise.
	* lib/openat-priv.h: Likewise.
	* lib/openat-proc.c: Likewise.
	* lib/openat.c: Likewise.
	* lib/openat.h: Likewise.
	* lib/pagealign_alloc.c: Likewise.
	* lib/pagealign_alloc.h: Likewise.
	* lib/physmem.c: Likewise.
	* lib/physmem.h: Likewise.
	* lib/pipe-safer.c: Likewise.
	* lib/pipe.c: Likewise.
	* lib/pipe.h: Likewise.
	* lib/posixtm.c: Likewise.
	* lib/posixtm.h: Likewise.
	* lib/posixver.c: Likewise.
	* lib/printf-frexp.c: Likewise.
	* lib/printf-frexp.h: Likewise.
	* lib/printf-frexpl.c: Likewise.
	* lib/printf-frexpl.h: Likewise.
	* lib/printf.c: Likewise.
	* lib/progname.c: Likewise.
	* lib/progname.h: Likewise.
	* lib/progreloc.c: Likewise.
	* lib/putenv.c: Likewise.
	* lib/quote.c: Likewise.
	* lib/quote.h: Likewise.
	* lib/quotearg.c: Likewise.
	* lib/quotearg.h: Likewise.
	* lib/raise.c: Likewise.
	* lib/readline.c: Likewise.
	* lib/readline.h: Likewise.
	* lib/readlink.c: Likewise.
	* lib/readtokens.c: Likewise.
	* lib/readtokens.h: Likewise.
	* lib/readtokens0.c: Likewise.
	* lib/readtokens0.h: Likewise.
	* lib/readutmp.c: Likewise.
	* lib/readutmp.h: Likewise.
	* lib/realloc.c: Likewise.
	* lib/relocwrapper.c: Likewise.
	* lib/rename-dest-slash.c: Likewise.
	* lib/rename.c: Likewise.
	* lib/rmdir.c: Likewise.
	* lib/rpmatch.c: Likewise.
	* lib/safe-read.c: Likewise.
	* lib/safe-read.h: Likewise.
	* lib/safe-write.c: Likewise.
	* lib/safe-write.h: Likewise.
	* lib/same-inode.h: Likewise.
	* lib/same.c: Likewise.
	* lib/same.h: Likewise.
	* lib/save-cwd.c: Likewise.
	* lib/save-cwd.h: Likewise.
	* lib/savedir.c: Likewise.
	* lib/savedir.h: Likewise.
	* lib/savewd.c: Likewise.
	* lib/savewd.h: Likewise.
	* lib/search.in.h: Likewise.
	* lib/setenv.c: Likewise.
	* lib/setenv.h: Likewise.
	* lib/settime.c: Likewise.
	* lib/sh-quote.c: Likewise.
	* lib/sh-quote.h: Likewise.
	* lib/sig2str.c: Likewise.
	* lib/sig2str.h: Likewise.
	* lib/signal.in.h: Likewise.
	* lib/signbitd.c: Likewise.
	* lib/signbitf.c: Likewise.
	* lib/signbitl.c: Likewise.
	* lib/sigprocmask.c: Likewise.
	* lib/sincosl.c: Likewise.
	* lib/sleep.c: Likewise.
	* lib/sprintf.c: Likewise.
	* lib/sqrtl.c: Likewise.
	* lib/stat-time.h: Likewise.
	* lib/stdio--.h: Likewise.
	* lib/stdio-safer.h: Likewise.
	* lib/stdlib--.h: Likewise.
	* lib/stdlib-safer.h: Likewise.
	* lib/stdlib.in.h: Likewise.
	* lib/stpcpy.c: Likewise.
	* lib/stpncpy.c: Likewise.
	* lib/strchrnul.c: Likewise.
	* lib/strcspn.c: Likewise.
	* lib/strerror.c: Likewise.
	* lib/strftime.c: Likewise.
	* lib/strftime.h: Likewise.
	* lib/striconveh.c: Likewise.
	* lib/striconveh.h: Likewise.
	* lib/striconveha.c: Likewise.
	* lib/striconveha.h: Likewise.
	* lib/stripslash.c: Likewise.
	* lib/strnlen1.c: Likewise.
	* lib/strnlen1.h: Likewise.
	* lib/strtod.c: Likewise.
	* lib/strtoimax.c: Likewise.
	* lib/strtok_r.c: Likewise.
	* lib/strtol.c: Likewise.
	* lib/strtoll.c: Likewise.
	* lib/strtoul.c: Likewise.
	* lib/strtoull.c: Likewise.
	* lib/sysexits.in.h: Likewise.
	* lib/tempname.c: Likewise.
	* lib/tempname.h: Likewise.
	* lib/timespec.h: Likewise.
	* lib/tls.c: Likewise.
	* lib/tls.h: Likewise.
	* lib/tmpdir.c: Likewise.
	* lib/tmpdir.h: Likewise.
	* lib/tmpfile-safer.c: Likewise.
	* lib/tmpfile.c: Likewise.
	* lib/trigl.c: Likewise.
	* lib/trigl.h: Likewise.
	* lib/trim.c: Likewise.
	* lib/trim.h: Likewise.
	* lib/trunc.c: Likewise.
	* lib/truncf.c: Likewise.
	* lib/truncl.c: Likewise.
	* lib/tsearch.c: Likewise.
	* lib/unicodeio.c: Likewise.
	* lib/unicodeio.h: Likewise.
	* lib/unistd--.h: Likewise.
	* lib/unistd-safer.h: Likewise.
	* lib/unistdio/ulc-fprintf.c: Likewise.
	* lib/unistdio/ulc-vfprintf.c: Likewise.
	* lib/unlinkdir.c: Likewise.
	* lib/unlinkdir.h: Likewise.
	* lib/unlocked-io.h: Likewise.
	* lib/unsetenv.c: Likewise.
	* lib/userspec.c: Likewise.
	* lib/utime.c: Likewise.
	* lib/utimecmp.c: Likewise.
	* lib/utimecmp.h: Likewise.
	* lib/utimens.c: Likewise.
	* lib/verify.h: Likewise.
	* lib/verror.c: Likewise.
	* lib/verror.h: Likewise.
	* lib/version-etc-fsf.c: Likewise.
	* lib/version-etc.c: Likewise.
	* lib/version-etc.h: Likewise.
	* lib/vfprintf.c: Likewise.
	* lib/vprintf.c: Likewise.
	* lib/vsprintf.c: Likewise.
	* lib/w32spawn.h: Likewise.
	* lib/wait-process.c: Likewise.
	* lib/wait-process.h: Likewise.
	* lib/wcwidth.c: Likewise.
	* lib/write-any-file.c: Likewise.
	* lib/xalloc-die.c: Likewise.
	* lib/xalloc.h: Likewise.
	* lib/xasprintf.c: Likewise.
	* lib/xgetcwd.c: Likewise.
	* lib/xgetcwd.h: Likewise.
	* lib/xgetdomainname.c: Likewise.
	* lib/xgetdomainname.h: Likewise.
	* lib/xgethostname.c: Likewise.
	* lib/xmalloc.c: Likewise.
	* lib/xmalloca.c: Likewise.
	* lib/xmalloca.h: Likewise.
	* lib/xmemcoll.c: Likewise.
	* lib/xnanosleep.c: Likewise.
	* lib/xreadlink.c: Likewise.
	* lib/xreadlink.h: Likewise.
	* lib/xsetenv.c: Likewise.
	* lib/xsetenv.h: Likewise.
	* lib/xstriconv.c: Likewise.
	* lib/xstriconv.h: Likewise.
	* lib/xstrndup.c: Likewise.
	* lib/xstrndup.h: Likewise.
	* lib/xstrtod.c: Likewise.
	* lib/xstrtod.h: Likewise.
	* lib/xstrtol-error.c: Likewise.
	* lib/xstrtol.c: Likewise.
	* lib/xstrtol.h: Likewise.
	* lib/xtime.h: Likewise.
	* lib/xvasprintf.c: Likewise.
	* lib/xvasprintf.h: Likewise.
	* lib/yesno.c: Likewise.
	* lib/yesno.h: Likewise.
	* posix-modules: Likewise.
	* tests/test-alloca-opt.c: Likewise.
	* tests/test-arcfour.c: Likewise.
	* tests/test-arctwo.c: Likewise.
	* tests/test-argmatch.c: Likewise.
	* tests/test-argp-2.sh: Likewise.
	* tests/test-argp.c: Likewise.
	* tests/test-arpa_inet.c: Likewise.
	* tests/test-array_list.c: Likewise.
	* tests/test-array_oset.c: Likewise.
	* tests/test-atexit.c: Likewise.
	* tests/test-avltree_list.c: Likewise.
	* tests/test-avltree_oset.c: Likewise.
	* tests/test-avltreehash_list.c: Likewise.
	* tests/test-base64.c: Likewise.
	* tests/test-binary-io.c: Likewise.
	* tests/test-byteswap.c: Likewise.
	* tests/test-c-ctype.c: Likewise.
	* tests/test-c-strcasecmp.c: Likewise.
	* tests/test-c-strcasestr.c: Likewise.
	* tests/test-c-strncasecmp.c: Likewise.
	* tests/test-c-strstr.c: Likewise.
	* tests/test-canonicalize-lgpl.c: Likewise.
	* tests/test-canonicalize.c: Likewise.
	* tests/test-carray_list.c: Likewise.
	* tests/test-ceilf.c: Likewise.
	* tests/test-ceill.c: Likewise.
	* tests/test-count-one-bits.c: Likewise.
	* tests/test-crc.c: Likewise.
	* tests/test-dirname.c: Likewise.
	* tests/test-fbufmode.c: Likewise.
	* tests/test-fcntl.c: Likewise.
	* tests/test-fflush.c: Likewise.
	* tests/test-floorf.c: Likewise.
	* tests/test-floorl.c: Likewise.
	* tests/test-fopen.c: Likewise.
	* tests/test-fprintf-posix.c: Likewise.
	* tests/test-fprintf-posix.h: Likewise.
	* tests/test-fpurge.c: Likewise.
	* tests/test-freadable.c: Likewise.
	* tests/test-freadahead.c: Likewise.
	* tests/test-freading.c: Likewise.
	* tests/test-freopen.c: Likewise.
	* tests/test-frexp.c: Likewise.
	* tests/test-frexpl.c: Likewise.
	* tests/test-fseek.c: Likewise.
	* tests/test-fseeko.c: Likewise.
	* tests/test-fseterr.c: Likewise.
	* tests/test-fstrcmp.c: Likewise.
	* tests/test-ftell.c: Likewise.
	* tests/test-ftello.c: Likewise.
	* tests/test-fwritable.c: Likewise.
	* tests/test-fwriting.c: Likewise.
	* tests/test-getaddrinfo.c: Likewise.
	* tests/test-getpass.c: Likewise.
	* tests/test-gettimeofday.c: Likewise.
	* tests/test-hmac-md5.c: Likewise.
	* tests/test-hmac-sha1.c: Likewise.
	* tests/test-iconv.c: Likewise.
	* tests/test-iconvme.c: Likewise.
	* tests/test-inttypes.c: Likewise.
	* tests/test-isnan.c: Likewise.
	* tests/test-isnanf.c: Likewise.
	* tests/test-isnanl-nolibm.c: Likewise.
	* tests/test-isnanl.c: Likewise.
	* tests/test-isnanl.h: Likewise.
	* tests/test-ldexpl.c: Likewise.
	* tests/test-linked_list.c: Likewise.
	* tests/test-linkedhash_list.c: Likewise.
	* tests/test-locale.c: Likewise.
	* tests/test-localename.c: Likewise.
	* tests/test-lock.c: Likewise.
	* tests/test-lseek.c: Likewise.
	* tests/test-malloca.c: Likewise.
	* tests/test-math.c: Likewise.
	* tests/test-mbscasecmp.c: Likewise.
	* tests/test-mbscasestr1.c: Likewise.
	* tests/test-mbscasestr2.c: Likewise.
	* tests/test-mbscasestr3.c: Likewise.
	* tests/test-mbscasestr4.c: Likewise.
	* tests/test-mbschr.c: Likewise.
	* tests/test-mbscspn.c: Likewise.
	* tests/test-mbsncasecmp.c: Likewise.
	* tests/test-mbspbrk.c: Likewise.
	* tests/test-mbspcasecmp.c: Likewise.
	* tests/test-mbsrchr.c: Likewise.
	* tests/test-mbsspn.c: Likewise.
	* tests/test-mbsstr1.c: Likewise.
	* tests/test-mbsstr2.c: Likewise.
	* tests/test-mbsstr3.c: Likewise.
	* tests/test-md5.c: Likewise.
	* tests/test-memmem.c: Likewise.
	* tests/test-netinet_in.c: Likewise.
	* tests/test-open.c: Likewise.
	* tests/test-printf-frexp.c: Likewise.
	* tests/test-printf-frexpl.c: Likewise.
	* tests/test-printf-posix.c: Likewise.
	* tests/test-printf-posix.h: Likewise.
	* tests/test-rbtree_list.c: Likewise.
	* tests/test-rbtree_oset.c: Likewise.
	* tests/test-rbtreehash_list.c: Likewise.
	* tests/test-read-file.c: Likewise.
	* tests/test-rijndael.c: Likewise.
	* tests/test-search.c: Likewise.
	* tests/test-signbit.c: Likewise.
	* tests/test-sleep.c: Likewise.
	* tests/test-snprintf-posix.c: Likewise.
	* tests/test-snprintf-posix.h: Likewise.
	* tests/test-snprintf.c: Likewise.
	* tests/test-sprintf-posix.c: Likewise.
	* tests/test-sprintf-posix.h: Likewise.
	* tests/test-stat-time.c: Likewise.
	* tests/test-stdbool.c: Likewise.
	* tests/test-stdint.c: Likewise.
	* tests/test-stdio.c: Likewise.
	* tests/test-stdlib.c: Likewise.
	* tests/test-stpncpy.c: Likewise.
	* tests/test-strcasestr.c: Likewise.
	* tests/test-striconv.c: Likewise.
	* tests/test-striconveh.c: Likewise.
	* tests/test-striconveha.c: Likewise.
	* tests/test-string.c: Likewise.
	* tests/test-sys_select.c: Likewise.
	* tests/test-sys_socket.c: Likewise.
	* tests/test-sys_stat.c: Likewise.
	* tests/test-sys_time.c: Likewise.
	* tests/test-sysexits.c: Likewise.
	* tests/test-time.c: Likewise.
	* tests/test-tls.c: Likewise.
	* tests/test-trunc.c: Likewise.
	* tests/test-truncf.c: Likewise.
	* tests/test-truncl.c: Likewise.
	* tests/test-unistd.c: Likewise.
	* tests/test-vasnprintf-posix.c: Likewise.
	* tests/test-vasnprintf-posix2.c: Likewise.
	* tests/test-vasnprintf.c: Likewise.
	* tests/test-vasprintf-posix.c: Likewise.
	* tests/test-vasprintf.c: Likewise.
	* tests/test-verify.c: Likewise.
	* tests/test-vfprintf-posix.c: Likewise.
	* tests/test-vprintf-posix.c: Likewise.
	* tests/test-vsnprintf-posix.c: Likewise.
	* tests/test-vsnprintf.c: Likewise.
	* tests/test-vsprintf-posix.c: Likewise.
	* tests/test-wchar.c: Likewise.
	* tests/test-wctype.c: Likewise.
	* tests/test-wcwidth.c: Likewise.
	* tests/test-xstrtol.c: Likewise.
	* tests/test-xvasprintf.c: Likewise.
	* tests/uniconv/test-u16-conv-from-enc.c: Likewise.
	* tests/uniconv/test-u16-conv-to-enc.c: Likewise.
	* tests/uniconv/test-u16-strconv-from-enc.c: Likewise.
	* tests/uniconv/test-u16-strconv-to-enc.c: Likewise.
	* tests/uniconv/test-u32-conv-from-enc.c: Likewise.
	* tests/uniconv/test-u32-conv-to-enc.c: Likewise.
	* tests/uniconv/test-u32-strconv-from-enc.c: Likewise.
	* tests/uniconv/test-u32-strconv-to-enc.c: Likewise.
	* tests/uniconv/test-u8-conv-from-enc.c: Likewise.
	* tests/uniconv/test-u8-conv-to-enc.c: Likewise.
	* tests/uniconv/test-u8-strconv-from-enc.c: Likewise.
	* tests/uniconv/test-u8-strconv-to-enc.c: Likewise.
	* tests/uniname/test-uninames.c: Likewise.
	* tests/unistdio/test-u16-asnprintf1.c: Likewise.
	* tests/unistdio/test-u16-asnprintf1.h: Likewise.
	* tests/unistdio/test-u16-printf1.h: Likewise.
	* tests/unistdio/test-u16-vasnprintf1.c: Likewise.
	* tests/unistdio/test-u16-vasnprintf2.c: Likewise.
	* tests/unistdio/test-u16-vasnprintf3.c: Likewise.
	* tests/unistdio/test-u16-vasprintf1.c: Likewise.
	* tests/unistdio/test-u16-vsnprintf1.c: Likewise.
	* tests/unistdio/test-u16-vsprintf1.c: Likewise.
	* tests/unistdio/test-u32-asnprintf1.c: Likewise.
	* tests/unistdio/test-u32-asnprintf1.h: Likewise.
	* tests/unistdio/test-u32-printf1.h: Likewise.
	* tests/unistdio/test-u32-vasnprintf1.c: Likewise.
	* tests/unistdio/test-u32-vasnprintf2.c: Likewise.
	* tests/unistdio/test-u32-vasnprintf3.c: Likewise.
	* tests/unistdio/test-u32-vasprintf1.c: Likewise.
	* tests/unistdio/test-u32-vsnprintf1.c: Likewise.
	* tests/unistdio/test-u32-vsprintf1.c: Likewise.
	* tests/unistdio/test-u8-asnprintf1.c: Likewise.
	* tests/unistdio/test-u8-asnprintf1.h: Likewise.
	* tests/unistdio/test-u8-printf1.h: Likewise.
	* tests/unistdio/test-u8-vasnprintf1.c: Likewise.
	* tests/unistdio/test-u8-vasnprintf2.c: Likewise.
	* tests/unistdio/test-u8-vasnprintf3.c: Likewise.
	* tests/unistdio/test-u8-vasprintf1.c: Likewise.
	* tests/unistdio/test-u8-vsnprintf1.c: Likewise.
	* tests/unistdio/test-u8-vsprintf1.c: Likewise.
	* tests/unistdio/test-ulc-asnprintf1.c: Likewise.
	* tests/unistdio/test-ulc-asnprintf1.h: Likewise.
	* tests/unistdio/test-ulc-printf1.h: Likewise.
	* tests/unistdio/test-ulc-vasnprintf1.c: Likewise.
	* tests/unistdio/test-ulc-vasnprintf2.c: Likewise.
	* tests/unistdio/test-ulc-vasnprintf3.c: Likewise.
	* tests/unistdio/test-ulc-vasprintf1.c: Likewise.
	* tests/unistdio/test-ulc-vsnprintf1.c: Likewise.
	* tests/unistdio/test-ulc-vsprintf1.c: Likewise.
	* tests/uniwidth/test-u16-strwidth.c: Likewise.
	* tests/uniwidth/test-u16-width.c: Likewise.
	* tests/uniwidth/test-u32-strwidth.c: Likewise.
	* tests/uniwidth/test-u32-width.c: Likewise.
	* tests/uniwidth/test-u8-strwidth.c: Likewise.
	* tests/uniwidth/test-u8-width.c: Likewise.
	* tests/uniwidth/test-uc_width.c: Likewise.
	* config/srclist-update: Likewise.
	(fixlicense): Update to GPLv3+.

	Change copyright notice from LGPLv2.1+ to LGPLv3+.
	* tests/test-tsearch.c: Change copyright notice.

	Change copyright notice from LGPLv2.0+ to LGPLv3+.
	* lib/c-strcaseeq.h: Change copyright notice.
	* lib/streq.h: Likewise.
	* lib/uniconv.h: Likewise.
	* lib/uniconv/u-conv-from-enc.h: Likewise.
	* lib/uniconv/u-conv-to-enc.h: Likewise.
	* lib/uniconv/u-strconv-from-enc.h: Likewise.
	* lib/uniconv/u-strconv-to-enc.h: Likewise.
	* lib/uniconv/u16-conv-from-enc.c: Likewise.
	* lib/uniconv/u16-conv-to-enc.c: Likewise.
	* lib/uniconv/u16-strconv-from-enc.c: Likewise.
	* lib/uniconv/u16-strconv-from-locale.c: Likewise.
	* lib/uniconv/u16-strconv-to-enc.c: Likewise.
	* lib/uniconv/u16-strconv-to-locale.c: Likewise.
	* lib/uniconv/u32-conv-from-enc.c: Likewise.
	* lib/uniconv/u32-conv-to-enc.c: Likewise.
	* lib/uniconv/u32-strconv-from-enc.c: Likewise.
	* lib/uniconv/u32-strconv-from-locale.c: Likewise.
	* lib/uniconv/u32-strconv-to-enc.c: Likewise.
	* lib/uniconv/u32-strconv-to-locale.c: Likewise.
	* lib/uniconv/u8-conv-from-enc.c: Likewise.
	* lib/uniconv/u8-conv-to-enc.c: Likewise.
	* lib/uniconv/u8-strconv-from-enc.c: Likewise.
	* lib/uniconv/u8-strconv-from-locale.c: Likewise.
	* lib/uniconv/u8-strconv-to-enc.c: Likewise.
	* lib/uniconv/u8-strconv-to-locale.c: Likewise.
	* lib/uniname.h: Likewise.
	* lib/uniname/uniname.c: Likewise.
	* lib/unistdio.h: Likewise.
	* lib/unistdio/u-asnprintf.h: Likewise.
	* lib/unistdio/u-asprintf.h: Likewise.
	* lib/unistdio/u-printf-args.c: Likewise.
	* lib/unistdio/u-printf-args.h: Likewise.
	* lib/unistdio/u-printf-parse.h: Likewise.
	* lib/unistdio/u-snprintf.h: Likewise.
	* lib/unistdio/u-sprintf.h: Likewise.
	* lib/unistdio/u-vasprintf.h: Likewise.
	* lib/unistdio/u-vsnprintf.h: Likewise.
	* lib/unistdio/u-vsprintf.h: Likewise.
	* lib/unistdio/u16-asnprintf.c: Likewise.
	* lib/unistdio/u16-asprintf.c: Likewise.
	* lib/unistdio/u16-printf-parse.c: Likewise.
	* lib/unistdio/u16-snprintf.c: Likewise.
	* lib/unistdio/u16-sprintf.c: Likewise.
	* lib/unistdio/u16-u16-asnprintf.c: Likewise.
	* lib/unistdio/u16-u16-asprintf.c: Likewise.
	* lib/unistdio/u16-u16-snprintf.c: Likewise.
	* lib/unistdio/u16-u16-sprintf.c: Likewise.
	* lib/unistdio/u16-u16-vasnprintf.c: Likewise.
	* lib/unistdio/u16-u16-vasprintf.c: Likewise.
	* lib/unistdio/u16-u16-vsnprintf.c: Likewise.
	* lib/unistdio/u16-u16-vsprintf.c: Likewise.
	* lib/unistdio/u16-vasnprintf.c: Likewise.
	* lib/unistdio/u16-vasprintf.c: Likewise.
	* lib/unistdio/u16-vsnprintf.c: Likewise.
	* lib/unistdio/u16-vsprintf.c: Likewise.
	* lib/unistdio/u32-asnprintf.c: Likewise.
	* lib/unistdio/u32-asprintf.c: Likewise.
	* lib/unistdio/u32-printf-parse.c: Likewise.
	* lib/unistdio/u32-snprintf.c: Likewise.
	* lib/unistdio/u32-sprintf.c: Likewise.
	* lib/unistdio/u32-u32-asnprintf.c: Likewise.
	* lib/unistdio/u32-u32-asprintf.c: Likewise.
	* lib/unistdio/u32-u32-snprintf.c: Likewise.
	* lib/unistdio/u32-u32-sprintf.c: Likewise.
	* lib/unistdio/u32-u32-vasnprintf.c: Likewise.
	* lib/unistdio/u32-u32-vasprintf.c: Likewise.
	* lib/unistdio/u32-u32-vsnprintf.c: Likewise.
	* lib/unistdio/u32-u32-vsprintf.c: Likewise.
	* lib/unistdio/u32-vasnprintf.c: Likewise.
	* lib/unistdio/u32-vasprintf.c: Likewise.
	* lib/unistdio/u32-vsnprintf.c: Likewise.
	* lib/unistdio/u32-vsprintf.c: Likewise.
	* lib/unistdio/u8-asnprintf.c: Likewise.
	* lib/unistdio/u8-asprintf.c: Likewise.
	* lib/unistdio/u8-printf-parse.c: Likewise.
	* lib/unistdio/u8-snprintf.c: Likewise.
	* lib/unistdio/u8-sprintf.c: Likewise.
	* lib/unistdio/u8-u8-asnprintf.c: Likewise.
	* lib/unistdio/u8-u8-asprintf.c: Likewise.
	* lib/unistdio/u8-u8-snprintf.c: Likewise.
	* lib/unistdio/u8-u8-sprintf.c: Likewise.
	* lib/unistdio/u8-u8-vasnprintf.c: Likewise.
	* lib/unistdio/u8-u8-vasprintf.c: Likewise.
	* lib/unistdio/u8-u8-vsnprintf.c: Likewise.
	* lib/unistdio/u8-u8-vsprintf.c: Likewise.
	* lib/unistdio/u8-vasnprintf.c: Likewise.
	* lib/unistdio/u8-vasprintf.c: Likewise.
	* lib/unistdio/u8-vsnprintf.c: Likewise.
	* lib/unistdio/u8-vsprintf.c: Likewise.
	* lib/unistdio/ulc-asnprintf.c: Likewise.
	* lib/unistdio/ulc-asprintf.c: Likewise.
	* lib/unistdio/ulc-printf-parse.c: Likewise.
	* lib/unistdio/ulc-snprintf.c: Likewise.
	* lib/unistdio/ulc-sprintf.c: Likewise.
	* lib/unistdio/ulc-vasnprintf.c: Likewise.
	* lib/unistdio/ulc-vasprintf.c: Likewise.
	* lib/unistdio/ulc-vsnprintf.c: Likewise.
	* lib/unistdio/ulc-vsprintf.c: Likewise.
	* lib/unistr.h: Likewise.
	* lib/unistr/u-cpy-alloc.h: Likewise.
	* lib/unistr/u-cpy.h: Likewise.
	* lib/unistr/u-endswith.h: Likewise.
	* lib/unistr/u-move.h: Likewise.
	* lib/unistr/u-set.h: Likewise.
	* lib/unistr/u-startswith.h: Likewise.
	* lib/unistr/u-stpcpy.h: Likewise.
	* lib/unistr/u-stpncpy.h: Likewise.
	* lib/unistr/u-strcat.h: Likewise.
	* lib/unistr/u-strcpy.h: Likewise.
	* lib/unistr/u-strcspn.h: Likewise.
	* lib/unistr/u-strdup.h: Likewise.
	* lib/unistr/u-strlen.h: Likewise.
	* lib/unistr/u-strncat.h: Likewise.
	* lib/unistr/u-strncpy.h: Likewise.
	* lib/unistr/u-strnlen.h: Likewise.
	* lib/unistr/u-strpbrk.h: Likewise.
	* lib/unistr/u-strspn.h: Likewise.
	* lib/unistr/u-strstr.h: Likewise.
	* lib/unistr/u-strtok.h: Likewise.
	* lib/unistr/u16-check.c: Likewise.
	* lib/unistr/u16-chr.c: Likewise.
	* lib/unistr/u16-cmp.c: Likewise.
	* lib/unistr/u16-cpy-alloc.c: Likewise.
	* lib/unistr/u16-cpy.c: Likewise.
	* lib/unistr/u16-endswith.c: Likewise.
	* lib/unistr/u16-mblen.c: Likewise.
	* lib/unistr/u16-mbsnlen.c: Likewise.
	* lib/unistr/u16-mbtouc-aux.c: Likewise.
	* lib/unistr/u16-mbtouc-unsafe-aux.c: Likewise.
	* lib/unistr/u16-mbtouc-unsafe.c: Likewise.
	* lib/unistr/u16-mbtouc.c: Likewise.
	* lib/unistr/u16-mbtoucr.c: Likewise.
	* lib/unistr/u16-move.c: Likewise.
	* lib/unistr/u16-next.c: Likewise.
	* lib/unistr/u16-prev.c: Likewise.
	* lib/unistr/u16-set.c: Likewise.
	* lib/unistr/u16-startswith.c: Likewise.
	* lib/unistr/u16-stpcpy.c: Likewise.
	* lib/unistr/u16-stpncpy.c: Likewise.
	* lib/unistr/u16-strcat.c: Likewise.
	* lib/unistr/u16-strchr.c: Likewise.
	* lib/unistr/u16-strcmp.c: Likewise.
	* lib/unistr/u16-strcpy.c: Likewise.
	* lib/unistr/u16-strcspn.c: Likewise.
	* lib/unistr/u16-strdup.c: Likewise.
	* lib/unistr/u16-strlen.c: Likewise.
	* lib/unistr/u16-strmblen.c: Likewise.
	* lib/unistr/u16-strmbtouc.c: Likewise.
	* lib/unistr/u16-strncat.c: Likewise.
	* lib/unistr/u16-strncmp.c: Likewise.
	* lib/unistr/u16-strncpy.c: Likewise.
	* lib/unistr/u16-strnlen.c: Likewise.
	* lib/unistr/u16-strpbrk.c: Likewise.
	* lib/unistr/u16-strrchr.c: Likewise.
	* lib/unistr/u16-strspn.c: Likewise.
	* lib/unistr/u16-strstr.c: Likewise.
	* lib/unistr/u16-strtok.c: Likewise.
	* lib/unistr/u16-to-u32.c: Likewise.
	* lib/unistr/u16-to-u8.c: Likewise.
	* lib/unistr/u16-uctomb-aux.c: Likewise.
	* lib/unistr/u16-uctomb.c: Likewise.
	* lib/unistr/u32-check.c: Likewise.
	* lib/unistr/u32-chr.c: Likewise.
	* lib/unistr/u32-cmp.c: Likewise.
	* lib/unistr/u32-cpy-alloc.c: Likewise.
	* lib/unistr/u32-cpy.c: Likewise.
	* lib/unistr/u32-endswith.c: Likewise.
	* lib/unistr/u32-mblen.c: Likewise.
	* lib/unistr/u32-mbsnlen.c: Likewise.
	* lib/unistr/u32-mbtouc-unsafe.c: Likewise.
	* lib/unistr/u32-mbtouc.c: Likewise.
	* lib/unistr/u32-mbtoucr.c: Likewise.
	* lib/unistr/u32-move.c: Likewise.
	* lib/unistr/u32-next.c: Likewise.
	* lib/unistr/u32-prev.c: Likewise.
	* lib/unistr/u32-set.c: Likewise.
	* lib/unistr/u32-startswith.c: Likewise.
	* lib/unistr/u32-stpcpy.c: Likewise.
	* lib/unistr/u32-stpncpy.c: Likewise.
	* lib/unistr/u32-strcat.c: Likewise.
	* lib/unistr/u32-strchr.c: Likewise.
	* lib/unistr/u32-strcmp.c: Likewise.
	* lib/unistr/u32-strcpy.c: Likewise.
	* lib/unistr/u32-strcspn.c: Likewise.
	* lib/unistr/u32-strdup.c: Likewise.
	* lib/unistr/u32-strlen.c: Likewise.
	* lib/unistr/u32-strmblen.c: Likewise.
	* lib/unistr/u32-strmbtouc.c: Likewise.
	* lib/unistr/u32-strncat.c: Likewise.
	* lib/unistr/u32-strncmp.c: Likewise.
	* lib/unistr/u32-strncpy.c: Likewise.
	* lib/unistr/u32-strnlen.c: Likewise.
	* lib/unistr/u32-strpbrk.c: Likewise.
	* lib/unistr/u32-strrchr.c: Likewise.
	* lib/unistr/u32-strspn.c: Likewise.
	* lib/unistr/u32-strstr.c: Likewise.
	* lib/unistr/u32-strtok.c: Likewise.
	* lib/unistr/u32-to-u16.c: Likewise.
	* lib/unistr/u32-to-u8.c: Likewise.
	* lib/unistr/u32-uctomb.c: Likewise.
	* lib/unistr/u8-check.c: Likewise.
	* lib/unistr/u8-chr.c: Likewise.
	* lib/unistr/u8-cmp.c: Likewise.
	* lib/unistr/u8-cpy-alloc.c: Likewise.
	* lib/unistr/u8-cpy.c: Likewise.
	* lib/unistr/u8-endswith.c: Likewise.
	* lib/unistr/u8-mblen.c: Likewise.
	* lib/unistr/u8-mbsnlen.c: Likewise.
	* lib/unistr/u8-mbtouc-aux.c: Likewise.
	* lib/unistr/u8-mbtouc-unsafe-aux.c: Likewise.
	* lib/unistr/u8-mbtouc-unsafe.c: Likewise.
	* lib/unistr/u8-mbtouc.c: Likewise.
	* lib/unistr/u8-mbtoucr.c: Likewise.
	* lib/unistr/u8-move.c: Likewise.
	* lib/unistr/u8-next.c: Likewise.
	* lib/unistr/u8-prev.c: Likewise.
	* lib/unistr/u8-set.c: Likewise.
	* lib/unistr/u8-startswith.c: Likewise.
	* lib/unistr/u8-stpcpy.c: Likewise.
	* lib/unistr/u8-stpncpy.c: Likewise.
	* lib/unistr/u8-strcat.c: Likewise.
	* lib/unistr/u8-strchr.c: Likewise.
	* lib/unistr/u8-strcmp.c: Likewise.
	* lib/unistr/u8-strcpy.c: Likewise.
	* lib/unistr/u8-strcspn.c: Likewise.
	* lib/unistr/u8-strdup.c: Likewise.
	* lib/unistr/u8-strlen.c: Likewise.
	* lib/unistr/u8-strmblen.c: Likewise.
	* lib/unistr/u8-strmbtouc.c: Likewise.
	* lib/unistr/u8-strncat.c: Likewise.
	* lib/unistr/u8-strncmp.c: Likewise.
	* lib/unistr/u8-strncpy.c: Likewise.
	* lib/unistr/u8-strnlen.c: Likewise.
	* lib/unistr/u8-strpbrk.c: Likewise.
	* lib/unistr/u8-strrchr.c: Likewise.
	* lib/unistr/u8-strspn.c: Likewise.
	* lib/unistr/u8-strstr.c: Likewise.
	* lib/unistr/u8-strtok.c: Likewise.
	* lib/unistr/u8-to-u16.c: Likewise.
	* lib/unistr/u8-to-u32.c: Likewise.
	* lib/unistr/u8-uctomb-aux.c: Likewise.
	* lib/unistr/u8-uctomb.c: Likewise.
	* lib/unitypes.h: Likewise.
	* lib/uniwidth.h: Likewise.
	* lib/uniwidth/cjk.h: Likewise.
	* lib/uniwidth/u16-strwidth.c: Likewise.
	* lib/uniwidth/u16-width.c: Likewise.
	* lib/uniwidth/u32-strwidth.c: Likewise.
	* lib/uniwidth/u32-width.c: Likewise.
	* lib/uniwidth/u8-strwidth.c: Likewise.
	* lib/uniwidth/u8-width.c: Likewise.
	* lib/uniwidth/width.c: Likewise.

2007-10-07  Bruno Haible  <bruno@clisp.org>

	* lib/inttypes.in.h: Change copyright notice from LGPL to GPL.
	The file is still under LGPL (see modules/inttypes).

2007-10-06  Bruno Haible  <bruno@clisp.org>

	* modules/trunc (Dependencies): Add 'extensions'.
	* m4/trunc.m4 (gl_FUNC_TRUNC): Require gl_USE_SYSTEM_EXTENSIONS.
	Reported by Ben Pfaff <blp@gnu.org>.

2007-10-06  Bruno Haible  <bruno@clisp.org>

	* modules/freopen-tests: New file.
	* tests/test-freopen.c: New file.

	* modules/fopen-tests: New file.
	* tests/test-fopen.c: New file.

	* modules/fopen: New file.
	* lib/fopen.c: New file.
	* m4/fopen.m4: New file.
	* modules/freopen: New file.
	* lib/freopen.c: New file.
	* m4/freopen.m4: New file.
	* lib/stdio.in.h (fopen, freopen): New declarations.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Initialize also GNULIB_FOPEN,
	GNULIB_FREOPEN, REPLACE_FOPEN, REPLACE_FREOPEN.
	* modules/stdio (Makefile.am): Substitute also GNULIB_FOPEN,
	GNULIB_FREOPEN, REPLACE_FOPEN, REPLACE_FREOPEN.
	* doc/functions/fopen.texi: Mention the 'fopen' module.
	* doc/functions/freopen.texi: Mention the 'freopen' module.

2007-10-06  Bruno Haible  <bruno@clisp.org>

	* modules/open-tests: New file.
	* tests/test-open.c: New file.

	* modules/open: New file.
	* lib/open.c: New file.
	* m4/open.m4: New file.
	* lib/fchdir.c (open): If the gnulib module 'open' is used, do what
	lib/open.c does.
	* lib/fcntl.in.h (open): Declare also if replaced by the 'open' module.
	* m4/fcntl_h.m4 (gl_FCNTL_MODULE_INDICATOR, gl_FCNTL_H_DEFAULTS): New
	macros.
	(gl_FCNTL_H): Require gl_FCNTL_H_DEFAULTS.
	* modules/fcntl (Makefile.am): Also substitute GNULIB_OPEN and
	REPLACE_OPEN.
	* doc/functions/open.texi: Mention the 'open' module.

2007-10-04  Bruno Haible  <bruno@clisp.org>

	* modules/ceill-tests: New file.
	* tests/test-ceill.c: New file.

	* modules/ceill: New file.
	* lib/ceill.c: Replace entire file.
	* m4/ceill.m4: New file.
	* lib/math.in.h (ceill): Replace declaration.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_CEILL.
	* modules/math (Makefile.am): Substitute also GNULIB_CEILL.
	* doc/functions/ceill.texi: Mention the 'ceill' module.
	* modules/mathl (Files): Remove lib/ceill.c.
	(Depends-on): Add ceill.

2007-10-04  Bruno Haible  <bruno@clisp.org>

	* modules/ceilf-tests: New file.
	* tests/test-ceilf.c: New file.

	* modules/ceilf: New file.
	* lib/ceil.c: New file.
	* lib/ceilf.c: New file.
	* m4/ceilf.m4: New file.
	* lib/math.in.h (ceilf): New declaration.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_CEILF and
	HAVE_DECL_CEILF.
	* modules/math (Makefile.am): Substitute also GNULIB_CEILF and
	HAVE_DECL_CEILF.
	* doc/functions/ceilf.texi: Mention the 'ceilf' module.

2007-10-04  Bruno Haible  <bruno@clisp.org>

	* modules/floorl-tests: New file.
	* tests/test-floorl.c: New file.

	* modules/floorl: New file.
	* lib/floorl.c: Replace entire file.
	* m4/floorl.m4: New file.
	* lib/math.in.h (floorl): Replace declaration.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_FLOORL.
	* modules/math (Makefile.am): Substitute also GNULIB_FLOORL.
	* doc/functions/floorl.texi: Mention the 'floorl' module.
	* modules/mathl (Files): Remove lib/floorl.c.
	(Depends-on): Add floorl.

2007-10-04  Bruno Haible  <bruno@clisp.org>

	* modules/floorf-tests: New file.
	* tests/test-floorf.c: New file.

	* modules/floorf: New file.
	* lib/floor.c: New file.
	* lib/floorf.c: New file.
	* m4/floorf.m4: New file.
	* lib/math.in.h (floorf): New declaration.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_FLOORF and
	HAVE_DECL_FLOORF.
	* modules/math (Makefile.am): Substitute also GNULIB_FLOORF and
	HAVE_DECL_FLOORF.
	* doc/functions/floorf.texi: Mention the 'floorf' module.

2007-10-04  Benoit Sigoure  <tsuna@lrde.epita.fr>
	    Bruno Haible  <bruno@clisp.org>

	Advertise for the Git server instead of the CVS server.
	* doc/gnulib-intro.texi (Steady Development): Mention the Git
	repository instead of the CVS one.
	* doc/gnulib-tool.texi (VCS Issues): Renamed from "CVS Issues". Talk
	about all VCS systems generically.
	* doc/gnulib.texi (Introduction): Capitalize `Git'.

2007-10-04  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib.texi (Function Substitutes): Explain what an absent module
	means.
	Reported by Benoît Sigoure <tsuna@lrde.epita.fr>.

2007-10-04  Bruno Haible  <bruno@clisp.org>

	* modules/truncl-tests: New file.
	* tests/test-truncl.c: New file.

	* modules/truncl: New file.
	* lib/truncl.c: New file.
	* m4/truncl.m4: New file.
	* lib/math.in.h (truncl): New declaration.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_TRUNCL and
	HAVE_DECL_TRUNCL.
	* modules/math (Makefile.am): Substitute also GNULIB_TRUNCL and
	HAVE_DECL_TRUNCL.
	* doc/functions/truncl.texi: Mention the 'truncl' module.

2007-10-04  Bruno Haible  <bruno@clisp.org>

	* modules/truncf-tests: New file.
	* tests/test-truncf.c: New file.

	* modules/truncf: New file.
	* lib/trunc.c: Make paramerizable through USE_* macros.
	* lib/truncf.c: New file.
	* m4/truncf.m4: New file.
	* lib/math.in.h (truncf): New declaration.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_TRUNCF and
	HAVE_DECL_TRUNCF.
	* modules/math (Makefile.am): Substitute also GNULIB_TRUNCF and
	HAVE_DECL_TRUNCF.
	* doc/functions/truncf.texi: Mention the 'truncf' module.

2007-10-03  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_automake_snippet): Synthesize an EXTRA_DIST
	augmentation also for tests modules.
	* modules/argp-tests (Makefile.am): Remove EXTRA_DIST augmentation.
	* modules/atexit-tests (Makefile.am): Likewise.
	* modules/binary-io-tests (Makefile.am): Likewise.
	* modules/c-strcase-tests (Makefile.am): Likewise.
	* modules/canonicalize-lgpl-tests (Makefile.am): Likewise.
	* modules/canonicalize-tests (Makefile.am): Likewise.
	* modules/closein-tests (Makefile.am): Likewise.
	* modules/fprintf-posix-tests (Makefile.am): Likewise.
	* modules/freadahead-tests (Makefile.am): Likewise.
	* modules/fseek-tests (Makefile.am): Likewise.
	* modules/fseeko-tests (Makefile.am): Likewise.
	* modules/ftell-tests (Makefile.am): Likewise.
	* modules/ftello-tests (Makefile.am): Likewise.
	* modules/isnanl-nolibm-tests (Makefile.am): Likewise.
	* modules/isnanl-tests (Makefile.am): Likewise.
	* modules/lseek-tests (Makefile.am): Likewise.
	* modules/mbscasecmp-tests (Makefile.am): Likewise.
	* modules/mbscasestr-tests (Makefile.am): Likewise.
	* modules/mbschr-tests (Makefile.am): Likewise.
	* modules/mbscspn-tests (Makefile.am): Likewise.
	* modules/mbsncasecmp-tests (Makefile.am): Likewise.
	* modules/mbspbrk-tests (Makefile.am): Likewise.
	* modules/mbspcasecmp-tests (Makefile.am): Likewise.
	* modules/mbsrchr-tests (Makefile.am): Likewise.
	* modules/mbsspn-tests (Makefile.am): Likewise.
	* modules/mbsstr-tests (Makefile.am): Likewise.
	* modules/printf-posix-tests (Makefile.am): Likewise.
	* modules/snprintf-posix-tests (Makefile.am): Likewise.
	* modules/sprintf-posix-tests (Makefile.am): Likewise.
	* modules/tsearch-tests (Makefile.am): Likewise.
	* modules/uniname/uniname-tests (Makefile.am): Likewise.
	* modules/unistdio/u16-vasnprintf-tests (Makefile.am): Likewise.
	* modules/unistdio/u32-vasnprintf-tests (Makefile.am): Likewise.
	* modules/unistdio/u8-vasnprintf-tests (Makefile.am): Likewise.
	* modules/unistdio/ulc-vasnprintf-tests (Makefile.am): Likewise.
	* modules/vasnprintf-posix-tests (Makefile.am): Likewise.
	* modules/vfprintf-posix-tests (Makefile.am): Likewise.
	* modules/vprintf-posix-tests (Makefile.am): Likewise.
	* modules/vsnprintf-posix-tests (Makefile.am): Likewise.
	* modules/vsprintf-posix-tests (Makefile.am): Likewise.
	* modules/xstrtoimax-tests (Makefile.am): Likewise.
	* modules/xstrtol-tests (Makefile.am): Likewise.
	* modules/xstrtoumax-tests (Makefile.am): Likewise.
	* modules/yesno-tests (Makefile.am): Likewise.

2007-10-03  Bruno Haible  <bruno@clisp.org>

	* modules/trunc-tests: New file.
	* tests/test-trunc.c: New file.

	* modules/trunc: New file.
	* lib/trunc.c: New file.
	* m4/trunc.m4: New file.
	* lib/math.in.h (trunc): New declaration.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_TRUNC and
	HAVE_DECL_TRUNC.
	* modules/math (Makefile.am): Substitute also GNULIB_TRUNC and
	HAVE_DECL_TRUNC.
	* doc/functions/trunc.texi: Mention the 'trunc' module.

2007-10-03  Bruno Haible  <bruno@clisp.org>

	* tests/test-fpending.c: New file, mostly copied
	from coreutils/lib/t-fpending.c.
	* modules/fpending-tests: New file.

2007-10-03  Bruno Haible  <bruno@clisp.org>

	Port the stdio extensions to QNX (untested).
	* lib/fseterr.c (fseterr): Add support for QNX.
	* lib/fbufmode.c (fbufmode): Likewise.
	* lib/freadable.c (freadable): Likewise.
	* lib/fwritable.c (fwritable): Likewise.
	* lib/freading.c (freading): Likewise.
	* lib/fwriting.c (fwriting): Likewise.
	* lib/freadahead.c (freadahed): Likewise.
	* lib/fpurge.c (fpurge): Likewise.
	* lib/fseeko.c (rpl_fseeko): Likewise.

2007-10-03  Bruno Haible  <bruno@clisp.org>
	    Jim Meyering  <jim@meyering.net>
	    Eric Blake  <ebb9@byu.net>

	* doc/relocatable.texi: Use @command instead of @program.

2007-10-02  Jim Meyering  <jim@meyering.net>

	Perform one more "_.h" -> ".in.h" substitution.
	* modules/unistd (Makefile.am) [unistd.h]: Use unistd.h.in
	instead of unistd_.h here, too.

2007-10-01  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_initmacro_done): Special case for alloca.c.
	Needed for the alloca-opt module.

2007-09-30  Bruno Haible  <bruno@clisp.org>

	* lib/alloca.in.h: Renamed from lib/alloca_.h.
	* modules/alloca-opt (Files, Makefile.am): Use alloca.in.h instead of
	alloca_.h.
	* lib/argz.in.h: Renamed from lib/argz_.h.
	* modules/argz (Files, Makefile.am): Use argz.in.h instead of argz_.h.
	* lib/byteswap.in.h: Renamed from lib/byteswap_.h.
	* modules/byteswap (Files, Makefile.am): Use byteswap.in.h instead of
	byteswap_.h.
	* lib/dirent.in.h: Renamed from lib/dirent_.h.
	* modules/fchdir (Files, Makefile.am): Use dirent.in.h instead of
	dirent_.h.
	* lib/fcntl.in.h: Renamed from lib/fcntl_.h.
	* modules/fcntl (Files, Makefile.am): Use fcntl.in.h instead of
	fcntl_.h.
	* lib/float.in.h: Renamed from lib/float_.h.
	* modules/float (Files, Makefile.am): Use float.in.h instead of
	float_.h.
	* lib/fnmatch.in.h: Renamed from lib/fnmatch_.h.
	* modules/fnmatch (Files, Makefile.am): Use fnmatch.in.h instead of
	fnmatch_.h.
	* lib/getopt.in.h: Renamed from lib/getopt_.h.
	* modules/getopt (Files, Makefile.am): Use getopt.in.h instead of
	getopt_.h.
	* lib/glob.in.h: Renamed from lib/glob_.h.
	* modules/glob (Files, Makefile.am): Use glob.in.h instead of glob_.h.
	* lib/iconv.in.h: Renamed from lib/iconv_.h.
	* modules/iconv_open (Files, Makefile.am): Use iconv.in.h instead of
	iconv_.h.
	* lib/inttypes.in.h: Renamed from lib/inttypes_.h.
	* modules/inttypes (Files, Makefile.am): Use inttypes.in.h instead of
	inttypes_.h.
	* lib/locale.in.h: Renamed from lib/locale_.h.
	* modules/locale (Files, Makefile.am): Use locale.in.h instead of
	locale_.h.
	* lib/math.in.h: Renamed from lib/math_.h.
	* modules/math (Files, Makefile.am): Use math.in.h instead of math_.h.
	* lib/netinet_in.in.h: Renamed from lib/netinet_in_.h.
	* modules/netinet_in (Files, Makefile.am): Use netinet_in.in.h instead
	of netinet_in_.h. Add dependency.
	* lib/poll.in.h: Renamed from lib/poll_.h.
	* modules/poll (Files, Makefile.am): Use poll.in.h instead of poll_.h.
	* lib/search.in.h: Renamed from lib/search_.h.
	* modules/search (Files, Makefile.am): Use search.in.h instead of
	search_.h.
	* lib/signal.in.h: Renamed from lib/signal_.h.
	* modules/signal (Files, Makefile.am): Use signal.in.h instead of
	_signal.h.
	* lib/stdbool.in.h: Renamed from lib/stdbool_.h.
	* modules/stdbool (Files, Makefile.am): Use stdbool.in.h instead of
	stdbool_.h.
	* lib/stdint.in.h: Renamed from lib/stdint_.h.
	* modules/stdint (Files, Makefile.am): Use stdint.in.h instead of
	stdint_.h.
	* lib/stdio.in.h: Renamed from lib/stdio_.h.
	* modules/stdio (Files, Makefile.am): Use stdio.in.h instead of
	stdio_.h.
	* lib/stdlib.in.h: Renamed from lib/stdlib_.h.
	* modules/stdlib (Files, Makefile.am): Use stdlib.in.h instead of
	stdlib_.h.
	* lib/string.in.h: Renamed from lib/string_.h.
	* modules/string (Files, Makefile.am): Use string.in.h instead of
	string_.h.
	* doc/gnulib-tool.texi (Initial import): Update.
	* lib/sys_select.in.h: Renamed from lib/sys_select_.h.
	* modules/sys_select (Files, Makefile.am): Use sys_select.in.h instead
	of sys_select_.h. Add dependency.
	* lib/sys_socket.in.h: Renamed from lib/sys_socket_.h.
	* modules/sys_socket (Files, Makefile.am): Use sys_socket.in.h instead
	of sys_socket_.h.
	* lib/sys_stat.in.h: Renamed from lib/sys_stat_.h.
	* modules/sys_stat (Files, Makefile.am): Use sys_stat.in.h instead of
	sys_stat_.h.
	* lib/sys_time.in.h: Renamed from lib/sys_time_.h.
	* modules/sys_time (Files, Makefile.am): Use sys_time.in.h instead of
	sys_time_.h.
	* lib/sysexits.in.h: Renamed from lib/sysexits_.h.
	* modules/sysexits (Files, Makefile.am): Use sysexits.in.h instead of
	sysexits_.h.
	* lib/time.in.h: Renamed from lib/time_.h.
	* modules/time (Files, Makefile.am): Use time.in.h instead of time_.h.
	* lib/unistd.in.h: Renamed from lib/unistd_.h.
	* modules/unistd (Files, Makefile.am): Use unistd.in.h instead of
	unistd_.h.
	* lib/wchar.in.h: Renamed from lib/wchar_.h.
	* modules/wchar (Files, Makefile.am): Use wchar.in.h instead of
	wchar_.h.
	* lib/wctype.in.h: Renamed from lib/wctype_.h.
	* modules/wctype (Files, Makefile.am): Use wctype.in.h instead of
	wctype_.h.
	* build-aux/bootstrap (slurp): Update.
	* lib/.cppi-disable: Update.

2007-09-30  Bruno Haible  <bruno@clisp.org>

	* tests/test-getaddrinfo.c (AF_UNSPEC): Provide a fallback definition.
	Needed on BeOS.

2007-09-30  Bruno Haible  <bruno@clisp.org>

	* modules/dirname-tests (check_PROGRAMS): Renamed from noinst_PROGRAMS.

2007-09-29  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h (getdelim, getline): Add identifiers. Doc tweak.

2007-09-29  Bruno Haible  <bruno@clisp.org>

	* lib/xreadlink.c (xreadlink): Simplify to a wrapper around areadlink.
	* modules/xreadlink (Depends-on): Add areadlink, remove readlink etc.
	* build-aux/install-reloc: Compile also areadlink.c.
	* modules/relocatable-prog-wrapper (Files): Add lib/areadlink.[hc].

2007-09-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_initmacro_done): Indentation.

2007-09-29  Bruno Haible  <bruno@clisp.org>

	* README: Add CVS checkout update instructions.
	Info from Bob Proulx <bob@proulx.com>.

2007-09-28  Eric Blake  <ebb9@byu.net>

	Provide move-if-change.
	* build-aux/move-if-change: New file, based on best practice
	rather than any canonical upstream location.

2007-09-28  Jim Meyering  <jim@meyering.net>

	Fix canonicalize loop-detection corner case.
	Do not attempt to stat the symlink values stored via seen_triple.
	Without this, coreutils' tests/misc/readlink-fp-loop test would fail
	on linux-2.6.18, (but not 2.6.22).
	* lib/canonicalize.c (seen_triple): Use triple_compare_ino_str, not
	triple_compare.  The former compares dev,ino,filename, while the latter
	would actually stat dirname(filename) when dev and ino were equal.
	* lib/hash-triple.c: Install <string.h>.
	(STREQ): Define.
	(triple_compare_ino_str): New function.
	* lib/hash-triple.h (triple_compare_ino_str): Declare it.

2007-09-28  Eric Blake  <ebb9@byu.net>

	Enforce that AC_REPLACE_FUNCS files exist.
	* gnulib-tool (func_emit_initmacro_done): Make AC_LIBSOURCES
	override check for typos.

	Fix test-closein on Solaris 10.
	* tests/test-closein.c (main): Don't assume stdin can be inherited
	closed on all systems.
	* tests/test-closein.sh: Likewise.
	Reported by Piotr Tarnowski.

2007-09-28  Jim Meyering  <jim@meyering.net>

	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP): Fix typo in comment.

2007-09-27  Jim Meyering  <jim@meyering.net>

	canonicalize: Avoid a false-positive cycle failure.
	* modules/canonicalize (Depends-on): Add file-set and hash-triple.
	Sort.  Remove cycle-check.
	* lib/canonicalize.c: Include file-set.h and hash-triple.h,
	not cycle-check.h.
	(seen_triple): New function.
	(canonicalize_filename_mode): Use it instead of cycle-check.
	* tests/test-canonicalize.c: Add a test for this bug.
	* tests/test-canonicalize.sh: Set up and run the test.

	New module, file-set, from coreutils.
	* modules/file-set: Define it.
	* lib/file-set.c, lib/file-set.h: Implement.

	New module, hash-triple, from coreutils.
	* modules/hash-triple: Define it.
	* lib/hash-triple.c, lib/hash-triple.h: Implement.

2007-09-25  Eric Blake  <ebb9@byu.net>

	Fix strerror on Interix.
	* lib/string_.h (strerror): Declare replacement.
	* doc/functions/strerror.texi (strerror): Document the Interix
	shortcoming.
	* modules/string (Makefile.am): Support new hooks.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Add new hooks.
	* m4/strerror.m4 (gl_FUNC_STRERROR): Defer to
	gl_FUNC_STRERROR_SEPARATE.
	(gl_FUNC_STRERROR_SEPARATE): Check for Interix bug.
	* lib/strerror.c (rpl_strerror): Provide replacement.
	* modules/strerror (Depends-on): Add string.
	(configure.ac): Detect use of module.
	* tests/test-strerror.c: New file.
	* modules/strerror-tests: New test module.
	* modules/argp (Depends-on): Add strerror.
	* modules/error (Depends-on): Likewise.
	Reported by Martin Koeppe.

2007-09-24  Bruno Haible  <bruno@clisp.org>

	* README: Update git instructions.

2007-09-24  Eric Blake  <ebb9@byu.net>

	Revert fpending breakage from 2007-09-08.
	* m4/fpending.m4 (gl_FUNC_FPENDING): Don't require existence of
	__fpending.c.

2007-09-24  Jim Meyering  <jim@meyering.net>

	filenamecat.c: Add a test.
	* lib/filenamecat.c (main) [TEST_FILE_NAME_CONCAT]: Add a test
	showing how the function works when DIR is the empty string.

2007-09-21  Simon Josefsson  <simon@josefsson.org>

	* tests/test-canonicalize.sh: Turn on executable bit.

2007-09-19  Eric Blake  <ebb9@byu.net>

	* README: Update CVS instructions.

2007-09-18  Bruno Haible  <bruno@clisp.org>

	* modules/areadlink: New file.
	* lib/areadlink.h (areadlink): New declaration.
	* lib/areadlink.c: New file, based on lib/xreadlink.c.

2007-09-17  Jim Meyering  <jim@meyering.net>

	* lib/savewd.c (ESTALE) [!defined]: Define.
	Reported to be required on Interix by Martin Koeppe.

2007-09-17  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_version): Use $version.

2007-09-16  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_LONG_DOUBLE, gl_PRINTF_INFINITE,
	gl_PRINTF_INFINITE_LONG_DOUBLE): Increase buf's size from 100 to 10000.
	Needed on glibc-2.6.1 with -fstack-protector -D_FORTIFY_SOURCE=2.
	Reported by Greg Schafer <gschafer@zip.com.au>.

2007-09-15  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (sed): Try a little harder to make bash understand the
	alias.
	Reported by Bruce Korb <bruce.korb@gmail.com>.

2007-09-13  Eric Blake  <ebb9@byu.net>

	* ChangeLog: Remove conflict markers.

2007-09-13  Simon Josefsson  <simon@josefsson.org>

	* lib/gc-gnulib.c (gc_hash_open): Catch NULL calloc return value.
	Reported by Bruno Haible <bruno@clisp.org>.

2007-09-12  Bruno Haible  <bruno@clisp.org>

	* m4/lock.m4: Don't provide an AC_USE_SYSTEM_EXTENSIONS definition.
	(gl_LOCK_EARLY_BODY): Use AC_GNU_SOURCE when AC_USE_SYSTEM_EXTENSIONS
	is not defined.

2007-09-12  Eric Blake  <ebb9@byu.net>

	Track CVS Autoconf on AC_USE_SYSTEM_EXTENSIONS.
	* m4/extensions.m4 (AC_USE_SYSTEM_EXTENSIONS): Update to CVS
	Autoconf definition.
	* modules/euidaccess (Depends-on): Add extensions, for
	AC_USE_SYSTEM_EXTENSIONS with autoconf <= 2.59.
	* modules/fnmatch (Depends-on): Likewise.
	* modules/getaddrinfo (Depends-on): Likewise.
	* modules/getdelim (Depends-on): Likewise.
	* modules/getline (Depends-on): Likewise.
	* modules/getsubopt (Depends-on): Likewise.
	* modules/gettext (Depends-on): Likewise.
	* modules/group-member (Depends-on): Likewise.
	* modules/mbchar (Depends-on): Likewise.
	* modules/memmem (Depends-on): Likewise.
	* modules/mempcpy (Depends-on): Likewise.
	* modules/memrchr (Depends-on): Likewise.
	* modules/pagealign_alloc (Depends-on): Likewise.
	* modules/readutmp (Depends-on): Likewise.
	* modules/stpcpy (Depends-on): Likewise.
	* modules/stpncpy (Depends-on): Likewise.
	* modules/strchrnul (Depends-on): Likewise.
	* modules/strndup (Depends-on): Likewise.
	* modules/strsep (Depends-on): Likewise.
	* modules/strverscmp (Depends-on): Likewise.
	* modules/vasprintf (Depends-on): Likewise.
	* modules/wcwidth (Depends-on): Likewise.
	* m4/euidaccess.m4 (gl_FUNC_EUIDACCESS): AC_GNU_SOURCE will be
	obsolete in Autoconf 2.62; use AC_USE_SYSTEM_EXTENSIONS instead.
	* m4/fnmatch.m4 (gl_FUNC_FNMATCH_GNU): Likewise.
	* m4/getaddrinfo.m4 (gl_PREREQ_GETADDR_INFO): Likewise.
	* m4/getdelim.m4 (gl_FUNC_GETDELIM): Likewise.
	* m4/getline.m4 (gl_FUNC_GETLINE): Likewise.
	* m4/getsubopt.m4 (gl_FUNC_GETSUBOPT): Likewise.
	* m4/glob.m4 (gl_PREREQ_GLOB): Likewise.
	* m4/group-member.m4 (gl_FUNC_GROUP_MEMBER): Likewise.
	* m4/mbchar.m4 (gl_MBCHAR): Likewise.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): Likewise.
	* m4/mempcpy.m4 (gl_FUNC_MEMPCPY): Likewise.
	* m4/memrchr.m4 (gl_FUNC_MEMRCHR): Likewise.
	* m4/mmap-anon.m4 (gl_FUNC_MMAP_ANON): Likewise.
	* m4/pagealign_alloc.m4 (gl_PAGEALIGN_ALLOC): Likewise.
	* m4/readutmp.m4 (gl_READUTMP): Likewise.
	* m4/regex.m4 (gl_PREREQ_REGEX): Likewise.
	* m4/stpcpy.m4 (gl_FUNC_STPCPY): Likewise.
	* m4/stpncpy.m4 (gl_FUNC_STPNCPY): Likewise.
	* m4/strchrnul.m4 (gl_FUNC_STRCHRNUL): Likewise.
	* m4/strndup.m4 (gl_FUNC_STRNDUP): Likewise.
	* m4/strnlen.m4 (gl_FUNC_STRNLEN): Likewise.
	* m4/strsep.m4 (gl_FUNC_STRSEP): Likewise.
	* m4/strverscmp.m4 (gl_FUNC_STRVERSCMP): Likewise.
	* m4/vasprintf.m4 (gl_PREREQ_VASPRINTF_H): Likewise.
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Likewise.
	* m4/lock.m4 (gl_LOCK_EARLY_BODY): Likewise, but provide fallback,
	so that lock.m4 can be used in gettext without extensions module.

2007-09-11  Bruno Haible  <bruno@clisp.org>

	* m4/isc-posix.m4: Remove file.
	Suggested by Eric Blake.

2007-09-11  Eric Blake  <ebb9@byu.net>

	* ChangeLog: Restore lines accidentally truncated 2007-04-06.

2007-09-10  Bruno Haible  <bruno@clisp.org>

	* posix-modules: Fix typo in error message.
	Reported by Matt <mkraai@beckman.com>.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	* doc/functions/getdelim.texi: Update list of platforms lacking the
	function.
	* doc/functions/getline.texi: Likewise.

2007-09-09  Jim Meyering  <jim@meyering.net>

	* lib/hash.c (hash_initialize): Detect calloc failure.
	Reported by Bruno Haible.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	* lib/canonicalize-lgpl.c (__realpath): Set errno to ENOMEM when
	malloc or realloc fails.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	* modules/getcwd (Depends-on): Add malloc-posix.
	* modules/glob (Depends-on): Likewise.
	* modules/putenv (Depends-on): Likewise.
	* modules/strdup (Depends-on): Likewise.
	* modules/getdelim (Depends-on): Add realloc-posix.
	* modules/read-file (Depends-on): Likewise.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	* m4/malloc.m4 (gl_CHECK_MALLOC_POSIX): New macro.
	(gl_FUNC_MALLOC_POSIX): Require it.
	* m4/realloc.m4 (gl_FUNC_REALLOC_POSIX): Likewise.
	* m4/calloc.m4 (gl_FUNC_CALLOC_POSIX): Likewise.
	* modules/realloc (Files): Add m4/malloc.m4.
	* modules/calloc (Files): Likewise.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	* modules/malloc-posix: New file.
	* modules/malloc (Depends-on): Add malloc-posix.
	* lib/malloc.c: Include errno.h.
	(rpl_malloc): Merge the requirements of a glibc-compatible malloc
	and a POSIX-compatible malloc into a single function. Set ENOMEM
	when returning NULL.
	* m4/malloc.m4: New file.
	* doc/functions/malloc.texi: Mention the malloc-posix module.
	* lib/stdlib_.h (malloc): New declaration.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Initialize
	GNULIB_MALLOC_POSIX and HAVE_MALLOC_POSIX.
	* modules/stdlib (stdlib.h): Substitute also GNULIB_MALLOC_POSIX
	and HAVE_MALLOC_POSIX.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	* modules/realloc-posix: New file.
	* modules/realloc (Depends-on): Add realloc-posix.
	* lib/realloc.c: Include errno.h.
	(rpl_realloc): Merge the requirements of a glibc-compatible realloc
	and a POSIX-compatible realloc into a single function. Set ENOMEM
	when returning NULL.
	* m4/realloc.m4: New file.
	* doc/functions/realloc.texi: Mention the realloc-posix module.
	* lib/stdlib_.h (realloc): New declaration.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Initialize
	GNULIB_REALLOC_POSIX and HAVE_REALLOC_POSIX.
	* modules/stdlib (stdlib.h): Substitute also GNULIB_REALLOC_POSIX
	and HAVE_REALLOC_POSIX.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	* modules/calloc-posix: New file.
	* modules/calloc (Depends-on): Add calloc-posix.
	* lib/calloc.c: Include errno.h.
	(rpl_calloc): Merge the requirements of a glibc-compatible calloc
	and a POSIX-compatible calloc into a single function. Set ENOMEM
	when returning NULL.
	* m4/calloc.m4 (gl_FUNC_CALLOC_POSIX): New macro.
	* doc/functions/calloc.texi: Mention the calloc-posix module.
	* lib/stdlib_.h (calloc): New declaration.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Initialize
	GNULIB_CALLOC_POSIX and HAVE_CALLOC_POSIX.
	* modules/stdlib (stdlib.h): Substitute also GNULIB_CALLOC_POSIX
	and HAVE_CALLOC_POSIX.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	Allow for modules to show an arbitrary notice.
	* modules/TEMPLATE-EXTENDED: Add 'Notice' field.
	* gnulib-tool: New option --extract-notice.
	(func_usage): Document it.
	(sed_extract_prog): Update.
	(func_get_notice): New function.
	(func_modules_notice): New function.
	(func_import, func_create_testdir): Invoke it.
	Suggested by Jim Meyering.

2007-09-09  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: New options --verbose, --quiet.
	(func_usage): Document them.
	(verbose): New variable.
	(func_execute_command): New function.
	(func_import): Don't show the module list and the file list if
	$verbose < 0.
	(func_create_testdir): Likewise. Use func_execute_command.
	(func_create_megatestdir): Use func_execute_command.

2007-09-08  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Prefer rsync over wget when available,
	for fetching the PO files.

2007-09-08  Bruno Haible  <bruno@clisp.org>

	* posix-modules: New file. Portions copied from gnulib-tool.
	* doc/gnulib.texi (POSIX Substitutes Library): New chapter.

2007-09-08  Jim Meyering  <jim@meyering.net>

	Rename __fpending.c -> fpending.c and __fpending.h -> fpending.h
	* lib/fpending.h: Rename from __fpending.h.
	* lib/fpending.c: Rename from __fpending.c.
	Include "fpending.h", not "__fpending.h".
	* lib/__fpending.h, lib/__fpending.c: Remove files.
	* modules/fpending (Files): Reflect new file names.
	* lib/close-stream.c: Include "fpending.h", not "__fpending.h".

2007-09-08  Bruno Haible  <bruno@clisp.org>

	* m4/inttypes-h.m4: Remove stub file.

2007-09-07  Simon Josefsson  <simon@josefsson.org>

	* doc/headers/stdint.texi: Discuss #include_next issue.

2007-09-06  Paul Eggert  <eggert@cs.ucla.edu>

	* build-aux/bootstrap: Remove obsolete comment about wget --help.

2007-09-06  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* m4/time_h.m4 (gl_CHECK_TYPE_STRUCT_TIMESPEC): Fix misspelling
	in variable name.

2007-09-03  Jim Meyering  <jim@meyering.net>

	New module: git-version-gen.
	* modules/git-version-gen: New file.

	Import changes from coreutils for bootstrap script.

	* build-aux/bootstrap (WGET_COMMAND): Remove code to set this variable.

	bootstrap: uses rsync to download the .po files
	* build-aux/bootstrap (po_download_command_format): New global.
	(download_po_files): Use rsync.
	(update_po_files): Don't remove .po files after download,
	so future rsync runs can take advantage of the copies.

	* build-aux/bootstrap (gnulib_tool): Make sha1sum check quietly.

	Solve the unnecessary-.po-file-regeneration problem once and for all.
	* build-aux/bootstrap (download_po_files): New function, renamed from
	get_translations.  Now, downloads, but doesn't update LINGUAS.
	(update_po_files): New function.

	bootstrap: Ignore more.
	* build-aux/bootstrap (symlink_to_dir): Add a directory name like
	uniwidth to e.g., lib/.gitignore.
	(slurp): Handle the sys_stat_.h -> sys mapping, too.

	* build-aux/bootstrap: New setting: vc_ignore.
	(insert_sorted_if_absent): Create $file if absent.
	Adapt to new, possibly empty, list: $vc_ignore.

	bootstrap: generate more ignorable names
	* build-aux/bootstrap (slurp): When generating ignorable names,
	also map .sin to .sed, .gperf to .c, and .y to .c.

2007-09-03  Jim Meyering  <jim@meyering.net>

	* build-aux/git-version-gen: New file, from coreutils.  For details, see
	http://git.sv.gnu.org/gitweb/?p=coreutils.git;a=commitdiff;h=bfe49f506

2007-09-02  Bruno Haible  <bruno@clisp.org>

	Fix mis-recognition of 'mcs' on QNX 6.
	* m4/csharpcomp.m4 (gt_CSHARPCOMP): Test whether the "mcs --version"
	output contains the string "Mono".
	* lib/csharpcomp.c (compile_csharp_using_mono): Likewise.
	Reported by <kraai@ftbfs.org> at <https://savannah.gnu.org/bugs/?18337>.

2007-09-01  Bruno Haible  <bruno@clisp.org>

	Fix collision between uniwidth/* and linebreak modules.
	* lib/linebreak.h (locale_charset, uc_width, u8_width, u16_width,
	u32_width): Remove declarations.
	* lib/linebreak.c: Include uniwidth.h, uniwidth/cjk.h, streq.h.
	(u32_mbtouc_unsafe, streq9, streq8, streq7, streq6, streq5, streq4,
	streq3, streq2, streq1, streq0): Remove functions.
	(STREQ): Remove macro.
	(is_cjk_encoding): Remove function.
	(nonspacing_table_data, nonspacing_table_ind): Remove constants.
	(uc_width, u8_width, u16_width, u32_width): Remove functions.
	* modules/linebreak (Depends-on): Add streq, uniwidth/width.
	* NEWS: Document the change.

2007-09-01  Bruno Haible  <bruno@clisp.org>

	* lib/streq.h: Add double-inclusion guard.

2007-09-01  Karl Berry  <karl@gnu.org>

	* MODULES.html.sh: Rename mreadlink_with_size to areadlink_with_size.

2007-08-28  Jim Meyering  <jim@meyering.net>

	Rename mreadlink_with_size to areadlink_with_size.
	* NEWS: Document the change.
	* lib/mreadlink-with-size.c (mreadlink_with_size): Rename this to...
	* lib/areadlink-with-size.c (areadlink_with_size): ...this.
	* lib/mreadlink.h: Rename this to...
	* lib/areadlink.h: ...this.
	* modules/mreadlink-with-size: Rename this to...
	* modules/areadlink-with-size: ...this.
	* lib/canonicalize.c: Reflect the renaming.
	* modules/canonicalize: Likewise.

2007-08-26  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): When deciding which files to remove,
	consider also dangling symbolic links.
	Reported by Eric Blake.

2007-08-26  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_ln_if_changed): Use "test -h", not "test -L".

2007-08-23  Simon Josefsson  <simon@josefsson.org>

	* lib/readline.c: Don't include getline.h, the prototype is now
	found in stdio.h.

2007-08-23  Jim Meyering  <jim@meyering.net>

	Getdelim touchup.
	* lib/getdelim.c (getdelim): Don't bother to save/restore errno
	around the funlockfile call, since funlockfile never sets errno.
	Don't set errno upon failed realloc.

2007-08-22  Eric Blake  <ebb9@byu.net>

	Getline touchups.
	* lib/getdelim.c (getdelim): Revert regression that required *n to
	be 0 when *lineptr is NULL.  Preserve errno across funlockfile.
	* m4/getdelim.m4 (gl_FUNC_GETDELIM): Check for declaration of
	getdelim, rather than whether implementation is missing.
	* m4/getline.m4 (gl_FUNC_GETLINE): Likewise for getline.
	* lib/stdio_.h (getline): Also declare if replacement is
	required.
	* doc/functions/getdelim.texi: New file.
	* doc/functions/getline.texi: Likewise.
	* doc/gnulib.texi (Function Substitutes): Add new files.
	Reported by Bruno Haible.

2007-08-22  Ludovic Courtès  <ludo@gnu.org>

	* users.txt: Add Guile.

2007-08-22  Eric Blake  <ebb9@byu.net>

	* tests/test-getdelim.c (main): Use remove, not unlink.
	* tests/test-getline.c (main): Likewise.

	Move getline and getdelim into stdio.h, per POSIX 200x.
	* modules/getline (Files): Remove getline.h.
	(Depends-on): Add stdio.
	(configure.ac): Add module indicator.
	* modules/getdelim (Files): Remove getdelim.h.
	(Depends-on): Add stdio.
	(configure.ac): Add module indicator.
	* modules/stdio (Makefile.am): Work with new indicators.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Add new defaults.
	* m4/getdelim.m4 (gl_FUNC_GETDELIM): Work with stdio needs.
	* m4/getline.m4 (gl_FUNC_GETLINE): Likewise.
	* lib/getdelim.h: Delete.
	* lib/getline.h: Delete.
	* lib/stdio_.h (getdelim, getline): Declare.
	* modules/getdelim-tests: New module.
	* modules/getline-tests: Likewise.
	* tests/test-getdelim.c: New file.
	* tests/test-getline.c: Likewise.
	* NEWS: Document the change.
	* lib/getline.c: Update choice of header.
	* lib/csharpcomp.c: Likewise.
	* lib/getpass.c: Likewise.
	* lib/javacomp.c: Likewise.
	* lib/javaversion.c: Likewise.
	* lib/yesno.c: Likewise.
	* lib/getdelim.c: Likewise.
	(getdelim): Set errno on failure, and avoid memory leak.

2007-08-19  Bruno Haible  <bruno@clisp.org>

	* modules/closein (Depends-on): Add freadahead.
	* lib/closein.c: Include freadahead.h.
	(close_stdin): Skip the fseeko and fflush calls if freadahead(stdin)
	is zero.

2007-08-19  Bruno Haible  <bruno@clisp.org>

	* modules/freadahead-tests: New file.
	* tests/test-freadahead.sh: New file.
	* tests/test-freadahead.c: New file.

	* modules/freadahead: New file.
	* lib/freadahead.h: New file.
	* lib/freadahead.c: New file.
	* MODULES.html.sh (File stream based Input/Output): Add freadahead,
	fbufmode, fpurge, freadable, fwritable.

2007-08-19  Eric Blake  <ebb9@byu.net>

	Test yesno in combination with closein.
	* lib/yesno.c (yesno): Document use of stdin.
	* modules/yesno-tests (Files): New module.
	* tests/test-yesno.c (main): New file.
	* tests/test-yesno.sh: Likewise.

2007-08-19  Bruno Haible  <bruno@clisp.org>

	* lib/fbufmode.c (fbufmode): Add tentative support for Solaris/AMD64.
	* lib/fseeko.c (rpl_fseeko): Likewise.
	* lib/fseterr.c (fseterr): Likewise.

2007-08-19  Bruno Haible  <bruno@clisp.org>

	* tests/test-lseek.c (main): Disable a test for BeOS.
	* doc/functions/lseek.texi: Document the BeOS bug.

2007-08-19  Bruno Haible  <bruno@clisp.org>
	    Eric Blake  <ebb9@byu.net>

	* lib/lseek.c: Include <sys/stat.h>.
	(rpl_lseek): Add workaround code also for Unix platforms.
	Needed for BeOS.
	* m4/lseek.m4 (gl_FUNC_LSEEK): When cross-compiling, fail on BeOS.
	* doc/functions/lseek.texi: Document BeOS definiency.

2007-08-18  Bruno Haible  <bruno@clisp.org>

	* modules/fstrcmp-tests: New file.
	* tests/test-fstrcmp.c: New file.

2007-08-18  Bruno Haible  <bruno@clisp.org>

	* modules/fstrcmp: New file, from GNU gettext with modifications.
	* lib/fstrcmp.h: New file, from GNU gettext.
	* lib/fstrcmp.c: New file, from GNU gettext.
	* MODULES.html.sh (String handling): Add fstrcmp.

2007-08-18  Bruno Haible  <bruno@clisp.org>

	* lib/diffseq.h (struct context): Change type of 'heuristic' field to
	'bool'.
	(diag, compareseq): Remove const from the ctxt argument.
	(USE_HEURISTIC): Undefine at the end.

2007-08-18  Jim Meyering  <jim@meyering.net>

	New file: lib/idcache.h
	* NEWS: Mention the addition.
	* modules/idcache (Files): Add lib/idcache.h
	* lib/idcache.c: Include "idcache.h".
	Don't include <sys/types.h>.
	Add a FIXME comment.
	Move file-scoped "static" declarations to the top.
	* lib/idcache.h: New file.  Include <sys/types.h> here, instead.

2007-08-17  Bruno Haible  <bruno@clisp.org>
	and Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh: Add diffseq.
	* modules/diffseq: New file.
	* lib/diffseq.h: New file, from GNU gettext with a few minor changes,
	extracted from GNU gettext's fstrcmp.c and GNU diff's analyze.c.

2007-08-15  Paul Eggert  <eggert@cs.ucla.edu>

	Import changes from coreutils for bootstrap script.

	2007-07-21  Paul Eggert  <eggert@cs.ucla.edu>

	* build-aux/bootstrap (slurp): Work even in environments where
	"ls" defaults to "ls -A".  Put in a FIXME, though, since the
	current code does not slurp files whose names start with ".", and
	this looks like it might be a troublesome area.

	2007-07-11  Jim Meyering  <jim@meyering.net>

	If there's a GPL vN copyright comment, require that N == 3.

	2007-07-08  Jim Meyering  <jim@meyering.net>

	Run the coreutils-specific code only if tests/Makefile.am.in exists.
	* build-aux/bootstrap (mam_template): Move definition out of loop.

	Create symlinks for gl/{lib,m4}/*, just as for gnulib/{lib,m4}/*.

	* build-aux/bootstrap (symlink_to_dir): Rename function from
	symlink_to_gnulib.  Add a directory parameter.  Update all
	callers.
	(cp_mark_as_generated): Also check for -- and link to -- files in
	gl/.

	2007-07-08  Jim Meyering  <jim@meyering.net>

	Adapt to deeper hierarchy in gnulib.
	* build-aux/bootstrap (symlink_to_dir): If the destination
	directory doesn't exist, create it. This is required at least for
	"lib/uniwidth/cjk.h".

	2007-05-15  Jim Meyering  <jim@meyering.net>

	* build-aux/bootstrap: Now that generated Makefile.am files
	are no longer under version control, they must be created at
	bootstrap time.

2007-08-14  Ben Pfaff  <blp@gnu.org>

	* lib/count-one-bits.h: Add comments.  From Bruno Haible.

2007-08-14  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/count-one-bits.h: Don't include <limits.h>; no longer needed
	given the changes below.
	(COUNT_ONE_BITS): Use 'verify' rather than 'verify_true'.  Work
	even on hosts that have padding bits beyond the supported 64.

2007-08-10  Paul Eggert  <eggert@cs.ucla.edu>

	* NEWS: In xstrtol, remove STRTOL_FATAL_ERROR and add xstrtol_fatal.
	* lib/xstrtol.h: Don't include exitfail.h; that's now internal to
	xstrtol.c.  Include getopt.h, since xstrtol_fatal's signature
	depends on it.
	(xstrtol_error): Remove.
	(xstrtol_fatal): New decl, replacing the functionality of xstrtol_error
	but with a different signature.
	(ATTRIBUTE_NORETURN, __attribute__): New macros.
	* lib/xstrtol-error.c: Include exitfail.h.
	(xstrtol_fatal): New function, with a different signature from the
	old xstrtol_error, so that the caller need not worry about passing
	in an exit status, or about storage management of the option argument.
	(xstrtol_error): Now a static function.  Redo signature to
	implement xstrtol_fatal.  Output the correct number of hyphens in
	front of the option so that the caller need not worry about
	storage management.
	(N_): New macro.
	(_): Remove; not used now.
	* modules/xstrtol: Depend on getopt.
	* tests/test-xstrtol.c (main): Use new xstrtol_error function instead
	of old STRTOL_FATAL_ERROR macro.
	* tests/test-xstrtol.sh (t-xstrtol.xo): Adjust to match new behavior
	of test program.
	* tests/test-xstrtoimax.sh (t-xstrtoimax.xo): Likewise.
	* tests/test-xstrtoumax.sh (t-xstrtoumax.xo): Likewise.

2007-08-08  Eric Blake  <ebb9@byu.net>

	* lib/xstrtol-error.c: Add missing include.

	Move xstrtol messages into gnulib domain, when --pobase is used.
	* lib/xstrtol.h (_STRTOL_ERROR): Move messages out of macro...
	* lib/xstrtol-error.c (xstrtol_error): ...into new file.
	* modules/xstrtol (Files): Distribute new file.
	* m4/xstrtol.m4 (gl_XSTRTOL): Build new file.
	* lib/xstrtol.c (TESTING_XSTRTO): Move tests...
	* tests/test-xstrtol.c: ...into new file.
	* tests/test-xstrtoul.c: Also test xstrtoul.
	* tests/test-xstrtoimax.c: Also test xstrtoimax.
	* tests/test-xstrtoumax.c: Also test xstrtoumax.
	* tests/test-xstrtol.sh: Drive the tests.
	* tests/test-xstrtoimax.sh: Likewise.
	* tests/test-xstrtoumax.sh: Likewise.
	* modules/xstrtol-tests: New module.
	* modules/xstrtoimax-tests: Likewise.
	* modules/xstrtoumax-tests: Likewise.

2007-08-08  Jim Meyering  <jim@meyering.net>

	New function: mfile_name_concat.
	* lib/filenamecat.c (mfile_name_concat): New function, just like
	file_name_concat, but return NULL upon failure rather than exiting
	with a diagnostic.
	* lib/filenamecat.h: Declare it.

2007-08-07  Bruno Haible  <bruno@clisp.org>

	* m4/inttypes.m4 (gl_INTTYPES_H): Use GL_TRIGGER_STDC_LIMIT_MACROS
	instead of __STDC_LIMIT_MACROS_TRIGGER. This avoids a redefinition
	warning from gcc.
	Reported by Eric Blake.

2007-08-07  Simon Josefsson  <simon@josefsson.org>

	* modules/crypto/arctwo (License): Use the synonymous term "LGPLv2+".
	* modules/crypto/arcfour (License): Likewise.
	* modules/crypto/des-tests (License): Likewise.
	* modules/crypto/gc-arctwo-tests (License): Likewise.
	* modules/crypto/gc-des-tests (License): Likewise.
	* modules/crypto/gc-hmac-md5-tests (License): Likewise.
	* modules/crypto/gc-hmac-sha1-tests (License): Likewise.
	* modules/crypto/gc-md2-tests (License): Likewise.
	* modules/crypto/gc-md4-tests (License): Likewise.
	* modules/crypto/gc-md5-tests (License): Likewise.
	* modules/crypto/gc-pbkdf2-sha1-tests (License): Likewise.
	* modules/crypto/gc-rijndael-tests (License): Likewise.
	* modules/crypto/gc-sha1-tests (License): Likewise.
	* modules/crypto/gc-tests (License): Likewise.
	* modules/crypto/hmac-md5 (License): Likewise.
	* modules/crypto/hmac-sha1 (License): Likewise.
	* modules/crypto/md2-tests (License): Likewise.
	* modules/crypto/md4-tests (License): Likewise.
	* modules/crypto/md5 (License): Likewise.
	* modules/crypto/rijndael (License): Likewise.
	* modules/crypto/sha1 (License): Likewise.
	* modules/memxor (License): Likewise.

2007-08-06  Paul Eggert  <eggert@cs.ucla.edu>
	and Bruno Haible  <bruno@clisp.org>

	* NEWS: Describe interface changes to human, xstrtol.
	* lib/human.h: Include <xstrtol.h>.
	(human_options): Return enum strtol_error, not int.  Remove
	bool arg; take int * instead.
	* lib/human.c: Don't include "gettext.h".
	(_): Remove; no longer used.
	Don't include <xstrtol.h>, since human.h does it.
	(human_options): Adjust to abovementioned interface changes.
	Do not report error to stderr; that's now the caller's
	responsibility.
	* lib/xstrtol.c (main) [defined TESTING_XSTRTO]: Adjust to
	interface change.
	* lib/xstrtol.h (_STRTOL_ERROR): Take Option, Arg rather than
	Str, Argument_type_string.  All uses changed.  Put " argument"
	in diagnostics to make them clearer.  Change wording of suffix
	message for clarity.
	(STRTOL_FATAL_ERROR): Take Option, Arg rather than Str,
	Argument_type_string.
	(STRTOL_FATAL_WARN): Remove; no longer used.
	* modules/human (Depends-on): Remove gettext-h.

2007-08-06  Simon Josefsson  <simon@josefsson.org>

	* build-aux/maint.mk, build-aux/GNUmakefile: Relicense to GPLv3+.

2007-07-31  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H): Test whether WCHAR_MIN and WCHAR_MAX
	are defined by <stdint.h> (as opposed to <wchar.h>, as on Dragonfly).
	Reported by Joerg Sonnenberger <joerg@britannica.bec.de>.

2007-07-31  Bruno Haible  <bruno@clisp.org>

	* lib/fflush.c (rpl_fflush): On BSD systems, use the __SNPT flag.
	Suggested by Joerg Sonnenberger <joerg@britannica.bec.de>.

2007-07-30  Bruno Haible  <bruno@clisp.org>

	* modules/base64 (License): Use the synonymous term "LGPLv2+".
	* modules/c-ctype (License): Likewise.
	* modules/c-strcase (License): Likewise.
	* modules/check-version (License): Likewise.
	* modules/iconv (License): Likewise.
	* modules/iconv_open (License): Likewise.
	* modules/read-file (License): Likewise.
	* modules/striconv (License): Likewise.
	* modules/strverscmp (License): Likewise.
	* modules/vasprintf (License): Likewise.
	* modules/crypto/des (License): Likewise.
	* modules/crypto/gc (License): Likewise.
	* modules/crypto/gc-arcfour (License): Likewise.
	* modules/crypto/gc-arctwo (License): Likewise.
	* modules/crypto/gc-des (License): Likewise.
	* modules/crypto/gc-hmac-md5 (License): Likewise.
	* modules/crypto/gc-hmac-sha1 (License): Likewise.
	* modules/crypto/gc-md2 (License): Likewise.
	* modules/crypto/gc-md4 (License): Likewise.
	* modules/crypto/gc-md5 (License): Likewise.
	* modules/crypto/gc-pbkdf2-sha1 (License): Likewise.
	* modules/crypto/gc-random (License): Likewise.
	* modules/crypto/gc-rijndael (License): Likewise.
	* modules/crypto/gc-sha1 (License): Likewise.
	* modules/crypto/md2 (License): Likewise.
	* modules/crypto/md4 (License): Likewise.

2007-07-30  Jim Meyering  <jim@meyering.net>

	* lib/fts.c (fts_read): Upon failure to chdir into a subdirectory,
	set fts_info to FTS_DNR, not to FTS_ERR, so that the caller knows
	it has valid stat data.  This bug would cause du not to count the
	sizes of inaccessible directories.
	Patch by Bryan Mason <bmason@redhat.com>, via Jose Maria Plans
	in <http://bugzilla.redhat.com/250077>.

2007-07-25  Peter O'Gorman  <peter@pogma.com>
	    Bruno Haible  <bruno@clisp.org>

	* m4/include_next.m4 (gl_INCLUDE_NEXT): Test whether #include_next
	really works. Needed because AIX 4.3 "xlc -E" doesn't understand
	#include_next, gives a diagnostic about it, but reports no error in
	the exit code.
	Reported by Gary V. Vaughan <gary@thewrittenword.com>.

2007-07-24  Ben Pfaff  <blp@gnu.org>

	Improve name: "count-one-bits" is better than "popcount".
	* MODULES.html.sh: Update name.
	* lib/popcount.h: Renamed lib/count-one-bits.h.
	(popcount): Renamed count_one_bits.
	(popcountl): Renamed count_one_bits_l.
	(popcountll): Renamed count_one_bits_ll.
	* m4/popcount.m4: Renamed m4/count-one-bits.m4.
	* modules/popcount: Renamed module/count-one-bits.
	* modules/popcount-tests: Renamed module/count-one-bits-tests.
	* tests/test-popcount.c: Renamed tests/test-count-one-bits.c.

2007-07-23  Ben Pfaff  <blp@gnu.org>

	* lib/popcount.h (popcount32): Reduce size of constants, to allow
	better code generation, and add U to large constants to avoid
	warnings, in non-GCC case.
	Suggested by Bruno Haible.

2007-07-23  Ben Pfaff  <blp@gnu.org>

	* lib/popcount.h: Use verify_true instead of if...abort.
	* modules/popcount: Depend on verify module.
	Suggested by Jim Meyering.

2007-07-23  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Create a .cvsignore file also when the
	directory is not yet in CVS but the toplevel directory is. When
	creating a .cvsignore file, add ".deps" and ".dirstamp" to it.
	Reported by Karl Berry.

2007-07-22  Ben Pfaff  <blp@gnu.org>

	* lib/popcount.h: Use faster, branchless algorithm for non-GCC
	case.
	Suggested by Eric Blake.

2007-07-22  Ben Pfaff  <blp@gnu.org>

	New module: popcount.
	* MODULES.html.sh: Add popcount.
	* modules/popcount: New file.
	* modules/popcount-tests: New file.
	* tests/test-popcount.c: New file.
	* lib/popcount.h: New file.
	* m4/popcount.m4: New file.

2007-07-22  Paul Eggert  <eggert@cs.ucla.edu>

	* build-aux/announce-gen: Update to GPLv3.

	* build-aux/config.guess: Update from config.

2007-07-21  Bruno Haible  <bruno@clisp.org>

	* lib/error.c (_) [ENABLE_NLS]: Define to gettext.
	* lib/verror.c (_) [ENABLE_NLS]: Likewise.

2007-07-20  Jim Meyering  <jim@meyering.net>

	* check-module: Diagnose a self-dependency.

2007-07-19  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Don't abort if pobase or po_domain is
	empty.
	Reported by Eric Blake.

2007-07-18  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: New options --po-base, --po-domain.
	(func_usage): Document them.
	(pobase, po_domain): New variables.
	(func_emit_lib_Makefile_am): Augment AM_CPPFLAGS, defining
	DEFAULT_TEXT_DOMAIN.
	(func_emit_po_Makevars, func_emit_po_POTFILES_in): New functions.
	(func_import): Consider pobase and po_domain. Create a po/ directory.
	(func_create_testdir): Set pobase and po_domain to empty.
	* build-aux/po/Makefile.in.in: New file, from GNU gettext 0.16.1.
	* build-aux/po/remove-potcdate.sin: New file, from GNU gettext 0.16.1.

2007-07-18  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_automake_snippet): Synthesize also an
	EXTRA_DIST augmentation for files in build-aux/.

2007-07-16  Bruno Haible  <bruno@clisp.org>

	* modules/lseek (License): Use the synonymous term "LGPLv2+".
	* modules/getdelim (License): Likewise.

2007-07-16  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* modules/arpa_inet (License): Use the synonymous term LGPLv2+.
	* modules/d-type (License): Likewise.
	* modules/extensions (License): Likewise.
	* modules/fnmatch (License): Likewise.
	* modules/fseeko (License): Likewise.
	* modules/getaddrinfo (License): Likewise.
	* modules/getline (License): Likewise.
	* modules/getlogin_r (License): Likewise.
	* modules/getpass (License): Likewise.
	* modules/gettimeofday (License): Likewise.
	* modules/glob (License): Likewise.
	* modules/inet_ntop (License): Likewise.
	* modules/malloc (License): Likewise.
	* modules/malloca (License): Likewise.
	* modules/memmem (License): Likewise.
	* modules/mempcpy (License): Likewise.
	* modules/memset (License): Likewise.
	* modules/minmax (License): Likewise.
	* modules/mktime (License): Likewise.
	* modules/netinet_in (License): Likewise.
	* modules/pathmax (License): Likewise.
	* modules/poll (License): Likewise.
	* modules/regex (License): Likewise.
	* modules/snprintf (License): Likewise.
	* modules/stdbool (License): Likewise.
	* modules/stdint (License): Likewise.
	* modules/stdio (License): Likewise.
	* modules/strcase (License): Likewise.
	* modules/strcasestr (License): Likewise.
	* modules/strdup (License): Likewise.
	* modules/string (License): Likewise.
	* modules/strndup (License): Likewise.
	* modules/strnlen (License): Likewise.
	* modules/strpbrk (License): Likewise.
	* modules/strptime (License): Likewise.
	* modules/strsep (License): Likewise.
	* modules/sys_select (License): Likewise.
	* modules/sys_socket (License): Likewise.
	* modules/sys_stat (License): Likewise.
	* modules/sys_time (License): Likewise.
	* modules/time (License): Likewise.
	* modules/time_r (License): Likewise.
	* modules/timegm (License): Likewise.
	* modules/unistd (License): Likewise.
	* modules/vsnprintf (License): Likewise.
	* modules/wctype (License): Likewise.

2007-07-16  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* modules/argz (License): LGPLv2+.

2007-07-15  Karl Berry  <karl@gnu.org>

	* doc/gnulib.texi: revise node structure per new fdl.texi.

2007-07-14  Bruno Haible  <bruno@clisp.org>

	* lib/uniname/gen-uninames.lisp (main): Emit a "do not edit" line to
	the output file.
	* lib/uniname/uninames.h: Regenerated.

2007-07-14  Karl Berry  <karl@gnu.org>

	* doc/*gpl*.texi, doc/fdl.texi: new versions, consistently
	omitting sectioning and index commands.

2007-07-13  Bruno Haible  <bruno@clisp.org>

	New gnulib-tool option --more-symlinks.
	* gnulib-tool (func_usage): Document --more-symlinks.
	(do_copyrights): New variable.
	Recognize option --more-symlinks.
	(func_import): Don't add a copyright notice transform to
	sed_transform_lib_file if do_copyrights is empty.

2007-07-13  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (decimal_point_char): Define also if
	(NEED_PRINTF_LONG_DOUBLE || NEED_PRINTF_INFINITE_DOUBLE)
	&& !NEED_PRINTF_DIRECTIVE_A.
	Reported by Clemens Koller <clemens.koller@anagramm.de> via
	Gary V. Vaughan <gary@gnu.org>.

2007-07-13  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/inttypes_.h: Undo previous change, since it was fixed
	in a different way in the 2007-07-02 fix to m4/inttypes.m4.

2007-07-13  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h: Fix typo: _GL_JUST_INCLUDE_SYSTEM_INTTYPES_H was
	misspelled as _GL_JUST_INCLUDE_ABSOLUTE_INTTYPES_H.

2007-07-13  Jim Meyering  <jim@meyering.net>

	df: Don't fail for Tru64's "file-on-file mount".
	* m4/fsusage.m4 (gl_FSUSAGE): Reject Tru64's buggy statvfs,
	so we fall through and use statfs instead.  Details here:
	<http://thread.gmane.org/gmane.comp.gnu.coreutils.bugs/10878>
	Reported by Albert Chin.

2007-07-13  Bruno Haible  <bruno@clisp.org>

	* modules/alloca-opt (License): Use the synonymous term "LGPLv2+".
	* modules/configmake (License): Likewise.
	* modules/gettext (License): Likewise.
	* modules/gettext-h (License): Likewise.
	* modules/include_next (License): Likewise.
	* modules/link-warning (License): Likewise.
	* modules/localcharset (License): Likewise.
	* modules/localename (License): Likewise.
	* modules/lock (License): Likewise.
	* modules/relocatable-lib-lgpl (License): Likewise.
	* modules/size_max (License): Likewise.
	* modules/vasnprintf (License): Likewise.
	* modules/wchar (License): Likewise.
	* modules/xsize (License): Likewise.

2007-07-13  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Treat LGPLv2 as synonymous to LGPL.
	(func_create_testdir): Handle copying terms "GPLv2+" and "LGPLv2+".

2007-07-12  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-intro.texi (Copyright): Clarify the license abbreviations
	in the modules files.

2007-07-11  Karl Berry  <karl@gnu.org>

	* MODULES.html.sh (func_module): use
	 sed -e '\|^'"${includefile}"'$|d'
	 instead of /.../d, to avoid errors on $includefile's containing /.

2007-07-10  Sergey Poznyakoff  <gray@gnu.org.ua>

	* gnulib-tool (func_import): Avoid duplication of --avoid
	statements
	(func_dest_tmpfilename,func_create_testdir): Translate `-' in file
	names to `_' in variable names.

2007-07-10  Eric Blake  <ebb9@byu.net>

	* lib/version-etc.c (version_etc_va): Default to GPLv3+.
	* NEWS: Document this change.

2007-07-08  Bruno Haible  <bruno@clisp.org>

	Update to Unicode 5.0.
	* lib/uniwidth/width.c (nonspacing_table_data): Add U+00AD,
	U+0350..U+035F, U+05A2, U+05BA, U+05C5, U+05C7, U+0600..U+0603,
	U+0610..U+0615, U+0656..U+065E, U+07EB..U+07F3, U+0A01, U+0AE2..U+0AE3,
	U+0CBC. Remove U+0CBF, U+0CC6. Add U+0CE2..U+0CE3, U+135F,
	U+17B4..U+17B5, U+17DD. Remove U+180E. Add U+1920..U+1922,
	U+1927..U+192B, U+1932, U+1939..U+193B, U+1A17..U+1A18, U+1B00..U+1B03,
	U+1B34, U+1B36..U+1B3A, U+1B3C, U+1B42, U+1B6B..U+1B73, U+1DC0..U+1DCA,
	U+1DFE..U+1DFF, U+20EB..U+20EF, U+A802, U+A806, U+A80B, U+A825..U+A826,
	U+10A01..U+10A03, U+10A05..U+10A06, U+10A0C..U+10A0F, U+10A38..U+10A3A,
	U+10A3F, U+1D242..U+1D244.
	(nonspacing_table_ind): Update.
	(uc_width): Assign width 0 to U+E0100..U+E01EF. Assign width 1 to
	U+4DC0..U+4DFF. Assign width 2 to U+2329..U+232A, U+FE10..U+FE1F.

2007-07-08  Bruno Haible  <bruno@clisp.org>

	Update to Unicode 5.0.
	* lib/uniname/gen-uninames.lisp (main): Add the range 0x12xxx to the
	code transform. Extend the name index field of unicode_name_to_code and
	unicode_code_to_name from 16 to 24 bits.
	* lib/uniname/uniname.c (unicode_character_name,
	unicode_name_character): Add the range 0x12xxx to the code transform.
	* lib/uniname/uninames.h: Regenerated.
	* tests/uniname/UnicodeDataNames.txt: Update to Unicode 5.0.

2007-07-07  Bruno Haible  <bruno@clisp.org>

	* modules/wcwidth-tests: New file.
	* tests/test-wcwidth.c: New file.

	Work around MacOS X wcwidth() bug.
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Test against MacOS X 10.3 bug.
	* lib/wcwidth.c: Include localcharset.h, streq.h, uniwidth.h.
	(rpl_wcwidth): Special-case the UTF-8 locales. Fall back to the
	original wcwidth in non-UTF-8 locales.
	* modules/wcwidth (Depends-on): Add localcharset, streq,
	uniwidth/width.
	* doc/functions/wcwidth.texi: Update.

2007-07-07  Bruno Haible  <bruno@clisp.org>

	* lib/wchar_.h: Include the GL_LINK_WARNING macro.
	(wcwidth): New declaration.
	* m4/wchar.m4 (gl_WCHAR_MODULE_INDICATOR, gl_WCHAR_H_DEFAULTS): New
	macros.
	(gl_WCHAR_H): Require gl_WCHAR_H_DEFAULTS. Don't set WCHAR_H to empty
	here. Prepare for creating <wchar.h> unconditionally.
	* modules/wchar (Depends-on): Add link-warning.
	(Makefile.am): Substitute also GNULIB_WCWIDTH, HAVE_DECL_WCWIDTH,
	REPLACE_WCWIDTH, and GL_LINK_WARNING.
	* lib/wcwidth.h: Remove file.
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Require gl_WCHAR_H_DEFAULTS. Set
	HAVE_DECL_WCWIDTH, REPLACE_WCWIDTH, WCHAR_H.
	* modules/wcwidth (Files): Remove lib/wcwidth.h.
	(configure.ac): Invoke gl_WCHAR_MODULE_INDICATOR.
	(Include): Replace wcwidth.h with <wchar.h>.
	* lib/wcwidth.c: Include <wchar.h> instead of wcwidth.h.
	* lib/mbchar.h: Don't include wcwidth.h.
	* lib/mbswidth.c: Likewise.
	* NEWS: Mention the change.

2007-07-07  Bruno Haible  <bruno@clisp.org>

	* lib/wcwidth.c: New file, extracted from lib/wcwidth.h.
	* lib/wcwidth.h: Don't include wctype.h. Replace inline function
	definition with an external declaration.
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Use wcwidth.c when wcwidth is not
	defined as a function. Remove AC_C_INLINE requirement.
	* modules/wcwidth (Files): Add lib/wcwidth.c.
	(Makefile.am): Remove redundant statement.

2007-07-07  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Unicode string functions): Add the new modules.

	* tests/uniwidth/test-u32-strwidth.c: New file.
	* modules/uniwidth/u32-strwidth-tests: New file.

	* lib/uniwidth/u32-strwidth.c: New file.
	* modules/uniwidth/u32-strwidth: New file.

	* tests/uniwidth/test-u16-strwidth.c: New file.
	* modules/uniwidth/u16-strwidth-tests: New file.

	* lib/uniwidth/u16-strwidth.c: New file.
	* modules/uniwidth/u16-strwidth: New file.

	* tests/uniwidth/test-u8-strwidth.c: New file.
	* modules/uniwidth/u8-strwidth-tests: New file.

	* lib/uniwidth/u8-strwidth.c: New file.
	* modules/uniwidth/u8-strwidth: New file.

	* tests/uniwidth/test-u32-width.c: New file.
	* modules/uniwidth/u32-width-tests: New file.

	* lib/uniwidth/u32-width.c: New file.
	* modules/uniwidth/u32-width: New file.

	* tests/uniwidth/test-u16-width.c: New file.
	* modules/uniwidth/u16-width-tests: New file.

	* lib/uniwidth/u16-width.c: New file.
	* modules/uniwidth/u16-width: New file.

	* tests/uniwidth/test-u8-width.c: New file.
	* modules/uniwidth/u8-width-tests: New file.

	* lib/uniwidth/u8-width.c: New file.
	* modules/uniwidth/u8-width: New file.

	* tests/uniwidth/test-uc_width.c: New file.
	* modules/uniwidth/width-tests: New file.

	* lib/uniwidth/width.c: New file, from GNU libiconv.
	* lib/uniwidth/cjk.h: New file, from GNU libiconv.
	* modules/uniwidth/width: New file.

	* lib/uniwidth.h: New file, from GNU libiconv.
	* modules/uniwidth/base: New file.

2007-07-07  Bruno Haible  <bruno@clisp.org>

	* lib/uniname.h: New file, from GNU gettext.
	* lib/uniname/gen-uninames.lisp: New file, from GNU gettext.
	* lib/uniname/uninames.h: New file, from GNU gettext.
	* lib/uniname/uniname.c: New file, from GNU gettext.
	* tests/uniname/test-uninames.sh: New file.
	* tests/uniname/test-uninames.c: New file, from GNU gettext.
	* tests/uniname/UnicodeDataNames.txt: New file, from GNU gettext.
	* modules/uniname/base: New file.
	* modules/uniname/uniname: New file.
	* modules/uniname/uniname-tests: New file.
	* MODULES.html.sh (Unicode string functions): Add the new modules.

2007-07-06  Bruno Haible  <bruno@clisp.org>

	* doc/Makefile (TEXI2HTML): Specify a --reference-limit.

2007-07-06  Bruno Haible  <bruno@clisp.org>

	* lib/sys_time_.h: Use a recursion-safe inclusion guard rather than
	a split double-inclusion guard. Needed for cygwin, where <sys/time.h>
	includes <cygwin/sys_time.h> which includes <sys/select.h> which
	include <sys/time.h>.
	Reported by Eric Blake.

2007-07-06  Eric Blake  <ebb9@byu.net>

	Fix testing canonicalize on cygwin.
	* modules/canonicalize-lgpl-tests (test_canonicalize_lgpl_LDADD):
	Revert patch from 2007-06-19.
	* tests/test-canonicalize-lgpl.c (main): Instead, skip test when
	canonicalize module is also in use.
	* tests/test-canonicalize.c: New file.
	* tests/test-canonicalize.sh: Likewise.
	* modules/canonicalize-tests: Likewise.

2007-07-06  Jim Meyering  <jim@meyering.net>

	* lib/getugroups.c (getugroups): Detect getgrent failure.
	Adjust comment to reflect reality: this function may return -1.

2007-07-05  Sergey Poznyakoff  <gray@gnu.org.ua>

	* build-aux/bootstrap (TP_URL,get_translations): Update to use
	the new TP address.
	(usage): Fix typo
	(gnulib_mk): New variable.

2007-07-05  Jim Meyering  <jim@meyering.net>

	Don't let endgrent clobber errno, no matter how improbable.
	* lib/getugroups.c (getugroups): Save and restore errno around
	endgrent call.

	Close the group DB even when failing with 2^31 or more members.
	* lib/getugroups.c (getugroups): Don't return without calling endgrent.

2007-07-04  Jim Meyering  <jim@meyering.net>

	* lib/getugroups.h: New file.
	* lib/getugroups.c: Include "getugroups.h".
	Remove uses of "register" keyword.
	Move local variable, "cp", down into scope where used.
	Give "username" parameter the "const" attribute.
	* modules/getugroups (Files): Add lib/getugroups.h

2007-07-04  Karl Berry  <karl@gnu.org>

	* MODULES.html.sh (func_all_modules): Complete rename of
	gpl/lgpl to gpl-2.0 and lgpl-2.1, and add gpl-3.0.

2007-07-02  Bruno Haible  <bruno@clisp.org>

	* m4/inttypes.m4 (gl_INTTYPES_H): Define __STDC_LIMIT_MACROS in C++
	mode, when inttypes.h comes from gnulib.
	Reported by Joel E. Denny <jdenny@ces.clemson.edu>.

2007-07-02  Simon Josefsson  <simon@josefsson.org>

	* NEWS: Mention lgpl module name change.

	* modules/lgpl-2.1: Renamed from lgpl.

	* NEWS: Mention gpl module name change.

	* modules/gpl-3.0: New file, based on gpl-2.0.

	* modules/gpl-2.0: Renamed from gpl.

	* modules/gpl: Fix filename, doc/gpl.texi is now found at
	doc/gpl-2.0.texi.

2007-07-02  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/inttypes_.h [defined __cplusplus&&!defined __STDC_LIMIT_MACROS]:
	#define __STDC_LIMIT_MACROS temporarily while including
	<stdint.h>, so that __STDC_LIMIT_MACROS is defined.
	Problem reported by Joel E. Denny in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-07/msg00008.html>.

2007-07-01  Bruno Haible  <bruno@clisp.org>

	* lib/unistdio.h: New file.
	* lib/unistdio/u-asnprintf.h: New file.
	* lib/unistdio/u-asprintf.h: New file.
	* lib/unistdio/u-printf-args.c: New file.
	* lib/unistdio/u-printf-args.h: New file.
	* lib/unistdio/u-printf-parse.h: New file.
	* lib/unistdio/u-snprintf.h: New file.
	* lib/unistdio/u-sprintf.h: New file.
	* lib/unistdio/u-vasprintf.h: New file.
	* lib/unistdio/u-vsnprintf.h: New file.
	* lib/unistdio/u-vsprintf.h: New file.
	* lib/unistdio/ulc-asnprintf.c: New file.
	* lib/unistdio/ulc-asprintf.c: New file.
	* lib/unistdio/ulc-fprintf.c: New file, based on lib/fprintf.c.
	* lib/unistdio/ulc-printf-parse.c: New file.
	* lib/unistdio/ulc-snprintf.c: New file.
	* lib/unistdio/ulc-sprintf.c: New file.
	* lib/unistdio/ulc-vasnprintf.c: New file.
	* lib/unistdio/ulc-vasprintf.c: New file.
	* lib/unistdio/ulc-vfprintf.c: New file, based on lib/vfprintf.c.
	* lib/unistdio/ulc-vsnprintf.c: New file.
	* lib/unistdio/ulc-vsprintf.c: New file.
	* lib/unistdio/u8-asnprintf.c: New file.
	* lib/unistdio/u8-asprintf.c: New file.
	* lib/unistdio/u8-printf-parse.c: New file.
	* lib/unistdio/u8-snprintf.c: New file.
	* lib/unistdio/u8-sprintf.c: New file.
	* lib/unistdio/u8-vasnprintf.c: New file.
	* lib/unistdio/u8-vasprintf.c: New file.
	* lib/unistdio/u8-vsnprintf.c: New file.
	* lib/unistdio/u8-vsprintf.c: New file.
	* lib/unistdio/u8-u8-asnprintf.c: New file.
	* lib/unistdio/u8-u8-asprintf.c: New file.
	* lib/unistdio/u8-u8-snprintf.c: New file.
	* lib/unistdio/u8-u8-sprintf.c: New file.
	* lib/unistdio/u8-u8-vasnprintf.c: New file.
	* lib/unistdio/u8-u8-vasprintf.c: New file.
	* lib/unistdio/u8-u8-vsnprintf.c: New file.
	* lib/unistdio/u8-u8-vsprintf.c: New file.
	* lib/unistdio/u16-asnprintf.c: New file.
	* lib/unistdio/u16-asprintf.c: New file.
	* lib/unistdio/u16-printf-parse.c: New file.
	* lib/unistdio/u16-snprintf.c: New file.
	* lib/unistdio/u16-sprintf.c: New file.
	* lib/unistdio/u16-vasnprintf.c: New file.
	* lib/unistdio/u16-vasprintf.c: New file.
	* lib/unistdio/u16-vsnprintf.c: New file.
	* lib/unistdio/u16-vsprintf.c: New file.
	* lib/unistdio/u16-u16-asnprintf.c: New file.
	* lib/unistdio/u16-u16-asprintf.c: New file.
	* lib/unistdio/u16-u16-snprintf.c: New file.
	* lib/unistdio/u16-u16-sprintf.c: New file.
	* lib/unistdio/u16-u16-vasnprintf.c: New file.
	* lib/unistdio/u16-u16-vasprintf.c: New file.
	* lib/unistdio/u16-u16-vsnprintf.c: New file.
	* lib/unistdio/u16-u16-vsprintf.c: New file.
	* lib/unistdio/u32-asnprintf.c: New file.
	* lib/unistdio/u32-asprintf.c: New file.
	* lib/unistdio/u32-printf-parse.c: New file.
	* lib/unistdio/u32-snprintf.c: New file.
	* lib/unistdio/u32-sprintf.c: New file.
	* lib/unistdio/u32-vasnprintf.c: New file.
	* lib/unistdio/u32-vasprintf.c: New file.
	* lib/unistdio/u32-vsnprintf.c: New file.
	* lib/unistdio/u32-vsprintf.c: New file.
	* lib/unistdio/u32-u32-asnprintf.c: New file.
	* lib/unistdio/u32-u32-asprintf.c: New file.
	* lib/unistdio/u32-u32-snprintf.c: New file.
	* lib/unistdio/u32-u32-sprintf.c: New file.
	* lib/unistdio/u32-u32-vasnprintf.c: New file.
	* lib/unistdio/u32-u32-vasprintf.c: New file.
	* lib/unistdio/u32-u32-vsnprintf.c: New file.
	* lib/unistdio/u32-u32-vsprintf.c: New file.
	* tests/unistdio/test-ulc-asnprintf1.c: New file.
	* tests/unistdio/test-ulc-asnprintf1.h: New file.
	* tests/unistdio/test-ulc-printf1.h: New file.
	* tests/unistdio/test-ulc-vasnprintf1.c: New file.
	* tests/unistdio/test-ulc-vasnprintf2.c: New file.
	* tests/unistdio/test-ulc-vasnprintf2.sh: New file.
	* tests/unistdio/test-ulc-vasnprintf3.c: New file.
	* tests/unistdio/test-ulc-vasnprintf3.sh: New file.
	* tests/unistdio/test-ulc-vasprintf1.c: New file.
	* tests/unistdio/test-ulc-vsnprintf1.c: New file.
	* tests/unistdio/test-ulc-vsprintf1.c: New file.
	* tests/unistdio/test-u8-asnprintf1.c: New file.
	* tests/unistdio/test-u8-asnprintf1.h: New file.
	* tests/unistdio/test-u8-printf1.h: New file.
	* tests/unistdio/test-u8-vasnprintf1.c: New file.
	* tests/unistdio/test-u8-vasnprintf2.c: New file.
	* tests/unistdio/test-u8-vasnprintf2.sh: New file.
	* tests/unistdio/test-u8-vasnprintf3.c: New file.
	* tests/unistdio/test-u8-vasnprintf3.sh: New file.
	* tests/unistdio/test-u8-vasprintf1.c: New file.
	* tests/unistdio/test-u8-vsnprintf1.c: New file.
	* tests/unistdio/test-u8-vsprintf1.c: New file.
	* tests/unistdio/test-u16-asnprintf1.c: New file.
	* tests/unistdio/test-u16-asnprintf1.h: New file.
	* tests/unistdio/test-u16-printf1.h: New file.
	* tests/unistdio/test-u16-vasnprintf1.c: New file.
	* tests/unistdio/test-u16-vasnprintf2.c: New file.
	* tests/unistdio/test-u16-vasnprintf2.sh: New file.
	* tests/unistdio/test-u16-vasnprintf3.c: New file.
	* tests/unistdio/test-u16-vasnprintf3.sh: New file.
	* tests/unistdio/test-u16-vasprintf1.c: New file.
	* tests/unistdio/test-u16-vsnprintf1.c: New file.
	* tests/unistdio/test-u16-vsprintf1.c: New file.
	* tests/unistdio/test-u32-asnprintf1.c: New file.
	* tests/unistdio/test-u32-asnprintf1.h: New file.
	* tests/unistdio/test-u32-printf1.h: New file.
	* tests/unistdio/test-u32-vasnprintf1.c: New file.
	* tests/unistdio/test-u32-vasnprintf2.c: New file.
	* tests/unistdio/test-u32-vasnprintf2.sh: New file.
	* tests/unistdio/test-u32-vasnprintf3.c: New file.
	* tests/unistdio/test-u32-vasnprintf3.sh: New file.
	* tests/unistdio/test-u32-vasprintf1.c: New file.
	* tests/unistdio/test-u32-vsnprintf1.c: New file.
	* tests/unistdio/test-u32-vsprintf1.c: New file.
	* modules/unistdio/base: New file.
	* modules/unistdio/u-printf-args: New file.
	* modules/unistdio/ulc-asnprintf: New file.
	* modules/unistdio/ulc-asprintf: New file.
	* modules/unistdio/ulc-fprintf: New file.
	* modules/unistdio/ulc-printf-parse: New file.
	* modules/unistdio/ulc-snprintf: New file.
	* modules/unistdio/ulc-sprintf: New file.
	* modules/unistdio/ulc-vasnprintf: New file.
	* modules/unistdio/ulc-vasprintf: New file.
	* modules/unistdio/ulc-vfprintf: New file.
	* modules/unistdio/ulc-vsnprintf: New file.
	* modules/unistdio/ulc-vsprintf: New file.
	* modules/unistdio/u8-asnprintf: New file.
	* modules/unistdio/u8-asprintf: New file.
	* modules/unistdio/u8-printf-parse: New file.
	* modules/unistdio/u8-snprintf: New file.
	* modules/unistdio/u8-sprintf: New file.
	* modules/unistdio/u8-vasnprintf: New file.
	* modules/unistdio/u8-vasprintf: New file.
	* modules/unistdio/u8-vsnprintf: New file.
	* modules/unistdio/u8-vsprintf: New file.
	* modules/unistdio/u8-u8-asnprintf: New file.
	* modules/unistdio/u8-u8-asprintf: New file.
	* modules/unistdio/u8-u8-snprintf: New file.
	* modules/unistdio/u8-u8-sprintf: New file.
	* modules/unistdio/u8-u8-vasnprintf: New file.
	* modules/unistdio/u8-u8-vasprintf: New file.
	* modules/unistdio/u8-u8-vsnprintf: New file.
	* modules/unistdio/u8-u8-vsprintf: New file.
	* modules/unistdio/u16-asnprintf: New file.
	* modules/unistdio/u16-asprintf: New file.
	* modules/unistdio/u16-printf-parse: New file.
	* modules/unistdio/u16-snprintf: New file.
	* modules/unistdio/u16-sprintf: New file.
	* modules/unistdio/u16-vasnprintf: New file.
	* modules/unistdio/u16-vasprintf: New file.
	* modules/unistdio/u16-vsnprintf: New file.
	* modules/unistdio/u16-vsprintf: New file.
	* modules/unistdio/u16-u16-asnprintf: New file.
	* modules/unistdio/u16-u16-asprintf: New file.
	* modules/unistdio/u16-u16-snprintf: New file.
	* modules/unistdio/u16-u16-sprintf: New file.
	* modules/unistdio/u16-u16-vasnprintf: New file.
	* modules/unistdio/u16-u16-vasprintf: New file.
	* modules/unistdio/u16-u16-vsnprintf: New file.
	* modules/unistdio/u16-u16-vsprintf: New file.
	* modules/unistdio/u32-asnprintf: New file.
	* modules/unistdio/u32-asprintf: New file.
	* modules/unistdio/u32-printf-parse: New file.
	* modules/unistdio/u32-snprintf: New file.
	* modules/unistdio/u32-sprintf: New file.
	* modules/unistdio/u32-vasnprintf: New file.
	* modules/unistdio/u32-vasprintf: New file.
	* modules/unistdio/u32-vsnprintf: New file.
	* modules/unistdio/u32-vsprintf: New file.
	* modules/unistdio/u32-u32-asnprintf: New file.
	* modules/unistdio/u32-u32-asprintf: New file.
	* modules/unistdio/u32-u32-snprintf: New file.
	* modules/unistdio/u32-u32-sprintf: New file.
	* modules/unistdio/u32-u32-vasnprintf: New file.
	* modules/unistdio/u32-u32-vasprintf: New file.
	* modules/unistdio/u32-u32-vsnprintf: New file.
	* modules/unistdio/u32-u32-vsprintf: New file.
	* modules/unistdio/ulc-asnprintf-tests: New file.
	* modules/unistdio/ulc-vasnprintf-tests: New file.
	* modules/unistdio/ulc-vasprintf-tests: New file.
	* modules/unistdio/ulc-vsnprintf-tests: New file.
	* modules/unistdio/ulc-vsprintf-tests: New file.
	* modules/unistdio/u8-asnprintf-tests: New file.
	* modules/unistdio/u8-vasnprintf-tests: New file.
	* modules/unistdio/u8-vasprintf-tests: New file.
	* modules/unistdio/u8-vsnprintf-tests: New file.
	* modules/unistdio/u8-vsprintf-tests: New file.
	* modules/unistdio/u16-asnprintf-tests: New file.
	* modules/unistdio/u16-vasnprintf-tests: New file.
	* modules/unistdio/u16-vasprintf-tests: New file.
	* modules/unistdio/u16-vsnprintf-tests: New file.
	* modules/unistdio/u16-vsprintf-tests: New file.
	* modules/unistdio/u32-asnprintf-tests: New file.
	* modules/unistdio/u32-vasnprintf-tests: New file.
	* modules/unistdio/u32-vasprintf-tests: New file.
	* modules/unistdio/u32-vsnprintf-tests: New file.
	* modules/unistdio/u32-vsprintf-tests: New file.
	* MODULES.html.sh (Unicode string functions): Add the new modules.

2007-07-01  Bruno Haible  <bruno@clisp.org>

	* lib/sprintf.c (sprintf): Limit the available length estimation,
	to avoid address wraparound.
	* lib/vsprintf.c (vsprintf): Likewise.
	* modules/sprintf-posix (Dependencies): Add stdint.
	* modules/vsprintf-posix (Dependencies): Likewise.

2007-07-01  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (self_abspathname): Determine PATH_SEPARATOR and handle
	Windows PATH as well. Conservative double-quoting. Comments.

2007-07-01  Bruno Haible  <bruno@clisp.org>
	    Eric Blake  <ebb9@byu.net>
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (self_abspathname): Fix algorithm to cope with
	empty components in $PATH, denoting '.'.

2007-07-01  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool: Fix indentation.
	(func_create_megatestdir): Likewise.
	Report by Bruno Haible.

2007-06-30  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Sync from Automake.
	* build-aux/gnupload: Fix shell portability issues with for loops.
	Report by Karl Berry.

2007-06-29  Simon Josefsson  <simon@josefsson.org>

	* build-aux/maint.mk (POURL): Use translationproject.org.

2007-06-27  Simon Josefsson  <simon@josefsson.org>
	    Bruno Haible  <bruno@clisp.org>

	* m4/getaddrinfo.m4 (gl_GETADDRINFO): Require gl_HEADER_SYS_SOCKET
	before using HAVE_WS2TCPIP_H. Check for gai_strerror through an
	explicit link test, rather than AC_REPLACE_FUNCS - for mingw.
	(gl_PREREQ_GETADDRINFO): Require gl_HEADER_SYS_SOCKET before using
	HAVE_SYS_SOCKET_H and HAVE_WS2TCPIP_H.

2007-06-27  Bruno Haible  <bruno@clisp.org>

	* build-aux/config.rpath: Upgrade to libtool-1.5.24.
	* build-aux/config.libpath: Upgrade to libtool-1.5.24.

2007-06-26  Karl Berry  <karl@gnu.org>

	* MODULES.html.sh: remove xreadlink-with-size.

2007-06-23  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/time_.h: Port to Solaris 8 with Sun Studio 11, using a
	method that I hope also handles the double-include problem noted
	by Bruno Haible in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-05/msg00186.html>.

2007-06-23  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am, func_emit_tests_Makefile_am):
	Don't let the 'mostlyclean' target fail if the last subdirectory could
	not be removed.
	Reported by Karl Berry.

2007-06-23  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (echo): Add a speedier workaround for ksh.
	* tests/test-echo.sh: Likewise.

2007-06-23  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (echo): Add workarounds also for bash versions < 2.04.
	* tests/test-echo.sh: Likewise.

2007-06-23  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (IFS): Initialize early, so we don't set it to
	empty later.
	(self_abspathname): Rewrite algorithm to set it, reindent.
	(func_emit_lib_Makefile_am, func_emit_tests_Makefile_am)
	(func_create_megatestdir): Merge some sed scripts.

2007-06-23  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/include_next.m4 (gl_CHECK_NEXT_HEADERS): Check some typos
	exposed by Sun Studio 11 cc on Solaris 8.

2007-06-22  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (echo): Ensure the echo primitive does not interpret
	backslashes.
	* tests/test-echo.sh: New file.

2007-06-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_add_or_update, func_create_testdir): Do not
	simplify `sed_replace_build_aux' scripts, they are portable but
	echoing them with `echo' is not.
	Report and analysis by Fernando Ferreira <fernando.prog@netcabo.pt>.

2007-06-21  Karl Berry  <karl@gnu.org>

	* config/srclist.txt: guess we can't handle the licenses via
	srclist at the moment.

2007-06-21  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh: Add include_next.
	* modules/include_next: New file.

2007-06-20  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/include_next.m4 (gl_INCLUDE_NEXT): Define and AC_SUBST
	INCLUDE_NEXT.
	(gl_CHECK_NEXT_HEADERS): New macro.
	* m4/fcntl_h.m4 (gl_FCNTL_H): use gl_CHECK_NEXT_HEADERS instead of
	the obsolescent gl_ABSOLUTE_HEADER.
	* m4/fchdir.m4 (gl_FUNC_FCHDIR): Likewise.
	* m4/float_h.m4 (gl_FLOAT_H): Likewise.
	* m4/iconv_h.m4 (gl_ICONV_H): Likewise.
	* m4/inttypes.m4 (gl_INTTYPES_H): Likewise.
	* m4/locale_h.m4 (gl_LOCALE_H): Likewise.
	* m4/math_h.m4 (gl_MATH_H): Likewise.
	* m4/netinet_in_h.m4 (gl_HEADER_NETINET_IN): Likewise.
	* m4/search_h.m4 (gl_SEARCH_H): Likewise.
	* m4/signal_h.m4 (gl_SIGNAL_H): Likewise.
	* m4/stdint.m4 (gl_STDINT_H): Likewise.
	* m4/stdio_h.m4 (gl_STDIO_H): Likewise.
	* m4/stdlib_h.m4 (gl_STDLIB_H): Likewise.
	* m4/string_h.m4 (gl_HEADER_STRING_H_BODY): Likewise.
	* m4/sys_select_h.m4 (gl_HEADER_SYS_SELECT): Likewise.
	* m4/sys_socket_h.m4 (gl_HEADER_SYS_SOCKET): Likewise.
	* m4/sys_stat_h.m4 (gl_HEADER_SYS_STAT_H): Likewise.
	* m4/sys_time_h.m4 (gl_HEADER_SYS_TIME_H_BODY): Likewise.
	* m4/sysexits.m4 (gl_SYSEXITS): Likewise.
	* m4/time_h.m4 (gl_HEADER_TIME_H_BODY): Likewise.
	* m4/unistd_h.m4 (gl_UNISTD_H): Likewise.
	* m4/wchar.m4 (gl_WCHAR_H): Likewise.
	* m4/wctype.m4 (gl_WCTYPE_H): Likewise.
	* m4/inttypes.m4 (gl_INTTYPES_H): Define
	_GL_JUST_INCLUDE_SYSTEM_INTTYPES_H to avoid the problem of unclean
	builds, since ABSOLUTE_INTTYPES_H is no longer being defined.
	* m4/stdint.m4 (gl_STDINT_H): Likewise, for
	_GL_JUST_INCLUDE_SYSTEM_STDINT_H.
	* lib/fcntl_.h: Use @INCLUDE_NEXT@ @NEXT_foo_H@
	rather than @HAVE_INCLUDE_NEXT@ and @ABSOLUTE_foo_H@.
	* lib/float_.h: Likewise.
	* lib/inttypes_.h: Likewise.
	* lib/math_.h: Likewise.
	* lib/search_.h: Likewise.
	* lib/signal_.h: Likewise.
	* lib/stdint_.h: Likewise.
	* lib/stdio_.h: Likewise.
	* lib/stdlib_.h: Likewise.
	* lib/string_.h: Likewise.
	* lib/sys_stat_.h: Likewise.
	* lib/sys_time_.h: Likewise.
	* lib/time_.h: Likewise.
	* lib/unistd_.h: Likewise.
	* lib/wchar_.h: Likewise.
	* lib/wctype_.h: Likewise.
	* lib/dirent_.h: Likewise.
	* lib/iconv_.h: Likewise.
	* lib/locale_.h: Likewise.
	* lib/netinet_in_.h: Likewise.
	* lib/sys_select_.h: Likewise.
	* lib/sys_socket_.h: Likewise.
	* lib/sysexits_.h: Likewise.
	* modules/fcntl (Depends-on): Depend on include_next, not
	absolute_header.
	(Makefile): Substitute INCLUDE_NEXT and NEXT_foo_H, not
	HAVE_INCLUDE_NEXT and ABSOLUTE_foo_H.
	* modules/fchdir: Likewise.
	* modules/float: Likewise.
	* modules/iconv_open: Likewise.
	* modules/inttypes: Likewise.
	* modules/locale: Likewise.
	* modules/math: Likewise.
	* modules/netinet_in: Likewise.
	* modules/search: Likewise.
	* modules/signal: Likewise.
	* modules/stdint: Likewise.
	* modules/stdio: Likewise.
	* modules/stdlib: Likewise.
	* modules/string: Likewise.
	* modules/sys_select: Likewise.
	* modules/sys_socket: Likewise.
	* modules/sys_stat: Likewise.
	* modules/sys_time: Likewise.
	* modules/sysexits: Likewise.
	* modules/time: Likewise.
	* modules/unistd: Likewise.
	* modules/wchar: Likewise.
	* modules/wctype: Likewise.
	* modules/sys_stat: Change maintainer to "all".
	* modules/unistd: Likewise.

2007-06-20  Karl Berry  <karl@gnu.org>

	* config/srclist.txt: track www changes in license files.

2007-06-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* build-aux/bootstrap: Remove stray dot.
	Make sure build_aux settings are honored when linking
	gnulib_extra_files.

2007-06-19  Eric Blake  <ebb9@byu.net>

	* modules/canonicalize-lgpl-tests (test_canonicalize_lgpl_LDADD):
	Allow compilation on cygwin.

2007-06-19  Jim Meyering  <jim@meyering.net>

	xreadlink-with-size: Remove module.  No longer used.
	Ex-callers now use xreadlink or mreadlink-with-size.
	* modules/xreadlink-with-size: Remove module.
	* lib/xreadlink-with-size.c: Remove file.
	* lib/xreadlink.h (xreadlink_with_size): Remove prototype.
	(xreadlink): Remove inaccurate comment.  The one in xreadlink.c,
	just before the function definition *is* accurate.

	Eliminate one way canonicalize_filename_mode could exit.
	* lib/canonicalize.c (canonicalize_filename_mode):
	Use mreadlink_with_size, not xreadlink_with_size.

2007-06-18  Paul Eggert  <eggert@cs.ucla.edu>

	Detect porting problems to FreeBSD/arm, which has time_t wider than
	long int.  Original problem reported for GNU diff by Xin Li in
	<http://lists.gnu.org/archive/html/bug-gnu-utils/2007-06/msg00091.html>.
	* modules/getdate (Depends-on): Add intprops, verify.
	* lib/getdate.y: Include intprops.h, verify.h.  Verify that time_t
	is an integer type no wider than long int.

2007-06-18  Jim Meyering  <jim@meyering.net>

	New module: mreadlink-with-size.
	* MODULES.html.sh: Add mreadlink-with-size.
	* modules/mreadlink-with-size: New module
	* modules/canonicalize (Depends-on): Depend on mreadlink-with-size,
	not xreadlink-with-size.
	* lib/mreadlink-with-size.c, lib/mreadlink.h: New files.

2007-06-16  Bruno Haible  <bruno@clisp.org>

	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): Catch the MacOS X 10.4 bug.
	* doc/functions/frexpl.texi: Document the MacOS X 10.4 bug.
	Reported by Gary V. Vaughan <gary@gnu.org>.

2007-06-15  Paul Eggert  <eggert@cs.ucla.edu>

	Revamp lchown so that it lives in unistd.h where it belongs.
	* lib/lchown.h: Remove.
	* lib/dirchownmod.c: Don't include lib/lchown.h.
	* lib/fchownat.c: Likewise.
	* lib/openat.c: Likewise.
	* lib/lchown.c (REPLACE_CHOWN): Define to 0 if the system chown
	does not follow symlinks.
	(EOPNOTSUPP): Define if not defined.
	* lib/unistd_.h (chown): Do not replace if REPLADE_CHOWN
	is defined to 0.
	(lchown): New decl.
	* m4/lchown.m4 (gl_FUNC_LCHOWN): Require gl_UNISTD_H_DEFAULTS.
	Do not check for lchown decl.
	Set REPLACE_LCHOWN.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Set GNULIB_LCHOWN,
	REPLACE_LCHOWN.
	* modules/chown: Make it clear it follows symlinks.
	* modules/lchown: Make it clear it doesn't follow symlinks.
	(Files): Remove lib/lchown.h
	(Depends-on): Add unistd.
	(configure.ac): Add gl_UNISTD_MODULE_INDICATOR([lchown]).
	(Include): Include <unistd.h>, not "lchown.h".
	* modules/unistd (unistd.h): Substitude GNULIB_LCHOWN and
	REPLACE_LCHOWN.

2007-06-15  Jim Meyering  <jim@meyering.net>

	Change license (GPL to LGPL) of fsusage and dependents.
	* modules/fsusage (License): Change to LGPL.
	* modules/full-read (License): Likewise.
	* modules/full-write (License): Likewise.
	* modules/safe-read (License): Likewise.
	* modules/safe-write (License): Likewise.

2007-06-14  Ben Pfaff  <blp@gnu.org>

	Missing part of allocsa -> malloca transition.
	* modules/relocatable-prog-wrapper: gl_ALLOCSA should be
	gl_MALLOCA.

2007-06-12  Bruno Haible  <bruno@clisp.org>

	* m4/isnanl.m4 (gl_FUNC_ISNANL_WORKS): Guess no when cross-compiling
	to ia64, x86_64, i386.
	Reported by Eric Blake.

2007-06-12  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_INFINITE_LONG_DOUBLE): Guess no also when
	cross-compiling to x86_64.

2007-06-12  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/absolute-header.m4 (gl_ABSOLUTE_HEADER): Fix POSIX sed portability
	glitch reported by Ralf Wildenhues in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-06/msg00114.html>.

	* m4/regex.m4 (gl_REGEX): Catch a bug with [[:alnum:]_-] reported by
	Vin Shelton.

2007-06-11  Bruno Haible  <bruno@clisp.org>

	* lib/printf-args.c (PRINTF_FETCHARGS) [ENABLE_UNISTDIO]: Fix NULL
	replacement string.
	Reported by Eric Blake.

2007-06-10  Bruno Haible  <bruno@clisp.org>

	Prepare vasnprintf code for use with Unicode strings.
	* lib/printf-args.h (PRINTF_FETCHARGS): New macro.
	(arg_type) [ENABLE_UNISTDIO]: Define TYPE_U8_STRING, TYPE_U16_STRING,
	TYPE_U32_STRING.
	(argument) [ENABLE_UNISTDIO]: Add a_u8_string, a_u16_string,
	a_u32_string variants.
	(PRINTF_FETCHARGS): Renamed from printf_fetchargs.
	* lib/printf-args.c: Don't include config.h and the specification
	header if PRINTF_FETCHARGS is already defined.
	(PRINTF_FETCHARGS): Renamed from printf_fetchargs.
	(PRINTF_FETCHARGS) [ENABLE_UNISTDIO]: Add code for TYPE_U8_STRING,
	TYPE_U16_STRING, TYPE_U32_STRING.
	* lib/printf-parse.h [ENABLE_UNISTDIO] (u8_directive, u8_directives,
	u16_directive, u16_directives, u32_directive, u32_directives): New
	types.
	(ulc_printf_parse, u8_printf_parse, u16_printf_parse, u32_printf_parse):
	New declarations.
	* lib/printf-parse.c: Don't include config.h and the specification
	header if PRINTF_PARSE is already defined. Eliminate the set of
	parameters for WIDE_CHAR_VERSION; the user of this file must provide
	them now. Include c-ctype.h.
	(PRINTF_PARSE) [ENABLE_UNISTDIO]: Add code implementing the 'U'
	directive and CHAR_T_ONLY_ASCII.
	* lib/vasnprintf.c: Don't include config.h and the specification header
	if VASNPRINTF is already defined.
	(DCHAR_IS_TCHAR, DCHAR_CPY): New macros.
	(VASNPRINTF): Use PRINTF_FETCHARGS instead of printf_fetchargs. Use
	DCHAR_CPY. Handle the case that DCHAR_T and FCHAR_T are not the same
	type. Handle the case that TCHAR_T and FCHAR_T are not of the same
	size. Handle the case that DCHAR_T and TCHAR_T are not the same type,
	add a conversion from TCHAR_T[] to DCHAR_T[], and rework the padding
	code accordingly.
	(VASNPRINTF) [ENABLE_UNISTDIO]: Implement the 'U' directive. Enable
	pad_ourselves also in this case, with the 'c' and 's' directives, and
	with a different notion of "width".
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_WITH_EXTRAS): New macros.

2007-06-10  Bruno Haible  <bruno@clisp.org>

	* modules/unistr/u32-mbsnlen: New file.
	* lib/unistr/u32-mbsnlen.c: New file.

	* modules/unistr/u16-mbsnlen: New file.
	* lib/unistr/u16-mbsnlen.c: New file.

	* modules/unistr/u8-mbsnlen: New file.
	* lib/unistr/u8-mbsnlen.c: New file.

	* lib/unistr.h (u8_mbsnlen, u16_mbsnlen, u32_mbsnlen): New
	declarations.

2007-06-10  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h (mbsnlen): New declaration.
	* lib/mbsnlen.c: New file.
	* m4/mbsnlen.m4: New file.
	* modules/mbsnlen: New file.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Set GNULIB_MBSNLEN.
	* modules/string (string.h): Substitute GNULIB_MBSNLEN.
	* MODULES.html.sh (Internationalization functions): Add mbsnlen.

2007-06-10  Bruno Haible  <bruno@clisp.org>

	* lib/mbslen.c: Include <stdlib.h>, needed for MB_CUR_MAX.

2007-06-10  Bruno Haible  <bruno@clisp.org>

	* lib/mbiter.h: Include <stddef.h>, needed for ptrdiff_t.
	* lib/mbuiter.h: Likewise.

2007-06-10  Bruno Haible  <bruno@clisp.org>

	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF): Check for _snprintf
	declaration.

2007-06-10  Karl Berry  <karl@gnu.org>

	* config/srclist.txt: remove gettext entries, Bruno prefers
	to update individually.

2007-06-10  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF) [!USE_SNPRINTF]: Remove variable
	'maxlen'. Ensure only length + width bytes are allocated, not
	length + 1 + width.

2007-06-09  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (FCHAR_T, DCHAR_T, TCHAR_T): New macros.
	(CHAR_T): Remove macro.
	(VASNPRINTF): Update.

2007-06-09  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Unicode string functions): Add the new modules.

	* modules/uniconv/u32-conv-to-enc: New file.
	* lib/uniconv/u32-conv-to-enc.c: New file.
	* modules/uniconv/u32-conv-to-enc-tests: New file.
	* tests/uniconv/test-u32-conv-to-enc.c: New file.

	* modules/uniconv/u16-conv-to-enc: New file.
	* lib/uniconv/u16-conv-to-enc.c: New file.
	* lib/uniconv/u-conv-to-enc.h: New file.
	* modules/uniconv/u16-conv-to-enc-tests: New file.
	* tests/uniconv/test-u16-conv-to-enc.c: New file.

	* modules/uniconv/u8-conv-to-enc: New file.
	* lib/uniconv/u8-conv-to-enc.c: New file.
	* modules/uniconv/u8-conv-to-enc-tests: New file.
	* tests/uniconv/test-u8-conv-to-enc.c: New file.

	* lib/uniconv.h (u8_conv_to_encoding, u16_conv_to_encoding,
	u32_conv_to_encoding): New declarations.

2007-06-09  Bruno Haible  <bruno@clisp.org>

	* tests/uniconv/test-u32-strconv-to-enc.c (main): Remove unused code.

2007-06-09  Bruno Haible  <bruno@clisp.org>

	Rename 'allocsa' -> 'malloca', 'freesa' -> 'freea'.
	* modules/malloca: Renamed from modules/allocsa, updated.
	* lib/malloca.h: Renamed from lib/allocsa.h, updated.
	* lib/malloca.c: Renamed from lib/allocsa.c, updated.
	* lib/malloca.valgrind: Renamed from lib/allocsa.valgrind, updated.
	* m4/malloca.m4: Renamed from m4/allocsa.m4, updated.
	* modules/malloca-tests: Renamed from modules/allocsa-tests, updated.
	* tests/test-malloca.c: Renamed from tests/test-allocsa.c, updated.
	* modules/xmalloca: Renamed from modules/xallocsa, updated.
	* lib/xmalloca.h: Renamed from lib/xallocsa.h, updated.
	* lib/xmalloca.c: Renamed from lib/xallocsa.c, updated.
	* modules/c-strcasestr (Depends-on): Update.
	* lib/c-strcasestr.c: Update.
	* modules/c-strstr (Depends-on): Update.
	* lib/c-strstr.c: Update.
	* modules/canonicalize-lgpl (Depends-on): Update.
	* lib/canonicalize-lgpl.c: Update.
	* modules/clean-temp (Depends-on): Update.
	* lib/clean-temp.c: Update.
	* modules/csharpcomp (Depends-on): Update.
	* lib/csharpcomp.c: Update.
	* modules/csharpexec (Depends-on): Update.
	* lib/csharpexec.c: Update.
	* modules/javacomp (Depends-on): Update.
	* lib/javacomp.c: Update.
	* modules/javaexec (Depends-on): Update.
	* lib/javaexec.c: Update.
	* modules/mbscasestr (Depends-on): Update.
	* lib/mbscasestr.c: Update.
	* modules/mbsstr (Depends-on): Update.
	* lib/mbsstr.c: Update.
	* modules/setenv (Depends-on): Update.
	* lib/setenv.c: Update.
	* modules/strcasestr (Depends-on): Update.
	* lib/strcasestr.c: Update.
	* modules/striconveha (Depends-on): Update.
	* lib/striconveha.c: Update.
	* modules/relocatable-prog-wrapper (Files): Update.
	* lib/relocwrapper.c: Update.
	* build-aux/install-reloc: Update.
	* MODULES.html.sh (Memory management functions <stdlib.h>): Update.

2007-06-08  Bruno Haible  <bruno@clisp.org>

	Port to uClibc.
	* lib/fbufmode.c (fbufmode): Add special code for uClibc.
	* lib/fpurge.c (fpurge): Likewise.
	* lib/freading.c (freading): Likewise.
	* lib/fseeko.c (rpl_fseeko): Likewise.
	* lib/fseterr.c (fseterr): Likewise.
	* lib/fwriting.c (fwriting): Likewise.
	* tests/test-fflush.c (main): Avoid a failure on uClibc.

2007-06-08  Bruno Haible  <bruno@clisp.org>

	* m4/intlmacosx.m4: New file, extracted from gettext.m4.
	* m4/gettext.m4 (gt_INTL_MACOSX): Remove macro, moved to intlmacosx.m4.
	* modules/gettext (Files): Add m4/intlmacosx.m4.

2007-06-07  Bruno Haible  <bruno@clisp.org>

	* modules/localename-tests: New file.
	* tests/test-localename.c: New file.

	New module 'localename'.
	* lib/localename.h: New file.
	* lib/localename.c: New file, from GNU gettext.
	* m4/localename.m4: New file.
	* modules/localename: New file.

2007-06-07  Bruno Haible  <bruno@clisp.org>

	Work around the lack of <wchar.h> on some builds of uClibc.
	* doc/headers/wchar.texi: Update.
	* lib/wchar_.h: Include <wchar.h> only if it exists.
	* m4/wchar.m4 (gl_WCHAR_H): Check for <wchar.h>. Set HAVE_WCHAR_H.
	* m4/stdint.m4 (gl_STDINT_H): Check for <wchar.h>.
	(gl_STDINT_TYPE_PROPERTIES): Don't try to include <wchar.h> if it
	doesn't exist.
	* modules/wchar (wchar.h): Substitute HAVE_WCHAR_H.
	* modules/mbfile (Depends-on): Add wchar.
	* modules/mbiter (Depends-on): Likewise.
	* modules/mbuiter (Depends-on): Likewise.
	Reported by Simon Josefsson.

2007-06-06  Paul Eggert  <eggert@cs.ucla.edu>

	Work around problem reported by Steven M. Schweda in
	<http://lists.gnu.org/archive/html/bug-tar/2007-06/msg00002.html>:
	Tru64 5.1B with the Compaq compiler environment installed declares
	an 'isblank' function but does not define it in the C library.
	* lib/fnmatch.c (isblank): Check for HAVE_ISBLANK, too.
	* lib/regex_internal.h (isblank): Likewise.
	* m4/fnmatch.m4 (_AC_LIBOBJ_FNMATCH): Check for isblank existence.
	* m4/regex.m4 (gl_PREREQ_REGEX): Likewise.

2007-06-05  Bruno Haible  <bruno@clisp.org>

	Fix *printf so that it recognizes non-IEEE numbers on i386, x86_64,
	ia64.
	* modules/printf-safe: New file.
	* modules/fprintf-posix (Depends-on): Add printf-safe.
	* modules/printf-posix (Depends-on): Likewise.
	* modules/snprintf-posix (Depends-on): Likewise.
	* modules/sprintf-posix (Depends-on): Likewise.
	* modules/vasnprintf-posix (Depends-on): Likewise.
	* modules/vasprintf-posix (Depends-on): Likewise.
	* modules/vfprintf-posix (Depends-on): Likewise.
	* modules/vprintf-posix (Depends-on): Likewise.
	* modules/vsnprintf-posix (Depends-on): Likewise.
	* modules/vsprintf-posix (Depends-on): Likewise.
	* m4/printf.m4 (gl_PRINTF_INFINITE_LONG_DOUBLE): Require
	AC_C_BIGENDIAN. Define CHECK_PRINTF_SAFE if printf-safe is used. Test
	non-IEEE numbers on i386, x86_64, ia64. When cross-compiling, guess
	"no" on i386, x86_64, ia64.
	* tests/test-snprintf-posix.h (LDBL80_WORDS): New macro.
	(test_function): Check result of %La, %Lf, %Le, %Lg on non-IEEE numbers
	on i386, x86_64, ia64.
	* tests/test-sprintf-posix.h (LDBL80_WORDS): New macro.
	(test_function): Check result of %La, %Lf, %Le, %Lg on non-IEEE numbers
	on i386, x86_64, ia64.
	* tests/test-vasnprintf-posix.c: Include float.h.
	(LDBL80_WORDS): New macro.
	(test_function): Check result of %La, %Lf, %Le, %Lg on non-IEEE numbers
	on i386, x86_64, ia64.
	* tests/test-vasprintf-posix.c: Include float.h.
	(LDBL80_WORDS): New macro.
	(test_function): Check result of %La, %Lf, %Le, %Lg on non-IEEE numbers
	on i386, x86_64, ia64.
	* tests/test-snprintf-posix.c: Include float.h.
	* tests/test-sprintf-posix.c: Likewise.
	* tests/test-vsnprintf-posix.c: Likewise.
	* tests/test-vsprintf-posix.c: Likewise.

2007-06-05  Bruno Haible  <bruno@clisp.org>

	Fix isnanl so that it recognizes non-IEEE numbers on i386, x86_64, ia64.
	* m4/isnanl.m4 (gl_FUNC_ISNANL_WORKS): Require AC_C_BIGENDIAN. Test
	non-IEEE numbers on i386, x86_64, ia64.
	(gl_LONG_DOUBLE_EXPONENT_LOCATION): Require AC_C_BIGENDIAN.
	* lib/isnan.c (FUNC): Add special code for i386, x86_64, ia64.
	* tests/test-isnanl.h: Include float.h.
	(main): Check also non-IEEE numbers on i386, x86_64, ia64.

2007-06-05  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Do the extra handling of NaN and Inf
	also the %a / %A. Handle the %a / %A code before this extra handling.

2007-06-05  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c [NEED_PRINTF_LONG_DOUBLE ||
	NEED_PRINTF_INFINITE_LONG_DOUBLE]: Include fpucw.h.

2007-06-05  Bruno Haible  <bruno@clisp.org>

	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_INFINITE_LONG_DOUBLE): Fix
	typo in variable name.

2007-06-05  Eric Blake  <ebb9@byu.net>

	* m4/lseek.m4 (gl_FUNC_LSEEK): Work when cross-compiling.
	Reported by Simon Josefsson.

2007-06-04  Bruno Haible  <bruno@clisp.org>

	Avoid test failures on some PowerPC platforms.
	* tests/test-printf-frexpl.c (MIN_NORMAL_EXP, MIN_SUBNORMAL_EXP):
	Define differently for PowerPC.
	* tests/test-frexpl.c (MIN_NORMAL_EXP): Likewise.
	Reported by Gary V. Vaughan <gary@gnu.org>.

2007-06-02  Bruno Haible  <bruno@clisp.org>

	Fix test-stdint failure on FreeBSD/ia64.
	* m4/stdint.m4 (gl_STDINT_H): Check the values of PTRDIFF_MIN,
	PTRDIFF_MAX, SIG_ATOMIC_MIN, SIG_ATOMIC_MAX, SIZE_MAX, WCHAR_MIN,
	WCHAR_MAX, WINT_MIN, WINT_MAX entirely, not only for plausibility.
	* doc/headers/stdint.texi: Update.

2007-06-01  Bruno Haible  <bruno@clisp.org>

	* tests/test-binary-io.c (main): Pass a third argument to open().
	Reported by Gary V. Vaughan <gary@gnu.org>.

2007-06-01  Bruno Haible  <bruno@clisp.org>

	* doc/functions/frexpl.texi: Update for mingw.

2007-06-01  Bruno Haible  <bruno@clisp.org>

	* tests/test-lseek.c (main): Disable test of errno for invalid third
	argument.
	* doc/functions/lseek.texi: Update.
	Reported by Gary V. Vaughan <gary@gnu.org>.

2007-05-28  Bruno Haible  <bruno@clisp.org>

	* m4/intl.m4 (AM_INTL_SUBDIR): Substitute variables WOE32, WINDRES.

2007-05-31  Eric Blake  <ebb9@byu.net>

	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): Guess no on mingw when
	cross compiling.

2007-05-30  Eric Blake  <ebb9@byu.net>
	and Bruno Haible  <bruno@clisp.org>

	Work around mingw test failures exposed by m4-1.4.9b.
	* m4/stdint.m4 (gl_STDINT_H): Detect mingw bug.
	* tests/test-unistd.c: Disable uid_t and git_t tests for the
	moment.

2007-05-30  Bruno Haible  <bruno@clisp.org>

	* tests/test-lseek.c: Explicitly close file descriptors 0 and 1 before
	assuming that they are closed. Needed on HP-UX 11.

2007-05-29  Bruno Haible  <bruno@clisp.org>

	Fix a problem with #include_next.
	* lib/dirent_.h: Split the double-inclusion guard.
	* lib/fcntl_.h: Likewise.
	* lib/float_.h: Likewise.
	* lib/iconv_.h: Likewise.
	* lib/inttypes_.h: Likewise.
	* lib/locale_.h: Likewise.
	* lib/math_.h: Likewise.
	* lib/netinet_in_.h: Likewise.
	* lib/search_.h: Likewise.
	* lib/signal_.h: Likewise.
	* lib/stdint_.h: Likewise.
	* lib/stdio_.h: Likewise.
	* lib/stdlib_.h: Likewise.
	* lib/string_.h: Likewise.
	* lib/sys_select_.h: Likewise.
	* lib/sys_socket_.h: Likewise.
	* lib/sys_stat_.h: Likewise.
	* lib/sys_time_.h: Likewise.
	* lib/sysexits_.h: Likewise.
	* lib/time_.h: Likewise.
	* lib/unistd_.h: Likewise.
	* lib/wchar_.h: Likewise.
	* lib/wctype_.h: Likewise.

2007-05-29  Bruno Haible  <bruno@clisp.org>

	* tests/test-unistd.c: Disable the tests for useconds_t and intptr_t
	for the moment.

2007-05-29  Bruno Haible  <bruno@clisp.org>

	* m4/isnan.m4 (gl_DOUBLE_EXPONENT_LOCATION): Silence the AC_C_BIGENDIAN
	invocation.
	Reported by Eric Blake.

2007-05-29  Bruno Haible  <bruno@clisp.org>

	* m4/isnanf.m4 (gl_FLOAT_EXPONENT_LOCATION): Fix typo in cross-
	compiling case.

2007-05-29  Eric Blake  <ebb9@byu.net>
	    Bruno Haible  <bruno@clisp.org>

	* m4/isnanf.m4 (gl_FUNC_ISNANF_NO_LIBM): Avoid syntax error on
	cross compiles.

2007-05-28  Eric Blake  <ebb9@byu.net>

	* modules/closein-tests (test_closein_LDADD): Support test on
	cygwin with libtool.

2007-05-28  Bruno Haible  <bruno@clisp.org>

	* tests/uniconv/test-u16-conv-from-enc.c: Remove #ifdef HAVE_CONFIG_H.
	* tests/uniconv/test-u16-strconv-from-enc.c: Likewise.
	* tests/uniconv/test-u16-strconv-to-enc.c: Likewise.
	* tests/uniconv/test-u32-conv-from-enc.c: Likewise.
	* tests/uniconv/test-u32-strconv-from-enc.c: Likewise.
	* tests/uniconv/test-u32-strconv-to-enc.c: Likewise.
	* tests/uniconv/test-u8-conv-from-enc.c: Likewise.
	* tests/uniconv/test-u8-strconv-from-enc.c: Likewise.
	* tests/uniconv/test-u8-strconv-to-enc.c: Likewise.

2007-05-28  Eric Blake  <ebb9@byu.net>

	Unconditionally include <config.h> in unit tests.
	* tests/test-alloca-opt.c: Remove #ifdef HAVE_CONFIG_H.
	* tests/test-allocsa.c, tests/test-arcfour.c,
	tests/test-arctwo.c, tests/test-argmatch.c, tests/test-argp.c,
	tests/test-array_list.c, tests/test-array_oset.c,
	tests/test-atexit.c, test-avltree_list.c, test-avltree_oset.c,
	test-avltreehash_list.c, test-base64.c, test-binary-io.c,
	test-c-ctype.c, test-c-strcasecmp.c, test-c-strcasestr.c,
	test-c-strncasecmp.c, test-c-strstr.c, test-canonicalize-lgpl.c,
	test-carray_list.c, test-crc.c, test-des.c, test-dirname.c,
	test-fflush.c, test-fprintf-posix.c, test-gc-arcfour.c,
	test-gc-arctwo.c, test-gc-des.c, test-gc-hmac-md5.c,
	test-gc-hmac-sha1.c, test-gc-md2.c, test-gc-md4.c, test-gc-md5.c,
	test-gc-pbkdf2-sha1.c, test-gc-rijndael.c, test-gc-sha1.c,
	test-gc.c, test-getpass.c, test-hmac-md5.c, test-hmac-sha1.c,
	test-iconv.c, test-linked_list.c, test-linkedhash_list.c,
	test-lock.c, test-mbscasecmp.c, test-mbscasestr1.c,
	test-mbscasestr2.c, test-mbscasestr3.c, test-mbscasestr4.c,
	test-mbschr.c, test-mbscspn.c, test-mbsncasecmp.c, test-mbspbrk.c,
	test-mbspcasecmp.c, test-mbsrchr.c, test-mbsspn.c, test-mbsstr1.c,
	test-mbsstr2.c, test-mbsstr3.c, test-md2.c, test-md4.c,
	test-md5.c, test-memmem.c, test-printf-posix.c,
	test-rbtree_list.c, test-rbtree_oset.c, test-rbtreehash_list.c,
	test-read-file.c, test-rijndael.c, test-snprintf-posix.c,
	test-snprintf.c, test-sprintf-posix.c, test-stdint.c,
	test-strcasestr.c, test-striconv.c, test-striconveh.c,
	test-striconveha.c, test-tls.c, test-vasnprintf-posix.c,
	test-vasnprintf-posix2.c, test-vasnprintf.c,
	test-vasprintf-posix.c, test-vasprintf.c, test-verify.c,
	test-vfprintf-posix.c, test-vprintf-posix.c,
	test-vsnprintf-posix.c, test-vsnprintf.c, test-vsprintf-posix.c,
	test-xvasprintf.c: Likewise.

2007-05-28  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Remember the --with-tests command-line
	option through the macro gl_WITH_TESTS in the gnulib-cache.m4.
	Reported by Eric Blake.

2007-05-28  Bruno Haible  <bruno@clisp.org>

	* modules/ftell-tests: New file.
	* tests/test-ftell.c: New file, based on tests/test-ftello.c.
	* tests/test-ftell.sh: New file, based on tests/test-ftello.sh.

	* lib/ftell.c: New file.
	* modules/ftell: New file.
	* m4/ftell.m4: New file.
	* doc/functions/ftell.texi: Update.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_FTELL,
	REPLACE_FTELL.
	* lib/stdio_.h (rpl_ftell): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_FTELL,
	REPLACE_FTELL.

2007-05-28  Eric Blake  <ebb9@byu.net>

	* lib/allocsa.h (safe_alloca): Avoid compiler warning.

2007-05-28  Bruno Haible  <bruno@clisp.org>

	* modules/fseek-tests: New file.
	* tests/test-fseek.c: New file, based on tests/test-fseeko.c.
	* tests/test-fseek.sh: New file, based on tests/test-fseeko.sh.

	* lib/fseek.c: New file.
	* modules/fseek: New file.
	* m4/fseek.m4: New file.
	* doc/functions/fseek.texi: Update.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_FSEEK,
	REPLACE_FSEEK.
	* lib/stdio_.h (rpl_fseek): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_FSEEK,
	REPLACE_FSEEK.

2007-05-28  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h (fflush): More comments.

2007-05-28  Bruno Haible  <bruno@clisp.org>

	* m4/lseek.m4 (gl_FUNC_LSEEK): When not cross-compiling, perform a real
	runtime test.

2007-05-28  Eric Blake  <ebb9@byu.net>

	Improve lseek module.
	* lib/lseek.c (rpl_lseek): Detect EBADF on mingw.
	* lib/unistd_.h (lseek): Scale back link warning message.
	* tests/test-lseek.c: Beef up test.
	* tests/test-lseek.sh: Exercise more facets of lseek.
	Reported by Bruno Haible.

2007-05-28  Bruno Haible  <bruno@clisp.org>

	* tests/test-unistd.c: Test all the types that <unistd.h> is expected
	to define.

2007-05-27  Bruno Haible  <bruno@clisp.org>

	* m4/iconv.m4 (AM_ICONV_LINK): Fix 2007-03-31 patch.

2007-05-27  Bruno Haible  <bruno@clisp.org>

	* modules/openmp: New file.
	* m4/openmp.m4: New file, taken from autoconf's CVS with changes by
	Noah Misch.

2007-05-26  Bruno Haible  <bruno@clisp.org>

	* modules/chdir-long (Depends-on): Add fchdir.
	* modules/chdir-safer (Depends-on): Likewise.
	* modules/fts (Depends-on): Likewise.
	* modules/fts-lgpl (Depends-on): Likewise.
	* modules/openat (Depends-on): Likewise.
	* modules/savewd (Depends-on): Likewise.

2007-05-24  Eric Blake  <ebb9@byu.net>

	Fix lseek on mingw.
	* modules/lseek: New module.
	* m4/lseek.m4: New file.
	* lib/lseek.c: New file.
	* modules/lseek-tests: New file.
	* tests/test-lseek.c: New file.
	* tests/test-lseek.sh: New file.
	* MODULES.html.sh: Document lseek module.
	* modules/fflush (Depends-on): Add lseek, fseeko.
	* modules/fseeko (Depends-on): Likewise.
	* modules/ftello (Depends-on): Likewise.
	* m4/fseeko.m4 (gl_FUNC_FSEEKO): Replace fseek[o] if lseek is
	broken.
	* m4/ftello.m4 (gl_FUNC_FTELLO): Replace ftell[o] if lseek is
	broken.
	* m4/fflush.m4 (gl_REPLACE_FFLUSH): Trigger fseeko module.
	* lib/fseeko.c (rpl_fseeko): Quit early on non-seekable files.
	* lib/ftello.c (rpl_ftello): Likewise.
	* tests/test-fseeko.c (main): Test this.
	* tests/test-fseeko.sh: Likewise.
	* tests/test-ftello.c (main): Likewise.
	* tests/test-ftello.sh: Likewise.
	* lib/stdio_.h (fseek, ftell): Simplify, since missing fseeko now
	implies replacing fseek.
	* modules/stdio (Makefile.am): No longer need HAVE_FSEEKO,
	HAVE_FTELLO.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Add lseek info.
	* modules/unistd (Makefile.am): Likewise.
	* lib/unistd_.h (lseek): Declare a replacement.
	* doc/functions/lseek.texi (lseek): Document this fix.
	* doc/functions/fseek.texi (fseek): Likewise.
	* doc/functions/ftell.texi (ftell): Likewise.

2007-05-24  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (test_function): Allow up to 50 bytes
	in the printed representation of a NaN.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	Reported by Eric Blake.

2007-05-23  Eric Blake  <ebb9@byu.net>

	Fix fseeko/ftello on cygwin 1.5.24.
	* doc/functions/fseeko.texi (fseeko): Document the fix.
	* doc/functions/ftello.texi (ftello): Document the fix.
	* doc/functions/stdin.texi (stdin): Document the cygwin bug.
	* doc/functions/stdout.text (stdout): New file.
	* doc/functions/stderr.text (stderr): New file.
	* doc/gnulib.texi (Function Substitutes): Use new files.
	* tests/test-fseeko.c (main): Check for broken fseeko on cygwin
	prior to 1.7.0.
	* tests/test-ftello.c (main): Likewise for ftello.
	* tests/test-fseeko.sh: New file.
	* tests/test-ftello.sh: New file.
	* modules/fseeko-tests (Makefile.am): Ensure test-fseeko is run
	with seekable stdin.
	* modules/ftello-tests (Makefile.am): Likewise for test-ftello.
	* m4/fseeko.m4 (gl_FUNC_FSEEKO): Detect the cygwin bug.
	(gl_REPLACE_FSEEKO): New macro.
	* m4/ftello.m4 (gl_FUNC_FTELLO, gl_REPLACE_FTELLO): Likewise.
	* modules/fseeko (Files): Distribute fseeko.c.
	* modules/ftello (Files): Distribute ftello.c.
	* lib/fseeko.c (rpl_fseeko) [__CYGWIN__]: Convert stdin to 64-bit
	mode.
	* lib/ftello.c (rpl_ftello): New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Allow replacement of
	fseeko, ftello.
	(gl_STDIN_LARGE_OFFSET): New macro.
	* modules/stdio (Makefile.am): Perform the replacement.
	* lib/stdio_.h (rpl_fseeko, rpl_ftello): Define when needed.

2007-05-23  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h (fseeko, ftello): Provide a link warning only if
	GNULIB_POSIXCHECK is defined.

2007-05-21  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_INFINITE, gl_PRINTF_INFINITE_LONG_DOUBLE):
	Check also the output for NaN arguments. When cross-compiling, guess
	no on IRIX.
	* lib/vasnprintf.c: Update comments.
	* tests/test-vasnprintf-posix.c (strisnan): New function.
	(test_function): Use it.
	* tests/test-vasprintf-posix.c (strisnan): New function.
	(test_function): Use it.
	* tests/test-snprintf-posix.h (strisnan): New function.
	(test_function): Use it.
	* tests/test-sprintf-posix.h (strisnan): New function.
	(test_function): Use it.
	Reported by Eric Blake.

2007-05-20  Bruno Haible  <bruno@clisp.org>

	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): Add test for large finite
	numbers that fails on BeOS.
	* doc/functions/frexpl.texi: Update.

2007-05-20  Jim Meyering  <jim@meyering.net>

	* NEWS: Mention the incompatible change (s/futimens/gl_futimens/)
	forced upon us by glibc-2.6.

2007-05-20  Bruno Haible  <bruno@clisp.org>

	Fix *printf result for NaN, Inf on AIX, Solaris, OSF/1.
	* m4/printf.m4 (gl_PRINTF_INFINITE): Update cross-compiling guesses.
	(gl_PRINTF_INFINITE_LONG_DOUBLE): New macro.
	* lib/vasnprintf.c: Use NEED_PRINTF_INFINITE_DOUBLE instead of
	NEED_PRINTF_INFINITE.
	(is_infinitel): New function.
	(VASNPRINTF): Handle NEED_PRINTF_INFINITE_LONG_DOUBLE case.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_INFINITE_DOUBLE): Renamed from
	gl_PREREQ_VASNPRINTF_INFINITE.
	(gl_PREREQ_VASNPRINTF_INFINITE_LONG_DOUBLE): New macro.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Invoke
	gl_PRINTF_INFINITE_LONG_DOUBLE and test its result. Invoke
	gl_PREREQ_VASNPRINTF_INFINITE_DOUBLE and
	gl_PREREQ_VASNPRINTF_INFINITE_LONG_DOUBLE instead of
	gl_PREREQ_VASNPRINTF_INFINITE.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Likewise.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	* doc/functions/fprintf.texi: Update.
	* doc/functions/printf.texi: Update.
	* doc/functions/snprintf.texi: Update.
	* doc/functions/sprintf.texi: Update.
	* doc/functions/vfprintf.texi: Update.
	* doc/functions/vprintf.texi: Update.
	* doc/functions/vsnprintf.texi: Update.
	* doc/functions/vsprintf.texi: Update.

2007-05-20  Bruno Haible  <bruno@clisp.org>

	* m4/frexpl.m4 (gl_FUNC_FREXPL_NO_LIBM): Set REPLACE_FREXPL if frexpl
	was not found in libc.
	* m4/printf-frexpl.m4 (gl_FUNC_PRINTF_FREXPL): Likewise.

2007-05-20  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (test_function): Allow NaN to be
	printed as "-nan" instead of "nan".
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	Needed for HP-UX 11.

2007-05-20  Jim Meyering  <jim@meyering.net>

	Fix buggy test for the fchownat-deref bug.
	* m4/openat.m4 (gl_FUNC_FCHOWNAT_DEREF_BUG): Create the dangling
	symlink required for the run-test.  Without it, this test would
	always declare that fchownat doesn't work, and client code would
	unnecessarily use the replacement function with fixed libc.
	(gl_FUNC_FCHOWNAT): Eliminate a variable that wasn't initialized.
	Reported by Greg Schafer.

2007-05-19  Bruno Haible  <bruno@clisp.org>

	* m4/isnanf.m4 (gl_ISNANF_WORKS): New macro.
	(gl_FUNC_ISNANF_NO_LIBM): Invoke it.
	* lib/isnan.c (FUNC): Use run-time expressions for SGI compiler.
	Needed for IRIX 6.5 and Solaris 2.5.1.

2007-05-19  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (have_minus_zero): New function.
	(test_function): Skip tests involving -0.0 on platforms where
	-0.0 = 0.0.
	* tests/test-vasprintf-posix.c (have_minus_zero): New function.
	(test_function): Skip tests involving -0.0 on platforms where
	-0.0 = 0.0.
	* tests/test-snprintf-posix.h (have_minus_zero): New function.
	(test_function): Skip tests involving -0.0 on platforms where
	-0.0 = 0.0.
	* tests/test-sprintf-posix.h (have_minus_zero): New function.
	(test_function): Skip tests involving -0.0 on platforms where
	-0.0 = 0.0.
	* tests/test-fprintf-posix.h (test_function): Remove all -0.0 related
	tests.
	* tests/test-printf-posix.h (test_function): Likewise.
	* tests/test-printf-posix.output: Remove all -0.0 related results.
	Needed for IRIX 6.5.

2007-05-19  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (test_function): Allow NaN to be
	printed as "nan0x7fffffff" instead of "nan".
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-fprintf-posix.h (NaN): Remove macro.
	(test_function): Remove all NaN related tests.
	* tests/test-printf-posix.h (NaN): Remove macro.
	(test_function): Remove all NaN related tests.
	* tests/test-printf-posix.output: Remove all NaN related results.
	Needed for IRIX 6.5.

2007-05-19  Bruno Haible  <bruno@clisp.org>

	* m4/frexp.m4 (gl_FUNC_FREXP_WORKS): Fix C89 syntax error in test code.
	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): Likewise.

2007-05-19  Bruno Haible  <bruno@clisp.org>

	* lib/float_.h: New file.
	* m4/float_h.m4: New file.
	* modules/float: New file.
	* modules/isnanl (Dependencies): Add float.
	* modules/isnanl-nolibm (Dependencies): Likewise.
	* modules/mathl (Dependencies): Likewise.
	* modules/printf-frexpl (Dependencies): Likewise.
	* modules/signbit (Dependencies): Likewise.
	* modules/vasnprintf (Dependencies): Likewise.
	* doc/headers/float.texi: Update.

2007-05-19  Jim Meyering  <jim@meyering.net>

	* lib/utimens.c (gl_futimens): Rename from futimens,
	now that glibc-2.6 declares futimens.
	* lib/utimens.h: Likewise.

2007-05-19  Bruno Haible  <bruno@clisp.org>

	Avoid test failures on mingw.
	* tests/test-fprintf-posix.sh: Convert CR/LF to LF in output.
	* tests/test-printf-posix.sh: Likewise.
	* tests/test-vfprintf-posix.sh: Likewise.
	* tests/test-vprintf-posix.sh: Likewise.

2007-05-19  Bruno Haible  <bruno@clisp.org>

	Fix *printf result for NaN, Inf, -0.0 on mingw.
	* m4/printf.m4 (gl_PRINTF_INFINITE): New macro.
	* lib/vasnprintf.c: Include math.h and isnan.h.
	(is_infinite_or_zero): New function.
	(VASNPRINTF): Fix also the handling of infinite or zero 'double'
	values in the %f, %F, %e, %E, %g, %G directives.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_INFINITE): New macro.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Invoke
	gl_PRINTF_INFINITE and test its result. Invoke
	gl_PREREQ_VASNPRINTF_INFINITE.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Likewise.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	* doc/functions/fprintf.texi: Update.
	* doc/functions/printf.texi: Update.
	* doc/functions/snprintf.texi: Update.
	* doc/functions/sprintf.texi: Update.
	* doc/functions/vfprintf.texi: Update.
	* doc/functions/vprintf.texi: Update.
	* doc/functions/vsnprintf.texi: Update.
	* doc/functions/vsprintf.texi: Update.

2007-05-19  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (convert_to_decimal): Add an extra_zeroes argument.
	(scale10_round_decimal_long_double): Inline scale10_round_long_double.
	Instead of multiplying with 10^k, set extra_zeroes to k.
	(scale10_round_long_double): Remove function.

2007-05-18  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF) [NEED_PRINTF_FLAG_ZERO]: Fix logic bug
	introduced on 2007-05-06.

2007-05-18  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (test_function): Also test the %e and
	%g directives.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.

2007-05-18  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (SIZEOF): New macro.
	(strmatch): New function.
	(test_function): Test the %f directive on numbers of various exponents.
	* tests/test-vasprintf-posix.c (SIZEOF): New macro.
	(strmatch): New function.
	(test_function): Test the %f directive on numbers of various exponents.
	* tests/test-snprintf-posix.h (strmatch): New function.
	(test_function): Test the %f directive on numbers of various exponents.
	* tests/test-sprintf-posix.h (strmatch): New function.
	(test_function): Test the %f directive on numbers of various exponents.
	* tests/test-snprintf-posix.c (SIZEOF): New macro.
	* tests/test-sprintf-posix.c (SIZEOF): New macro.
	* tests/test-vsnprintf-posix.c (SIZEOF): New macro.
	* tests/test-vsprintf-posix.c (SIZEOF): New macro.

2007-05-18  Bruno Haible  <bruno@clisp.org>

	Add support for 'long double' number output.
	* m4/printf.m4 (gl_PRINTF_LONG_DOUBLE): New macro.
	* lib/vasnprintf.c: Include math.h and float+.h.
	(mp_limb_t): New type.
	(GMP_LIMB_BITS): New macro.
	(mp_twolimb_t): New type.
	(GMP_TWOLIMB_BITS): New macro.
	(mpn_t): New type.
	(multiply, divide, convert_to_decimal, decode_long_double,
	scale10_round_long_double, scale10_round_decimal_long_double,
	floorlog10l): New functions.
	(VASNPRINTF) [NEED_PRINTF_LONG_DOUBLE]: Implement 'long double' support
	for the %f, %F, %e, %E, %g, %G directives.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_LONG_DOUBLE): New macro.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Invoke
	gl_PRINTF_LONG_DOUBLE and test its result. Invoke
	gl_PREREQ_VASNPRINTF_LONG_DOUBLE.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Likewise.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	* modules/fprintf-posix (Depends-on): Add frexpl-nolibm.
	* modules/snprintf-posix (Depends-on): Likewise.
	* modules/sprintf-posix (Depends-on): Likewise.
	* modules/vasnprintf-posix (Depends-on): Likewise.
	* modules/vasprintf-posix (Depends-on): Likewise.
	* modules/vfprintf-posix (Depends-on): Likewise.
	* modules/vsnprintf-posix (Depends-on): Likewise.
	* modules/vsprintf-posix (Depends-on): Likewise.
	* modules/vasnprintf (Files): Add lib/float+.h.
	* doc/functions/fprintf.texi: Update.
	* doc/functions/printf.texi: Update.
	* doc/functions/snprintf.texi: Update.
	* doc/functions/sprintf.texi: Update.
	* doc/functions/vfprintf.texi: Update.
	* doc/functions/vprintf.texi: Update.
	* doc/functions/vsnprintf.texi: Update.
	* doc/functions/vsprintf.texi: Update.

2007-05-18  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (USE_SNPRINTF): Define to 0 on BeOS.

2007-05-18  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF) [WIN32]: Use %I64d instead of %lld
	for printing 64-bit integers. Needed for mingw.

2007-05-18  Bruno Haible  <bruno@clisp.org>

	* m4/printf-frexpl.m4 (gl_FUNC_PRINTF_FREXPL): Invoke
	gl_FUNC_FREXPL_WORKS.
	* modules/printf-frexpl (Files): Add m4/frexpl.m4.

2007-05-18  Bruno Haible  <bruno@clisp.org>

	* modules/frexpl-nolibm-tests: New file.

	* modules/frexpl-nolibm: New file.
	* m4/frexpl.m4 (gl_FUNC_FREXPL_NO_LIBM): New macro.

2007-05-17  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/dirent_.h: Prefer #include_next <foo.h> to #include
	@ABSOLUTE_FOO_H@ if @HAVE_INCLUDE_NEXT@.  This works better with
	GCC 4.2, which otherwise issues a lot of warnings.
	* lib/iconv_.h, lib/locale_.h, lib/netinet_in_.h, lib/sys_select_.h:
	* lib/sys_socket_.h, lib/sys_stat_.h, lib/sysexits_.h, lib/unistd_.h:
	Likewise.
	* modules/fchdir (dirent.h): Substitute @HAVE_INCLUDE_NEXT@.
	* modules/iconv_open (iconv.h): Likewise.
	* modules/locale (locale.h): Likewise.
	* modules/netinet_in (netinet/in.h): Likewise.
	* modules/sys_select (sys_select.h): Likewise.
	* modules/sys_socket (sys/socket.h): Likewise.
	* modules/sys_stat (sys/stat.h): Likewise.
	* modules/sysexits (sysexits.h): Likewise.
	* modules/unistd (unistd.h): Likewise.

2007-05-17  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* modules/closein-tests (Makefile.am): Distribute
	`test-closein.sh'.

2007-05-17  Bruno Haible  <bruno@clisp.org>

	* tests/test-printf-posix.output: Renamed from
	tests/test-fprintf-posix.out.
	* modules/fprintf-posix-tests: Update.
	* modules/printf-posix-tests: Update.
	* modules/vfprintf-posix-tests: Update.
	* modules/vprintf-posix-tests: Update.
	* tests/test-fprintf-posix.sh: Update.
	* tests/test-printf-posix.sh: Update.
	* tests/test-vfprintf-posix.sh: Update.
	* tests/test-vprintf-posix.sh: Update.
	Reported by Ralf Wildenhues.

2007-05-16  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/fcntl_.h: Prefer #include_next <foo.h> to #include
	@ABSOLUTE_FOO_H@ if @HAVE_INCLUDE_NEXT@.  This works better with
	GCC 4.2, which otherwise issues a lot of warnings.
	* lib/inttypes_.h, lib/math_.h, lib/search_.h, lib/signal_.h:
	* lib/stdint_.h, lib/stdio_.h, lib/stdlib_.h, lib/string_.h:
	* lib/sys_time_.h, lib/time_.h, lib/wchar_.h, lib/wctype_.h: Likewise.
	* lib/stdlib_.h: Don't bother with #pragma GCC system_header, as
	it should no longer be needed.
	* lib/string_.h: Likewise.
	* modules/absolute-header (HAVE_INCLUDE_NEXT): New 'make' define.
	* modules/fcntl (fcntl.h): Substitute @HAVE_INCLUDE_NEXT@.
	* modules/inttypes (inttypes.h): Likewise.
	* modules/math (math.h): Likewise.
	* modules/search (search.h): Likewise.
	* modules/signal (signal.h): Likewise.
	* modules/stdint (stdint.h): Likewise.
	* modules/stdio (stdio.h): Likewise.
	* modules/stdlib (stdlib.h): Likewise.
	* modules/string (string.h): Likewise.
	* modules/sys_time (sys/time.h): Likewise.
	* modules/time (time.h): Likewise.
	* modules/wchar (wchar.h): Likewise.
	* modules/wctype (wtype.h): Likewise.

2007-05-16  Thien-Thi Nguyen  <ttn@gnuvola.org>  (tiny change)

	* doc/gnulib-tool.texi (CVS Issues): Fix typo.

2007-05-13  Bruno Haible  <bruno@clisp.org>

	* stpcpy.m4 (gl_FUNC_STPCPY): Require AC_C_RESTRICT.
	* stpncpy.m4 (gl_FUNC_STPNCPY): Likewise.
	* strsep.m4 (gl_FUNC_STRSEP): Likewise.
	* strtok_r.m4 (gl_FUNC_STRTOK_R): Likewise.
	(gl_PREREQ_STRTOK_R): Don't require it here.

2007-05-13  Bruno Haible  <bruno@clisp.org>

	* lib/stdlib_.h (mkdtemp, mkstemp): Comment out argument name. Needed
	when used in C++ mode.

2007-05-12  Bruno Haible  <bruno@clisp.org>

	* lib/linebuffer.h: Tweak doc.
	* lib/linebuffer.c: Likewise.

2007-05-12  James Youngman  <jay@gnu.org>

	* lib/linebuffer.c (readlinebuffer_delim): New function,
	like readlinebuffer, but use a caller-specified delimiter.
	(readlinebuffer): Just call readlinebuffer_delim with '\n'
	as the delimiter.
	* lib/linebuffer.h (readlinebuffer_delim): Declare it.

2007-05-12  Sergey Poznyakoff  <gray@gnu.org.ua>

	* m4/openat.m4 (gl_FUNC_OPENAT): Do not require openat-die.
	* modules/openat (Files): Remove openat-die.c.
	(Depends-on): Add openat-die.
	* modules/openat-die: New module.

2007-05-06  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_FLAG_GROUPING, gl_VSNPRINTF_ZEROSIZE_C99):
	Update with info about Cygwin.
	* doc/functions/fprintf.texi: Update.
	* doc/functions/printf.texi: Update.
	* doc/functions/snprintf.texi: Update.
	* doc/functions/sprintf.texi: Update.
	* doc/functions/vfprintf.texi: Update.
	* doc/functions/vprintf.texi: Update.
	* doc/functions/vsnprintf.texi: Update.
	* doc/functions/vsprintf.texi: Update.
	Reported by Eric Blake.

2007-05-06  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF) [NEED_PRINTF_FLAG_ZERO]: Perform the
	padding ourselves for the floating-point directives.
	* m4/printf.m4 (gl_PRINTF_FLAG_ZERO): New macro.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_FLAG_ZERO): New macro.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Invoke
	gl_PRINTF_FLAG_ZERO and test its result. Invoke
	gl_PREREQ_VASNPRINTF_FLAG_ZERO.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	* tests/test-snprintf-posix.h (test_function): Also check the width
	and some flags in the %f directive.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-vasnprintf-posix.c (test_function): Likewise.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* doc/functions/fprintf.texi: Update.
	* doc/functions/printf.texi: Update.
	* doc/functions/snprintf.texi: Update.
	* doc/functions/sprintf.texi: Update.
	* doc/functions/vfprintf.texi: Update.
	* doc/functions/vprintf.texi: Update.
	* doc/functions/vsnprintf.texi: Update.
	* doc/functions/vsprintf.texi: Update.

2007-05-06  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF) [NEED_PRINTF_FLAG_GROUPING]: Don't
	pass the ' flag character to sprintf or snprintf.
	* m4/printf.m4 (gl_PRINTF_FLAG_GROUPING): New macro.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_FLAG_GROUPING): New macro.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Invoke
	gl_PRINTF_FLAG_GROUPING and test its result. Invoke
	gl_PREREQ_VASNPRINTF_FLAG_GROUPING.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	* tests/test-snprintf-posix.h (test_function): Also check the grouping
	flag.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-vasnprintf-posix.c (test_function): Likewise.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* doc/functions/fprintf.texi: Update.
	* doc/functions/printf.texi: Update.
	* doc/functions/snprintf.texi: Update.
	* doc/functions/sprintf.texi: Update.
	* doc/functions/vfprintf.texi: Update.
	* doc/functions/vprintf.texi: Update.
	* doc/functions/vsnprintf.texi: Update.
	* doc/functions/vsprintf.texi: Update.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* tests/test-argp-2.sh (func_compare): Drop .exe suffix.

2007-05-03  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/d-ino.m4 (gl_CHECK_TYPE_STRUCT_DIRENT_D_INO): Use better
	comment for D_INO_IN_DIRENT.  Problem reported by James Youngman.

2007-05-02  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/d-ino.m4 (gl_CHECK_TYPE_STRUCT_DIRENT_D_INO): Test whether
	readdir returns garbage in d_ino.  Problem reported by Kaz Sasayama in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-05/msg00021.html>.

2007-05-02  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-help.c (struct hol_entry): New member `ord'.
	(HOL_ENTRY_PTRCMP): Use ord for comparison
	(hol_sort): Initialize ord.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* doc/functions/_Exit_C99.texi: Renamed from doc/functions/_Exit.texi.
	Reported by Eric Blake.
	* doc/gnulib.texi (Function Substitutes): Update.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* doc/functions.texi: Remove file, now redundant through
	doc/functions/*.texi.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* modules/argp (Depends-on): Add sleep.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* modules/sleep-tests: New file.
	* tests/test-sleep.c: New file.

	* modules/sleep: New file.
	* lib/sleep.c: New file.
	* m4/sleep.m4: New file.
	* lib/unistd_.h (sleep): New declaration.
	* m4/unistd_h.m4 (gl_UNISTD_H_DEFAULTS): Initialize GNULIB_SLEEP,
	HAVE_SLEEP.
	* modules/unistd (Makefile.am): Substitute GNULIB_SLEEP, HAVE_SLEEP.
	* doc/functions/sleep.texi: Document the sleep module.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* lib/sigprocmask.h: Remove file.
	* lib/signal_.h: Incorporate the previous contents of sigprocmask.h.
	* lib/sigprocmask.c: Include <signal.h> instead of sigprocmask.h.
	* m4/signal_h.m4 (gl_SIGNAL_H_DEFAULTS): Substitute GNULIB_SIGPROCMASK,
	HAVE_POSIX_SIGNALBLOCKING, HAVE_SIGSET_T.
	* m4/signalblocking.m4 (gl_SIGNALBLOCKING): Require
	gl_SIGNAL_H_DEFAULTS. Set HAVE_POSIX_SIGNALBLOCKING as a shell variable.
	(gl_PREREQ_SIGPROCMASK): Require gl_SIGNAL_H_DEFAULTS. Set
	HAVE_SIGSET_T as a shell variable.
	* modules/signal (Makefile.am): Substitute GNULIB_SIGPROCMASK,
	HAVE_POSIX_SIGNALBLOCKING, HAVE_SIGSET_T into signal.h.
	* modules/sigprocmask (Files): Remove lib/sigprocmask.h.
	(Depends-on): Add signal. Remove verify.
	(configure.ac): Invoke gl_SIGNAL_MODULE_INDICATOR.
	(Include): Mention <signal.h> instead of sigprocmask.h.
	* NEWS: Mention the change.
	* lib/fatal-signal.c: Don't include sigprocmask.h.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* modules/signal: New file.
	* lib/signal_.h: New file.
	* m4/signal_h.m4: New file.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* lib/wctype_.h: Test HAVE_ISWCNTRL at configure time.
	* m4/wctype.m4 (gl_WCTYPE_H): Substitute HAVE_ISWCNTRL.
	* modules/wctype (Makefile.am): Substitute HAVE_ISWCNTRL instead of
	HAVE_WCTYPE_CTMP_BUG into wctype.h.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* lib/sys_stat_.h: Test HAVE_LSTAT, HAVE_DECL_MKDIR, HAVE_IO_H at
	configure time.
	* m4/sys_stat_h.m4 (gl_HEADER_SYS_STAT_H): Substitute HAVE_LSTAT,
	HAVE_DECL_MKDIR, HAVE_IO_H via AC_SUBST.
	* modules/sys_stat (Makefile.am): Substitute their values into
	sys/stat.h.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* lib/glob_.h: Test HAVE_SYS_CDEFS_H at configure time.
	* m4/glob.m4 (gl_PREREQ_GLOB): Substitute HAVE_SYS_CDEFS_H via AC_SUBST.
	* modules/glob (Makefile.am): Put HAVE_SYS_CDEFS_H value into glob.h.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* doc/header/assert.texi: Undo last change: don't mention the gnulib
	'assert' module here.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* doc/functions/*.texi: New files.
	* doc/functions/google-ranking.txt: New file.
	* doc/gnulib.texi (Function Substitutes): New chapter.
	(ctime, inet_ntoa): Remove sections.
	* doc/ctime.texi: Remove file.
	* doc/inet_ntoa.texi: Remove file.
	* doc/Makefile (gnulib.info, gnulib.html, gnulib.dvi): Update
	dependencies.
	(%.info): New rule, specifying a --reference-limit.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (posix_functions): Remove 'exec', 'toc'.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* modules/mkdir (Depends-on): Add sys_stat, because sys_stat provides
	the portability of 'mkdir' to mingw systems.

2007-05-01  Bruno Haible  <bruno@clisp.org>

	* doc/headers/google-ranking.txt: New file.

2007-04-30  Eric Blake  <ebb9@byu.net>

	Prefer fseeko to fseek.
	* modules/getpass (Depends-on): Add fseeko.
	* lib/getpass.c (getpass): Use fseeko, not fseek.

2007-04-30  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-help.c (hol_entry_cmp): Option sorting algorithm
	assumes the sorting is stable, while most qsort implementations
	are not.  Use argument addresses to ensure they never compare as
	equal.

	* tests/test-argp-2.sh (usage-indent test): Fix output
	(func_compare): Restore diff options
	* tests/test-argp.c: Restore #include "progname.h"

2007-04-29  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_VSNPRINTF_ZEROSIZE_C99): New macro.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Invoke
	gl_VSNPRINTF_ZEROSIZE_C99. Test gl_cv_func_vsnprintf_zerosize_c99.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* modules/snprintf-posix-tests (Files): Add tests/test-snprintf.c.
	(configure.ac): Define CHECK_SNPRINTF_POSIX.
	(TESTS, check_PROGRAMS): Add test-snprintf.
	* modules/vsnprintf-posix-tests (Files): Add tests/test-vsnprintf.c.
	(configure.ac): Define CHECK_VSNPRINTF_POSIX.
	(TESTS, check_PROGRAMS): Add test-vsnprintf.
	* tests/test-snprintf.c (main) [!CHECK_SNPRINTF_POSIX]: Disable
	assertions that fail on HP-UX, OSF/1, or IRIX.
	* tests/test-vsnprintf.c (main) [!CHECK_VSNPRINTF_POSIX]: Likewise.

2007-04-29  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (posix_functions): Remove 'contents'.

2007-04-29  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (gendocs_template_min): new entry.

2007-04-29  Bruno Haible  <bruno@clisp.org>

	Work around fpurge bug on BSD systems.
	* modules/fpurge (Makefile.am): Compile fpurge.c unconditionally.
	* m4/fpurge.m4 (gl_FUNC_FPURGE): Don't invoke AC_LIBOBJ.
	* lib/fpurge.h (fpurge): Don't handle __fpurge wrapper here. Define
	fpurge to rpl_fpurge if the system already has this function.
	* lib/fpurge.c (fpurge): Handle also the __fpurge wrapper case and
	the case where the system already has this function. Correct invariants
	on BSD systems.
	* lib/fseeko.c (rpl_fseeko): Update recognition of preceding fflush on
	BSD systems.

2007-04-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-help.c (hol_cluster_cmp): Reverse comparison.  Change
	proposed by Sven Verdoolaege.

	* tests/test-argp.c: Fix option ordering.  Test deeply clustered
	options.
	* tests/test-argp-2.sh (func_compare): Use diff instead of cmp.
	(usage and help tests): Update

2007-04-29  Bruno Haible  <bruno@clisp.org>

	* tests/test-fflush.c (main): Use a file of size 17, not 10.
	Print more information in case of failure. Disable a test on BeOS.

2007-04-29  Bruno Haible  <bruno@clisp.org>

	* tests/**/test-*.[hc] (ASSERT): Use fprintf to show the line number.
	This helps debugging on systems on which no gdb is available.

2007-04-29  Bruno Haible  <bruno@clisp.org>

	* lib/freading.h: Improve comments.
	* lib/fwriting.h: Likewise.
	* tests/test-freading.c (main): Don't check freading immediately after
	repositioning. Needed for glibc.

2007-04-29  Bruno Haible  <bruno@clisp.org>

	* lib/freading.c (freading): Trivial simplification.

2007-04-28  Bruno Haible  <bruno@clisp.org>

	* tests/test-fwriting.c (main): Also test the interaction between
	fflush and fwriting.
	* modules/fwriting-tests (Depends-on): Add fflush.

	* tests/test-freading.c (main): Also test the interaction between
	fflush and freading.
	* modules/freading-tests (Depends-on): Add fflush.

2007-04-28  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h (fseek, ftell): Provide link warnings suggesting to use
	fseeko and ftello.
	Suggested by Eric Blake.

2007-04-28  Jim Meyering  <jim@meyering.net>

	Avoid false-negative in gl_STDINT_H's C99 conformance test.
	* m4/stdint.m4 (gl_STDINT_H): When checking whether stdint.h conforms
	to C99, include all of gl_STDINT_INCLUDES, not just <stddef.h>.

2007-04-27  Eric Blake  <ebb9@byu.net>

	* doc/headers/assert.texi (assert.h): Document assert module use.

2007-04-27  Bruno Haible  <bruno@clisp.org>

	* doc/headers/*.texi: New files.
	* doc/gnulib.texi (Header File Substitutes): New chapter.
	* doc/Makefile (gnulib.info, gnulib.html, gnulib.dvi): Specify
	dependencies.
	(standards.info ,standards.html, standards.dvi): Update dependencies.
	(mostlyclean, clean): New targets.

2007-04-27  Bruno Haible  <bruno@clisp.org>

	* lib/sysexits_.h: Renamed from lib/sysexit_.h.
	* modules/sysexits (Files, Makefile.am): Update.

	* lib/sys_socket_.h: Renamed from lib/socket_.h.
	* modules/sys_socket (Files, Makefile.am): Update.

	* lib/sys_stat_.h: Renamed from lib/stat_.h.
	* modules/sys_stat (Files, Makefile.am): Update.

2007-04-27  Eric Blake  <ebb9@byu.net>

	* lib/freading.h: Improve comments.
	* lib/fwriting.h: Likewise.
	* lib/fflush.c: Likewise.

	Fix closein for mingw.
	* modules/closein-tests: Add tests for closein.
	* tests/test-closein.c: New file.
	* tests/test-closein.sh: Likewise.
	* lib/unistd_.h [!SEEK_CUR]: Mingw also needs stdlib.h for _exit.
	* lib/closein.c (close_stdin): Don't fflush non-seekable streams.

2007-04-27  Bruno Haible  <bruno@clisp.org>

	* lib/inttypes_.h [_DECC]: Don't use #include_next if the compiler
	version is < 6.
	* lib/math_.h [__DECC]: Likewise.
	* lib/stdio_.h [__DECC]: Likewise.
	* lib/stdlib_.h [__DECC]: Likewise.
	* lib/string_.h [__DECC]: Likewise.
	* lib/time_.h [__DECC]: Likewise.
	* lib/wchar_.h [__DECC]: Likewise.
	* lib/wctype_.h [__DECC]: Likewise.

2007-04-27  Bruno Haible  <bruno@clisp.org>

	* tests/test-fbufmode.c (main): Relax test, to avoid failure on mingw.

2007-04-27  Bruno Haible  <bruno@clisp.org>

	* lib/fflush.c: Add comments.
	* modules/fpurge-tests (Depends-on): Add fflush.
	* modules/freadable-tests (Depends-on): Likewise.
	* modules/fwritable-tests (Depends-on): Likewise.

2007-04-27  Charles Wilson  <libtool@cwilson.fastmail.fm>

	* m4/argz.m4 (gl_FUNC_ARGZ): Use !HAVE_WORKING_ARGZ instead of
	SYSTEM_ARGZ_IS_BROKEN.  Also, minor stylistic improvements.
	Report by Bruno Haible <bruno@clisp.org>.

2007-04-26  Eric Blake  <ebb9@byu.net>

	Fix fflush on mingw.
	* modules/fflush (Depends-on): Add freading.
	* lib/fflush.c (rpl_fflush): Use freading to avoid losing buffered
	but unread data.

2007-04-26  Eric Blake  <ebb9@byu.net>
	and Bruno Haible  <bruno@clisp.org>

	Implement freading and fwriting.
	* lib/freading.c: New file.
	* lib/freading.h: Likewise.
	* m4/freading.m4: Likewise.
	* modules/freading: Likewise.
	* modules/freading-tests: Likewise.
	* tests/test-freading.c: Likewise.
	* lib/fwriting.c: New file.
	* lib/fwriting.h: Likewise.
	* m4/fwriting.m4: Likewise.
	* modules/fwriting: Likewise.
	* modules/fwriting-tests: Likewise.
	* tests/test-fwriting.c: Likewise.
	* MODULES.html.sh (File stream based Input/Output): Mention them.

2007-04-26  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h (fseeko, ftello): Check that off_t has the same size as
	'long' when we assume it.
	Suggested by Eric Blake.

2007-04-26  Bruno Haible  <bruno@clisp.org>

	Ensure fseeko, ftello are declared on glibc systems.
	* modules/fflush (configure.ac-early): Require AC_FUNC_FSEEKO.
	* modules/fseeko (configure.ac-early): Likewise.
	* modules/ftello (configure.ac-early): Likewise.
	* m4/fflush.m4 (gl_REPLACE_FFLUSH): Don't define HAVE_FSEEKO, rely on
	AC_FUNC_FSEEKO for this.
	* m4/fseeko.m4 (gl_FUNC_FSEEKO): Inline gl_CHECK_FSEEKO.
	(gl_CHECK_FSEEKO): Remove macro.

2007-04-26  Bruno Haible  <bruno@clisp.org>

	* tests/test-fflush.c (main): Also check the ftell result after
	fflush and fseek/fseeko.
	* lib/fflush.c (rpl_fflush): For BSD implementations, update the
	file descriptor position cache in the stream.
	* lib/fseeko.c (rpl_fseeko): Likewise.

2007-04-26  Bruno Haible  <bruno@clisp.org>

	* modules/fflush-tests (Depends-on): Add fseeko.

2007-04-25  Charles Wilson  <libtool@cwilson.fastmail.fm>
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/argz_.h: ensure error_t definition is obtained in same
	mechanism system argz.h would have.
	* m4/argz.m4 (gl_FUNC_ARGZ): add new test to check if $host's
	argz facilities are known bad.  Err on the side of caution if
	cross-compiling.

2007-04-25  Eric Blake  <ebb9@byu.net>

	* lib/fpurge.c (includes): Use stdlib.h for free.
	* tests/test-fflush.c (main): Also test fflush-fseeko.

2007-04-25  Bruno Haible  <bruno@clisp.org>

	Make fflush+fseek POSIX-compliant on FreeBSD and MacOS X.
	* lib/fseeko.c: New file.
	* lib/stdio_.h: Include <sys/types.h> when off_t is needed.
	(fseeko, fseek): Define to replacements if REPLACE_FFLUSH.
	* m4/fseeko.m4 (gl_CHECK_FSEEKO): New macro, extracted from
	gl_FUNC_FSEEKO.
	(gl_FUNC_FSEEKO): Invoke it.
	* m4/fflush.m4 (gl_REPLACE_FFLUSH): Arrange to compile fseeko.c. Invoke
	gl_CHECK_FSEEKO. Define HAVE_FSEEKO.
	* modules/fflush (Files): Add lib/fseeko.c, m4/fseeko.m4.

2007-04-25  Bruno Haible  <bruno@clisp.org>

	* modules/fflush (Depends-on): Add ftello.

2007-04-25  Bruno Haible  <bruno@clisp.org>

	* modules/ftello-tests: New file.
	* tests/test-ftello.c: New file.

	* modules/ftello: New file.
	* m4/ftello.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_FTELLO,
	HAVE_FTELLO.
	* lib/stdio_.h (ftello): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_FTELLO,
	HAVE_FTELLO.

2007-04-25  Bruno Haible  <bruno@clisp.org>

	* modules/fseeko-tests: New file.
	* tests/test-fseeko.c: New file.

	* modules/fseeko: New file.
	* m4/fseeko.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_FSEEKO,
	HAVE_FSEEKO.
	* lib/stdio_.h (fseeko): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_FSEEKO,
	HAVE_FSEEKO.

2007-04-25  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h (fflush): Add support for GNULIB_POSIXCHECK.

2007-04-25  Bruno Haible  <bruno@clisp.org>

	* lib/unistd_.h: Include <stdio.h> if needed to get the SEEK_* macros.
	* tests/test-stdio.c: Check that the various SEEK_* macros are defined.
	* tests/test-unistd.c: Likewise.
	* tests/test-fcntl.c: Likewise.

2007-04-23  Eric Blake  <ebb9@byu.net>

	* lib/fflush.c: Fix missing include.
	Reported by Bruno Haible.

2007-04-23  Bruno Haible  <bruno@clisp.org>

	* lib/fpurge.c (fpurge) [glibc, BSD]: Free a malloc()ed ungetc buffer.
	Reported by Eric Blake.

2007-04-23  Bruno Haible  <bruno@clisp.org>

	* lib/fbufmode.c (fbufmode): Port to Solaris/SPARC64.

2007-04-23  Bruno Haible  <bruno@clisp.org>

	* lib/fseterr.c (fseterr): Don't hardcode the value of _IOERR.

2007-04-23  Bruno Haible  <bruno@clisp.org>

	* tests/test-fbufmode.c (main): Be prepared to a failure of setvbuf.
	Needed on HP-UX 11.

2007-04-16  Eric Blake  <ebb9@byu.net>

	Make fflush rely on fpurge.
	* lib/fflush.c (rpl_fflush): Rely on fpurge module, rather than
	open coding all variants.
	* modules/fflush (Depends-on): Add fpurge and unistd.
	* modules/fflush-tests (Depends-on): Unistd is no longer extra.
	* m4/fflush.m4 (gl_REPLACE_FFLUSH): Simplify.

	Fix --with-tests compilation on cygwin.
	* modules/argmatch-tests (Makefile.am): List gnulib library first
	in LDADD.
	* modules/argp-tests (Makefile.am): Likewise.
	* modules/array-list-tests (Makefile.am): Likewise.
	* modules/array-oset-tests (Makefile.am): Likewise.
	* modules/avltree-list-tests (Makefile.am): Likewise.
	* modules/avltree-oset-tests (Makefile.am): Likewise.
	* modules/avltreehash-list-tests (Makefile.am): Likewise.
	* modules/carray-list-tests (Makefile.am): Likewise.
	* modules/dirname-tests (Makefile.am): Likewise.
	* modules/frexp-tests (Makefile.am): Likewise.
	* modules/isnanl-tests (Makefile.am): Likewise.
	* modules/linked-list-tests (Makefile.am): Likewise.
	* modules/linkedhash-list-tests (Makefile.am): Likewise.
	* modules/lock-tests (Makefile.am): Likewise.
	* modules/rbtree-list-tests (Makefile.am): Likewise.
	* modules/rbtree-oset-tests (Makefile.am): Likewise.
	* modules/rbtreehash-list-tests (Makefile.am): Likewise.
	* modules/tls-tests (Makefile.am): Likewise.
	* modules/tsearch-tests (Makefile.am): Likewise.
	* modules/xvasprintf-tests (Makefile.am): Likewise.

	Fix fpurge for cygwin.
	* lib/fpurge.c (fpurge): Fix order of operation flub, and return a
	value.
	* modules/fpurge-tests (Depends-on): Clean up trash.

2007-04-16  Simon Josefsson  <simon@josefsson.org>

	* lib/gc-libgcrypt.c (gc_hash_open): Shut up compiler warnings.

	* m4/autobuild.m4: Re-indent.

2007-04-13  Bruno Haible  <bruno@clisp.org>

	* modules/fpurge-tests: New file.
	* tests/test-fpurge.c: New file.

	* modules/fpurge: New file.
	* lib/fpurge.h: New file.
	* lib/fpurge.c: New file.
	* m4/fpurge.m4: New file.

2007-04-13  Bruno Haible  <bruno@clisp.org>

	* modules/fbufmode-tests: New file.
	* tests/test-fbufmode.c: New file.

	* modules/fbufmode: New file.
	* lib/fbufmode.h: New file.
	* lib/fbufmode.c: New file.
	* m4/fbufmode.m4: New file.

2007-04-13  Bruno Haible  <bruno@clisp.org>

	* modules/fwritable-tests: New file.
	* tests/test-fwritable.c: New file.

	* modules/fwritable: New file.
	* lib/fwritable.h: New file.
	* lib/fwritable.c: New file.
	* m4/fwritable.m4: New file.

2007-04-13  Bruno Haible  <bruno@clisp.org>

	* modules/freadable-tests: New file.
	* tests/test-freadable.c: New file.

	* modules/freadable: New file.
	* lib/freadable.h: New file.
	* lib/freadable.c: New file.
	* m4/freadable.m4: New file.

2007-04-13  Bruno Haible  <bruno@clisp.org>

	* modules/fflush-tests (Makefile.am): Remove EXTRA_DIST. Augment
	MOSTLYCLEANFILES.

2007-04-13  Paul Eggert  <eggert@cs.ucla.edu>

	* build-aux/bootstrap (gnulib_tool_option_extras): New var, used by
	gzip bootstrap.conf to avoid dragging in i18n machinery.
	(gnulib_tool_option): Use it.

2007-04-13  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (test_function): Add tests for %f and
	%F directives.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-fprintf-posix.h (test_function): Likewise.
	* tests/test-printf-posix.h (test_function): Likewise.
	* tests/test-fprintf-posix.out: Likewise.

2007-04-13  Bruno Haible  <bruno@clisp.org>

	* modules/lock-tests (configure.ac): For LIBSCHED, try also -lposix4.
	* modules/tls-tests (configure.ac): Likewise.
	Reported by Arto C. Nirkko <anirkko@insel.ch>.

2007-04-13  Bruno Haible  <bruno@clisp.org>

	* lib/tls.c (glthread_tls_get): Fix return type.
	Patch by Arto C. Nirkko <anirkko@insel.ch>.

2007-04-12  Eric Blake  <ebb9@byu.net>

	* modules/gettime (Depends-on): Remove gettime.
	Reported by Dmitry V. Levin.

2007-04-12  Bruno Haible  <bruno@clisp.org>

	* modules/fflush (Include): Mention <stdio.h>.
	* modules/strtoimax (Include): Mention <inttypes.h>.
	* modules/strtoumax (Include): Likewise.

2007-04-12  Eric Blake  <ebb9@byu.net>

	* .cvsignore: New file.
	* .gitignore: Likewise.

2007-04-12  Bruno Haible  <bruno@clisp.org>

	* modules/iconv-tests (test_iconv_LDADD): Mention -liconv after LDADD,
	not before, since $(LDADD) often contains libgnu.a.
	* modules/striconv-tests (test_striconv_LDADD): Likewise.
	* modules/striconveh-tests (test_striconveh_LDADD): Likewise.
	* modules/striconveha-tests (test_striconveha_LDADD): Likewise.
	Needed on Cygwin.

2007-04-12  Eric Blake  <ebb9@byu.net>

	Work around glibc's failure to flush stdin on fclose.
	* lib/closein.c (close_stdin): Flush stdin before closing.

	Work around glibc's failure to reset seekable stdin on exit.
	* modules/closein: New module.
	* lib/closein.c: New file.
	* lib/closein.h: Likewise.
	* m4/closein.m4: Likewise.
	* MODULES.html.sh (File stream based Input/Output): Document it.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* gnulib-tool: Rename generated 'autobuild' script to
	'do-autobuild' in --create-megatestdir output.

	* doc/gnulib.texi (Build robot for gnulib): Fix.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* modules/sysexits (Depends-on): Add absolute-header.

2007-04-12  Eric Blake  <ebb9@byu.net>

	No need to preserve errno on success.
	* lib/fflush.c (rpl_fflush): Simplify errno tracking.
	Reported by Bruno Haible.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* MODULES.html.sh (Support for maintaining and releasing
	projects): Add autobuild.  Suggested by Eric Blake <ebb9@byu.net>.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* gnulib-tool (func_modules_add_dummy): Respect --avoid=dummy.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* modules/autobuild: New module.

	* m4/autobuild.m4: New file.

2007-04-11  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Implement the %F directive using the
	%f directive, if NEED_PRINTF_DIRECTIVE_F is defined.
	* m4/printf.m4 (gl_PRINTF_DIRECTIVE_F): New macro.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_DIRECTIVE_F): New macro.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Invoke
	gl_PRINTF_DIRECTIVE_F. Test gl_cv_func_printf_directive_f. Invoke
	gl_PREREQ_VASNPRINTF_DIRECTIVE_F for the replacement.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Invoke
	gl_PRINTF_DIRECTIVE_F. Test gl_cv_func_printf_directive_f. Invoke
	gl_PREREQ_VASNPRINTF_DIRECTIVE_F for the replacement.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Invoke
	gl_PRINTF_DIRECTIVE_F. Test gl_cv_func_printf_directive_f. Invoke
	gl_PREREQ_VASNPRINTF_DIRECTIVE_F for the replacement.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Invoke
	gl_PRINTF_DIRECTIVE_F. Test gl_cv_func_printf_directive_f. Invoke
	gl_PREREQ_VASNPRINTF_DIRECTIVE_F for the replacement.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Invoke
	gl_PRINTF_DIRECTIVE_F. Test gl_cv_func_printf_directive_f. Invoke
	gl_PREREQ_VASNPRINTF_DIRECTIVE_F for the replacement.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Invoke
	gl_PRINTF_DIRECTIVE_F. Test gl_cv_func_printf_directive_f. Invoke
	gl_PREREQ_VASNPRINTF_DIRECTIVE_F for the replacement.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Invoke
	gl_PRINTF_DIRECTIVE_F. Test gl_cv_func_printf_directive_f. Invoke
	gl_PREREQ_VASNPRINTF_DIRECTIVE_F for the replacement.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Invoke
	gl_PRINTF_DIRECTIVE_F. Test gl_cv_func_printf_directive_f. Invoke
	gl_PREREQ_VASNPRINTF_DIRECTIVE_F for the replacement.
	Reported by Eric Blake.

2007-04-11  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_DIRECTIVE_A): Fix test. It always failed.

2007-04-10  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_DIRECTIVE_A): Add a test for correct result
	for NaN and Infinity. Needed on FreeBSD 6.1.
	* tests/test-vasnprintf-posix.c (test_function): Undo last change
	regarding results for "%010a" of Infinity and NaN.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-fprintf-posix.h (test_function): Likewise.
	* tests/test-printf-posix.h (test_function): Likewise.
	* tests/test-fprintf-posix.out: Likewise.

2007-04-10  Bruno Haible  <bruno@clisp.org>

	* modules/locale-tests: New file.
	* tests/test-locale.c: New file.

	* modules/locale: New file.
	* lib/locale_.h: New file.
	* m4/locale_h.m4: New file.

2007-04-10  Paul Eggert  <eggert@cs.ucla.edu>
	    Bruno Haible  <bruno@clisp.org>

	* m4/signbit.m4 (gl_SIGNBIT): When the sign bit position could not
	be determined, test for availability of the copysignf, copysign,
	copysignl functions.
	* lib/signbitf.c (gl_signbitf): Use copysignf if available in libc.
	* lib/signbitd.c (gl_signbitd): Use copysign if available in libc.
	* lib/signbitl.c (gl_signbitl): Use copysignl if available in libc.

2007-04-09  Eric Blake  <ebb9@byu.net>

	* lib/stdio_.h [REPLACE_FFLUSH]: Declare rpl_fflush.
	* modules/stdio (Makefile.am): Support fflush.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Likewise.
	* modules/fflush: New file.
	* lib/fflush.c: Likewise.
	* m4/fflush.m4: Likewise.
	* modules/fflush-tests: New test.
	* tests/test-fflush.c: Likewise.
	* MODULES.html.sh (Input/output <stdio.h>): Document new module.

2007-04-06  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c: Include <math.h>. Don't include float+.h.
	(VASNPRINTF): Use signbit for faster determination whether to print a
	minus sign.
	* modules/vasnprintf (Files): Remove lib/float+.h.
	* modules/fprintf-posix (Depends-on): Add signbit.
	* modules/snprintf-posix (Depends-on): Likewise.
	* modules/sprintf-posix (Depends-on): Likewise.
	* modules/vasnprintf-posix (Depends-on): Likewise.
	* modules/vasprintf-posix (Depends-on): Likewise.
	* modules/vfprintf-posix (Depends-on): Likewise.
	* modules/vsnprintf-posix (Depends-on): Likewise.
	* modules/vsprintf-posix (Depends-on): Likewise.

2007-04-06  Bruno Haible  <bruno@clisp.org>

	* tests/test-frexp.c (main): Test also the sign bit of zero results.
	* tests/test-frexpl.c (main): Likewise.
	* tests/test-ldexpl.c (main): Likewise.
	* modules/frexp-tests (Depends-on): Add signbit.
	* modules/frexpl-tests (Depdends-on): Likewise.
	* modules/ldexpl-tests (Depdends-on): Likewise.

2007-04-06  Bruno Haible  <bruno@clisp.org>

	* modules/signbit-tests: New file.
	* tests/test-signbit.c: New file.

	* modules/signbit: New file.
	* lib/signbitf.c: New file.
	* lib/signbitd.c: New file.
	* lib/signbitl.c: New file.
	* m4/signbit.m4: New file.
	* lib/math_.h (gl_signbitf, gl_signbitd, gl_signbitl): New declarations.
	(signbit): New macro.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_SIGNBIT and
	REPLACE_SIGNBIT.
	* modules/math (Makefile.am) Substibute also GNULIB_SIGNBIT and
	REPLACE_FREXPL into math.h.

2007-04-06  Bruno Haible  <bruno@clisp.org>

	* modules/isnanf-nolibm-tests: New file.
	* tests/test-isnanf.c: New file.

	* modules/isnanf-nolibm: New file.
	* lib/isnanf.h: New file.
	* lib/isnanf.c: New file.
	* lib/isnan.c: Consider the USE_FLOAT macro.
	* m4/isnanf.m4: New file.

2007-04-06  Bruno Haible  <bruno@clisp.org>

	* modules/gettext-h (configure.ac): AC_SUBST LIBINTL and LTLIBINTL.
	(Link): New section.

	* modules/canonicalize-lgpl-tests (Makefile.am): Undo last change.

2007-04-06  Bruno Haible  <bruno@clisp.org>

	Assume the 'long double' type.
	* m4/longdouble.m4: Remove file.
	* config/srclist.txt: Don't mention longdouble.m4.
	* lib/allocsa.h: Assume HAVE_LONG_DOUBLE to be true.
	* lib/float+.h: Likewise.
	* lib/frexp.c: Likewise.
	* lib/printf-args.h: Likewise.
	* lib/printf-args.c: Likewise.
	* lib/printf-frexp.c: Likewise.
	* lib/printf-parse.c: Likewise.
	* lib/vasnprintf.c: Likewise.
	* m4/allocsa.m4: Remove gt_TYPE_LONGDOUBLE invocation.
	* m4/intl.m4: Likewise.
	* m4/isnanl.m4: Likewise.
	* m4/printf.m4: Likewise.
	* m4/printf-frexpl.m4: Likewise.
	* m4/vasnprintf.m4: Likewise.
	* modules/allocsa (Files): Remove m4/longdouble.m4.
	* modules/gettext (Files): Likewise.
	* modules/relocatable-prog-wrapper (Files): Likewise.
	* modules/vasnprintf (Files): Likewise.
	* modules/isnanl (Files): Likewise.
	(Include): Simplify.
	* modules/isnanl-nolibm (Files): Remove m4/longdouble.m4.
	(Include): Simplify.
	* modules/printf-frexpl (Files): Remove m4/longdouble.m4.
	(Include): Simplify.
	* modules/snprintf-posix-tests (Files): Remove m4/longdouble.m4.
	(configure.ac): Remove gt_TYPE_LONGDOUBLE invocation.
	* modules/sprintf-posix-tests (Files): Remove m4/longdouble.m4.
	(configure.ac): Remove gt_TYPE_LONGDOUBLE invocation.
	* modules/vasnprintf-posix-tests (Files): Remove m4/longdouble.m4.
	(configure.ac): Remove gt_TYPE_LONGDOUBLE invocation.
	* modules/vasprintf-posix-tests (Files): Remove m4/longdouble.m4.
	(configure.ac): Remove gt_TYPE_LONGDOUBLE invocation.
	* modules/vsnprintf-posix-tests (Files): Remove m4/longdouble.m4.
	(configure.ac): Remove gt_TYPE_LONGDOUBLE invocation.
	* modules/vsprintf-posix-tests (Files): Remove m4/longdouble.m4.
	(configure.ac): Remove gt_TYPE_LONGDOUBLE invocation.
	* tests/test-isnanl-nolibm.c: Assume HAVE_LONG_DOUBLE to be true.
	* tests/test-isnanl.c: Likewise.
	* tests/test-snprintf-posix.h: Likewise.
	* tests/test-sprintf-posix.h: Likewise.
	* tests/test-vasnprintf-posix.c: Likewise.
	* tests/test-vasnprintf-posix2.c: Likewise.
	* tests/test-vasprintf-posix.c: Likewise.

2007-04-06  Bruno Haible  <bruno@clisp.org>

	Fix problem with Compaq (ex-DEC) Desktop C compiler on Tru64.
	* lib/math_.h [__DECC]: Include the overridden include file through
	#include_next, outside the double-inclusion guard.
	* lib/stdio_.h [__DECC]: Likewise.
	* lib/stdlib_.h [__DECC]: Likewise.
	* lib/string_.h [__DECC]: Likewise.
	* lib/time_.h [__DECC]: Likewise.
	* lib/wchar_.h [__DECC]: Likewise.
	* lib/wctype_.h [__DECC]: Likewise.
	* lib/inttypes_.h [__DECC]: Likewise.
	Reported by Albert Chin <china@thewrittenword.com> in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-04/msg00088.html>.

2007-04-04  Eric Blake  <ebb9@byu.net>

	* m4/stdint.m4 (gl_STDINT_H): Detect WINT_MAX bug in cygwin
	1.5.x.

2007-04-04  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_DIRECTIVE_A): Add a test for correct
	rounding. Don't assume that FreeBSD 6 and NetBSD 4 pass this test.

2007-04-04  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix.c (test_function): Allow two possible
	results for "%010a" of Infinity and NaN.
	* tests/test-vasprintf-posix.c (test_function): Likewise.
	* tests/test-snprintf-posix.h (test_function): Likewise.
	* tests/test-sprintf-posix.h (test_function): Likewise.
	* tests/test-fprintf-posix.h (test_function): Remove these tests.
	* tests/test-printf-posix.h (test_function): Likewise.
	* tests/test-fprintf-posix.out: Update.
	Needed for FreeBSD 6.1.

2007-04-04  Bruno Haible  <bruno@clisp.org>

	* DEPENDENCIES: Remove mentions of tar and gzip, since they are not
	directly used by the gnulib modules nor by gnulib-tool.

2007-04-04  Paul Eggert  <eggert@cs.ucla.edu>

	* DEPENDENCIES: Give overall description of version dependency
	desirability.  Use more-typical names for apps.
	Add shell, coreutils, diffutils, grep, tar, gzip.

2007-04-04  Simon Josefsson  <simon@josefsson.org>

	* MODULES.html.sh: Rename crypto modules.  Remove iconvme.

2007-04-04  Karl Berry  <karl@gnu.org>

	* MODULES.html.sh (func_module): missing '.

2007-04-03  Bruno Haible  <bruno@clisp.org>

	* modules/argmatch-tests (Makefile.am): New variable
	test_argmatch_LDADD.
	* modules/argp-tests (Makefile.am): New variable test_argp_LDADD.
	* modules/array-list-tests (Makefile.am): New variable
	test_array_list_LDADD.
	* modules/array-oset-tests (Makefile.am): New variable
	test_array_oset_LDADD.
	* modules/avltree-list-tests (Makefile.am): New variable
	test_avltree_list_LDADD.
	* modules/avltree-oset-tests (Makefile.am): New variable
	test_avltree_oset_LDADD.
	* modules/avltreehash-list-tests (Makefile.am): New variable
	test_avltreehash_list_LDADD.
	* modules/canonicalize-lgpl-tests (Makefile.am): New variable
	test_canonicalize_lgpl_LDADD.
	* modules/carray-list-tests (Makefile.am): New variable
	test_carray_list_LDADD.
	* modules/dirname-tests (Makefile.am): New variable
	test_dirname_LDADD.
	* modules/linked-list-tests (Makefile.am): New variable
	test_linked_list_LDADD.
	* modules/linkedhash-list-tests (Makefile.am): New variable
	test_linkedhash_list_LDADD.
	* modules/rbtree-list-tests (Makefile.am): New variable
	test_rbtree_list_LDADD.
	* modules/rbtree-oset-tests (Makefile.am): New variable
	test_rbtree_oset_LDADD.
	* modules/rbtreehash-list-tests (Makefile.am): New variable
	test_rbtreehash_list_LDADD.
	* modules/xvasprintf-tests (Makefile.am): New variable
	test_xvasprintf_LDADD.
	Reported by Eric Blake.

2007-04-03  Eric Blake  <ebb9@byu.net>

	* DEPENDENCIES: Weaken m4 requirements.

2007-04-03  Bruno Haible  <bruno@clisp.org>

	* modules/frexp-tests (configure.ac): Remove AC_SUBST.
	* modules/isnanl-tests (configure.ac): Likewise.

2007-04-03  Ben Pfaff  <blp@gnu.org>

	* modules/iconv_open: Add $(srcdir)/ to source directory
	references in Makefile fragments that call gperf, to fix VPATH
	builds.

2007-04-03  Bruno Haible  <bruno@clisp.org>

	* modules/ldexpl (Depends-on): Add isnanl, remove isnanl-nolibm.
	* lib/ldexpl.c: Undo last change.

2007-04-03  Bruno Haible  <bruno@clisp.org>

	* modules/printf-frexpl (Depends-on): Undo last change.
	(Files): Add m4/ldexpl.m4.

2007-04-03  Bruno Haible  <bruno@clisp.org>

	* m4/isnanl.m4 (gl_FUNC_ISNANL): Substitute ISNANL_LIBM.
	* modules/isnanl (Link): New section.

	* m4/frexp.m4 (gl_FUNC_FREXP): Substitute FREXP_LIBM.
	* modules/frexp (Link): New section.

	* m4/frexpl.m4 (gl_FUNC_FREXPL): Substitute FREXPL_LIBM.
	* modules/frexpl (Link): New section.

	* m4/ldexpl.m4 (gl_FUNC_LDEXPL): Substitute LDEXPL_LIBM.
	* modules/ldexpl (Link): New section.

2007-04-03  Bruno Haible  <bruno@clisp.org>

	* modules/TEMPLATE-EXTENDED: New file.
	* gnulib-tool (func_all_modules, func_verify_module): Exclude it.

2007-04-03  Bruno Haible  <bruno@clisp.org>

	* DEPENDENCIES: New file.
	Suggested by Simon Josefsson.

2007-04-03  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib.texi: Escape @.

2007-04-03  James Youngman  <jay@gnu.org>
	and Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stat-time.h (get_stat_birthtime): Check for zero-valued
	birthtime on all systems that have birthtime, not just those which
	use st_birthtimensec rather than st_birthtim.  Putting zero in
	st_birthtim.tv_sec is how (for example) FreeBSD/x86 6.1 indicates
	that the birth time is not available for files on an NFS mount.

2007-04-03  Simon Josefsson  <simon@josefsson.org>

	* modules/memxor: Move back from crypto/, suggested by Bruno.
	* modules/crypto/hmac-sha1: Fix memxor dependency.

	* modules/crypto/gc: Moved from ../.

2007-04-02  Eric Blake  <ebb9@byu.net>

	* lib/ldexpl.c (includes): Avoid libm.

	* modules/printf-frexpl (Depends-on): Depend on ldexpl.

2007-04-02  Bruno Haible  <bruno@clisp.org>

	* lib/sysexit_.h (EX_OK): Disable the EX_OK definition from <unistd.h>
	on IRIX.

2007-04-02  Bruno Haible  <bruno@clisp.org>

	* m4/intdiv0.m4 (gt_INTDIV0): Avoid performing the test for real on
	x86 or x86_64 platforms running MacOS X.
	Reported by Ryan Schmidt <@ryandesign.com>.

2007-04-02  Bruno Haible  <bruno@clisp.org>

	* m4/intdiv0.m4 (gt_INTDIV0): When cross-compiling, treat x86_64 like
	i386.

2007-04-01  Simon Josefsson  <simon@josefsson.org>

	* modules/crypto/arcfour: Moved from ../.
	* modules/crypto/arcfour-tests: Moved from ../.
	* modules/crypto/arctwo: Moved from ../.
	* modules/crypto/arctwo-tests: Moved from ../.
	* modules/crypto/des: Moved from ../.
	* modules/crypto/des-tests: Moved from ../.
	* modules/crypto/gc-arcfour: Moved from ../.
	* modules/crypto/gc-arcfour-tests: Moved from ../.
	* modules/crypto/gc-arctwo: Moved from ../.
	* modules/crypto/gc-arctwo-tests: Moved from ../.
	* modules/crypto/gc-des: Moved from ../.
	* modules/crypto/gc-des-tests: Moved from ../.
	* modules/crypto/gc-hmac-md5: Moved from ../.
	* modules/crypto/gc-hmac-md5-tests: Moved from ../.
	* modules/crypto/gc-hmac-sha1: Moved from ../.
	* modules/crypto/gc-hmac-sha1-tests: Moved from ../.
	* modules/crypto/gc-md2: Moved from ../.
	* modules/crypto/gc-md2-tests: Moved from ../.
	* modules/crypto/gc-md4: Moved from ../.
	* modules/crypto/gc-md4-tests: Moved from ../.
	* modules/crypto/gc-md5: Moved from ../.
	* modules/crypto/gc-md5-tests: Moved from ../.
	* modules/crypto/gc-pbkdf2-sha1: Moved from ../.
	* modules/crypto/gc-pbkdf2-sha1-tests: Moved from ../.
	* modules/crypto/gc-random: Moved from ../.
	* modules/crypto/gc-rijndael: Moved from ../.
	* modules/crypto/gc-rijndael-tests: Moved from ../.
	* modules/crypto/gc-sha1: Moved from ../.
	* modules/crypto/gc-sha1-tests: Moved from ../.
	* modules/crypto/gc-tests: Moved from ../.
	* modules/crypto/hmac-md5: Moved from ../.
	* modules/crypto/hmac-md5-tests: Moved from ../.
	* modules/crypto/hmac-sha1: Moved from ../.
	* modules/crypto/hmac-sha1-tests: Moved from ../.
	* modules/crypto/md2: Moved from ../.
	* modules/crypto/md2-tests: Moved from ../.
	* modules/crypto/md4: Moved from ../.
	* modules/crypto/md4-tests: Moved from ../.
	* modules/crypto/md5: Moved from ../.
	* modules/crypto/md5-tests: Moved from ../.
	* modules/crypto/memxor: Moved from ../.
	* modules/crypto/rijndael: Moved from ../.
	* modules/crypto/rijndael-tests: Moved from ../.
	* modules/crypto/sha1: Moved from ../.

2007-03-30  James Youngman  <jay@gnu.org>

	* tests/test-stat-time.c (prepare_test): use chmod() rather than
	rename() to change the ctime of a file (because ctime is unaffected
	by rename on jfs2 on AIX 5.1).
	(main): Start by doing cleanup, in case a previous run failed leaving
	test files behind.

2007-03-31  Bruno Haible  <bruno@clisp.org>

	Support old proprietary implementations of iconv.
	* modules/iconv_open: New file.
	* lib/iconv_.h: New file.
	* m4/iconv_h.m4: New file.
	* lib/iconv_open.c: New file.
	* lib/iconv_open-aix.gperf: New file.
	* lib/iconv_open-hpux.gperf: New file.
	* lib/iconv_open-irix.gperf: New file.
	* lib/iconv_open-osf.gperf: New file.
	* m4/iconv_open.m4: New file.
	* modules/linebreak (Depends-on): Add iconv_open.
	* modules/striconv (Depends-on): Likewise.
	* modules/striconveh (Depends-on): Likewise.
	* modules/unicodeio (Depends-on): Likewise.
	* lib/striconveh.h (mem_cd_iconveh, str_cd_iconveh): Allow cd to be
	(iconv_t)(-1).
	* lib/striconveh.c (mem_cd_iconveh_internal): Use an indirect
	conversion if cd is (iconv_t)(-1).
	(mem_iconveh, str_iconveh): Don't fail just because a direct conversion
	is not possible.

2007-03-31  Bruno Haible  <bruno@clisp.org>

	* tests/test-striconveha.c (main): Don't expect "autodetect_jp" to
	work on Solaris either. Protect also second use of "autodetect_jp".

2007-03-31  Bruno Haible  <bruno@clisp.org>

	* m4/frexpl.m4 (gl_FUNC_FREXPL): Set HAVE_DECL_FREXPL to 0 when
	the function is not present.

2007-03-31  Bruno Haible  <bruno@clisp.org>

	* m4/ldexpl.m4 (gl_FUNC_LDEXPL): Set HAVE_DECL_LDEXPL to 0 when
	the function is not present.

2007-03-31  Bruno Haible  <bruno@clisp.org>

	* m4/iconv.m4 (AM_ICONV_LINK): Fix 2007-03-29 patch. Test also against
	a bug in HP-UX iconv_open().

2007-03-31  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (func_module): Don't show gnulib-common.m4.
	(Mathematics <math.h>): New section, add fpieee.
	(Input/output <stdio.h>): Add fseterr.
	(Mathematics <math.h>): New section, add printf-frexp.
	(Container data structures): Add sublist.
	(Core language properties): Add fpucw, inline.
	(Functions for greatest-width integer types <inttypes.h>): Add
	imaxabs, imaxdiv, inttypes.
	(Mathematics <math.h>): Add frexp, frexpl, isnan-nolibm, isnanl,
	isnanl-nolibm, ldexp.
	(Mathematics <math.h>): New section, add printf-frexpl.
	(Support for systems lacking POSIX:2001): Add fprintf-posix,
	printf-posix, snprintf-posix, sprintf-posix, string, search, socklen,
	sys_select, sys_socket, vasnprintf-posix, vasprintf-posix,
	vfprintf-posix, vprintf-posix, vsnprintf-posix, vsprintf-posix.
	(Unicode string functions): Add unistr/u*-mbtoucr.
	(Java): Add javacomp-script, javaexec-script.
	(C#): Add csharpcomp-script, csharpexec-script.
	(Support for building libraries and executables): Add havelib,
	relocatable-*.
	(Support for maintaining and releasing projects): Renamed from
	'Support for maintaining and release projects'. Add announce-gen.

2007-03-31  Bruno Haible  <bruno@clisp.org>

	* README: Talk primarily about git.
	(git and CVS): Renamed from CVS.
	* doc/gnulib.texi (Introduction, Build robot for gnulib): Mention that
	gnulib is available through git.
	* doc/gnulib-tool.texi (CVS Issues): Mention git and svn as well.

2007-03-30  Bruno Haible  <bruno@clisp.org>

	* lib/alloca_.h: Change prefix of double-inclusion guard macro to _GL_.
	* lib/poll_.h: Likewise.
	* lib/stat_.h: Likewise.
	* lib/sys_time_.h: Likewise.
	* lib/sysexit_.h: Likewise.
	* lib/glob_.h: Prefix double-inclusion guard macro with _GL_.
	* lib/stdbool_.h: Likewise.
	* lib/byteswap_.h: Add double-inclusion guard.

2007-03-30  Sergey Poznyakoff  <gray@mirddin.farlep.net>

	* lib/sysexit_.h: Prefix double-inclusion guard macro with _GNULIB.

2007-03-30  Karl Berry  <karl@gnu.org>

	* config/srclist-update: double space after USA in the license
	substitution, since that's how it's usually (?) written.

2007-03-30  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/write-any-file.c (can_write_any_file): Fix else-else bug
	reported by Bruno Haible.

2007-03-29  Bruno Haible  <bruno@clisp.org>

	* m4/iconv.m4 (AM_ICONV_LINK): Require AC_CANONICAL_HOST. Test against
	a bug in AIX iconv().

2007-03-29  Bruno Haible  <bruno@clisp.org>

	* modules/ldexpl-tests: New file.
	* tests/test-ldexpl.c: New file.

2007-03-29  Bruno Haible  <bruno@clisp.org>

	* lib/ldexpl.c: Include fpucw.h.
	(ldexpl): Use BEGIN/END_LONG_DOUBLE_ROUNDING. Skip the last unneeded
	multiplication.
	* modules/ldexpl (Depends-on): Add fpucw.

2007-03-29  Bruno Haible  <bruno@clisp.org>

	* modules/ldexpl: New file.
	* m4/ldexpl.m4: New file.
	* lib/math_.h (ldexpl): Define to a replacement if REPLACE_LDEXPL is
	set.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize also GNULIB_LDEXPL,
	REPLACE_LDEXPL.
	* modules/math (Makefile.am): Substitute also GNULIB_LDEXPL,
	REPLACE_LDEXPL.
	* m4/printf-frexpl.m4 (gl_FUNC_PRINTF_FREXPL): Invoke
	gl_FUNC_LDEXPL_WORKS.
	* m4/mathl.m4 (gl_FUNC_LONG_DOUBLE_MATH): Remove test for ldexpl.
	* modules/mathl (Files): Remove lib/ldexpl.c.
	(Depends-on): Add ldexpl.

2007-03-29  Bruno Haible  <bruno@clisp.org>

	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): Declare frexpl.

2007-03-29  Bruno Haible  <bruno@clisp.org>

	* tests/test-striconveh.c (main): Don't assume that a direct conversion
	between ISO-8859-1 and ISO-8859-2 is possible. Needed for OSF/1, IRIX
	and possibly also HP-UX.
	* tests/test-striconveha.c (main): Don't expect "autodetect_jp" to
	work on AIX, IRIX, HP-UX, OSF/1.
	* tests/uniconv/test-u16-conv-from-enc.c (main): Likewise.
	* tests/uniconv/test-u16-strconv-from-enc.c (main): Likewise.
	* tests/uniconv/test-u32-conv-from-enc.c (main): Likewise.
	* tests/uniconv/test-u32-strconv-from-enc.c (main): Likewise.
	* tests/uniconv/test-u8-conv-from-enc.c (main): Likewise.
	* tests/uniconv/test-u8-strconv-from-enc.c (main): Likewise.

2007-03-29  Bruno Haible  <bruno@clisp.org>

	* tests/test-stat-time.c: Include <fcntl.h>, not <sys/fcntl.h>.

2007-03-29  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/acl-internal.h (acl_get_fd, acl_set_fd): undef before defining,
	to work around a problem on OSF/1 5.1 reported by Bruno Haible.

2007-03-29  Eric Blake  <ebb9@byu.net>

	* lib/acl-internal.h: Remove redundant include.
	(ACL_NOT_WELL_SUPPORTED): Also filter on EBUSY, returned by
	Cygwin when a file is locked.

2007-03-29  Bruno Haible  <bruno@clisp.org>

	* lib/vasprintf.c [IN_LIBASPRINTF]: Include different specification
	file.
	* lib/asprintf.c [IN_LIBASPRINTF]: Likewise.

2007-03-29  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/getcwd-path-max.m4 (gl_FUNC_GETCWD_PATH_MAX): Don't bother to
	try to remove a parent directory if the child couldn't be removed
	(except for the first rmdir, which could fail because the child
	doesn't exist).  Problem reported by Jeff Blaine in
	<http://lists.gnu.org/archive/html/bug-tar/2007-03/msg00014.html>.

2007-03-28  Bruno Haible  <bruno@clisp.org>

	* lib/striconveh.c (utf8conv_carefully): New function.
	(mem_cd_iconveh_internal): Invoke it.

2007-03-28  Bruno Haible  <bruno@clisp.org>

	* lib/striconveh.c (mem_cd_iconveh_internal): Use u8_mbtoucr instead
	of u8_mbtouc in order to distinguish invalid and incomplete UTF-8
	input.
	* modules/striconveh (Depends-on): Add unistr/u8-mbtoucr. Replace
	utf8-ucs4 with unistr/u8-mbtouc. Replace ucs4-utf8 with
	unistr/u8-uctomb.

2007-03-28  Bruno Haible  <bruno@clisp.org>

	* modules/unistr/u8-mbtoucr: New file.
	* lib/unistr/u8-mbtoucr.c: New file.
	* modules/unistr/u16-mbtoucr: New file.
	* lib/unistr/u16-mbtoucr.c: New file.
	* modules/unistr/u16-mbtoucr: New file.
	* lib/unistr/u16-mbtoucr.c: New file.
	* lib/unistr.h (u8_mbtoucr, u16_mbtoucr, u32_mbtoucr): New declarations.

2007-03-27  Simon Josefsson  <simon@josefsson.org>
	    Bruno Haible  <bruno@clisp.org>

	* m4/vasprintf.m4: Convert AC_SUBST into shell variable for
	REPLACE_VASPRINTF.  Set HAVE_VASPRINTF.  Add
	AC_REQUIRE([gl_STDIO_H_DEFAULTS]).

	* m4/stdio_h.m4: Add stubs for vasprintf too.

	* modules/stdio: Support vasprintf in sed command.

	* modules/vasprintf: Depend on stdio for prototypes.  Remove
	vasprintf.h.  Add stdio module indicator.

	* lib/stdio_.h: Declare asprintf and vasprintf, based on
	vasprintf.h.

	* lib/vasprintf.h: File removed.

	* lib/asprintf.c: Use stdio.h instead of vasprintf.h.
	* lib/vasprintf.c: Ditto.
	* lib/xvasprintf.c: Ditto.
	* tests/test-vasprintf-posix.c: Ditto.
	* tests/test-vasprintf.c: Ditto.

2007-03-27  Bruno Haible  <bruno@clisp.org>

	Make vasnprintf multithread-safe.
	* lib/vasnprintf.c (decimal_point_char): New function.
	(VASNPRINTF): Use it.
	Suggested by Simon Josefsson.

2007-03-27  Eric Blake  <ebb9@byu.net>

	Support sub-second birthtime on cygwin.
	* m4/stat-time.m4 (gl_STAT_BIRTHTIME): Also check for st_birthtim.
	* lib/stat-time.h (STAT_TIMESPEC): Adjust comments.
	(get_stat_birthtime): Also work with st_birthtim.

2007-03-27  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stat-time.h (USE_BIRTHTIME): Remove.
	(get_stat_atime_ns, get_stat_ctime_ns, get_stat_mtime_ns):
	(get_stat_birthtime_ns): Do not try to use "spare" fields.
	(get_stat_birthtime_ns): Simplify compile-time tests.
	(get_stat_birthtime): Change the API to look like
	get_stat_mtime etc., except return a negative tv_nsec on error.
	* m4/stat-time.m4 (gl_STAT_TIME, gl_STAT_BIRTHTIME):
	Don't check for "spare" fields.
	(gl_STAT_BIRTHTIME): Don't check for struct stat.st_birthtimespec.tv_sec
	or for struct stat.st_birthtime, as these tests aren't used.
	* tests/test-stat-time.c (test_birthtime): Adjust to new API.

2007-03-27  Bruno Haible  <bruno@clisp.org>

	* lib/stat-time.h: Include <sys/stat.h>.

2007-03-27  James Youngman  <jay@gnu.org>

	* lib/stat-time.h (get_stat_birthtime): New function for
	  retrieving st_birthtime as provided by UFS2 (hence *BSD).
	* m4/stat-time.m4 (gl_STAT_BIRTHTIME): Probe for st_birthtime
	  and its variants.
	* modules/stat-time (configure.ac): call gl_STAT_BIRTHTIME.
	* modules/stat-time-test: New file.
	* tests/test-stat-time.c: New test, devised by Bruno Haible.

2007-03-26  Bruno Haible  <bruno@clisp.org>

	Better support of signalling NaNs.
	* lib/atanl.c: Include isnanl.h.
	(atanl): Perform test for NaN at the beginning of the function and
	through a call to isnanl.
	* lib/cosl.c: Include isnanl.h.
	(cosl): Perform test for NaN at the beginning of the function and
	through a call to isnanl.
	* lib/ldexpl.c: Include isnanl.h.
	(ldexpl): Perform test for NaN through a call to isnanl.
	* lib/logl.c: Include isnanl.h.
	(logl): Perform test for NaN at the beginning of the function and
	through a call to isnanl.
	* lib/sinl.c: Include isnanl.h.
	(sinl): Perform test for NaN at the beginning of the function and
	through a call to isnanl.
	* lib/sqrtl.c: Include isnanl.h.
	(sqrtl): Perform test for NaN at the beginning of the function and
	through a call to isnanl.
	* lib/tanl.c: Include isnanl.h.
	(tanl): Perform test for NaN at the beginning of the function and
	through a call to isnanl.
	* lib/trigl.c (ieee754_rem_pio2l): Remove test for NaN.
	* modules/mathl (Depends-on): Add isnanl.

2007-03-26  Eric Blake  <ebb9@byu.net>

	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_DIRECTIVE_A): Fix
	regression in logic sense of previous patch.

2007-03-26  Bruno Haible  <bruno@clisp.org>

	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_DIRECTIVE_A): Don't use
	unportable shell command "if ! ...".
	Reported by Ralf Wildenhues.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/sysexit_,h: If HAVE_SYSEXITS_H is defined, include the original
	<sysexits.h> file, and only add EX_CONFIG.
	* m4/sysexits.m4 (gl_SYSEXITS): If <sysexits.h> exists, check its
	absolute file name and whether it is sufficient. Substitute also
	HAVE_SYSEXITS_H and ABSOLUTE_SYSEXITS_H.
	* modules/sysexits (Makefile.am): Substitute HAVE_SYSEXITS_H and
	ABSOLUTE_SYSEXITS_H into sysexits.h.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/getaddrinfo.c (getaddrinfo): Don't access hints->ai_flags when
	hints is NULL.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/uniconv/u8-conv-from-enc.c (u8_conv_from_encoding): Add a cast.
	* lib/uniconv/u8-strconv-to-enc.c (u8_strconv_to_encoding): Likewise.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c: Include langinfo.h.
	(VASNPRINTF): Prefer nl_langinfo over localeconv, since it's more
	multithread-safe.
	* m4/vasnprintf.m4 (gl_PREREQ_VASNPRINTF_DIRECTIVE_A): New macro.
	* m4/fprintf-posix.m4 (gl_FUNC_FPRINTF_POSIX): Invoke it.
	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Likewise.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vfprintf-posix.m4 (gl_FUNC_VFPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX: Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	Reported by Simon Josefsson.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/printf-parse.c [!IN_LIBINTL]: Include <stdint.h>, for intmax_t.
	(PRINTF_PARSE): Make the support for size specifier 'j' unconditional.
	* modules/vasnprintf (Depends-on): Add stdint.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* modules/fpieee: New file.
	* m4/fpieee.m4: New file.
	* modules/isnan-nolibm (Depends-on): Add fpieee.
	* modules/isnanl-nolibm (Depends-on): Add fpieee.
	* modules/isnanl (Depends-on): Add fpieee.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): Test also finite numbers.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	Avoid test failures on IRIX 6.5.
	* tests/test-frexpl.c (MIN_NORMAL_EXP): New macro.
	(main): Use it.
	* tests/test-printf-frexpl.c (MIN_NORMAL_EXP, MIN_SUBNORMAL_EXP): New
	macros.
	(main): Use them.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* m4/frexpl.m4 (gl_FUNC_FREXPL_WORKS): New macro.
	(gl_FUNC_FREXPL): Invoke it. Set REPLACE_FREXPL to 1 if it frexpl
	exists but doesn't work.
	* lib/math_.h (frexpl): Define as a replacement macro if REPLACE_FREXPL
	is set. Don't provide a prototype if REPLACE_FREXPL is not set.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize REPLACE_FREXPL.
	* modules/math (Makefile.am) Substibute also REPLACE_FREXPL into math.h.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* m4/frexp.m4 (gl_FUNC_FREXP_WORKS): Add check whether frexp(inf)
	returns inf. Needed on IRIX 6.5.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* tests/test-frexpl.c: Include isnanl-nolibm.h.
	(main): Use isnanl instead of x != x idiom.
	* modules/frexpl-tests (Depends-on): Add isnanl-nolibm.

	* tests/test-frexp.c: Include isnan.h.
	(main): Use isnan instead of x != x idiom.
	* modules/frexp-tests (Depends-on): Add isnan-nolibm.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* tests/test-frexp.c (NaN): New function/macro.
	(main): Use it instead of 0.0 / 0.0.
	* tests/test-isnan.c (NaN): New function/macro.
	(main): Use it instead of 0.0 / 0.0.
	* tests/test-vasnprintf-posix.c (NaN): New function/macro.
	(test_function): Use it instead of 0.0 / 0.0.
	* tests/test-vasprintf-posix.c (NaN): New function/macro.
	(test_function): Use it instead of 0.0 / 0.0.
	* tests/test-snprintf-posix.h (NaN): New function/macro.
	(test_function): Use it instead of 0.0 / 0.0.
	* tests/test-sprintf-posix.h (NaN): New function/macro.
	(test_function): Use it instead of 0.0 / 0.0.
	* tests/test-fprintf-posix.h (NaN): New function/macro.
	(test_function): Use it instead of 0.0 / 0.0.
	* tests/test-printf-posix.h (NaN): New function/macro.
	(test_function): Use it instead of 0.0 / 0.0.

	* lib/isnan.c (FUNC): Work around a DEC C compiler bug.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/glob_.h: Include <sys/stat.h>. Avoids warnings on AIX 5.1.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/regexec.c (merge_state_with_log): Make static.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/trigl.c (kernel_rem_pio2): Make static.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/sincosl.c (sincosl_table): Make static.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* lib/argp.h (__restrict): Define to empty, rather than to 'restrict',
	if the compiler does not support C99.

2007-03-25  Bruno Haible  <bruno@clisp.org>

	* modules/time (Makefile.am): Ensure all rule action lines start with a
	tab.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* modules/tsearch-tests: New file.
	* tests/test-tsearch.sh: New file.
	* tests/test-tsearch.c: New file, mostly copied from glibc.

	* modules/search-tests: New file.
	* tests/test-search.c: New file.

	* modules/search: New file.
	* lib/search_.h: New file, incorporating lib/tsearch.h.
	* m4/search_h.m4: New file.
	* lib/tsearch.h: Remove file.
	* lib/tsearch.c: Include search.h instead of tsearch.h.
	* m4/tsearch.m4 (gl_FUNC_TSEARCH): Require gl_SEARCH_H_DEFAULTS. Set
	HAVE_TSEARCH.
	* modules/tsearch (Files): Remove lib/tsearch.h.
	(Depends-on): Add search.
	(configure.ac): Invoke gl_SEARCH_MODULE_INDICATOR.
	(Include): Change tsearch.h into search.h.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* modules/fpucw: New file.
	* lib/fpucw.h: New file.
	* lib/frexp.c: Include fpucw.h.
	(DECL_ROUNDING, BEGIN_ROUNDING, END_ROUNDING): New macros.
	(FUNC): Use them.
	* lib/printf-frexp.c: Include fpucw.h.
	(DECL_ROUNDING, BEGIN_ROUNDING, END_ROUNDING): New macros.
	(FUNC): Use them.
	* lib/vasnprintf.c: Include fpucw.h.
	(VASNPRINTF): Invoke BEGIN/END_LONG_DOUBLE_ROUNDING around the
	'long double' calculations.
	* tests/test-frexpl.c: Include fpucw.h.
	(main): Invoke BEGIN_LONG_DOUBLE_ROUNDING.
	* tests/test-printf-frexpl.c: Include fpucw.h.
	(main): Invoke BEGIN_LONG_DOUBLE_ROUNDING.
	* modules/frexpl (Depends-on): Add fpucw.
	* modules/printf-frexpl (Depends-on): Likewise.
	* modules/fprintf-posix (Depends-on): Likewise.
	* modules/snprintf-posix (Depends-on): Likewise.
	* modules/sprintf-posix (Depends-on): Likewise.
	* modules/vasnprintf-posix (Depends-on): Likewise.
	* modules/vasprintf-posix (Depends-on): Likewise.
	* modules/vfprintf-posix (Depends-on): Likewise.
	* modules/vsnprintf-posix (Depends-on): Likewise.
	* modules/vsprintf-posix (Depends-on): Likewise.
	* modules/frexpl-tests (Depends-on): Likewise.
	* modules/printf-frexpl-tests (Depends-on): Likewise.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* lib/float+.h: New file.
	* lib/isnan.c: Include float+.h.
	(SIZE): New macro.
	(FUNC): Compare only SIZE bytes of the value.
	* lib/vasnprintf.c: Include float+.h.
	(VASNPRINTF): When comparing agains +0.0L or +0.0, compare only
	SIZEOF_LDBL or SIZEOF_DBL bytes.
	* modules/isnan-nolibm (Files): Add lib/float+.h.
	* modules/isnanl-nolibm (Files): Add lib/float+.h.
	* modules/isnanl (Files): Add lib/float+.h.
	* modules/vasnprintf (Files): Add lib/float+.h.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c [!HAVE_LONG_DOUBLE]: Include printf-frexp.h. Don't
	include isnanl-nolibm.h.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* tests/test-read-file.c (main): Don't produce spurious output for
	expected situations. Make the test fail if it encountered unexpected
	results.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* m4/locale-fr.m4 (gt_LOCALE_FR): Remove the special-casing of NetBSD,
	since its fr_FR.ISO8859-1 locale wouldn't pass the tests.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* m4/locale-fr.m4 (gt_LOCALE_FR, gt_LOCALE_FR_UTF8): Fix last change.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* modules/unistr/base (Depends-on): Remove utf8-ucs4-unsafe,
	utf16-ucs4-unsafe, utf8-ucs4, utf16-ucs4, ucs4-utf8, ucs4-utf16.

	* modules/unistr/u8-mbtouc: Add source files from module utf8-ucs4.
	* modules/utf8-ucs4: Turn into a symbolic link to module
	unistr/u8-mbtouc.

	* modules/unistr/u8-mbtouc-unsafe: Add source files from module
	utf8-ucs4-unsafe.
	* modules/utf8-ucs4-unsafe: Turn into a symbolic link to module
	unistr/u8-mbtouc-unsafe.

	* modules/unistr/u16-mbtouc: Add source files from module utf16-ucs4.
	* modules/utf16-ucs4: Turn into a symbolic link to module
	unistr/u16-mbtouc.

	* modules/unistr/u16-mbtouc-unsafe: Add source files from module
	utf16-ucs4-unsafe.
	* modules/utf16-ucs4-unsafe: Turn into a symbolic link to module
	unistr/u16-mbtouc-unsafe.

	* modules/unistr/u8-uctomb: Add source files from module utf4-utf8.
	* modules/ucs4-utf8: Turn into a symbolic link to module
	unistr/u8-ubtomb.

	* modules/unistr/u16-uctomb: Add source files from module utf4-utf16.
	* modules/ucs4-utf16: Turn into a symbolic link to module
	unistr/u16-ubtomb.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* lib/unistr/u8-mbtouc-aux.c: Renamed from lib/unistr/utf8-ucs4.c.
	Enable the function only if HAVE_INLINE.
	* lib/unistr/u8-mbtouc-unsafe-aux.c: Renamed from
	lib/unistr/utf8-ucs4-unsafe.c. Enable the function only if HAVE_INLINE.
	* lib/unistr/u16-mbtouc-aux.c: Renamed from lib/unistr/utf16-ucs4.c.
	Enable the function only if HAVE_INLINE.
	* lib/unistr/u16-mbtouc-unsafe-aux.c: Renamed from
	lib/unistr/utf16-ucs4-unsafe.c. Enable the function only if HAVE_INLINE.
	* lib/unistr/u8-uctomb-aux.c: Renamed from lib/unistr/ucs4-utf8.c.
	Enable the function only if HAVE_INLINE.
	* lib/unistr/u16-uctomb-aux.c: Renamed from lib/unistr/ucs4-utf16.c.
	Enable the function only if HAVE_INLINE.
	* modules/utf8-ucs4: Update.
	* modules/utf8-ucs4-unsafe: Update.
	* modules/utf16-ucs4: Update.
	* modules/utf16-ucs4-unsafe: Update.
	* modules/ucs4-utf8: Update.
	* modules/ucs4-utf16: Update.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* lib/utf8-ucs4.h: Remove file.
	* lib/utf8-ucs4-unsafe.h: Remove file.
	* lib/utf16-ucs4.h: Remove file.
	* lib/utf16-ucs4-unsafe.h: Remove file.
	* lib/ucs4-utf8.h: Remove file.
	* lib/ucs4-utf16.h: Remove file.
	* lib/unistr.h: Include their previous contents.
	* m4/utf-ucs4.m4: Remove file.
	* m4/ucs4-utf.m4: Remove file.
	* modules/utf8-ucs4 (Files): Remove lib/utf8-ucs4.h.
	(Depends-on): Add unistr/base.
	(configure.ac): Remove gl_UTF_UCS4.
	(Makefile.am): Update.
	(Include): Change to unistr.h.
	* modules/utf8-ucs4-unsafe (Files): Remove lib/utf8-ucs4-unsafe.h.
	(Depends-on): Add unistr/base.
	(configure.ac): Remove gl_UTF_UCS4.
	(Makefile.am): Update.
	(Include): Change to unistr.h.
	* modules/utf16-ucs4 (Files): Remove lib/utf16-ucs4.h.
	(Depends-on): Add unistr/base.
	(configure.ac): Remove gl_UTF_UCS4.
	(Makefile.am): Update.
	(Include): Change to unistr.h.
	* modules/utf16-ucs4-unsafe (Files): Remove lib/utf16-ucs4-unsafe.h.
	(Depends-on): Add unistr/base.
	(configure.ac): Remove gl_UTF_UCS4.
	(Makefile.am): Update.
	(Include): Change to unistr.h.
	* modules/ucs4-utf8 (Files): Remove lib/ucs4-utf8.h.
	(Depends-on): Add unistr/base.
	(configure.ac): Remove gl_UCS4_UTF.
	(Makefile.am): Update.
	(Include): Change to unistr.h.
	* modules/ucs4-utf16 (Files): Remove lib/ucs4-utf16.h.
	(Depends-on): Add unistr/base.
	(configure.ac): Remove gl_UCS4_UTF.
	(Makefile.am): Update.
	(Include): Change to unistr.h.
	* lib/unistr/utf8-ucs4.c: Include unistr.h instead of utf8-ucs4.h.
	* lib/unistr/utf8-ucs4-unsafe.c: Include unistr.h instead of
	utf8-ucs4-unsafe.h.
	* lib/unistr/utf16-ucs4.c: Include unistr.h instead of utf16-ucs4.h.
	* lib/unistr/utf16-ucs4-unsafe.c: Include unistr.h instead of
	utf16-ucs4-unsafe.h.
	* lib/unistr/ucs4-utf8.c: Include unistr.h instead of ucs4-utf8.h.
	* lib/unistr/ucs4-utf16.c: Include unistr.h instead of ucs4-utf16.h.
	* lib/unistr/u8-chr.c: Don't include ucs4-utf8.h.
	* lib/unistr/u8-strchr.c: Likewise.
	* lib/unistr/u8-strrchr.c: Likewise.
	* lib/unistr/u16-chr.c: Don't include ucs4-utf16.h.
	* lib/unistr/u16-strchr.c: Likewise.
	* lib/unistr/u16-strrchr.c: Likewise.
	* lib/striconveh.c: Update.
	* lib/linebreak.c: Update.

2007-03-24  Bruno Haible  <bruno@clisp.org>

	* lib/argp-help.c (fill_in_uparams, canon_doc_option): Cast the
	arguments of isspace, isalpha, isalnum, isdigit to 'unsigned char'.

2007-03-22  Bruno Haible  <bruno@clisp.org>

	* lib/strptime.c (__strptime_internal): Use ANSI C syntax.

2007-03-23  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh (File system functions): New module write-any-file.
	* modules/write-any-file, lib/write-any-file.c, lib/write-any-file.h:
	* m4/write-any-file.m4: New files.

2007-03-23  Eric Blake  <ebb9@byu.net>

	* gnulib-tool: Rearrange space-tab sequences, since some editors
	like to eat them.

2007-03-23  Eric Blake  <ebb9@byu.net>

	* lib/version-etc.c (version_etc_va): Update license wording to
	be more concise.  Recommended by Richard Stallman.

2007-03-22  Bruno Haible  <bruno@clisp.org>

	* lib/poll.c (MSG_PEEK): New fallback definition.

2007-03-22  Bruno Haible  <bruno@clisp.org>

	* modules/sys_socket-tests (configure.ac): Check for shutdown function.
	* tests/test-sys_socket.c (a): Test only if shutdown() exists.
	(main): Update.
	Fixes a compilation error on BeOS.

2007-03-22  Bruno Haible  <bruno@clisp.org>

	* modules/frexpl-tests: New file.
	* tests/test-frexpl.c: New file.

	* modules/frexpl: New file.
	* m4/frexpl.m4: New file.
	* modules/math (Makefile.am): Also substitute GNULIB_FREXPL into math.h.
	* lib/math_.h (frexpl): Test GNULIB_FREXPL instead of GNULIB_MATHL.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Initialize GNULIB_FREXPL.
	* modules/mathl (Files): Remove lib/frexpl.c, lib/frexp.c.
	(Depends-on): Add frexpl. Remove isnanl-nolibm.
	* m4/mathl.m4 (gl_FUNC_LONG_DOUBLE_MATH): Don't test for frexpl.

2007-03-22  Bruno Haible  <bruno@clisp.org>

	* lib/frexpl.c: Share code with lib/frexp.c.
	* modules/mathl (Files): Add lib/frexp.c.
	(Depends-on): Add isnanl-nolibm.

2007-03-22  Bruno Haible  <bruno@clisp.org>

	* modules/printf-frexp (Files): Add m4/frexp.m4.
	* m4/printf-frexp.m4 (gl_FUNC_PRINTF_FREXP): Define HAVE_FREXP_IN_LIBC
	only if the found frexp function actually works.

2007-03-22  Bruno Haible  <bruno@clisp.org>

	* lib/frexp.c: Remove older implementation that uses divisions.

2007-03-21  Bruno Haible  <bruno@clisp.org>

	* modules/frexp-tests: New file.
	* tests/test-frexp.c: New file.

	* modules/frexp: New file.
	* lib/frexp.c: New file.
	* m4/frexp.m4: New file.
	* lib/math_.h (frexp): New declaration.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Also initialize GNULIB_FREXP and
	REPLACE_FREXP.
	* modules/math (math.h): Also substitute GNULIB_FREXP, REPLACE_FREXP.

2007-03-21  Bruno Haible  <bruno@clisp.org>

	* modules/isnanl-tests: New file.
	* tests/test-isnanl.c: New file.

	* modules/isnanl: New file.
	* lib/isnanl.h: New file.
	* m4/isnanl.m4 (gl_FUNC_ISNANL): New macro.
	(gl_FUNC_ISNANL_NO_LIBM): Invoke gl_HAVE_ISNANL_NO_LIBM,
	gl_FUNC_ISNANL_WORKS.
	(gl_HAVE_ISNANL_NO_LIBM, gl_HAVE_ISNANL_IN_LIBM, gl_FUNC_ISNANL_WORKS):
	New macros.

2007-03-21  Bruno Haible  <bruno@clisp.org>

	* modules/isnanl-nolibm (Files): Add lib/isnanl-nolibm.h, remove
	lib/isnanl.h.
	(Include): Update.
	* lib/isnanl-nolibm.h: Renamed from lib/isnanl.h.
	* lib/vasnprintf.c: Update.
	* modules/isnanl-nolibm-tests (Files): Add tests/test-isnanl-nolibm.c,
	tests/test-isnanl.h, remove tests/test-isnanl.c.
	(Makefile.am): Update.
	* tests/test-isnanl-nolibm.c: New file.
	* tests/test-isnanl.h: New file.
	* tests/test-isnanl.c: Remove file.

2007-03-21  Jim Meyering  <jim@meyering.net>

	When trying to open ".", treat ESTALE like EACCES.
	* lib/savewd.c (savewd_save): Resort to forking not just upon
	failure with EACCES, but also when errno is ESTALE.

2007-03-20  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h (strndup): Enable declaration also if HAVE_STRNDUP.
	Needed on AIX 5.1. Reported by Matthew Woehlke.

2007-03-19  Paul Eggert  <eggert@cs.ucla.edu>

	Suggestions by Bruno Haible:
	* lib/acl-internal.h: Include "gettext.h" rather than rolling
	our own.
	(ACL_NOT_WELL_SUPPORTED): Parenthesize arg when used.
	* modules/acl (Depends-on): Add gettext.

2007-03-19  Bruno Haible  <bruno@clisp.org>

	* modules/iconvme: Remove file.
	* lib/iconvme.h: Remove file.
	* lib/iconvme.c: Remove file.
	* m4/iconvme.m4: Remove file.

2007-03-19  Bruno Haible  <bruno@clisp.org>

	* doc/relocatable-maint.texi: Break long shell script line.
	Suggested by Thien-Thi Nguyen <ttn@gnuvola.org>.

2007-03-19  Paul Eggert  <eggert@cs.ucla.edu>

	Add limited support for Solaris 10 ZFS-style ACLs: just enough to
	handle file_has_acl.
	* lib/acl-internal.h, lib/acl_entries.c, lib/file-has-acl.c: New files.
	* lib/acl.c: Move header inclusions and related macro defns into
	lib/acl-internal.h.
	(S_ISLNK): Remove defn, since that's now done for us.
	(file_has_acl): Move to lib/file-has-acl.c.
	Call acl_trivial if available.  This is the crucial part of the fix.
	(acl_entries): Move to lib/acl_entries.c.  Now extern, since it's
	shared within the library.  Rewrite a bit, partly to make it compatible
	with the GNU coding style.
	* m4/acl.m4 (AC_FUNC_ACL): Add AC_LIBOBJ([file-has-acl]).
	Remove unnecessary double-quotes.
	Don't test for acl_to_text; the build will catch that.
	Replace acl_entries if it doesn't exist and it is needed.
	Check for -lsec and acl_trivial (as used on Solaris 10).
	* modules/acl (Files): Add lib/acl-internal.h, lib/acl_entries.c,
	lib/file-has-acl.c.
	(Depends-on): Add sys_stat, for S_ISLNK.

2007-03-19  Ben Pfaff  <blp@gnu.org>

	* doc/gnulib.texi: Fix typos.
	Suggested by Thien-Thi Nguyen <ttn@gnuvola.org>.

2007-03-19  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getcwd.c (__getcwd): Remove redundant comparison of buf to NULL.
	If size is zero here, buf must be zero.

2007-03-19  Simon Josefsson  <simon@josefsson.org>

	* des.c: Remove weak_keys_chksum.  Reported by Bruno Haible
	<bruno@clisp.org>.

2007-03-18  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Undo first part of last patch.
	Suggested by Eric Blake.

2007-03-18  Ben Pfaff  <blp@gnu.org>

	* doc/relocatable.texi: Recommend using as prefix a directory
	that does not exist and will never be created.  Based on
	discussion with Bruno Haible, Ralf Wildenhues, Matthew Woehlke,
	and others.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* lib/fchownat.c: Include lchown.h.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	Fix endless loop when the given allocated size was > INT_MAX.
	* lib/vasnprintf.c (EOVERFLOW): New fallback definition.
	(VASNPRINTF): Fail with EOVERFLOW when the given allocated size is
	larger than INT_MAX, or when it grow to a value larger than INT_MAX.
	* lib/vsprintf.c (vsprintf): Don't pass a size > INT_MAX to vasnprintf.
	* lib/sprintf.c (sprintf): Likewise.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* tests/test-argp-2.sh (func_compare): Output a context diff.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* m4/locale-fr.m4 (gt_LOCALE_FR, gt_LOCALE_FR_UTF8): Check also the
	locale's decimal-point character.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Clear out the memory used for arg_mem
	before comparing it. Needed because on some platforms (e.g. x86) a
	'long double' occupies less bytes than sizeof (long double).

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* tests/test-crc.c (main): Make printf statements 64-bit clean.
	* tests/test-gc-pbkdf2-sha1.c (main): Likewise.
	* tests/test-getaddrinfo.c (simple): Likewise.
	* tests/test-read-file.c (main): Likewise.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* tests/test-dirname.c (main): Make printf statements 64-bit clean.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* tests/test-xvasprintf.c (test_xvasprintf, test_xasprintf): Remove
	unused variable.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* tests/test-c-strcasecmp.c: Include c-strcase.h.
	* tests/test-c-strncasecmp.c: Likewise.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* modules/stdlib (Depends-on): Add unistd.
	* lib/stdlib_.h: Include <unistd.h> if mkstemp is desired.
	Needed for MacOS X 10.3.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* lib/unistr/u-strdup.h: Include <stdlib.h>.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* lib/unistr/u-cpy-alloc.h: Include <stdlib.h>.

2007-03-17  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Update .cvsignore and .gitignore files
	to reflect files copied from gnulib (with or without modifications).
	Suggested by Jim Meyering.

2007-03-17  Eric Blake  <ebb9@byu.net>

	* NEWS: Document stdlib change from 2007-02-18.

2007-03-17  Jim Meyering  <jim@meyering.net>

	Detect use of AC_CONFIG_AUX_DIR also when its argument is quoted.
	* build-aux/bootstrap: Put ""s around use of $build_aux, in case
	someone uses a name containing shell meta-characters.
	Reported by Alfred M. Szmidt.

	* build-aux/bootstrap: Don't use \> in grep regexp.  For HP-UX.

2007-03-16  Alfred M. Szmidt  <ams@gnu.org>

	* build-aux/bootstrap (with_gettext): New variable.  Run autopoint
	and copy gettext configuration files only if configure.ac contains
	a use of AM_GNU_GETTEXT_VERSION.

2007-03-16  Alfred M. Szmidt  <ams@gnu.org>

	* build-aux/bootstrap (gnulib_name): New variable.
	(gnulib_tool_options): Use it.

2007-03-13  Simon Josefsson  <simon@josefsson.org>

	* tests/test-des.c: Use new namespace.

2007-03-15  Bruno Haible  <bruno@clisp.org>

	* lib/dummy.c (gl_dummy_symbol): Renamed from 'dummy'.
	Reported by James Youngman <jay@gnu.org>.

2007-03-15  Bruno Haible  <bruno@clisp.org>

	* lib/glob.c (glob): Add 'restrict' so that prototype matches the
	declared prototype. Needed with cc on OSF/1 5.1.

2007-03-15  Bruno Haible  <bruno@clisp.org>

	* lib/gl_list.h (gl_listelement_dispose_fn): New type.
	(gl_list_create_empty, gl_list_create): Add dispose_fn argument.
	(struct gl_list_implementation): Add dispose_fn argument to the
	'create_empty', 'create' methods.
	(struct gl_list_impl_base): Add field 'dispose_fn'.
	* lib/gl_list.c (gl_list_create_empty, gl_list_create): Add dispose_fn
	argument.
	* lib/gl_array_list.c (gl_array_create_empty, gl_array_create): Add
	dispose_fn argument.
	(gl_array_remove_node, gl_array_remove_at, gl_array_list_free): Call
	dispose_fn on the dropped values.
	* lib/gl_carray_list.c (gl_carray_create_empty, gl_carray_create): Add
	dispose_fn argument.
	(gl_carray_remove_at, gl_carray_list_free): Call dispose_fn on the
	dropped values.
	* lib/gl_anyavltree_list2.h (gl_tree_create): Add dispose_fn argument.
	(gl_tree_remove_node): Call dispose_fn on the dropped value.
	* lib/gl_anyrbtree_list2.h (gl_tree_create): Add dispose_fn argument.
	(gl_tree_remove_node): Call dispose_fn on the dropped value.
	* lib/gl_anytree_list2.h (gl_tree_create_empty): Add dispose_fn
	argument.
	(gl_tree_list_free): Call dispose_fn on the dropped values.
	* lib/gl_anytreehash_list2.h (gl_tree_list_free): Call dispose_fn on
	the dropped values.
	* lib/gl_anylinked_list2.h (gl_linked_create_empty, gl_linked_create):
	Add dispose_fn argument.
	(gl_linked_remove_node, gl_linked_remove_at, gl_linked_list_free):
	Call dispose_fn on the dropped values.
	* lib/gl_sublist.c (gl_sublist_create_empty, gl_sublist_create_fill):
	Add dispose_fn argument.
	(gl_sublist_create): Initialize the 'dispose_fn' field.
	* lib/clean-temp.c (create_temp_dir, register_fd): Update.
	* tests/test-array_list.c (main): Update.
	* tests/test-carray_list.c (main): Update.
	* tests/test-avltree_list.c (main): Update.
	* tests/test-rbtree_list.c (main): Update.
	* tests/test-avltreehash_list.c (main): Update.
	* tests/test-rbtreehash_list.c (main): Update.
	* tests/test-linked_list.c (main): Update.
	* tests/test-linkedhash_list.c (main): Update.
	* tests/test-array_oset.c (main): Update.

2007-03-15  Bruno Haible  <bruno@clisp.org>

	* lib/gl_oset.h (gl_setelement_dispose_fn): New type.
	(gl_oset_create_empty): Add dispose_fn argument.
	(struct gl_oset_implementation): Add dispose_fn argument to
	'create_empty' method.
	(struct gl_oset_impl_base): Add dispose_fn field.
	* lib/gl_oset.c (gl_oset_create_empty): Add dispose_fn argument.
	* lib/gl_array_oset.c (gl_array_create_empty): Add dispose_fn argument.
	(gl_array_remove_at, gl_array_free): Call dispose_fn on the dropped
	values.
	* lib/gl_anytree_oset.h (gl_tree_create_empty): Add dispose_fn argument.
	(gl_tree_oset_free): Call dispose_fn on the dropped values.
	* lib/gl_avltree_oset.c (gl_tree_remove_node): Call dispose_fn on the
	dropped value.
	* lib/gl_rbtree_oset.c (gl_tree_remove_node): Call dispose_fn on the
	dropped value.
	* tests/test-array_oset.c (main): Update.
	* tests/test-avltree_oset.c (main): Update.
	* tests/test-rbtree_oset.c (main): Update.
	* lib/gl_anytreehash_list1.h (add_to_bucket): Update.

2007-03-13  Bruno Haible  <bruno@clisp.org>

	* tests/test-stdbool.c (i): Update after last patch.

2007-03-12  Bruno Haible  <bruno@clisp.org>

	* lib/quotearg.c: Include <wctype.h> early, before the definition of
	the iswprint macro. Needed on Solaris 2.5.1.

2007-03-12  Bruno Haible  <bruno@clisp.org>

	* tests/test-printf-frexp.c (main): Declare x as volatile.

2007-03-12  Simon Josefsson  <simon@josefsson.org>

	* doc/gnulib.texi (Build robot for gnulib): New section.

2007-03-12  Jim Meyering  <jim@meyering.net>

	* build-aux/bootstrap: New file.
	* build-aux/bootstrap.conf: New file, from coreutils.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* m4/cycle-check.m4 (gl_CYCLE_CHECK): Require AC_C_INLINE.

2007-03-12  Simon Josefsson  <simon@josefsson.org>

	* lib/des.h, lib/des.c, lib/gc-gnulib.c: Use gl_ namespace, to
	avoid collisions with 'des_setkey'.  Reported by Bruno Haible
	<bruno@clisp.org>.  Also change 'tripledes_' to '3des_'.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* m4/locale-tr.m4 (gt_LOCALE_TR_UTF8): If the test program fails to
	compile, set LOCALE_TR_UTF8 to 'none' instead of empty.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h (INT64_MIN, INTMAX_MIN): Avoid using the ~INT..._MAX
	formula. Needed for SunPRO C 5.0.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* modules/long-options (Depends-on): Add getopt.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* modules/modechange (Depends-on): Add stdbool.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* modules/i-ring (Depends-on): Add stdbool.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* modules/gc-des (Depends-on): Add stdbool.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* m4/mktime.m4 (gl_PREREQ_MKTIME): Require AC_C_INLINE.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* m4/mempcpy.m4 (gl_FUNC_MEMPCPY): Require AC_C_RESTRICT.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* lib/unistr/u32-mbtouc-unsafe.c (u32_mbtouc_unsafe): Fix syntax error.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (sprintf): Undefine.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* lib/isnan.c (rpl_isnan, rpl_isnanl): Work around bug regarding
	initializers in SunPRO C and Compaq C compilers.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* lib/gl_array_oset.c (gl_array_iterator_next): Make pointer
	decrementing code ANSI C compliant.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* lib/dummy.c [__sun]: Define a dummy variable, not just a typedef.
	Needed for Solaris 2.5.1 ranlib and SunPRO C 5.0.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* tests/test-stdbool.c (s, d, e, xlcbug): Disable checks that gnulib's
	<stdbool.h> substitute doesn't pass.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (snprintf): Undefine. Avoids an endless recursion.

2007-03-11  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_megatestdir): Create also an autobuild
	script, for submission to autobuild.josefsson.org.

2007-03-10  Bruno Haible  <bruno@clisp.org>

	* modules/canonicalize-lgpl-tests: New file.
	* tests/test-canonicalize-lgpl.sh: New file.
	* tests/test-canonicalize-lgpl.c: New file.

	* modules/c-strcase-tests: New file.
	* tests/test-c-strcase.sh: New file.
	* tests/test-c-strcasecmp.c: New file.
	* tests/test-c-strncasecmp.c: New file.

	* modules/atexit-tests: New file.
	* tests/test-atexit.sh: New file.
	* tests/test-atexit.c: New file.

2007-03-10  Bruno Haible  <bruno@clisp.org>

	* tests/test-binary-io.sh: Use temporary filenames that are not so
	likely to clash with those of other tests (in a parallel make).
	* tests/test-binary-io.c: Likewise.

2007-03-10  Bruno Haible  <bruno@clisp.org>

	* lib/fseterr.c (fseterr): Port to Solaris/SPARC64. Deactivate the
	fallback; use #error instead.
	Suggested by Simon Josefsson.

2007-03-10  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Treat MOSTLYCLEANFILES like
	CLEANFILES. Put spaces in each line of $cleaned_files, not only the
	first and the last.

2007-03-10  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h (uint_least64_t): Fix typo in last patch.

2007-03-10  Bruno Haible  <bruno@clisp.org>

	* modules/snprintf-posix-tests (EXTRA_DIST): New variable. Needed for
	"make distcheck".
	* modules/sprintf-posix-tests (EXTRA_DIST): Likewise.
	* modules/vsnprintf-posix-tests (EXTRA_DIST): Likewise.
	* modules/vsprintf-posix-tests (EXTRA_DIST): Likewise.

2007-03-10  Bruno Haible  <bruno@clisp.org>

	* modules/allocsa-tests (test_allocsa_SOURCES): Remove redundant
	variable.
	* modules/dirname-tests (test_dirname_SOURCES): Remove redundant
	variable.

2007-03-09  Eric Blake  <ebb9@byu.net>
	and Matthew Woehlke  <mw_triad@users.sourceforge.net>  (tiny change)

	* lib/stdint_.h (int64_t, uint64_t): Don't undefine if 64-bit
	types are not being provided by gnulib.
	(GL_INT64_T, GL_UINT64_T): New witnesses of whether gnulib 64-bit
	types are supported.

2007-03-10  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h (__attribute__): New macro.
	(fprintf, vfprintf, printf, vprintf, snprintf, vsnprintf, sprintf,
	vsprintf): Specify __attribute__ __format__ for GCC.
	Suggested by Eric Blake.

2007-03-09  Bruno Haible  <bruno@clisp.org>

	* modules/printf-posix-tests: New file.
	* tests/test-printf-posix.sh: New file.
	* tests/test-printf-posix.c: New file.

	* modules/printf-posix: New file.
	* lib/printf.c: New file.
	* m4/printf-posix-rpl.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_PRINTF_POSIX,
	REPLACE_PRINTF.
	* lib/stdio_.h (printf): New declaration.
	(format, __format__, ____printf____, ____scanf____, ____strftime____,
	____strfmon____): New macros.
	* modules/stdio (Makefile.am): Substitute also GNULIB_PRINTF_POSIX,
	REPLACE_PRINTF.

2007-03-09  Bruno Haible  <bruno@clisp.org>

	* tests/test-vasnprintf-posix2.sh: New file.
	* tests/test-vasnprintf-posix2.c: New file.
	* modules/vasnprintf-posix-tests (Files): Add them and m4/locale-fr.m4.
	(configure.ac): Invoke gt_LOCALE_FR and gt_LOCALE_FR_UTF8.
	(Makefile.am): Activate test-vasnprintf-posix2.sh.

	* lib/vasnprintf.c (VASNPRINTF): For the 'a' and 'A' directives, use
	a locale dependent decimal point, rather than always '.'.

2007-03-09  Eric Blake  <ebb9@byu.net>

	* lib/stdlib_.h (EXIT_FAILURE): GNU code expects this to be 1, in
	spite of platforms like Tandem/NSK that define it to -1.

2007-03-08  Bruno Haible  <bruno@clisp.org>

	* modules/vprintf-posix-tests: New file.
	* tests/test-vprintf-posix.sh: New file.
	* tests/test-vprintf-posix.c: New file.
	* tests/test-printf-posix.h: New file.

	* modules/vprintf-posix: New file.
	* lib/vprintf.c: New file.
	* m4/vprintf-posix.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_VPRINTF_POSIX,
	REPLACE_VPRINTF.
	* lib/stdio_.h (vprintf): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_VPRINTF_POSIX,
	REPLACE_VPRINTF.

2007-03-08  Bruno Haible  <bruno@clisp.org>

	* modules/fprintf-posix-tests: New file.
	* tests/test-fprintf-posix.sh: New file.
	* tests/test-fprintf-posix.c: New file.

	* modules/fprintf-posix: New file.
	* lib/fprintf.c: New file.
	* m4/fprintf-posix.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_FPRINTF_POSIX,
	REPLACE_FPRINTF.
	* lib/stdio_.h (fprintf): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_FPRINTF_POSIX,
	REPLACE_FPRINTF.

2007-03-08  Bruno Haible  <bruno@clisp.org>

	* modules/vfprintf-posix-tests: New file.
	* tests/test-vfprintf-posix.sh: New file.
	* tests/test-vfprintf-posix.c: New file.
	* tests/test-fprintf-posix.h: New file.
	* tests/test-fprintf-posix.out: New file.

	* modules/vfprintf-posix: New file.
	* lib/vfprintf.c: New file.
	* m4/vfprintf-posix.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_VFPRINTF_POSIX,
	REPLACE_VFPRINTF.
	* lib/stdio_.h (vfprintf): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_VFPRINTF_POSIX,
	REPLACE_VFPRINTF.

2007-03-08  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h: Treat __need___FILE like __need_FILE.

2007-03-08  Bruno Haible  <bruno@clisp.org>

	* m4/snprintf-posix.m4 (gl_FUNC_SNPRINTF_POSIX): Use 'case' statements
	instead of 'expr' invocations.
	* m4/sprintf-posix.m4 (gl_FUNC_SPRINTF_POSIX): Likewise.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Likewise.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): Likewise.
	* m4/vsnprintf-posix.m4 (gl_FUNC_VSNPRINTF_POSIX): Likewise.
	* m4/vsprintf-posix.m4 (gl_FUNC_VSPRINTF_POSIX): Likewise.
	Suggested by Paul Eggert.

2007-03-08  Bruno Haible  <bruno@clisp.org>

	* modules/fseterr-tests: New file.
	* tests/test-fseterr.c: New file.

	* modules/fseterr: New file.
	* lib/fseterr.h: New file.
	* lib/fseterr.c: New file.

2007-03-08  Bruno Haible  <bruno@clisp.org>

	* lib/fnmatch_.h: Convert tabs in the middle of lines to spaces.
	* lib/getopt_.h: Likewise.
	* lib/mbswidth.h: Likewise.
	* lib/setenv.h: Likewise.
	* lib/vasnprintf.h: Likewise.
	* lib/vasprintf.h: Likewise.
	* lib/verror.h: Likewise.
	* lib/xsetenv.h: Likewise.
	* lib/xvasprintf.h: Likewise.

2007-03-08  Jim Meyering  <jim@meyering.net>

	* users.txt: Add parted.

	* ChangeLog: Restore 1500 lines mistakenly removed from the end.

2007-03-07  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4: Make the shell script snippets copy&pastable.

2007-03-02  Bruno Haible  <bruno@clisp.org>

	* lib/netinet_in_.h: New file.
	* m4/netinet_in_h.m4 (gl_HEADER_NETINET_IN): Test whether netinet/in.h
	is self-contained. Set ABSOLUTE_NETINET_IN_H, HAVE_NETINET_IN_H.
	* modules/netinet_in (Files): Add lib/netinet_in_.h.
	(Depends-on): Add absolute-header.
	(Makefile.am): Substitute ABSOLUTE_NETINET_IN_H, HAVE_NETINET_IN_H
	into netinet/in.h.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* lib/sys_select_.h: New file.
	* m4/sys_socket_h.m4 (gl_HEADER_SYS_SELECT): Test whether sys/select.h
	is self-contained. Set ABSOLUTE_SYS_SELECT_H, HAVE_SYS_SELECT_H.
	* modules/sys_select (Files): Add lib/sys_select_.h.
	(Depends-on): Add absolute-header.
	(Makefile.am): Substitute ABSOLUTE_SYS_SELECT_H, HAVE_SYS_SELECT_H
	into sys/select.h.

2007-03-02  Bruno Haible  <bruno@clisp.org>

	* lib/socket_.h: If sys/socket.h exists, include that and <sys/types.h>
	before it. Turn HAVE_WINSOCK2_H and HAVE_WS2TCPIP_H into configute-time
	values.
	* m4/sys_socket_h.m4 (gl_HEADER_SYS_SOCKET): Test also whether
	<sys/socket.h> is self-contained. Set ABSOLUTE_SYS_SOCKET_H,
	HAVE_SYS_SOCKET_H, HAVE_WINSOCK2_H, HAVE_WS2TCPIP_H.
	* modules/sys_socket (Depends-on): Add absolute-header.
	(Makefile.am): Substitute ABSOLUTE_SYS_SOCKET_H, HAVE_SYS_SOCKET_H,
	HAVE_WINSOCK2_H, HAVE_WS2TCPIP_H into sys/socket.h.
	(Include): Remove requirement of inclusion of <sys/types.h>.

2007-03-02  Bruno Haible  <bruno@clisp.org>

	* lib/byteswap_.h (bswap_32): Fix formula.

2007-03-06  Bruno Haible  <bruno@clisp.org>

	* modules/sprintf-posix-tests: New file.
	* tests/test-sprintf-posix.c: New file.

	* modules/sprintf-posix: New file.
	* lib/sprintf.c: New file.
	* m4/sprintf-posix.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_SPRINTF_POSIX,
	REPLACE_SPRINTF.
	* lib/stdio_.h (sprintf): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_SPRINTF_POSIX,
	REPLACE_SPRINTF.

2007-03-06  Bruno Haible  <bruno@clisp.org>

	* modules/vsprintf-posix-tests: New file.
	* tests/test-vsprintf-posix.c: New file.
	* tests/test-sprintf-posix.h: New file.

	* modules/vsprintf-posix: New file.
	* lib/vsprintf.c: New file.
	* m4/vsprintf-posix.m4: New file.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also GNULIB_VSPRINTF_POSIX,
	REPLACE_VSPRINTF.
	* lib/stdio_.h (vsprintf): New declaration.
	* modules/stdio (Makefile.am): Substitute also GNULIB_VSPRINTF_POSIX,
	REPLACE_VSPRINTF.

2007-03-06  Bruno Haible  <bruno@clisp.org>

	* modules/vsnprintf (Depend-on): Remove minmax.

2007-03-06  Bruno Haible  <bruno@clisp.org>

	* modules/snprintf-posix-tests: New file.
	* tests/test-snprintf-posix.c: New file.

	* modules/snprintf-posix: New file.
	* m4/snprintf-posix.m4: New file.
	* m4/snprintf.m4 (gl_REPLACE_SNPRINTF): New macro, extracted from
	gl_FUNC_SNPRINTF.
	(gl_FUNC_SNPRINTF): Invoke it.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also REPLACE_SNPRINTF.
	* lib/stdio_.h (snprintf): Define as a replacement if REPLACE_SNPRINTF
	is set.
	* modules/stdio (Makefile.am): Substitute also REPLACE_SNPRINTF.

2007-03-06  Bruno Haible  <bruno@clisp.org>

	* modules/vsnprintf-posix-tests: New file.
	* tests/test-vsnprintf-posix.c: New file.
	* tests/test-snprintf-posix.h: New file.

	* modules/vsnprintf-posix: New file.
	* m4/vsnprintf-posix.m4: New file.
	* m4/vsnprintf.m4 (gl_REPLACE_VSNPRINTF): New macro, extracted from
	gl_FUNC_VSNPRINTF.
	(gl_FUNC_VSNPRINTF): Invoke it.
	* m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS): Set also REPLACE_VSNPRINTF.
	* lib/stdio_.h (vsnprintf): Define as a replacement if
	REPLACE_VSNPRINTF is set.
	* modules/stdio (Makefile.am): Substitute also REPLACE_VSNPRINTF.

2007-03-06  Bruno Haible  <bruno@clisp.org>

	* m4/vasnprintf.m4 (gl_REPLACE_VASNPRINTF): Test for vasnprintf here.
	* m4/vasprintf-posix.m4 (gl_FUNC_VASPRINTF_POSIX): ... not here.

2007-03-06  Bruno Haible  <bruno@clisp.org>

	* lib/math_.h (acosl): Declare also if HAVE_DECL_ACOSL is set.
	(asinl): Declare also if HAVE_DECL_ASINL is set.
	(atanl): Declare also if HAVE_DECL_ATANL is set.
	(ceill): Declare also if HAVE_DECL_CEILL is set.
	(cosl): Declare also if HAVE_DECL_COSL is set.
	(expl): Declare also if HAVE_DECL_EXPL is set.
	(floorl): Declare also if HAVE_DECL_FLOORL is set.
	(frexpl): Declare also if HAVE_DECL_FREXPL is set.
	(ldexpl): Declare also if HAVE_DECL_LDEXPL is set.
	(logl): Declare also if HAVE_DECL_LOGL is set.
	(sinl): Declare also if HAVE_DECL_SINL is set.
	(sqrtl): Declare also if HAVE_DECL_SQRTL is set.
	(tanl): Declare also if HAVE_DECL_TANL is set.
	* modules/math (Makefile.am): Substitute the values of HAVE_DECL_*.
	* m4/math_h.m4 (gl_MATH_H_DEFAULTS): Set HAVE_DECL_* to 1.
	* m4/printf-frexpl.m4 (gl_FUNC_PRINTF_FREXPL): Fix tests for the
	declaration of frexpl, ldexpl.
	* modules/printf-frexpl (Depends-on): Add math.
	* lib/printf-frexp.c (frexpl, ldexpl): Undo last change.

2007-03-05  Bruno Haible  <bruno@clisp.org>

	* m4/printf-frexpl.m4 (gl_FUNC_PRINTF_FREXPL): Also test whether
	frexpl and ldexpl are declared.
	* lib/printf-frexp.c (frexpl, ldexpl): Provide fallback declarations.

2007-03-05  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_automake_snippet): Don't synthesize an
	EXTRA_lib_SOURCES augmentation for the relocatable-prog-wrapper module.

2007-03-05  Bruno Haible  <bruno@clisp.org>

	* lib/stdio_.h: Include <stddef.h>.

2007-03-05  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_SNPRINTF_DIRECTIVE_N): New macro.

2007-03-05  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4: Update with info about OpenBSD 3.9, HP-UX 10.20,
	NetBSD 4, from Ralf Wildenhues.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	* lib/vasprintf.h: Update #if logic for the case when the functions
	exist but are overridden.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	* m4/printf.m4 (gl_PRINTF_DIRECTIVE_A): Exclude two buggy
	implementations: glibc-2.4 and MacOS X 10.3.
	* tests/test-vasnprintf-posix.c (test_function): Test also the case
	that exhibits the bugs in glibc-2.4 and MacOS X 10.3.
	* tests/test-vasprintf-posix.c (test_function): Likewise.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	* modules/vasprintf-posix-tests: New file.
	* tests/test-vasprintf-posix.c: New file.

	* modules/vasprintf-posix: New file.
	* lib/vasprintf.h (asprintf, vasprintf): Rename if REPLACE_VASPRINTF is
	defined.
	* m4/vasprintf-posix.m4: New file.
	* m4/vasprintf.m4 (gl_REPLACE_VASPRINTF): New macro, extracted from
	gl_FUNC_VASPRINTF.
	(gl_FUNC_VASPRINTF): Invoke it.
	* m4/vasnprintf.m4 (gl_REPLACE_VASNPRINTF): Define REPLACE_VASNPRINTF
	here.
	* m4/vasnprintf-posix.m4 (gl_FUNC_VASNPRINTF_POSIX): Not here.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	* lib/sys_time_.h: Rename GETTIMEOFDAY_REPLACEMENT to
	REPLACE_GETTIMEOFDAY.
	* modules/sys_time (Makefile.am): Likewise.
	* m4/sys_time_h.m4: Likewise.
	* m4/gettimeofday.m4: Likewise.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	* modules/vasnprintf-posix-tests: New file.
	* tests/test-vasnprintf-posix.c: New file.

	* modules/vasnprintf-posix: New file.
	* lib/vasnprintf.c: Include isnan.h, isnanl.h, printf-frexp.h,
	printf-frexpl.h.
	(VASNPRINTF): Handle the 'a' and 'A' directives here, if needed.
	* lib/vasnprintf.h (asnprintf, vasnprintf): Rename if
	REPLACE_VASNPRINTF is defined.
	* m4/vasnprintf.m4 (gl_REPLACE_VASNPRINTF): New macro, extracted from
	gl_FUNC_VASNPRINTF.
	(gl_FUNC_VASNPRINTF): Invoke it.
	* m4/vasnprintf-posix.m4: New file.
	* m4/printf.m4: New file.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	Compile progreloc.c only if --enable-relocatable is specified.
	* m4/relocatable.m4 (gl_RELOCATABLE): Arrange to compile progreloc.c
	if --enable-relocatable was specified.
	* modules/relocatable-prog (Makefile.am): Remove progreloc.c from
	lib_SOURCES.

2007-03-04  Jim Meyering  <jim@meyering.net>

	* lib/acl.c (ACL_NOT_WELL_SUPPORTED): New macro.
	Use it consistently, rather than enumerating errno constants.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	* modules/xvasprintf-tests: New file.
	* tests/test-xvasprintf.c: New file.

	* modules/vasprintf-tests: New file.
	* tests/test-vasprintf.c: New file.

	* modules/vasnprintf-tests: New file.
	* tests/test-vasnprintf.c: New file.

	* modules/vsnprintf-tests: New file.
	* tests/test-vsnprintf.c: New file.

	* modules/snprintf-tests: New file.
	* tests/test-snprintf.c: New file.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	Compile relocatable.c only if --enable-relocatable is specified.
	* m4/relocatable-lib.m4 (gl_RELOCATABLE_LIBRARY_BODY): Renamed from
	gl_RELOCATABLE_LIBRARY.
	(gl_RELOCATABLE_LIBRARY, gl_RELOCATABLE_LIBRARY_SEPARATE): New macros.
	* m4/relocatable.m4 (gl_RELOCATABLE): Invoke gl_RELOCATABLE_LIBRARY.
	(gl_RELOCATABLE_BODY): Require gl_RELOCATABLE_LIBRARY_BODY instead of
	gl_RELOCATABLE_LIBRARY.
	* modules/relocatable-lib (configure.ac): Invoke gl_RELOCATABLE_LIBRARY.
	(Makefile.am): Remove lib_SOURCES.
	* modules/relocatable-lib-lgpl (configure.ac): Invoke
	gl_RELOCATABLE_LIBRARY.
	(Makefile.am): Remove lib_SOURCES.
	* modules/relocatable-prog (Makefile.am): Don't compile relocatable.c
	always.
	* modules/relocatable-prog-wrapper (configure.ac): Invoke
	gl_RELOCATABLE_LIBRARY_SEPARATE instead of gl_RELOCATABLE_LIBRARY.

2007-03-04  Bruno Haible  <bruno@clisp.org>

	* modules/argmatch-tests: New file.
	* tests/test-argmatch.c: New file.

	* tests/test-allocsa.c (main): Halve the number of loop runs.

	* modules/alloca-opt-tests: New file.
	* tests/test-alloca-opt.c: New file.

2007-03-04  Jim Meyering  <jim@meyering.net>

	Work around difference between Linux ACLs and Solaris 10 ZFS.
	* lib/acl.c (set_acl): Revert to using chmod_or_fchmod also
	for EINVAL.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* modules/relocatable-prog (Depends-on): Add back progreloc's
	dependencies: canonicalize-lgpl, xalloc, xreadlink, stdbool, unistd.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* modules/relocatable-lib-lgpl: Renamed from modules/relocatable-lib.
	* modules/relocatable-lib: New file.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* modules/relocatable-prog: Renamed from modules/relocatable.
	* doc/relocatable-maint.texi: Talk about module 'relocatable-prog'.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* modules/relocatable-script (Files): Add doc/relocatable.texi,
	m4/relocatable-lib.m4.
	(Depends-on): Remove 'relocatable'.
	(configure.ac): Add gl_RELOCATABLE_NOP.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* modules/relocatable-prog-wrapper: New file.
	* modules/relocatable (Depends-on): Add it. Remove all other
	dependencies except progname.
	(Files): Remove build-aux/install-reloc, lib/relocwrapper.c.

	* m4/strerror.m4 (gl_FUNC_STRERROR_SEPARATE): New macro.
	(gl_FUNC_STRERROR): Nop.
	* lib/strerror.c: Compile the file only if !HAVE_STRERROR.

	* m4/setenv.m4 (gl_FUNC_SETENV_SEPARATE): New macro.
	* lib/setenv.c: Compile the file only if _LIBC || !HAVE_SETENV.

	* m4/readlink.m4 (gl_FUNC_READLINK_SEPARATE): New macro.
	(gl_FUNC_READLINK): Update.

	* m4/canonicalize-lgpl.m4 (gl_CANONICALIZE_LGPL_SEPARATE): New macro.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* lib/xreadlink.c: Include <unistd.h> unconditionally.
	* modules/xreadlink (Depends-on): Add unistd.
	* modules/xreadlink-with-size (Depends-on): Likewise.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* m4/setenv.m4 (gl_FUNC_SETENV, gl_FUNC_UNSETENV): New macros,
	extracted from gt_FUNC_SETENV.
	(gt_FUNC_SETENV): Remove macro.
	* modules/setenv (configure.ac): Add gl_FUNC_SETENV, gl_FUNC_UNSETENV,
	remove gt_FUNC_SETENV.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* m4/relocatable-lib.m4 (gl_RELOCATABLE_LIBRARY): Define
	ENABLE_RELOCATABLE here.
	* m4/relocatable.m4 (gl_RELOCATABLE_BODY): Don't define it here.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* modules/rbtreehash-list-tests (Depends-on): Add progname.
	* tests/test-rbtreehash_list.c: Include progname.h.
	(main): Call set_program_name.

	* modules/rbtree-oset-tests (Depends-on): Add progname.
	* tests/test-rbtree_oset.c: Include progname.h.
	(main): Call set_program_name.

	* modules/rbtree-list-tests (Depends-on): Add progname.
	* tests/test-rbtree_list.c: Include progname.h.
	(main): Call set_program_name.

	* modules/linked-list-tests (Depends-on): Add progname.
	* tests/test-linked_list.c: Include progname.h.
	(main): Call set_program_name.

2007-03-03  Bruno Haible  <bruno@clisp.org>

	* lib/glob-libc.h (_Restrict_): New macro, copied from lib/regex.h.
	All uses of __restrict changed to _Restrict_.
	* lib/glob_.h (__restrict): Remove macro.

2007-03-02  Bruno Haible  <bruno@clisp.org>

	* modules/gettext (configure.ac): Require gettext infrastructure
	from version 0.16.1.

2007-03-02  Bruno Haible  <bruno@clisp.org>

	* modules/linkedhash-list-tests (Depends-on): Add progname.
	* tests/test-linkedhash_list.c: Include progname.h.
	(main): Call set_program_name.

	* modules/carray-list-tests (Depends-on): Add progname.
	* tests/test-carray_list.c: Include progname.h.
	(main): Call set_program_name.

	* modules/avltreehash-list-tests (Depends-on): Add progname.
	* tests/test-avltreehash_list.c: Include progname.h.
	(main): Call set_program_name.

	* modules/avltree-oset-tests (Depends-on): Add progname.
	* tests/test-avltree_oset.c: Include progname.h.
	(main): Call set_program_name.

	* modules/avltree-list-tests (Depends-on): Add progname.
	* tests/test-avltree_list.c: Include progname.h.
	(main): Call set_program_name.

	* modules/array-oset-tests (Depends-on): Add progname.
	* tests/test-array_oset.c: Include progname.h.
	(main): Call set_program_name.

	* modules/array-list-tests (Depends-on): Add progname.
	* tests/test-array_list.c: Include progname.h.
	(main): Call set_program_name.

	* modules/argp-tests (Depends-on): Add progname.
	* tests/test-argp.c: Include argp.h first. Include progname.h.
	(main): Call set_program_name.

2007-03-02  Paul Eggert  <eggert@cs.ucla.edu>

	* doc/gnulib-tool.texi (Initial import): Reword description of
	_FILE_OFFSET_BITS and _GNU_SOURCE, since they sometimes have a
	limited effect even if defined after the first system include.

2007-03-01  Bruno Haible  <bruno@clisp.org>

	* build-aux/config.libpath: Update to libtool-1.5.22.
	Reported by Albert Chin <bug-gnulib@mlists.thewrittenword.com>.

2007-03-01  Bruno Haible  <bruno@clisp.org>

	* doc/relocatable-maint.texi: Recommend to set foo_CPPFLAGS, not
	foo_CFLAGS.
	Reported by Ralf Wildenhues.

2007-03-01  Bruno Haible  <bruno@clisp.org>

	* build-aux/install-reloc: Remove object files left over by some
	compilers.
	Reported by Ralf Wildenhues.

2007-03-01  Bruno Haible  <bruno@clisp.org>

	* build-aux/install-reloc: Break long lines.

2007-03-01  Bruno Haible  <bruno@clisp.org>

	* doc/relocatable.texi: Document that it may not work on OpenBSD.
	Reported by Ralf Wildenhues.

2007-03-01  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (Initial import): Remove paragraph about
	include ordering constraints.

2007-03-01  Paul Eggert  <eggert@cs.ucla.edu>

	Followup to the 2007-02-12 patch, using suggestions from Bruno Haible in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-02/msg00136.html>.
	* doc/gnulib-tool.texi (Initial import): Mention _FILE_OFFSET_BITS
	as another example.
	* lib/time_.h: Fix misspelling.
	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP):
	Require gl_HEADER_TIME_H_DEFAULTS.
	* m4/strptime.m4 (gl_FUNC_STRPTIME): Likewise.
	* m4/time_r.m4 (gl_TIME_R): Likewise.
	* m4/timegm.m4 (gl_FUNC_TIMEGM): Likewise.

2007-03-01  Bruno Haible  <bruno@clisp.org>

	* m4/utimecmp.m4 (gl_UTIMECMP): Don't require gl_TIMESPEC.
	* m4/utimens.m4 (gl_UTIMENS): Likewise.

2007-03-01  Jim Meyering  <jim@meyering.net>

	* modules/xreadlink (Maintainer): Add my name.
	* modules/xreadlink-with-size (Depends-on): Alphabetize.

2007-02-26  Ben Pfaff  <blp@cs.stanford.edu>
	    Bruno Haible  <bruno@clisp.org>

	* build-aux/install-reloc: Compile also c-ctype.c.
	* build-aux/relocatable.sh.in: New file.
	* doc/relocatable.texi: New file.
	* doc/relocatable-maint.texi: New file.
	* doc/gnulib.texi: Include relocatable-maint.texi.
	* lib/progreloc.c: Include unistd.h unconditionally.
	* lib/relocwrapper.c: Include unistd.h unconditionally.
	Include c-ctype.h.
	(add_dotbin): Use c_tolower.
	* m4/relocatable-lib.m4: New file, extracted from m4/relocatable.m4.
	(gl_RELOCATABLE_LIBRARY): Renamed from AC_RELOCATABLE_LIBRARY.
	(gl_RELOCATABLE_NOP): Renamed from AC_RELOCATABLE_NOP.
	* m4/relocatable.m4 (AC_RELOCATABLE_LIBRARY, AC_RELOCATABLE_NOP): Move
	to m4/relocatable-lib.m4.
	(gl_RELOCATABLE): Renamed from AC_RELOCATABLE. Set also
	RELOCATABLE_CONFIG_H_DIR, RELOCATABLE_SRC_DIR, RELOCATABLE_BUILD_DIR.
	(gl_RELOCATABLE_BODY): Renamed from AC_RELOCATABLE_BODY. Don't
	require obsolete macro AC_EXEEXT. Don't check for unistd.h. Don't set
	SET_RELOCATABLE. Instead set RELOCATABLE_LDFLAGS, INSTALL_PROGRAM_ENV.
	* modules/relocatable: New file.
	* modules/relocatable-lib: New file.
	* modules/relocatable-script: New file.

2007-02-28  Bruno Haible  <bruno@clisp.org>

	Import --enable-relocatable infrastructure.
	* build-aux/config.libpath: New file, from GNU gettext.
	* build-aux/install-reloc: New file, from GNU gettext.
	* build-aux/reloc-ldflags: New file, from GNU gettext.
	* lib/relocatable.h: New file, from GNU gettext.
	* lib/relocatable.c: New file, from GNU gettext.
	* lib/relocwrapper.c: New file, from GNU gettext.
	* m4/relocatable.m4: New file, from GNU gettext.

2007-02-28  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (File system functions): Add xreadlink-with-size.

	* modules/xreadlink: New file, from GNU gettext with modifications.
	* lib/xreadlink.c: New file, from GNU gettext.
	* lib/xreadlink.h: Add comments.
	(xreadlink): New declaration.

	* modules/xreadlink-with-size: Renamed from modules/xreadlink.
	(Files): Remove m4/xreadlink.m4. Replace lib/xreadlink.c with
	lib/xreadlink-with-size.c.
	(configure.ac): Remove gl_XREADLINK invocation.
	(Makefile.am): Augment lib_SOURCES.
	* m4/xreadlink.m4: Remove file.
	* lib/xreadlink-with-size.c: Renamed from lib/xreadlink.c.
	(xreadlink_with_size): Renamed from xreadink.
	* lib/xreadlink.h (xreadlink_with_size): Renamed from xreadink.
	* modules/canonicalize (Depends-on): Replace xreadlink with
	xreadlink-with-size.
	* lib/canonicalize.c (canonicalize_filename_mode): Update.

2007-02-25  Jim Meyering  <jim@meyering.net>

	* build-aux/announce-gen: When complaining about excess arguments,
	list them.

2007-02-25  Paul Eggert  <eggert@cs.ucla.edu>

	* README: Document signed integer overflow situation more
	accurately.

2007-02-25  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (VASNPRINTF): Fix estimate of size needed for a
	'a' or 'A' conversion.

2007-02-25  Bruno Haible  <bruno@clisp.org>

	* modules/filename: Renamed from modules/pathname.
	(Files): Replace lib/pathname.h with lib/filename.h. Replace
	lib/concatpath.c with lib/concat-filename.c.
	(Makefile.am): Update.
	(Include): Replace pathname.h with filename.h.
	* lib/filename.h: Renamed from lib/pathname.h.
	(concatenated_filename): Renamed from concatenated_pathname.
	* lib/concat-filename.c: Renamed from lib/concatpath.c.
	(concatenated_filename): Renamed from concatenated_pathname.
	* lib/findprog.c: Include filename.h instead of pathname.h.
	(find_in_path): Update.
	* lib/javacomp.c: Include filename.h instead of pathname.h.
	(is_envjavac_gcj43_usable, is_envjavac_oldgcj_14_14_usable,
	is_envjavac_oldgcj_14_13_usable, is_envjavac_nongcj_usable,
	is_gcj_present, is_gcj43_usable, is_oldgcj_14_14_usable,
	is_oldgcj_14_13_usable, is_javac_usable): Update.
	* lib/javaexec.c: Include filename.h instead of pathname.h.
	(execute_java_class): Update.
	* modules/findprog: Update.
	* modules/javacomp: Update.
	* modules/javaexec: Update.
	* MODULES.html.sh (File system functions): Add 'filename', remove
	'pathname'.

2007-02-25  Bruno Haible  <bruno@clisp.org>

	* modules/printf-frexpl-tests: New file.
	* tests/test-printf-frexpl.c: New file.

	* modules/printf-frexpl: New file.
	* lib/printf-frexpl.h: New file.
	* lib/printf-frexpl.c: New file.
	* m4/printf-frexpl.m4: New file.

2007-02-25  Bruno Haible  <bruno@clisp.org>

	* modules/printf-frexp-tests: New file.
	* tests/test-printf-frexp.c: New file.

	* modules/printf-frexp: New file.
	* lib/printf-frexp.h: New file.
	* lib/printf-frexp.c: New file.
	* m4/printf-frexp.m4: New file.

2007-02-25  Bruno Haible  <bruno@clisp.org>

	Assume automake >= 1.10 for the tests.
	* modules/arcfour-tests (TESTS): Remove $(EXEEXT) suffix.
	* modules/arctwo-tests: Likewise.
	* modules/argp-tests: Likewise.
	* modules/avltree-list-tests: Likewise.
	* modules/avltree-oset-tests: Likewise.
	* modules/avltreehash-list-tests: Likewise.
	* modules/carray-list-tests: Likewise.
	* modules/crc-tests: Likewise.
	* modules/des-tests: Likewise.
	* modules/gc-arcfour-tests: Likewise.
	* modules/gc-arctwo-tests: Likewise.
	* modules/gc-des-tests: Likewise.
	* modules/gc-hmac-md5-tests: Likewise.
	* modules/gc-hmac-sha1-tests: Likewise.
	* modules/gc-md2-tests: Likewise.
	* modules/gc-md4-tests: Likewise.
	* modules/gc-md5-tests: Likewise.
	* modules/gc-pbkdf2-sha1-tests: Likewise.
	* modules/gc-rijndael-tests: Likewise.
	* modules/gc-sha1-tests: Likewise.
	* modules/gc-tests: Likewise.
	* modules/getaddrinfo-tests: Likewise.
	* modules/hmac-md5-tests: Likewise.
	* modules/hmac-sha1-tests: Likewise.
	* modules/linked-list-tests: Likewise.
	* modules/linkedhash-list-tests: Likewise.
	* modules/lock-tests: Likewise.
	* modules/md2-tests: Likewise.
	* modules/md4-tests: Likewise.
	* modules/md5-tests: Likewise.
	* modules/rbtree-list-tests: Likewise.
	* modules/rbtree-oset-tests: Likewise.
	* modules/rbtreehash-list-tests: Likewise.
	* modules/read-file-tests: Likewise.
	* modules/rijndael-tests: Likewise.
	* modules/stdint-tests: Likewise.
	* modules/tls-tests: Likewise.

2007-02-24  Bruno Haible  <bruno@clisp.org>

	* lib/isnanl.h (isnanl): Define through isnan if isnan is a macro.
	* m4/isnan.m4 (gl_FUNC_ISNAN_NO_LIBM): Don't check for isnan as a
	function; instead check whether isnan with a double argument links.
	* m4/isnanl.m4 (gl_FUNC_ISNANL_NO_LIBM): Don't check for isnanl as a
	function; instead check whether isnan with a 'long double' argument
	links.
	Reported by Eric Blake <ebb9@byu.net>.

2007-02-24  Bruno Haible  <bruno@clisp.org>

	* lib/isnan.c: Support the 'long double' case if USE_LONG_DOUBLE is
	defined.
	* lib/isnanl.c: Remove all code. Just include isnan.c.
	* modules/isnanl-nolibm (Files): Add lib/isnan.c.

2007-02-25  Jim Meyering  <jim@meyering.net>

	Avoid conflicting types for 'unsetenv' on FreeBSD.
	* lib/putenv.c (_unsetenv): Rename from "unsetenv", to avoid
	conflicting with FreeBSD's (5.0 and 6.1) function declaration
	in stdlib.h.

2007-02-24  Bruno Haible  <bruno@clisp.org>

	* modules/isnanl-nolibm-tests: New file.
	* tests/test-isnanl.c: New file.

	* modules/isnanl-nolibm: New file.
	* lib/isnanl.h: New file.
	* lib/isnanl.c: New file.
	* m4/isnanl.m4: New file.

2007-02-24  Bruno Haible  <bruno@clisp.org>

	* modules/isnan-nolibm-tests: New file.
	* tests/test-isnan.c: New file.

	* modules/isnan-nolibm: New file.
	* lib/isnan.h: New file.
	* lib/isnan.c: New file.
	* m4/isnan.m4: New file.

2007-02-24  Bruno Haible  <bruno@clisp.org>

	* lib/frexpl.c (frexpl): Correct return values for x = 1.0L. Don't
	assume that an exponent fits in 20 bits.

2007-02-24  Jim Meyering  <jim@meyering.net>

	* m4/regex.m4: Update the description of the configure-time option,
	--without-included-regex, to state accurately what the defaults are,
	and perhaps to give people an idea why using this option is risky.

2007-02-24  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP): Check for a nanosleep that
	loops on small arguments.  This attempts to avoid the problem
	Bruno Haible reported for AIX 4.3.2 in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-02/msg00309.html>.

2007-02-23  Bruno Haible  <bruno@clisp.org>

	* m4/perl.m4 (gl_PERL): Require version 5.005, not 5.003.
	Needed for help2man.

2007-02-23  Karl Berry  <karl@gnu.org>

	* doc/gnulib-tool.texi (CVS Issues): mention that when foo_.h
	exists, foo.h should be cvs-ignored, not committed.

2007-02-23  Eric Blake  <ebb9@byu.net>

	* lib/getdate.h (includes):  Include <time.h>, not "timespec.h".
	* lib/stat-time.h (includes): Likewise.
	* lib/utimecmp.c (includes): Likewise.
	* lib/utimens.h (includes): Likewise.
	* lib/getdate.y (includes): Also include "timespec.h" for use
	internal to the module.
	* modules/utimens (Depends-on): Revert yesterday's patch.
	* modules/nanosleep (Depends-on): Add missing dependency.

2007-02-22  Bruno Haible  <bruno@clisp.org>

	* lib/glob.c: Don't include getlogin_r.h.

2007-02-22  Jim Meyering  <jim@meyering.net>

	* modules/utimens (Depends-on): Add timespec, required for
	utimens.h's inclusion of timespec.h.

2007-02-21  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getcwd.c (__getcwd): Undo previous change; it mishandled
	long unreadable paths in GNU/Linux.  Problem reported by Andreas
	Schwab in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-02/msg00261.html>.
	I'll try to think of a better way to fix the Solaris problem.

	* lib/getcwd.c (__getcwd): Don't assume getcwd (NULL, 0) works
	like glibc; on Solaris 10, it fails with errno == EINVAL.
	POSIX says the behavior is unspecified if the first argument is NULL,
	so play it safe and never pass NULL to the system getcwd.

2007-02-21  Jim Meyering  <jim@meyering.net>

	* lib/gettimeofday.c (rpl_gettimeofday): Remove declaration
	of gettimeofday.  It would conflict with the one now always
	provided via sys_time_.h.  Reported by Matthew Woehlke, as
	an IRIX 6.5 build failure.

2007-02-20  Paul Eggert  <eggert@cs.ucla.edu>

	Minor fixups to port to Solaris 10 with Sun C 5.8.
	* lib/getcwd.c [!_LIBC]: Include dirfd.h, since we use dirfd.
	* modules/getcwd (Depends-on): Add dirfd.
	* lib/putenv.c (putenv): #undef it.
	(rpl_putenv): New decl.
	(malloc, free): Include <stdlib.h> rather than prototyping separately.

2007-02-20  Bruno Haible  <bruno@clisp.org>

	* modules/stdio-tests: New file.
	* tests/test-stdio.c: New file.

	* modules/vsnprintf (Files): Remove lib/vsnprintf.h.
	(Depends-on): Add stdio.
	(configure.ac): Invoke gl_STDIO_MODULE_INDICATOR.
	(Include): Use <stdio.h> instead of vsnprintf.h.
	* m4/vsnprintf.m4 (gl_FUNC_VSNPRINTF): Require gl_STDIO_H_DEFAULTS. Set
	HAVE_DECL_VSNPRINTF.
	* lib/vsnprintf.c: Include <stdio.h> instead of vsnprintf.h.

	* modules/snprintf (Files): Remove lib/snprintf.h.
	(Depends-on): Add stdio.
	(configure.ac): Invoke gl_STDIO_MODULE_INDICATOR.
	(Include): Use <stdio.h> instead of snprintf.h.
	* m4/snprintf.m4 (gl_FUNC_SNPRINTF): Require gl_STDIO_H_DEFAULTS. Set
	HAVE_DECL_SNPRINTF.
	* lib/snprintf.c: Include <stdio.h> instead of snprintf.h.
	* lib/getaddrinfo.c: Likewise.

	* modules/stdio: New file.
	* lib/stdio_.h: New file, incorporating snprintf.h and vsnprintf.h.
	* lib/snprintf.h: Remove file.
	* lib/vsnprintf.h: Remove file.
	* lib/.cppi-disable: Remove snprintf.h.
	* m4/stdio_h.m4: New file.
	* MODULES.html.sh (Support for systems lacking ISO C 99): Add stdio.

2007-02-20  Jim Meyering  <jim@meyering.net>

	* lib/ftruncate.c [HAVE_CHSIZE]: Document that this code is
	used by e.g., mingw.  From Bruno Haible.

2007-02-19  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h: Use "#pragma GCC system_header" to suppress some gcc
	warnings.
	Reported by Ben Pfaff <blp@cs.stanford.edu>.

2007-02-19  Bruno Haible  <bruno@clisp.org>

	* m4/ftruncate.m4 (gl_FUNC_FTRUNCATE): Don't request a complaint mail
	from mingw users.

2007-02-19  Bruno Haible  <bruno@clisp.org>

	* lib/stdlib_.h: Use "#pragma GCC system_header" to suppress some gcc
	warnings.
	Reported by Joel E. Denny <jdenny@ces.clemson.edu> via Paul Eggert.

2007-02-19  Jim Meyering  <jim@meyering.net>

	Don't use FD after a successful "fdopendir (fd)".
	* lib/getcwd.c (__getcwd) [AT_FDCWD]: fdopendir (fd) usually closes fd.
	Reset it by calling dirfd on the just-obtained DIR*.

	* m4/ftruncate.m4: Adjust comment to give this module a 3-year reprieve.
	Prompted by a report from Bruno Haible that mingw lacks ftruncate.

2007-02-18  Bruno Haible  <bruno@clisp.org>

	* lib/readlink.c: Include <unistd.h>.
	* m4/readlink.m4 (gl_FUNC_READLINK): Require gl_UNISTD_H_DEFAULTS. Set
	HAVE_READLINK.
	* modules/readlink (Depends-on): Add unistd.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.
	(Include): Add <unistd.h>.

	* lib/getlogin_r.h: Remove file.
	* lib/getlogin_r.c: Include <unistd.h> instead of getlogin_r.h.
	* m4/getlogin_r.m4 (gl_GETLOGIN_R_SUBSTITUTE): Remove macro.
	(gl_GETLOGIN_R): Inline it here. Require gl_UNISTD_H_DEFAULTS. Set
	HAVE_DECL_GETLOGIN_R.
	* modules/getlogin_r (Files): Remove lib/getlogin_r.h.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.
	(Include): Use <unistd.h> instead of getlogin_r.h.

	* lib/getcwd.h: Remove file.
	* lib/getcwd.c: Include <unistd.h> instead of getcwd.h.
	* lib/xgetcwd.c: Likewise.
	* m4/getcwd.m4 (gl_FUNC_GETCWD): Require gl_UNISTD_H_DEFAULTS. Set
	REPLACE_GETCWD. Don't define __GETCWD_PREFIX.
	* modules/getcwd (Files): Remove lib/getcwd.h.
	(Depends-on): Add unistd.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.
	(Include): Use <unistd.h> instad of getcwd.h.

	* lib/ftruncate.c: Include <unistd.h> first.
	* m4/ftruncate.m4 (gl_FUNC_FTRUNCATE): Require gl_UNISTD_H_DEFAULTS.
	Set HAVE_FTRUNCATE.
	* modules/ftruncate (Depends-on): Add unistd.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.

	* lib/fchdir.c: Include <unistd.h> first.
	* lib/dirent_.h: Test REPLACE_FCHDIR, not FCHDIR_REPLACEMENT.
	* m4/fchdir.m4 (gl_FUNC_FCHDIR): Require gl_UNISTD_H_DEFAULTS instead
	of gl_HEADER_UNISTD_DEFAULTS. Set REPLACE_FCHDIR. Don't set UNISTD_H.
	* modules/fchdir (configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.
	(Makefile.am): Substitute also REPLACE_FCHDIR into dirent.h.

	* lib/dup2.c: Include <unistd.h> first.
	* m4/dup2.m4 (gl_FUNC_DUP2): Require gl_UNISTD_H_DEFAULTS. Set
	HAVE_DUP2.
	* modules/dup2 (Depends-on): Add unistd.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.

	* lib/chown.c: Include <unistd.h> first. Undefine chown later.
	* m4/chown.m4 (gl_FUNC_CHOWN): Require gl_UNISTD_H_DEFAULTS. Set
	REPLACE_CHOWN. Don't define chown as a macro here.
	* modules/chown (Depends-on): Add unistd.
	(configure.ac): Invoke gl_UNISTD_MODULE_INDICATOR.

	* lib/unistd_.h: Test HAVE_UNISTD_H determined at configure time.
	Add definition for GL_LINK_WARNING.
	(chown, dup2): New declarations.
	(fchdir): Test REPLACE_FCHDIR, not FCHDIR_REPLACEMENT. Provide optional
	link warning.
	(ftruncate): New declaration.
	(getcwd): New declaration, taken from old getcwd.h.
	(getlogin_r): New declaration, taken from old getlogin_r.h.
	(readlink): New declaration.
	* m4/unistd_h.m4 (gl_UNISTD_H): Renamed from gl_HEADER_UNISTD. Don't
	set UNISTD_H. Inline gl_PREREQ_UNISTD. Set HAVE_UNISTD_H.
	(gl_PREREQ_UNISTD): Remove macro.
	(gl_UNISTD_MODULE_INDICATOR): New macro.
	(gl_UNISTD_H_DEFAULTS): Renamed from gl_HEADER_UNISTD_DEFAULTS. Set
	many new variables. Don't set UNISTD_H.
	* modules/unistd (Description): Change.
	(Depends-on): Add link-warning.
	(configure.ac): Update.
	(Makefile.am): Create unistd.h always. Substitute many new variables
	into it.

2007-02-18  Bruno Haible  <bruno@clisp.org>

	* lib/stdlib_.h (getsubopt): New declaration, copied from getsubopt.h.
	* modules/stdlib (stdlib.h): Also substitute GNULIB_GETSUBOPT and
	HAVE_GETSUBOPT.
	* m4/stdlib_h.m4 (gl_STDLIB_H_DEFAULTS): Also initialize
	GNULIB_GETSUBOPT and HAVE_GETSUBOPT.
	* lib/getsubopt.h: Remove file.
	* modules/getsubopt (Files): Remove lib/getsubopt.h.
	(Depends-on): Add stdlib.
	(configure.ac): Invoke gl_STDLIB_MODULE_INDICATOR.
	(Includes): Use <stdlib.h> instead of getsubopt.h.
	* m4/getsubopt.m4 (gl_FUNC_GETSUBOPT): Require gl_STDLIB_H_DEFAULTS.
	Set HAVE_GETSUBOPT.
	* lib/getsubopt.c: Don't include getsubopt.h.

2007-02-18  Bruno Haible  <bruno@clisp.org>

	* modules/fchdir (Depends-on): Add dup2.

2007-02-18  Bruno Haible  <bruno@clisp.org>

	* lib/stdlib_.h: Handle glibc's special invocation convention
	specially.

2007-02-18  Bruno Haible  <bruno@clisp.org>

	* modules/stdlib-tests: New file.
	* tests/test-stdlib.c: New file.

	* modules/mkstemp (Files): Remove lib/mkstemp.h.
	(Depends-on): Add stdlib.
	(configure.ac): Invoke gl_STDLIB_MODULE_INDICATOR.
	(Includes): Use <stdlib.h> instead of mkstemp.h.
	* m4/mkstemp.m4 (gl_FUNC_MKSTEMP): Require gl_STDLIB_H_DEFAULTS. Set
	REPLACE_MKSTEMP. Remove definition of __MKSTEMP_PREFIX.
	* lib/mkstemp.c: Don't include mkstemp.h.
	* lib/mkstemp-safer.c: Include <stdlib.h> instead of mkstemp.h.
	* lib/stdlib--.h: Don't include mkstemp.h.

	* modules/mkdtemp (Files): Remove lib/mkdtemp.h.
	(Depends-on): Add stdlib.
	(configure.ac): Invoke gl_STDLIB_MODULE_INDICATOR.
	(Includes): Use <stdlib.h> instead of mkdtemp.h.
	* m4/mkdtemp.m4 (gt_FUNC_MKDTEMP): Require gl_STDLIB_H_DEFAULTS. Set
	HAVE_MKDTEMP.
	* lib/mkdtemp.c: Don't include mkdtemp.h.
	* lib/clean-temp.c: Don't include mkdtemp.h.

	* modules/exit (Files): Remove lib/exit.h.
	(Depends-on): Add stdlib.
	(Makefile.am): Remove lib_SOURCES.
	(Include): Use <stdlib.h> instead of exit.h.
	* lib/argmatch.c: Don't include exit.h.
	* lib/execute.c: Likewise.
	* lib/pagealign_alloc.c: Likewise.
	* lib/pipe.c: Likewise.
	* lib/wait-process.c: Likewise.
	* lib/copy-file.c: Include <stdlib.h> instead of exit.h.
	* lib/exitfail.c: Likewise.
	* lib/savewd.c: Likewise.
	* lib/xsetenv.c: Likewise.

	* modules/stdlib: New file.
	* lib/stdlib_.h: New file, incorporating exit.h, mkdtemp.h, mkstemp.h
	and extra comments about mkstemp().
	* lib/exit.h: Remove file.
	* lib/mkdtemp.h: Remove file.
	* lib/mkstemp.h: Remove file.
	* m4/stdlib_h.m4: New file.
	* MODULES.html.sh (Support for systems lacking ANSI C 89): Add stdlib.

2007-02-18  Bruno Haible  <bruno@clisp.org>

	* modules/math-tests: New file.
	* tests/test-math.c: New file.

	* modules/math: New file.
	* modules/mathl (Files): Remove lib/mathl.h.
	(Depends-on): Add math.
	(Makefile.am): Don't mention mathl.h.
	(Include): Use <math.h> instead of mathl.h.
	* lib/math_.h: New file.
	* lib/mathl.h: Remove file.
	* lib/acosl.c: Include <config.h> and <math.h> first. Don't include
	mathl.h.
	* lib/asinl.c: Likewise.
	* lib/atanl.c: Likewise.
	* lib/ceill.c: Likewise.
	* lib/cosl.c: Likewise.
	* lib/expl.c: Likewise.
	* lib/floorl.c: Likewise.
	* lib/frexpl.c: Likewise.
	* lib/ldexpl.c: Likewise.
	* lib/logl.c: Likewise.
	* lib/sincosl.c: Likewise.
	* lib/sinl.c: Likewise.
	* lib/sqrtl.c: Likewise.
	* lib/tanl.c: Likewise.
	* lib/trigl.c: Likewise.
	* m4/math_h.m4: New file.
	* MODULES.html.sh (Mathematics): Add math.

2007-02-17  Bruno Haible  <bruno@clisp.org>

	* modules/wctype-tests: New file.
	* tests/test-wctype.c: New file.

	* modules/wchar-tests: New file.
	* tests/test-wchar.c: New file.

	* modules/unistd-tests: New file.
	* tests/test-unistd.c: New file.

	* modules/time-tests: New file.
	* tests/test-time.c: New file.

	* modules/sysexits-tests: New file.
	* tests/test-sysexits.c: New file.

	* modules/sys_time-tests: New file.
	* tests/test-sys_time.c: New file.

	* modules/sys_stat-tests: New file.
	* tests/test-sys_stat.c: New file.

	* modules/sys_socket-tests: New file.
	* tests/test-sys_socket.c: New file.

	* modules/sys_select-tests: New file.
	* tests/test-sys_select.c: New file.

	* modules/string-tests: New file.
	* tests/test-string.c: New file.

	* modules/stdbool-tests: New file.
	* tests/test-stdbool.c: New file.

	* modules/netinet_in-tests: New file.
	* tests/test-netinet_in.c: New file.

	* modules/inttypes-tests: New file.
	* tests/test-inttypes.c: New file.

	* modules/fcntl-tests: New file.
	* tests/test-fcntl.c: New file.

	* modules/byteswap-tests: New file.
	* tests/test-byteswap.c: New file.

	* modules/arpa_inet-tests: New file.
	* tests/test-arpa_inet.c: New file.

2007-02-17  Bruno Haible  <bruno@clisp.org>

	* lib/inttypes_.h: Add definition for GL_LINK_WARNING.
	(imaxabs, imaxdiv, strtoimax, strtoumax): Don't declare the function
	if the corresponding module is not enabled. Emit link warnings if
	the function is used nevertheless.
	* m4/inttypes.m4 (gl_INTTYPES_H): Never use the existing <inttypes.h>.
	Don't AC_SUBST HAVE_DECL_IMAXABS, HAVE_DECL_IMAXDIV,
	HAVE_DECL_STRTOIMAX, HAVE_DECL_STRTOUMAX.
	(gl_INTTYPES_MODULE_INDICATOR, gl_INTTYPES_H_DEFAULTS): New macros.
	* modules/inttypes (Depends-on): Add link-warning.
	(Makefile.am): Copy the contents of build-aux/link-warning.h into
	inttypes.h. Substitute also GNULIB_IMAXABS, GNULIB_IMAXDIV,
	GNULIB_STRTOIMAX, GNULIB_STRTOUMAX.
	* modules/imaxabs (configure.ac): Invoke gl_INTTYPES_MODULE_INDICATOR.
	* modules/imaxdiv (configure.ac): Likewise.
	* modules/strtoimax (configure.ac): Likewise.
	* modules/strtoumax (configure.ac): Likewise.

2007-02-17  Bruno Haible  <bruno@clisp.org>

	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Include the contents of
	gl_STRING_MODULE_INDICATOR_DEFAULTS.
	(gl_STRING_MODULE_INDICATOR_DEFAULTS): Remove macro.
	(gl_HEADER_STRING_H_BODY, gl_STRING_MODULE_INDICATOR): Update.

2007-02-17  Bruno Haible  <bruno@clisp.org>

	* modules/link-warning: New file.
	* build-aux/link-warning.h: New file, extracted from lib/string_.h.
	* lib/string_.h (GL_LINK_WARNING): Remove definition.
	* modules/string (Depends-on): Add link-warning.
	(Makefile.am): Copy the contents of build-aux/link-warning.h into
	string.h.
	* MODULES.html.sh (Support for building libraries and executables): Add
	link-warning.

2007-02-17  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h (memmem, mempcpy, memrchr, stpcpy, stpncpy, strcasecmp,
	strncasecmp, strchr, strchrnul, strdup, strndup, strnlen, strcspn,
	strpbrk, strspn, strrchr, strsep, strstr, strcasestr, strtok_r): Break
	long lines.

2007-02-17  Ben Pfaff  <blp@cs.stanford.edu>
	    Bruno Haible  <bruno@clisp.org>

	* modules/tmpfile: New file.
	* lib/tmpfile.c: New file.
	* m4/tmpfile.m4: New file.
	* MODULES.html.sh (func_all_modules): New section "Input/output".

2007-02-15  Bruno Haible  <bruno@clisp.org>

	* lib/clean-temp.c [WIN32 && !CYGWIN]: Include <windows.h>.
	(supports_delete_on_close): New function.
	(open_temp, fopen_temp): Use _O_TEMPORARY when supported.

2007-02-14  Bruno Haible  <bruno@clisp.org>

	* modules/mbspcasecmp-tests: New file.
	* tests/test-mbspcasecmp.sh: New file.
	* tests/test-mbspcasecmp.c: New file.

	New module mbspcasecmp.
	* modules/mbspcasecmp: New file.
	* lib/mbspcasecmp.c: New file.
	* lib/string_.h (strncasecmp): Change warning message.
	(mbspcasecmp): New declaration.
	* m4/mbspcasecmp.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSPCASECMP.
	* modules/string (string.h): Also substitute GNULIB_MBSPCASECMP.
	* MODULES.html.sh (Internationalization functions): Add mbspcasecmp.

2007-02-14  Bruno Haible  <bruno@clisp.org>

	* modules/mbsncasecmp-tests: New file.
	* tests/test-mbsncasecmp.sh: New file.
	* tests/test-mbsncasecmp.c: New file.

	New module mbsncasecmp.
	* modules/mbsncasecmp: New file.
	* lib/mbsncasecmp.c: New file.
	* lib/string_.h (mbsncasecmp): New declaration.
	* m4/mbsncasecmp.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSNCASECMP.
	* modules/string (string.h): Also substitute GNULIB_MBSNCASECMP.
	* MODULES.html.sh (Internationalization functions): Add mbsncasecmp.

2007-02-14  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/exclude.c (FNM_EXTMATCH): Define if system does not.
	Verify that it doesn't overlap with our flags.
	(fnmatch_no_wildcards): Don't use strcasecmp or strncasecmp, which
	do not have the desired effect in multibyte locales; instead, use
	mbscasecmp.
	* modules/exclude (Depends-on): Depend on mbscasecmp, not strcase.
	Add dependency on xalloc.  Depend on fnmatch, not fnmatch-gnu, since
	we don't require GNU fnmatch ourselves (if our users require it, they
	should do so explicitly).

	Fix regex code so it doesn't rely on strcasecmp.
	* lib/regex_internal.h: Include <langinfo.h> only if _LIBC is defined.
	Otherwise, include gnulib's langinfo.h.
	* lib/regcomp.c (init_dfa): Don't use strcasecmp, as it can have
	undesirable behavior in non-C locales.  Instead, rely on localecharset.
	* m4/regex.m4 (gl_PREREQ_REGEX): Don't require AM_LANGINFO_CODESET.
	* modules/regex (FILES): Remove m4/codeset.m4.
	(Depends-on): Add localcharset.  Remove strcase.

2007-02-13  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/unlinkdir.m4 (gl_UNLINKDIR): Fix m4 quoting bug.
	* m4/unlink-busy.m4 (gl_FUNC_UNLINK_BUSY_TEXT): Likewise.

2007-02-13  Bruno Haible  <bruno@clisp.org>

	* m4/intdiv0.m4 (gt_INTDIV0): Assume ANSI C. Fix underquoting bug.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2007-02-12  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h (memmem, mempcpy, memrchr, stpcpy, stpncpy, strchrnul,
	strdup, strndup, strnlen, strpbrk, strsep, strtok_r): If
	GNULIB_POSIXCHECK and the gnulib module not enabled, provoke a link-
	time warning rather than a link error.

2007-02-12  Bruno Haible  <bruno@clisp.org>

	* m4/locale-fr.m4 (gt_LOCALE_FR): Fix m4 quoting bug.
	* m4/locale-zh.m4 (gt_LOCALE_ZH_CN): Likewise.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2007-02-12  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/string_.h (strncasecmp): Fix typo: this macro takes 3
	args, not 2.

2007-02-12  Paul Eggert  <eggert@cs.ucla.edu>

	New module 'time', so that apps can include <time.h> as per
	POSIX and GNU instead of separate include files like time_r.h
	and timegm.h.  This implementation tries out a simpler approach
	for replacing decls in standard include files (as compared to
	the string module), somewhat as an experiment.

	* config/srclist.txt: Comment out mktime.c for now.
	* doc/gnulib-tool.texi (Initial import): Don't use time_r as an example
	since it doesn't apply any more.  Use generic wording instead.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): New module
	'time'.
	* lib/time_.h, m4/time_h.m4, modules/time: New files.
	* lib/strptime.h, lib/time_r.h, lib/timegm.h: Remove.
	* lib/mktime.c: Include config.h depending on _LIBC, not HAVE_CONFIG_H.
	Don't include <sys/types.h>; no longer needed since we assume C89.
	* lib/mktime.c: Don't include "time_r.h"; no longer needed.
	* lib/strftime.c: Likewise.
	* lib/time_r.c: Likewise.
	* lib/nanosleep.c (nanosleep): #undef after include files, not before.
	* lib/nanosleep.c: Include <time.h> first, to check interface.
	* lib/strptime.c: Likewise.
	* lib/time_r.c: Likewise.
	* lib/timegm.c: Likewise.
	* lib/strptime.c: Don't include strptime.h or time_r.h; no longer
	needed.
	* lib/timegm.c: Don't include timegm.h; no longer needed.
	* lib/timespec.h: Don't include <sys/time.h> before <time.h>;
	time.h now handles any problems in that area.
	(struct timespec, nanosleep): Remove; time.h now arranges for these.
	* lib/xnanosleep.c: Don't include timespec.h; no longer needed now
	that time.h defines struct timespec.
	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP): Check that nanosleep is declared.
	Set REPLACE_NANOSLEEP.  Don't AC_DEFINE nanosleep; the time module now
	handles that.
	* m4/strptime.m4 (gl_FUNC_STPRTIME): Set REPLACE_STRPTIME.
	* m4/time_r.m4 (gl_TIME_R): Don't define HAVE_TIME_R_POSIX; no longer
	needed.  Set REPLACE_LOCALTIME.
	* m4/timegm.m4 (gl_FUNC_TIMEGM): Set REPLACE_TIMEGM.
	* m4/timespec.m4 (gl_CHECK_TYPE_STRUCT_TIMESPEC): Move to time_h.m4.
	(gl_TIMESPEC): Don't check for sys/time.h or struct timespec or
	nanosleep; time_h.m4 now does that.  Don't require
	gl_USE_SYSTEM_EXTENSIONS; no longer needed directly, and the time
	module handles this now.
	* modules/getdate (Depends-on): Remove timespec.  Add time.
	* modules/nanosleep (Depends-on): Likewise.
	* modules/stat-time (Depends-on): Likewise.
	* modules/nanosleep (Include): Include time.h, not timespec.h.
	* modules/strptime (Files): Remove lib/strptime.h.
	(Depends-on): Add extensions, time.
	(Include): Include time.h, not strptime.h.
	* modules/time_r (Files): Remove lib/time_r.h.
	(Depends-on): Add time.
	(Include): Include time.h, not time_r.h.
	* modules/timegm: Likewise.
	* modules/timespec (Description): Now does timespec-related decls
	of our own, instead of struct timespec itself.
	(Depends-on): Add time; remove extensions.
	(Maintainer): Add self.
	* modules/utimecmp (Depends-on): Add time; remove timespec.
	* modules/utimens (Depends-on): Likewise.
	* modules/xnanosleep (Depends-on): Likewise.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	* lib/c-strstr.c: Include allocsa.h.
	(knuth_morris_pratt): Use allocsa/freesa instead of malloc/free.
	* lib/c-strcasestr.c: Include allocsa.h.
	(knuth_morris_pratt): Use allocsa/freesa instead of malloc/free.
	* lib/strcasestr.c: Include allocsa.h.
	(knuth_morris_pratt): Use allocsa/freesa instead of malloc/free.
	* lib/mbsstr.c: Include allocsa.h.
	(knuth_morris_pratt_unibyte, knuth_morris_pratt_multibyte): Use
	allocsa/freesa instead of malloc/free.
	* lib/mbscasestr.c: Include allocsa.h.
	(knuth_morris_pratt_unibyte, knuth_morris_pratt_multibyte): Use
	allocsa/freesa instead of malloc/free.
	* modules/c-strstr (Depends-on): Add allocsa.
	* modules/c-strcasestr (Depends-on): Likewise.
	* modules/strcasestr (Depends-on): Likewise.
	* modules/mbsstr (Depends-on): Likewise.
	* modules/mbscasestr (Depends-on): Likewise.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	* lib/mbsspn.c (mbsspn): Fix bug. Remove unnecessary strlen call.

	* modules/mbsspn-tests: New file.
	* tests/test-mbsspn.sh: New file.
	* tests/test-mbsspn.c: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	* lib/mbspbrk.c (mbspbrk): Remove unneeded cast.

	* modules/mbspbrk-tests: New file.
	* tests/test-mbspbrk.sh: New file.
	* tests/test-mbspbrk.c: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	* lib/mbscspn.c (mbscspn): Remove unnecessary strlen call and
	unneeded cast.

	* modules/mbscspn-tests: New file.
	* tests/test-mbscspn.sh: New file.
	* tests/test-mbscspn.c: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	* modules/mbscasecmp-tests: New file.
	* tests/test-mbscasecmp.sh: New file.
	* tests/test-mbscasecmp.c: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	Ensure O(n) worst-case complexity of mbscasestr.
	* lib/mbscasestr.c: Include stdbool.h.
	(knuth_morris_pratt_unibyte, knuth_morris_pratt_multibyte): New
	functions.
	(mbscasestr): Add some bookkeeping. Invoke knuth_morris_pratt_* when
	the bookkeeping indicates that it's worth it.
	* modules/mbscasestr (Depends-on): Add stdbool, mbslen, strnlen.

	* modules/mbscasestr-tests: New file.
	* tests/test-mbscasestr1.c: New file.
	* tests/test-mbscasestr2.sh: New file.
	* tests/test-mbscasestr2.c: New file.
	* tests/test-mbscasestr3.sh: New file.
	* tests/test-mbscasestr3.c: New file.
	* tests/test-mbscasestr4.sh: New file.
	* tests/test-mbscasestr4.c: New file.
	* m4/locale-tr.m4: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	Ensure O(n) worst-case complexity of mbsstr.
	* lib/mbsstr.c: Include stdbool.h.
	(knuth_morris_pratt_unibyte, knuth_morris_pratt_multibyte): New
	functions.
	(mbsstr): Add some bookkeeping. Invoke knuth_morris_pratt_* when the
	bookkeeping indicates that it's worth it.
	* modules/mbsstr (Depends-on): Add stdbool, mbslen, strnlen.

	* modules/mbsstr-tests: New file.
	* tests/test-mbsstr1.c: New file.
	* tests/test-mbsstr2.sh: New file.
	* tests/test-mbsstr2.c: New file.
	* tests/test-mbsstr3.sh: New file.
	* tests/test-mbsstr3.c: New file.
	* m4/locale-fr.m4: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	* lib/mbsrchr.c (mbsrchr): Fix bug.

	* modules/mbsrchr-tests: New file.
	* tests/test-mbsrchr.sh: New file.
	* tests/test-mbsrchr.c: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	* lib/mbschr.c (mbschr): Fix bug.

	* modules/mbschr-tests: New file.
	* tests/test-mbschr.sh: New file.
	* tests/test-mbschr.c: New file.
	* m4/locale-zh.m4: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	Support for copying multibyte string iterators.
	* lib/mbiter.h: Include <string.h>.
	(mbiter_multi_copy): New function.
	(mbi_copy): New macro.
	* lib/mbuiter.h: Include <string.h>.
	(mbuiter_multi_copy): New function.
	(mbui_copy): New macro.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	New module mbslen.
	* modules/mbslen: New file.
	* lib/mbslen.c: New file.
	* lib/string_.h (mbslen): New declaration.
	* m4/mbslen.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSLEN.
	* modules/string (string.h): Also substitute GNULIB_MBSLEN.
	* MODULES.html.sh (Internationalization functions): Add mbslen.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	Ensure O(n) worst-case complexity of strcasestr substitute.
	* lib/strcasestr.c: Include stdbool.h.
	(knuth_morris_pratt): New function.
	(strcasestr): Add some bookkeeping. Invoke knuth_morris_pratt when the
	bookkeeping indicates that it's worth it.
	* modules/strcasestr (Depends-on): Add stdbool, strnlen.

	* modules/strcasestr-tests: New file.
	* tests/test-strcasestr.c: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	Ensure O(n) worst-case complexity of c_strcasestr.
	* lib/c-strcasestr.c: Include stdbool.h, string.h.
	(knuth_morris_pratt): New function.
	(c_strcasestr): Add some bookkeeping. Invoke knuth_morris_pratt when
	the bookkeeping indicates that it's worth it.
	* modules/c-strcasestr (Depends-on): Add stdbool, strnlen.

	* modules/c-strcasestr-tests: New file.
	* tests/test-c-strcasestr.c: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	Ensure O(n) worst-case complexity of c_strstr.
	* lib/c-strstr.c: Include stdbool.h, string.h.
	(knuth_morris_pratt): New function.
	(c_strstr): Add some bookkeeping. Invoke knuth_morris_pratt when the
	bookkeeping indicates that it's worth it.
	* modules/c-strstr (Depends-on): Add stdbool, strnlen.

	* lib/c-strstr.c: Complete rewrite for maintainability.

	* modules/c-strstr-tests: New file.
	* tests/test-c-strstr.c: New file.

2007-02-11  Bruno Haible  <bruno@clisp.org>

	* m4/javacomp.m4 (gt_JAVACOMP): Work around a 'tr' bug in coreutils
	5.2.1 and earlier, whereby \055 was treated just like the range
	delimiter '-'.
	Reported by Joel E. Denny <jdenny@ces.clemson.edu>.

2007-02-08  Bruno Haible  <bruno@clisp.org>

	* modules/regex (Depends-on): Add stdbool.
	Reported by Dalibor Topic <robilad@kaffe.org>.

2007-02-05  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/regex.m4 (gl_REGEX): Check for glibc bug #3957.
	Prefer returning from main to exiting from it.
	Remove unnecessary parens after sizeof.

2007-02-05  Bruno Haible  <bruno@clisp.org>

	New module mbssep.
	* modules/mbssep: New file.
	* lib/mbssep.c: New file.
	* lib/string_.h (strsep): Add a conditional link warning.
	(mbssep): New declaration.
	* m4/mbssep.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSSEP.
	* modules/string (string.h): Also substitute GNULIB_MBSSEP.
	* MODULES.html.sh (Internationalization functions): Add mbssep.

2007-02-05  Bruno Haible  <bruno@clisp.org>

	* lib/strsep.c (strsep): Fix actions in case of no delimiters.
	Optimize search in case of 1 delimiter.

2007-02-05  Paolo Bonzini  <bonzini@gnu.org>

	* lib/acl.h: Include sys/types.h before sys/acl.h.

2007-02-05  Paolo Bonzini  <bonzini@gnu.org>

	Merge upstream fix for glibc bugzilla #3957:

	2007-02-05  Jakub Jelinek  <jakub@redhat.com>

	* lib/regcomp.c (parse_bracket_exp): Set '\n' bit rather than '\0'
	bit for RE_HAT_LISTS_NOT_NEWLINE.
	(build_charclass_op): Remove bogus comment.

2007-02-05  Simon Josefsson  <simon@josefsson.org>

	* lib/gc.h, lib/gc-libgcrypt.c: Support SHA-256/384/512.

2007-02-04  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getsubopt.c [!_LIBC]: Include config.h and getsubopt.h.
	* lib/memmem.c [!defined _LIBC]: Include config.h.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h (GL_LINK_WARNING2): Put the word "warning:" into the
	warning message.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbstok_r.
	* modules/mbstok_r: New file.
	* lib/mbstok_r.c: New file.
	* lib/string_.h (strtok_r): Change argument names to match the
	comments. Add a conditional link warning.
	(mbstok_r): New declaration.
	* m4/mbstok_r.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSTOK_R.
	* modules/string (string.h): Also substitute GNULIB_MBSTOK_R.
	* MODULES.html.sh (Internationalization functions): Add mbstok_r.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbsspn.
	* modules/mbsspn: New file.
	* lib/mbsspn.c: New file.
	* lib/string_.h (strspn): Add a conditional link warning.
	(mbsspn): New declaration.
	* m4/mbsspn.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSSPN.
	* modules/string (string.h): Also substitute GNULIB_MBSSPN.
	* MODULES.html.sh (Internationalization functions): Add mbsspn.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbspbrk.
	* modules/mbspbrk: New file.
	* lib/mbspbrk.c: New file.
	* lib/string_.h (strpbrk): Add a conditional link warning.
	(mbspbrk): New declaration.
	* m4/mbspbrk.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSPBRK.
	* modules/string (string.h): Also substitute GNULIB_MBSPBRK.
	* MODULES.html.sh (Internationalization functions): Add mbspbrk.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbscspn.
	* modules/mbscspn: New file.
	* lib/mbscspn.c: New file.
	* lib/string_.h (strcspn): Add a conditional link warning.
	(mbscspn): New declaration.
	* m4/mbscspn.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSCSPN.
	* modules/string (string.h): Also substitute GNULIB_MBSCSPN.
	* MODULES.html.sh (Internationalization functions): Add mbscspn.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbscasestr, reduced goal of strcasestr.
	* modules/mbscasestr: New file.
	* lib/mbscasestr.c: New file, copied from lib/strcasestr.c.
	(mbscasestr): Renamed from strcasestr.
	* lib/strcasestr.c: Don't include mbuiter.h.
	(strcasestr): Remove support for multibyte locales.
	* lib/string_.h (strcasestr): Don`t rename. Declare only if missing.
	Change the conditional link warning.
	(mbscasestr): New declaration.
	* m4/mbscasestr.m4: New file.
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR): Enable the replacement only if
	the system does not have strcasestr. Set HAVE_STRCASESTR instead of
	REPLACE_STRCASESTR.
	(gl_PREREQ_STRCASESTR): Don't require gl_FUNC_MBRTOWC.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Initialize
	HAVE_STRCASESTR instead of REPLACE_STRCASESTR.
	(gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize GNULIB_MBSCASESTR.
	* modules/string (string.h): Also substitute GNULIB_MBSCASESTR.
	Substitute HAVE_STRCASESTR instead of REPLACE_STRCASESTR.
	* modules/strcasestr (Files): Remove m4/mbrtowc.m4.
	(Depends-on): Remove mbuiter.
	* MODULES.html.sh (Internationalization functions): Add mbscasestr.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	Simplify handling of strncasecmp.
	* lib/string_.h (strncasecmp): Remove test for GNULIB_STRCASE. Change
	the conditional link warning.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Initialize
	HAVE_STRCASECMP, not REPLACE_STRCASECMP.
	(gl_STRING_MODULE_INDICATOR_DEFAULTS): Don't initialize GNULIB_STRCASE.
	* modules/strcase (configure.ac): Don't invoke
	gl_STRING_MODULE_INDICATOR.
	* modules/string (string.h): Don't substitute GNULIB_STRCASE.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbscasecmp, reduced goal of strcasecmp.
	* modules/mbscasecmp: New file.
	* lib/mbscasecmp.c: New file, copied from lib/strcasecmp.c.
	(mbscasecmp): Renamed from strcasecmp.
	* lib/strcasecmp.c: Don't include mbuiter.h.
	(strcasecmp): Remove support for multibyte locales.
	* lib/string_.h (strcasecmp): Don`t rename. Declare only if missing.
	Change the conditional link warning.
	(mbscasecmp): New declaration.
	* m4/mbscasecmp.m4: New file.
	* m4/strcase.m4 (gl_FUNC_STRCASECMP): Enable the replacement only if
	the system lacks strcasecmp. Set HAVE_STRCASECMP instead of
	REPLACE_STRCASECMP.
	(gl_PREREQ_STRCASECMP): Don't require gl_FUNC_MBRTOWC.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSCASECMP.
	* modules/string (string.h): Also substitute GNULIB_MBSCASECMP.
	Substitute HAVE_STRCASECMP instead of REPLACE_STRCASECMP.
	* modules/strcase (Files): Remove m4/mbrtowc.m4.
	(Depends-on): Remove mbuiter.
	* MODULES.html.sh (Internationalization functions): Add mbscasecmp.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbsstr. Remove module strstr.
	* modules/mbsstr: New file.
	* modules/strstr: Remove file.
	* lib/mbsstr.c: Renamed from lib/strstr.c.
	(mbsstr): Renamed from strstr.
	* lib/string_.h (strstr): Remove declaration. Change the conditional
	link warning.
	(mbsstr): New declaration.
	* m4/mbsstr.m4: New file.
	* m4/strstr.m4: Remove file.
	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): Don't initialize
	REPLACE_STRSTR.
	(gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize GNULIB_MBSSTR.
	Don't initialize GNULIB_STRSTR.
	* modules/string (string.h): Also substitute GNULIB_MBSSTR. Don't
	substitute GNULIB_STRSTR and REPLACE_STRSTR.
	* MODULES.html.sh (Internationalization functions): Add mbsstr.
	(Support for systems lacking ANSI C 89): Remove strstr.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbsrchr.
	* modules/mbsrchr: New file.
	* lib/mbsrchr.c: New file.
	* lib/string_.h (strrchr): Add a conditional link warning.
	(mbsrchr): New declaration.
	* m4/mbsrchr.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSRCHR.
	* modules/string (string.h): Also substitute GNULIB_MBSRCHR.
	* MODULES.html.sh (Internationalization functions): Add mbsrchr.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module mbschr.
	* modules/mbschr: New file.
	* lib/mbschr.c: New file.
	* lib/string_.h (strchr): Add a conditional link warning.
	(mbschr): New declaration.
	* m4/mbschr.m4: New file.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR_DEFAULTS): Initialize
	GNULIB_MBSCHR.
	* modules/string (string.h): Also substitute GNULIB_MBSCHR.
	* MODULES.html.sh (Internationalization functions): Add mbschr.

2007-02-04  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stdbool_.h: Mention that bool bit-fields aren't supported.

	* modules/stdarg (configure.ac-early): Require AC_PROG_CC_STDC.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	New module description section 'configure.ac-early'.
	* gnulib-tool (sed_extract_prog): Recognize configure.ac-early.
	(func_get_autoconf_early_snippet): New function.
	(func_import, func_create_testdir): Use it. Remove special cases for
	modules 'extensions' and 'lock'.
	* modules/extensions (configure.ac-early): Require
	gl_USE_SYSTEM_EXTENSIONS.
	* modules/lock (configure.ac-early): Require gl_LOCK_EARLY.

2007-02-04  Bruno Haible  <bruno@clisp.org>

	Make use of gcj-4.3's -fsource and -ftarget option.
	* m4/javacomp.m4 (gt_JAVACOMP): Test whether gcj is in version >= 4.3,
	and if so try the options -fsource and -ftarget.
	* lib/javacomp.c (compile_using_gcj): Add fsource_option,
	source_version, ftarget_option, target_version arguments.
	(is_envjavac_gcj43, is_envjavac_gcj43_usable): New functions.
	(is_envjavac_oldgcj_14_14_usable): Renamed from
	is_envjavac_gcj_14_14_usable.
	(is_envjavac_oldgcj_14_13_usable): Renamed from
	is_envjavac_gcj_14_13_usable.
	(is_gcj_present): Update.
	(is_gcj_43, is_gcj43_usable): New functions.
	(is_oldgcj_14_14_usable): Renamed from is_gcj_14_14_usable. Update.
	(is_oldgcj_14_13_usable): Renamed from is_gcj_14_13_usable. Update.
	(compile_java_class): Test whether gcj is in version >= 4.3, and if so
	try the options -fsource and -ftarget.

2007-02-03  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/xalloc.h (x2nrealloc): Fix an unlikely bug in the overflow
	checking code.  Set N = ceil (1.5 * N) rather than to a slightly
	larger value.

2007-02-03  Jim Meyering  <jim@meyering.net>

	Give tools a better chance to allocate space for very large buffers.
	* lib/xalloc.h (x2nrealloc): Use 3/2, not 2, as buffer size factor.

	Make pwd and readlink work also when run with an unreadable parent dir
	on systems with openat support.
	* lib/getcwd.c (__getcwd) [HAVE_PARTLY_WORKING_GETCWD]: Use the system
	provided getcwd function, even when we have openat support.
	Reported by Dmitry V. Levin in <http://bugzilla.redhat.com/227168>.

2007-02-02  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h (memmem, mempcpy, memrchr, stpcpy, stpncpy, strchrnul,
	strdup, strndup, strnlen, strpbrk, strsep, strtok_r): Provoke a link
	error only if GNULIB_POSIXCHECK is defined. Needed to avoid artificial
	portability problems if one of these functions is only used on specific
	platforms.
	Reported by Paul Eggert.

2007-02-02  Paul Eggert  <eggert@cs.ucla.edu>

	Avoid mempcpy in the regex code, as the string.h mempcpy stuff
	is causing more trouble than it's curing.
	* lib/regex_internal.h (__mempcpy): Remove.
	* lib/regcomp.c (regerror): Rewrite to avoid the need for mempcpy
	(and make the code a tad smaller to boot).
	* m4/regex.m4 (gl_PREREQ_REGEX): Don't check for mempcpy.

2007-02-02  Jim Meyering  <jim@meyering.net>

	* modules/arpa_inet: Put AC_PROG_MKDIR_P in the configure.ac:
	section, not in the Makefile.am: one.

2007-02-02  Eric Blake  <ebb9@byu.net>

	* lib/strchrnul.c: Always include config.h first.

	* modules/mountlist (Depends-on): Revert 2007-01-31 change,
	gnulib strstr is not necessary here.

2007-02-02  Simon Josefsson  <simon@josefsson.org>

	* m4/socklen.m4: Fix typo.

2007-02-02  Eric Blake  <ebb9@byu.net>

	* modules/arpa_inet (Makefile.am): Use MKDIR_P to avoid races.
	* modules/netinet_in (Makefile.am): Likewise.

2007-02-01  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h (GL_LINK_WARNING): New macro.
	(strcasecmp, strstr, strcasestr): If provided by the system,
	conditionally define as a macro that leads to a warning instead of to
	an error.
	(strncasecmp): Conditionally define as a macro that leads to a warning.

2007-02-01  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (strtok_r.c): lose sync, no more strtok_r.h.

2007-02-01  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Unicode string functions): Update after 2007-01-27
	renamings.

2007-02-01  Eric Blake  <ebb9@byu.net>

	* modules/regex (Depends-on): Revert dependence on mempcpy.
	* lib/regex_internal.h [! _LIBC && !__mempcpy]: Undo string
	module's definition of mempcpy.
	Reported by Paul Eggert.

2007-02-01  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/string_.h: If the gnulib module XYZ is not present, undefine
	the symbol XYZ before redefining it.  This fixes a problem with
	programs that don't use XYZ, when compiled on systems that define
	XYZ to something else.

2007-01-31  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/mkdir-p.c (make_dir_parents): Close a race condition that
	occurs when "mkdir -m foo" creates a setgid directory that is (1)
	writeable to group or other and (2) is intended to have a special
	mode bit that is set or cleared.  In such a case, the directory
	should be neither group- nor other-writeable until the special
	mode bits are right.

2007-01-31  Eric Blake  <ebb9@byu.net>

	* modules/mountlist (Depends-on): Add strstr.

	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR): Correct m4 usage
	bug.
	* modules/string (Makefile.am): Remove redundant replacement.
	* modules/regex (Depends-on): Add mempcpy.

2007-01-31  Bruno Haible  <bruno@clisp.org>

	New module description field 'Link'.
	* gnulib-tool (func_usage): Document --extract-link-directive.
	(sed_extract_prog): Recognize 'Link' directive.
	(func_get_link_directive): New function.
	(func_import): Show summary of link directives.
	Handle --extract-link-directive option.
	* modules/acl (Link): New section.
	* modules/clock-time (Link): New section.
	* modules/euidaccess (Link): New section.
	* modules/gettext (Link): New section.
	* modules/iconv (Link): New section.
	* modules/lock (Link): New section.
	* modules/nanosleep (Link): New section.
	* modules/readline (Link): New section.

2007-01-27  Bruno Haible  <bruno@clisp.org>

	Enforce the use of gnulib modules for unportable <string.h> functions.
	* m4/string_h.m4 (gl_STRING_MODULE_INDICATOR): New macro.
	(gl_STRING_MODULE_INDICATOR_DEFAULTS): New macro.
	(gl_HEADER_STRING_H_BODY): Require it.
	* lib/string_.h: If the gnulib module XYZ is not present, redefine
	the symbol XYZ to one that gives a link error.
	* modules/string (Makefile.am): Also substitute the GNULIB_* variables.
	* modules/memmem (configure.ac): Invoke gl_STRING_MODULE_INDICATOR.
	* modules/mempcpy (configure.ac): Likewise.
	* modules/memrchr (configure.ac): Likewise.
	* modules/stpcpy (configure.ac): Likewise.
	* modules/stpncpy (configure.ac): Likewise.
	* modules/strcase (configure.ac): Likewise.
	* modules/strcasestr (configure.ac): Likewise.
	* modules/strchrnul (configure.ac): Likewise.
	* modules/strdup (configure.ac): Likewise.
	* modules/strndup (configure.ac): Likewise.
	* modules/strnlen (configure.ac): Likewise.
	* modules/strpbrk (configure.ac): Likewise.
	* modules/strsep (configure.ac): Likewise.
	* modules/strstr (configure.ac): Likewise.
	* modules/strtok_r (configure.ac): Likewise.

2007-01-31  Jean-Louis Martineau  <martineau@zmanda.com>  (tiny change)

	* lib/gai_strerror.c (values): Add EAI_OVERFLOW.

2007-01-30  Jim Meyering  <jim@meyering.net>

	* lib/mpsort.c (mpsort): Remove spurious "return" in void function.

2007-01-29  Bruno Haible  <bruno@clisp.org>

	* lib/allocsa.h: Use '#if HAVE_*' instead of '#ifdef HAVE_*'.
	* lib/execute.c: Likewise.
	* lib/pipe.c: Likewise.
	* lib/printf-args.h: Likewise.
	* lib/printf-args.c: Likewise.
	* lib/printf-parse.c: Likewise.
	* lib/vasnprintf.c: Likewise.

2007-01-29  Eric Blake  <ebb9@byu.net>

	* lib/memrchr.c: Assume <string.h> unconditionally, to pull in
	declaration.

2007-01-29  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/strptime.h (strptime): Use 'restrict' for args where
	POSIX requires this.
	* lib/strptime.c (strptime): Likewise.
	Change license notice from LGPL to GPL, since gnulib-tool will
	change this as needed.
	Include <config.h> if _LIBC is not defined, not if HAVE_CONFIG_H is
	defined.
	Include "strptime.h" first, to check interface.
	Do not #undef _LIBC and _NL_CURRENT.
	Do not include <stdlib.h>; no longer needed.
	Include "time_r.h" and declare ptime_locale_status
	only if _LIBC is not defined.
	(__P): Remove unused macro.
	(match_string): Bring back glibc version, but use it only if _LIBC
	is defined.
	(__strptime_internal): Compile tm_gmtoff code if _LIBC is defined, too.
	Remove unnecessary assertion and abort() call.
	Use #ifdef _NL_CURRENT rather than #if 0, for benefit of glibc.
	* m4/strptime.m4: Fix serial number comment.
	(gl_FUNC_STRPTIME): Require AC_C_RESTRICT, gl_TM_GMTOFF.
	* modules/strptime (Files): Add m4/tm_gmtoff.m4.
	(Depends-on): Add time_r.

2007-01-29  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add
	strptime.
	* modules/strptime (Depends-on): Add stdbool.
	* lib/strptime.h: Include <time.h> always. Add comments.

2007-01-29  Yoann Vandoorselaere  <yoann@prelude-ids.org>

	* modules/strptime: New file.
	* lib/strptime.h: New file.
	* lib/strptime.c: New file.
	* m4/strptime.m4: New file.

2007-01-28  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh: New module mpsort.
	* lib/mpsort.c, lib/mpsort.h, m4/mpsort.m4, modules/mpsort: New files.

	* lib/regex.h (_Restrict_): Renamed from __restrict, to avoid
	a circularity problem with HP-UX ia64 reported by Bob Proulx in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-01/msg00394.html>.
	All uses changed.
	(_Restrict_arr_): Renamed from __restrict_arr, for similar reasons.
	All uses changed.
	* lib/regcomp.c, lib/regexec.c: Change all uses from __restrict
	to _Restrict_.
	* lib/regexec.c (regexec): Declare pmatch with _Restrict_arr_, so that
	the parameter matches the prototype.

2007-01-28  Jim Meyering  <jim@meyering.net>

	* modules/sys_time (Makefile.am) [MOSTLYCLEANFILES]: Do use
	sys/time.h here, reverting that part of the previous patch:
	<http://thread.gmane.org/gmane.comp.lib.gnulib.bugs/8959>.

2007-01-28  Bruno Haible  <bruno@clisp.org>

	* modules/sys_time (Makefile.am): Build sys/time.h only when it's the
	value of $(SYS_TIME_H).
	[MOSTLYCLEANFILES]: Now that sys/time.h is created only when needed,
	remove it conditionally, too. [added by Jim Meyering]
	* m4/sys_time_h.m4 (gl_HEADER_SYS_TIME_H_BODY): Set SYS_TIME_H.
	* m4/gettimeofday.m4 (gl_FUNC_GETTIMEOFDAY):
	(gl_FUNC_GETTIMEOFDAY_CLOBBER): Set SYS_TIME_H when setting
	GETTIMEOFDAY_REPLACEMENT to 1.

2007-01-28  Bruno Haible  <bruno@clisp.org>

	* m4/unistd_h.m4 (gl_HEADER_UNISTD_DEFAULTS): New macro.
	(gl_HEADER_UNISTD): Require it. Don't set UNISTD_H to empty here.
	* m4/fchdir.m4 (gl_FUNC_FCHDIR): Require gl_HEADER_UNISTD_DEFAULTS.
	Set UNISTD_H instead of UNISTD_H2.
	* modules/fchdir (BUILT_SOURCES): Drop $(UNISTD_H2).

2007-01-28  Bruno Haible  <bruno@clisp.org>

	* modules/mbchar (Makefile.am): Add mbchar.c to lib_SOURCES.
	* m4/mbchar.m4 (gl_MBCHAR): Remove AC_LIBOBJ invocation.

2007-01-28  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_emit_lib_Makefile_am, func_add_or_update)
	(func_create_testdir): Ensure C locale for `grep' and `tr'
	character ranges.
	(func_create_megatestdir): Avoid one `grep'.  Fix bug in
	ACLOCAL_AMFLAGS parsing state machine.

2007-01-27  Bruno Haible  <bruno@clisp.org>

	* modules/unistr/base: Update.

2007-01-27  Bruno Haible  <bruno@clisp.org>

	Rename u32-mbtouc -> u32-mbtouc-unsafe, u32-mbtouc-safe -> u32-mbtouc,
	u32_mbtouc -> u32_mbtouc_unsafe, u32_mbtouc_safe -> u32_mbtouc.
	* modules/unistr/u32-mbtouc-unsafe: Renamed from
	modules/unistr/u32-mbtouc.
	* lib/unistr/u32-mbtouc-unsafe.c: Renamed from lib/unistr/u32-mbtouc.c.
	* lib/unistr.h: Update.
	* lib/linebreak.c: Update.
	* modules/unistr/u32-mbtouc: Renamed from
	modules/unistr/u32-mbtouc-safe.
	* lib/unistr/u32-mbtouc.c: Renamed from lib/unistr/u32-mbtouc-safe.c.
	* lib/unistr.h: Update.
	* lib/unistr/u32-to-u8.c: Update.
	* lib/unistr/u32-to-u16.c: Update.

2007-01-27  Bruno Haible  <bruno@clisp.org>

	Rename utf16-ucs4 -> utf16-ucs4-unsafe, utf16-ucs4-safe -> utf16-ucs4,
	u16_mbtouc -> u16_mbtouc_unsafe, u16_mbtouc_safe -> u16_mbtouc.
	* modules/utf16-ucs4-unsafe: Renamed from modules/utf16-ucs4.
	* lib/utf16-ucs4-unsafe.h: Renamed from lib/utf16-ucs4.h.
	* lib/unistr/utf16-ucs4-unsafe.c: Renamed from lib/unistr/utf16-ucs4.c.
	* modules/unistr/u16-mbtouc-unsafe: Renamed from
	modules/unistr/u16-mbtouc.
	* lib/unistr/u16-mbtouc-unsafe.c: Renamed from lib/unistr/u16-mbtouc.c.
	* lib/unistr.h: Update.
	* lib/linebreak.c: Update.
	* modules/linebreak: Update.
	* modules/utf16-ucs4: Renamed from modules/utf16-ucs4-safe.
	* lib/utf16-ucs4.h: Renamed from lib/utf16-ucs4-safe.h.
	* lib/unistr/utf16-ucs4.c: Renamed from lib/unistr/utf16-ucs4-safe.c.
	* modules/unistr/u16-mbtouc: Renamed from
	modules/unistr/u16-mbtouc-safe.
	* lib/unistr/u16-mbtouc.c: Renamed from lib/unistr/u16-mbtouc-safe.c.
	* lib/unistr.h: Update.
	* lib/unistr/u16-to-u8.c: Update.
	* modules/unistr/u16-to-u8: Update.
	* lib/unistr/u16-to-u32.c: Update.
	* modules/unistr/u16-to-u32: Update.

2007-01-27  Bruno Haible  <bruno@clisp.org>

	Rename utf8-ucs4 -> utf8-ucs4-unsafe, utf8-ucs4-safe -> utf8-ucs4,
	u8_mbtouc -> u8_mbtouc_unsafe, u8_mbtouc_safe -> u8_mbtouc.
	* modules/utf8-ucs4-unsafe: Renamed from modules/utf8-ucs4.
	* lib/utf8-ucs4-unsafe.h: Renamed from lib/utf8-ucs4.h.
	* lib/unistr/utf8-ucs4-unsafe.c: Renamed from lib/unistr/utf8-ucs4.c.
	* modules/unistr/u8-mbtouc-unsafe: Renamed from
	modules/unistr/u8-mbtouc.
	* lib/unistr/u8-mbtouc-unsafe.c: Renamed from lib/unistr/u8-mbtouc.c.
	* lib/unistr.h: Update.
	* lib/striconveh.c: Update.
	* modules/striconveh: Update.
	* lib/linebreak.c: Update.
	* modules/linebreak: Update.
	* modules/utf8-ucs4: Renamed from modules/utf8-ucs4-safe.
	* lib/utf8-ucs4.h: Renamed from lib/utf8-ucs4-safe.h.
	* lib/unistr/utf8-ucs4.c: Renamed from lib/unistr/utf8-ucs4-safe.c.
	* modules/unistr/u8-mbtouc: Renamed from modules/unistr/u8-mbtouc-safe.
	* lib/unistr/u8-mbtouc.c: Renamed from lib/unistr/u8-mbtouc-safe.c.
	* lib/unistr.h: Update.
	* lib/striconveh.c: Update.
	* modules/striconveh: Update.
	* lib/unistr/u8-to-u16.c: Update.
	* modules/unistr/u8-to-u16: Update.
	* lib/unistr/u8-to-u32.c: Update.
	* modules/unistr/u8-to-u32: Update.

2007-01-27  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Sync from Libtool.
	* lib/argz.c: Do not include strings.h nor memory.h, include
	string.h unconditionally.  Patch by Simon Josefsson.

2007-01-27  Bruno Haible  <bruno@clisp.org>

	* m4/string_h.m4 (gl_HEADER_STRING_H_DEFAULTS): New macro, extracted
	from gl_HEADER_STRING_H_BODY.
	(gl_HEADER_STRING_H_BODY): Require it.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): Require gl_HEADER_STRING_H_DEFAULTS.
	* m4/mempcpy.m4 (gl_FUNC_MEMPCPY): Likewise.
	* m4/memrchr.m4 (gl_FUNC_MEMRCHR): Likewise.
	* m4/stpcpy.m4 (gl_FUNC_STPCPY): Likewise.
	* m4/stpncpy.m4 (gl_FUNC_STPNCPY): Likewise.
	* m4/strcase.m4 (gl_FUNC_STRCASECMP, gl_FUNC_STRNCASECMP): Likewise.
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR): Likewise.
	* m4/strchrnul.m4 (gl_FUNC_STRCHRNUL): Likewise.
	* m4/strdup.m4 (gl_FUNC_STRDUP): Likewise.
	* m4/strndup.m4 (gl_FUNC_STRNDUP): Likewise.
	* m4/strnlen.m4 (gl_FUNC_STRNLEN): Likewise.
	* m4/strpbrk.m4 (gl_FUNC_STRPBRK): Likewise.
	* m4/strsep.m4 (gl_FUNC_STRSEP): Likewise.
	* m4/strstr.m4 (gl_FUNC_STRSTR): Likewise.
	* m4/strtok_r.m4 (gl_FUNC_STRTOK_R): Likewise.

2007-01-27  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): If $for_test is true, turn
	check_PROGRAMS into noinst_PROGRAMS.
	(func_emit_tests_Makefile_am): Likewise. Also don't initialize
	check_PROGRAMS in this case.
	(func_import): Set for_test to false.
	(func_create_testdir): Set for_test to true.

2007-01-27  Yoann Vandoorselaere <yoann.v@prelude-ids.com>
	    Bruno Haible  <bruno@clisp.org>

	* modules/strcasestr (Files): Remove lib/strcasestr.h.
	(Depends-on): Add string.
	(Includes): Use <string.h> instead of strcasestr.h.
	* modules/string (Makefile.am): Also substitute the value of
	REPLACE_STRCASESTR.
	* m4/strcasestr.m4 (gl_FUNC_STRCASESTR): Don't define strcasestr here;
	assume strcasestr is declared in <string.h> not <strings.h>. Also
	set REPLACE_STRCASESTR.
	* m4/string_h.m4 (gl_HEADER_STRING_H_BODY): Provide a default value for
	REPLACE_STRCASESTR.
	* lib/strcasestr.h: Remove file.
	* lib/strcasestr.c: Include <string.h> instead of strcasestr.h.
	* lib/string_.h (strcasestr): New declaration.

2007-01-27  Bruno Haible  <bruno@clisp.org>

	* lib/string_.h: Use 'extern'.

2007-01-27  Jim Meyering  <jim@meyering.net>

	* lib/regex_internal.c (re_string_reconstruct): Remove declaration
	of set-but-not-used local, "q".

	* lib/mempcpy.c: Include <config.h> before <string.h>.
	This fixes a compilation error on HP-UX, due to the system's
	"restrict"-using mempcpy prototype.

2007-01-26  Bruno Haible  <bruno@clisp.org>

	Small optimization.
	* lib/javacomp.c: Include c-strstr.h.
	 (is_envjavac_gcj): Use c_strstr instead of strstr.
	* modules/javacomp (Depends-on): Add c-strstr, remove strstr.

2007-01-26  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Unicode string functions): Add the new modules.

	* modules/uniconv/u32-strconv-to-locale: New file.
	* lib/uniconv/u32-strconv-to-locale.c: New file.

	* modules/uniconv/u16-strconv-to-locale: New file.
	* lib/uniconv/u16-strconv-to-locale.c: New file.

	* modules/uniconv/u8-strconv-to-locale: New file.
	* lib/uniconv/u8-strconv-to-locale.c: New file.

	* modules/uniconv/u32-strconv-from-locale: New file.
	* lib/uniconv/u32-strconv-from-locale.c: New file.

	* modules/uniconv/u16-strconv-from-locale: New file.
	* lib/uniconv/u16-strconv-from-locale.c: New file.

	* modules/uniconv/u8-strconv-from-locale: New file.
	* lib/uniconv/u8-strconv-from-locale.c: New file.

	* modules/uniconv/u32-strconv-to-enc: New file.
	* lib/uniconv/u32-strconv-to-enc.c: New file.
	* modules/uniconv/u32-strconv-to-enc-tests: New file.
	* tests/uniconv/test-u32-strconv-to-enc.c: New file.

	* modules/uniconv/u16-strconv-to-enc: New file.
	* lib/uniconv/u16-strconv-to-enc.c: New file.
	* lib/uniconv/u-strconv-to-enc.h: New file.
	* modules/uniconv/u16-strconv-to-enc-tests: New file.
	* tests/uniconv/test-u16-strconv-to-enc.c: New file.

	* modules/uniconv/u8-strconv-to-enc: New file.
	* lib/uniconv/u8-strconv-to-enc.c: New file.
	* modules/uniconv/u8-strconv-to-enc-tests: New file.
	* tests/uniconv/test-u8-strconv-to-enc.c: New file.

	* modules/uniconv/u32-strconv-from-enc: New file.
	* lib/uniconv/u32-strconv-from-enc.c: New file.
	* modules/uniconv/u32-strconv-from-enc-tests: New file.
	* tests/uniconv/test-u32-strconv-from-enc.c: New file.

	* modules/uniconv/u16-strconv-from-enc: New file.
	* lib/uniconv/u16-strconv-from-enc.c: New file.
	* modules/uniconv/u16-strconv-from-enc-tests: New file.
	* tests/uniconv/test-u16-strconv-from-enc.c: New file.

	* modules/uniconv/u8-strconv-from-enc: New file.
	* lib/uniconv/u8-strconv-from-enc.c: New file.
	* lib/uniconv/u-strconv-from-enc.h: New file.
	* modules/uniconv/u8-strconv-from-enc-tests: New file.
	* tests/uniconv/test-u8-strconv-from-enc.c: New file.

	* modules/uniconv/u32-conv-from-enc: New file.
	* lib/uniconv/u32-conv-from-enc.c: New file.
	* modules/uniconv/u32-conv-from-enc-tests: New file.
	* tests/uniconv/test-u32-conv-from-enc.c: New file.

	* modules/uniconv/u16-conv-from-enc: New file.
	* lib/uniconv/u16-conv-from-enc.c: New file.
	* lib/uniconv/u-conv-from-enc.h: New file.
	* modules/uniconv/u16-conv-from-enc-tests: New file.
	* tests/uniconv/test-u16-conv-from-enc.c: New file.

	* modules/uniconv/u8-conv-from-enc: New file.
	* lib/uniconv/u8-conv-from-enc.c: New file.
	* modules/uniconv/u8-conv-from-enc-tests: New file.
	* tests/uniconv/test-u8-conv-from-enc.c: New file.

	* modules/uniconv/base: New file.
	* lib/uniconv.h: New file.

2007-01-26  Paul Eggert  <eggert@cs.ucla.edu>

	* doc/gnulib-tool.texi (Initial import): Update to match current
	behavior with strdup module.
	* lib/.cppi-disable: Remove strcase.h, strdup.h, strndup.h, strnlen.h.
	* lib/memmem.h: Remove; all uses removed.  This is now done
	by <string.h>.
	* lib/mempcpy.h: Likewise.
	* lib/memrchr.h: Likewise.
	* lib/stpcpy.h: Likewise.
	* lib/stpncpy.h: Likewise.
	* lib/strcase.h: Likewise.
	* lib/strchrnul.h: Likewise.
	* lib/strdup.h: Likewise.
	* lib/strndup.h: Likewise.
	* lib/strnlen.h: Likewise.
	* lib/strpbrk.h: Likewise.
	* lib/strsep.h: Likewise.
	* lib/strstr.h: Likewise.
	* lib/strtok_r.h: Likewise.
	* lib/string_.h: New file.
	* lib/argp-namefrob.h: Don't include no-longer-existent include files.
	Rely on <string.h> instead.
	* lib/canon-host.c: Likewise.
	* lib/chdir-long.c: Likewise.
	* lib/concatpath.c: Likewise.
	* lib/exclude.c: Likewise.
	* lib/fchdir.c: Likewise.
	* lib/getaddrinfo.c: Likewise.
	* lib/getcwd.c: Likewise.
	* lib/getsubopt.c: Likewise.
	* lib/glob.c: Likewise.
	* lib/hard-locale.c: Likewise.
	* lib/iconvme.c: Likewise.
	* lib/javacomp.c: Likewise.
	* lib/mempcpy.c: Likewise.
	* lib/memrchr.c: Likewise.
	* lib/regex_internal.h: Likewise.
	* lib/stpncpy.c: Likewise.
	* lib/strcasecmp.c: Likewise.
	* lib/strchrnul.c: Likewise.
	* lib/strdup.c: Likewise.
	* lib/striconv.c: Likewise.
	* lib/striconveh.c: Likewise.
	* lib/striconveha.c: Likewise.
	* lib/strncasecmp.c: Likewise.
	* lib/strndup.c: Likewise.
	* lib/strnlen.c: Likewise.
	* lib/strsep.c: Likewise.
	* lib/strstr.c: Likewise.
	* lib/strtok_r.c: Likewise.
	* lib/userspec.c: Likewise.
	* lib/w32spawn.h: Likewise.
	* lib/xstrndup.c: Likewise.
	* lib/mountlist.c (strstr): Remove decl.
	* m4/string_h.m4: New file.
	* m4/memmem.m4 (gl_FUNC_MEMMEM): Set HAVE_DECL_MEMMEM if necessary.
	* m4/mempcpy.m4 (gl_FUNC_MEMPCPY): Set HAVE_MEMPCPY if necessary.
	* m4/memrchr.m4 (gl_FUNC_MEMRCHR): Set HAVE_MEMRCHR
	* m4/stpcpy.m4 (gl_FUNC_STPCPY): Set HAVE_STPCPY if necessary.
	* m4/stpncpy.m4 (gl_PREREQ_STPNCPY): Set HAVE_STPNCPY if necessary.
	* m4/strcase.m4 (gl_FUNC_STRCASECMP):
	Set REPLACE_STRCASECMP if necessary.
	(gl_FUNC_STRNCASECMP): Set HAVE_DECL_STRNCASECMP if necessary.
	* m4/strchrnul.m4 (gl_FUNC_STRCHRNUL): Set HAVE_STRCHRNUL if necessary.
	* m4/strdup.m4 (gl_FUNC_STRDUP): Set HAVE_DECL_STRDUP if necessary.
	* m4/strndup.m4 (gl_FUNC_STRNDUP): Set HAVE_DECL_STRNLEN and
	HAVE_DECL_STRDUP if necessary.
	(gl_PREREQ_STRNLEN): Don't bother to check for strnlen decl,
	since gl_FUNC_STRNDUP does that now.
	* m4/strnlen.m4 (gl_FUNC_STRNLEN): Set HAVE_DECL_STRNLEN if necessary.
	Check for decl here...
	(gl_PREREQ_STRNLEN): ... not here.
	* m4/strpbrk.m4 (gl_FUNC_STRPBRK): Set HAVE_STRPBRK if necessary.
	* m4/strsep.m4 (gl_FUNC_STRSEP): Set HAVE_STRSEP if necessary.
	* m4/strstr.m4 (gl_FUNC_STRSTR): Set REPLACE_STRSTR if necessary.
	* m4/strtok_r.m4 (gl_FUNC_STRTOK_R): Set HAVE_DECL_STRTOK_R if
	necessary.
	* modules/string: New file.
	* modules/memmem (Files): Remove special-purpose include file.
	(Depends-on): Add string.
	(Include): Include <string.h>, not the removed file.
	* modules/mempcpy: Likewise.
	* modules/memrchr: Likewise.
	* modules/stpcpy: Likewise.
	* modules/stpncpy: Likewise.
	* modules/strcase: Likewise.
	* modules/strchrnul: Likewise.
	* modules/strdup: Likewise.
	* modules/strndup: Likewise.
	* modules/strnlen: Likewise.
	* modules/strpbrk: Likewise.
	* modules/strsep: Likewise.
	* modules/strstr: Likewise.
	* modules/strtok_r: Likewise.
	* tests/test-dirname.c: Don't include "strdup.h", since
	<string.h> now suffices.
	* tests/test-memmem.c: Don't include "memmem.h", since
	<string.h> now suffices.

2007-01-25  Bruno Haible  <bruno@clisp.org>

	* lib/striconveh.c (mem_cd_iconveh_internal): Ignore *lengthp if
	*resultp is 0.

	* lib/unistr/u16-to-u8.c (u16_to_u8): Fix u8_uctomb invocation.
	* lib/unistr/u32-to-u8.c (u32_to_u8): Likewise.
	* lib/unistr/u8-to-u16.c (u8_to_u16): Fix u16_uctomb invocation.
	* lib/unistr/u32-to-u16.c (u32_to_u16): Likewise.

	* modules/unistr/u8-to-u16 (Depends-on): Add missing modules.
	* modules/unistr/u8-to-u32 (Depends-on): Add missing modules.
	* modules/unistr/u16-to-u8 (Depends-on): Add missing modules.
	* modules/unistr/u16-to-u32 (Depends-on): Add missing modules.
	* modules/unistr/u32-to-u8 (Depends-on): Add missing modules.
	* modules/unistr/u32-to-u16 (Depends-on): Add missing modules.

2007-01-24  Bruno Haible  <bruno@clisp.org>

	Don't AC_REQUIRE autoconf macros that invoke AC_LIBOBJ. See
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-10/msg00279.html>.
	* m4/argp.m4 (gl_ARGP): Invoke, don't require, gl_GETOPT_SUBSTITUTE.
	* m4/fts.m4 (gl_FUNC_FTS, gl_FUNC_FTS_LGPL): Invoke, don't require,
	gl_FUNC_FTS_CORE.
	(gl_FUNC_FTS_CORE): Invoke, don't require, gl_FUNC_OPENAT.
	* m4/lstat.m4 (gl_FUNC_LSTAT): Invoke, don't require,
	AC_FUNC_LSTAT_FOLLOWS_SLASHED_SYMLINK.
	* m4/memcmp.m4 (gl_FUNC_MEMCMP): Invoke, don't require, AC_FUNC_MEMCMP.
	* m4/mktime.m4 (gl_FUNC_MKTIME): Invoke, don't require, AC_FUNC_MKTIME.
	* m4/openat.m4 (gl_FUNC_OPENAT): Invoke, don't require,
	gl_FUNC_FCHOWNAT.
	* m4/strftime.m4 (gl_FUNC_GNU_STRFTIME): Invoke, don't require,
	gl_FUNC_STRFTIME.
	* m4/strtod.m4 (gl_FUNC_STRTOD): Invoke, don't require, AC_FUNC_STRTOD.
	Reported by Ralf Wildenhues.

2007-01-24  Bruno Haible  <bruno@clisp.org>

	Drop AC_REQUIRE calls that are redundant with the module dependencies.
	* m4/canon-host.m4 (gl_PREREQ_CANON_HOST): Don't require
	gl_GETADDRINFO.
	* m4/chdir-long.m4 (gl_PREREQ_CHDIR_LONG): Don't require AM_STDBOOL_H,
	gl_FUNC_MEMPCPY, gl_FUNC_OPENAT, gl_FUNC_MEMRCHR.
	* m4/openat.m4 (gl_PREREQ_OPENAT): Don't require gl_SAVE_CWD.

2007-01-24  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/fnmatch.m4 (_AC_FUNC_FNMATCH_IF): Add test for glibc bug 361.
	Don't use 'exit'; just return from 'main'.
	(_AC_LIBOBJ_FNMATCH): Check for headers and functions just once.

	* lib/fnmatch_.h: Readjust white space and comments to match
	glibc, to avoid spurious diffs.

2007-01-23  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/fnmatch_loop.c (internal_fnmatch) [!_LIBC]: #if-out the
	2004-12-01 change by Jakub Jelinek, since this code won't compile
	if !LIBC.  Problem reported by Bob Proulx.

2007-01-23  Bruno Haible  <bruno@clisp.org>

	* lib/striconveh.c: Include c-strcaseeq.h.
	(mem_iconveh, str_iconveh): Use STRCASEEQ instead of c_strcasecmp.
	* modules/striconveh (Depends-on): Add c-strcaseeq.

2007-01-23  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (String handling): Add streq, c-strcaseeq.

	* modules/c-strcaseeq: New file.
	* lib/c-strcaseeq.h: New file.

	* modules/streq: New file.
	* lib/streq.h: New file.

2007-01-23  Bruno Haible  <bruno@clisp.org>

	* modules/striconveha-tests: New file.
	* tests/test-striconveha.c: New file.

	* lib/striconveha.h: Include <stdbool.h>.
	(mem_iconveha, str_iconveha): Add 'transliterate' argument.
	* lib/striconveha.c: Include allocsa.h, strdup.h, c-strcase.h.
	(mem_iconveha_notranslit): Renamed from mem_iconveha.
	(mem_iconveha): New function.
	(str_iconveha_notranslit): Renamed from str_iconveha.
	(str_iconveha): New function.
	* modules/striconveha (Depends-on): Add stdbool, allocsa, strdup,
	c-strcase.

2007-01-23  Bruno Haible  <bruno@clisp.org>

	* lib/striconveha.c (mem_iconveha): Fix endless recursion. Try all
	encodings without forgiving before trying any encoding with handler.
	(str_iconveha): Try all encodings without forgiving before trying any
	encoding with handler.

2007-01-23  Paul Eggert  <eggert@cs.ucla.edu>

	Import the following changes from libc.

	2005-10-14  Ulrich Drepper  <drepper@redhat.com>

	* lib/fnmatch_loop.c: Adjust for changed secondary hash function.

	2004-12-01  Jakub Jelinek  <jakub@redhat.com>

	* lib/fnmatch_loop.c (internal_fnmatch): Clear is_seqval after
	normal_bracket label.

	2004-09-01  Jakub Jelinek  <jakub@redhat.com>

	[BZ #361]
	* lib/fnmatch_loop.c (FCT): For backslash between brackets, branch
	to normal_bracket after fetching the next character.

2007-01-22  Bruno Haible  <bruno@clisp.org>

	* lib/striconveh.h (mem_cd_iconveh, mem_iconveh): Add 'offsets'
	argument.
	* lib/striconveh.c (iconv_carefully_1): New function.
	(mem_cd_iconveh_internal, mem_cd_iconveh, mem_iconveh): Add 'offsets'
	argument.
	(str_cd_iconveh): Update.
	* lib/striconveha.h (mem_iconveha): Add 'offsets' argument.
	* lib/striconveha.c (mem_iconveha): Add 'offsets' argument.
	* tests/test-striconveh.c (MAGIC): New macro.
	(new_offsets): New function.
	(main): Test call with and without offsets.

2007-01-22  Bruno Haible  <bruno@clisp.org>

	* modules/sys_stat (Makefile.am): Use @MKDIR_P@ instead of $(MKDIR_P).
	* modules/sys_select (Makefile.am): Likewise.
	* modules/sys_socket (Makefile.am): Likewise.
	* modules/sys_time (Makefile.am): Likewise.

2007-01-22  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/gettimeofday (License): Change from GPL to LGPL, since
	gettimeofday is a library function.

2007-01-22  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* lib/poll.c (rpl_poll): Don't check against FD_SETSIZE under Win32.

2007-01-21  Bruno Haible  <bruno@clisp.org>

	* m4/gnulib-common.m4 (AC_PROG_MKDIR_P): New macro.

2007-01-21  Bruno Haible  <bruno@clisp.org>

	* modules/striconveha: New file.
	* lib/striconveha.h: New file.
	* lib/striconveha.c: New file.
	* MODULES.html.sh (Internationalization functions): Add striconveha.
	* lib/striconv.c (str_iconv): Optimize the case of an empty input
	string.
	* lib/striconveh.c (mem_iconveh, str_iconveh): Likewise.

2007-01-21  Bruno Haible  <bruno@clisp.org>

	* lib/striconv.c (str_iconv): Guarantee errno is set when strdup fails.
	* lib/striconveh.c (str_iconveh): Likewise.

2007-01-21  Bruno Haible  <bruno@clisp.org>

	* lib/striconveh.h (mem_iconveh): New declaration.
	* lib/striconveh.c (mem_iconveh): New function.
	* tests/test-striconveh.c (main): Add tests for mem_iconveh.

2007-01-21  Bruno Haible  <bruno@clisp.org>

	* lib/xstriconv.h (xmem_cd_iconv): Change specification.

	* lib/striconveh.h (mem_cd_iconveh): Change specification.
	* lib/striconveh.c (mem_cd_iconveh): Don't free the user-supplied
	original result buffer.
	(str_cd_iconveh): Update.
	* tests/test-striconveh.c (main): Update.

	* lib/striconv.h (mem_cd_iconv): Change specification.
	* lib/striconv.c (mem_cd_iconv): Don't free the user-supplied original
	result buffer.
	(str_cd_iconv): Update.
	* tests/test-striconv.c (main): Update.

2007-01-21  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: Fix test whether sed is GNU sed supporting --posix.

2007-01-20  Jim Meyering  <jim@meyering.net>

	* lib/userspec.c (parse_with_separator): If a user or group string
	starts with "+", skip the corresponding name-to-ID look-up, since
	such a look-up must fail: user and group names may not include "+".

2007-01-19  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/poll.c: Include sys/time.h and time.h unconditionally,
	since we now assume the sys_time module.
	* m4/poll.m4 (gl_PREREQ_POLL): Don't require AC_HEADER_TIME or
	check for sys/time.h; no longer needed.
	* modules/poll (Depends-on): Depend on sys_time.

2007-01-18  Bruno Haible  <bruno@clisp.org>

	* m4/mktime.m4 (AC_FUNC_MKTIME): Remove test for <sys/time.h>.
	* m4/strftime.m4 (gl_FUNC_STRFTIME): Likewise.

	* m4/tempname.m4 (gl_PREREQ_TEMPNAME): Remove tests for sys/time.h and
	gettimeofday.

	* tests/test-gettimeofday.c: Include <time.h>.
	(dummy): Remove variable.

	* m4/sys_time_h.m4 (gl_HEADER_SYS_TIME_H_BODY): Renamed from
	gl_HEADER_SYS_TIME_H.
	(gl_HEADER_SYS_TIME_H): New macro.

	* lib/sys_time_.h: Test GETTIMEOFDAY_REPLACEMENT instead of
	HAVE_GETTIMEOFDAY_POSIX_SIGNATURE and GETTIMEOFDAY_CLOBBERS_LOCALTIME.
	* m4/gettimeofday.m4 (gl_FUNC_GETTIMEOFDAY,
	gl_FUNC_GETTIMEOFDAY_CLOBBER): Set GETTIMEOFDAY_REPLACEMENT instead of
	HAVE_GETTIMEOFDAY_POSIX_SIGNATURE and GETTIMEOFDAY_CLOBBERS_LOCALTIME.
	* m4/sys_time_h.m4 (gl_HEADER_SYS_TIME_H): Initialize
	GETTIMEOFDAY_REPLACEMENT instead of HAVE_GETTIMEOFDAY_POSIX_SIGNATURE
	and GETTIMEOFDAY_CLOBBERS_LOCALTIME.
	* modules/sys_time (sys/time.h): Substitute GETTIMEOFDAY_REPLACEMENT
	instead of HAVE_GETTIMEOFDAY_POSIX_SIGNATURE and
	GETTIMEOFDAY_CLOBBERS_LOCALTIME.

	* m4/gettimeofday.m4 (gl_GETTIMEOFDAY_REPLACE_LOCALTIME): Undo the
	last change; it caused a compilation error when cross-compiling to
	Cygwin.

2007-01-18  Jim Meyering  <jim@meyering.net>

	Use "$(MKDIR_P) sys", not race-prone "test -d sys || mkdir sys".
	* modules/sys_stat (Makefile.am): Use "$(MKDIR_P) sys", rather
	than the race-prone "test -d sys || mkdir sys".
	(configure.ac): Use AC_PROG_MKDIR_P.
	* modules/sys_select: Likewise.
	* modules/sys_socket: Likewise.
	* modules/sys_time: Likewise.

2007-01-18  Eric Blake  <ebb9@byu.net>

	* m4/gettimeofday.m4 (gl_GETTIMEOFDAY_REPLACE_LOCALTIME): Also
	replace gettimeofday.
	* lib/gettimeofday.c (rpl_gettimeofday): Declare with replacement
	name, to avoid infinite recursion.

2007-01-17  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh (Support for systems lacking POSIX:2001): New
	module sys_time.
	* lib/gethrxtime.c: Include <sys/time.h>, since we can no longer
	assume timespec.h defines struct timeval.
	* lib/settime.c: Likewise.
	* lib/utimens.c: Likewise.
	* lib/gettime.c (gettime): Remove test against HAVE_GETTIMEOFDAY,
	since we now assume the gettimeofday module.
	* lib/tempname.c (__gen_tempname): Likewise.
	* lib/gettimeofday.h: Remove.
	* lib/gettimeofday.c: Include <sys/time.h> instead of "gettimeofday.h".
	Don't include <sys/types.h> and <stdlib.h>; shouldn't be needed.
	Include <time.h>, for 'time()'.
	(localtime_buffer_addr): Also use this workaround if
	TZSET_CLOBBERS_LOCALTIME.  Set to a dummy static variable by default,
	to simplify the uses.  All uses changed.
	(localtime, gmtime, tzset, gettimeofday): Reformat slightly so
	that #undef is inside {}, and 'const' follows type name consistently.
	(tzset): Define replacement only if TZSET_CLOBBERS_LOCALTIME.
	(gettimeofday): Do not use the maximum possible value for
	tv->tv_usec, since that might break usages other than ls.c.
	Instead, we'll leave ls.c alone.  This undoes today's patch
	by Bruno.  Add a compile-time warning for 1s-clock resolution;
	we've never observed the problem but might as well keep the
	canary.
	* lib/nanosleep.c: Include timespec.h first, for interface check.
	* lib/nanosleep.c: Include <sys/time.h> unconditionally, since we
	now assume the sys_time module.
	* lib/tempname.c: Likewise.
	* lib/timespec.h: Likewise.
	* lib/nanosleep.c: Don't worry about TIME_WITH_SYS_TIME; no longer
	needed.
	* lib/strftime.c: Likewise.
	* lib/timespec.h: Likewise.
	* lib/posixtm.c: Include posixtm.h first, for interface check.
	Don't worry about TM_IN_SYS_TIME; that's wayyy obsolete.
	* lib/posixtm.h: Include stdbool.h and time.h, for proper interface.
	* lib/strftime.c: Don't include <sys/types.h>; shouldn't be needed.
	* lib/sys_time_.h: New file.
	* lib/timespec.h (struct timespec): Use long int, not long.
	* m4/gettimeofday.m4 (gl_FUNC_GETTIMEOFDAY):
	(gl_FUNC_GETTIMEOFDAY_CLOBBER, gl_PREREQ_GETTIMEOFDAY):
	Remove obsolescent call to AC_HEADER_TIME.
	* m4/mktime.m4 (AC_FUNC_MKTIME): Likewise.
	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP): Likewise.
	* m4/strftime.m4 (gl_FUNC_STRFTIME): Likewise.
	* m4/timespec.m4 (gl_TIMESPEC, gl_CHECK_TYPE_STRUCT_TIMESPEC):
	Likewise.
	* m4/tzset.m4 (gl_FUNC_TZSET_CLOBBER): Likewise.
	* m4/utimbuf.m4 (gl_CHECK_TYPE_STRUCT_UTIMBUF): Likewise.
	* m4/gettimeofday.m4 (gl_FUNC_GETTIMEOFDAY): Move sys/time.h tests
	into the sys_time module.  Check for gettimeofday just once.
	Prefix our variables with gl_, not with ac_ or jm_.  Tighten test
	for gettimeofday signature to just check the signature.  Merely
	compile it, since linking doesn't test signature.  Improve test for
	whether gettimeofday.o is actually needed.
	(gl_FUNC_GETTIMEOFDAY_CLOBBER): Renamed from
	AC_FUNC_GETTIMEOFDAY_CLOBBER.  All uses changed.  Use
	AC_RUN_IFELSE rather than AC_TRY_RUN.  If clobbering, set
	and define GETTIMEOFDAY_CLOBBERS_LOCALTIME.
	(gl_GETTIMEOFDAY_REPLACE_LOCALTIME): Don't define
	GETTIMEOFDAY_CLOBBERS_LOCALTIME; that's gl_FUNC_GETTIMEOFDAY_CLOBBER's
	job.  Don't define tzset; that's gl_FUNC_TZSET_CLOBBER's job.
	* m4/mktime.m4 (AC_FUNC_MKTIME): Just include <time.h> rather
	than worrying about sys/time.h.
	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP):
	Don't bother worrying about TIME_WITH_SYS_TIME.
	* m4/stat-time.m4 (gl_STAT_TIME): Likewise.
	* m4/posixtm.m4 (gl_POSIXTM): Remove obsolescent call to AC_STRUCT_TM.
	* m4/sys_time_h.m4: New file.
	* m4/tzset.m4 (gl_FUNC_TZSET_CLOBBER): Require gl_HEADER_SYS_TIME_H.
	Don't include sys/time.h.  Return from main rather than exiting.
	Define TZSET_CLOBBERS_LOCALTIME, for consistency with other names;
	all uses changed.
	* modules/gethrxtime (Depends-on): Add sys_time.
	* modules/gettime (Depends-on): Likewise.
	* modules/gettimeofday (Depends-on): Likewise.
	* modules/nanosleep (Depends-on): Likewise.
	* modules/settime (Depends-on): Likewise.
	* modules/tempname (Depends-on): Likewise.
	* modules/utimens (Depends-on): Likewise.
	* modules/gettimeofday (Files): Remove lib/gettimeofday.h.
	(Include:) Change back to <sys/time.h>.
	(Maintainer:) Add self.
	* modules/sys_time: New file.
	* modules/tempname (Depends-on): Add gettimeofday.
	* tests/test-gettimeofday.c: Include <sys/time.h>
	rather than gettimeofday.h.

2007-01-17  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_license): Revert last patch. Instead, let
	the license default to GPL.
	(func_create_testdir): Don't complain if a module is LGPL and its
	tests module depends on GPLed modules.

2007-01-17  Bruno Haible  <bruno@clisp.org>

	* lib/gettimeofday.c (gettimeofday): Add code for the case
	HAVE_GETTIMEOFDAY && !GETTIMEOFDAY_CLOBBERS_LOCALTIME. Use the
	maximum possible value for tv->tv_usec, rather than the minimum one.

2005-10-08  Martin Lambers  <marlam@marlam.de>
2005-10-08  Paul Eggert  <eggert@cs.ucla.edu>
2007-01-16  Bruno Haible  <bruno@clisp.org>

	* modules/gettimeofday (Files): Add lib/gettimeofday.h.
	(configure.ac): Remove AC_FUNC_GETTIMEOFDAY_CLOBBER. Add
	gl_FUNC_GETTIMEOFDAY.
	(Include): Add gettimeofday.h.
	* m4/gettimeofday.m4 (gl_FUNC_GETTIMEOFDAY): New macro.
	(AC_FUNC_GETTIMEOFDAY_CLOBBER): Don't invoke gl_PREREQ_GETTIMEOFDAY.
	(gl_GETTIMEOFDAY_REPLACE_LOCALTIME): Define
	GETTIMEOFDAY_CLOBBERS_LOCALTIME. Invoke gl_PREREQ_GETTIMEOFDAY here.
	(gl_PREREQ_GETTIMEOFDAY): Check for <sys/timeb.h> and _ftime.
	* lib/gettimeofday.h: New file.
	* lib/gettimeofday.c: Include <sys/timeb.h>.
	(localtime_buffer_addr, rpl_localtime, rpl_gmtime, rpl_tzset): Define
	only if GETTIMEOFDAY_CLOBBERS_LOCALTIME.
	(rpl_gettimeofday) [!HAVE_GETTIMEOFDAY]: Use _ftime() when available;
	fall back on time().

	* tests/test-gettimeofday.c: New file.
	* modules/gettimeofday-tests: New file.

2007-01-16  Eric Blake  <ebb9@byu.net>

	* modules/fnmatch (Depends-on): Depend on wchar.
	* lib/fnmatch.c (WIDE_CHAR_SUPPORT): Assume <wchar.h>.
	* m4/fnmatch.m4: Likewise.
	* modules/mbchar (Makefile.am): Assume <wchar.h>.
	* m4/mbchar.m4: Likewise.
	* modules/mbswidth (Depends-on): Depend on wchar.
	* lib/mbswidth.c: Assume <wchar.h>.
	* m4/mbswidth.m4: Likewise.
	* modules/quotearg (Depends-on): Depend on wchar.
	* lib/quotearg.c: Assume <wchar.h>.
	* m4/quotearg.m4: Likewise.
	* modules/regex (Depends-on): Depend on wchar.
	* lib/regex_internal.h: Assume <wchar.h>.
	* m4/regex.m4: Likewise.
	* modules/stdint (Depends-on): Depend on wchar.
	* lib/stdint_.h [!defined WCHAR_MIN]: Assume <wchar.h>.
	* m4/stdint.m4: Likewise.
	* tests/test-stdint.c [HAVE_WINT_T]: Likewise.
	* modules/strftime (Depends-on): Depend on wchar.
	* lib/strftime.c (DO_MULTIBYTE): Assume <wchar.h>.
	* modules/strtol (Depends-on): Depend on wchar.
	* lib/strtol.c: Assume <wchar.h>.
	* modules/wcwidth (Depends-on): Depend on wchar.
	* lib/wcwidth.h: Assume <wchar.h>.
	* m4/wcwidth.m4: Likewise.

2007-01-16  Bruno Haible  <bruno@clisp.org>

	* modules/csharpexec-script: New, created from...
	* modules/csharpexec: ... this.

2007-01-16  Paolo Bonzini  <bonzini@gnu.org>

	* modules/javaexec-script: New, created from...
	* modules/javaexec: ... this.

2007-01-16  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* modules/poll (Dependencies): Add sys_select.

2007-01-15  Jim Meyering  <jim@meyering.net>

	* m4/readutmp.m4 (gl_READUTMP): Work around AIX 4.3 struct-
	redefinition bug when using both <utmp.h> and <utmpx.h> headers.
	* lib/readutmp.h: Likewise.  Reported by Daniel Richard G. in
	<http://article.gmane.org/gmane.comp.gnu.core-utils.bugs/9415>.

2007-01-15  Bruno Haible  <bruno@clisp.org>

	* modules/striconveh: New file.
	* lib/striconveh.h: New file.
	* lib/striconveh.c: New file.
	* MODULES.html.sh (Internationalization functions): Add striconveh.

	* modules/striconveh-tests: New file.
	* tests/test-striconveh.c: New file.

2007-01-15  Bruno Haible  <bruno@clisp.org>

	* lib/striconv.c (str_cd_iconv): Use the first algorithm if iconv is
	not from GNU libiconv or GNU libc.

2007-01-15  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-intro.texi (Copyright): Explain the different license
	terms for module descriptions, autoconf macros, tests, documentation.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/striconv-tests: New file.
	* tests/test-striconv.c: New file.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/iconv-tests: New file.
	* tests/test-iconv.c: New file.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_license): For test modules, use the license of
	the main module.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/iconv (Include): Clarify that <iconv.h> can only be included
	if iconv is found to exist.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/c-ctype-tests: New file.
	* tests/test-c-ctype.c: New file.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/binary-io-tests: New file.
	* tests/test-binary-io.sh: New file.
	* tests/test-binary-io.c: New file.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/array-oset-tests: New file.
	* tests/test-array_oset.c: New file.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/array-list-tests: New file.
	* tests/test-array_list.c: New file.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Don't unnecessarily run configure
	and make.
	Reported by Simon Josefsson in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-01/msg00139.html>

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/allocsa-tests: New file.
	* tests/test-allocsa.c: New file.

2007-01-14  Bruno Haible  <bruno@clisp.org>

	* modules/fchdir (Depends-on): Add absolute-header.
	* modules/unistd (Depends-on): Likewise.

2006-12-30  Bruno Haible  <bruno@clisp.org>

	* modules/fchdir: New file.
	* modules/unistd (Files): Add lib/unistd_.h.
	(Makefile.am): Generate unistd.h from unistd_.h.
	* lib/fchdir.c: New file.
	* lib/dirent_.h: New file.
	* lib/unistd_.h: New file.
	* lib/fcntl_.h (open) [FCHDIR_REPLACEMENT]: New replacement.
	* m4/fchdir.m4: New file.
	* m4/unistd_h.m4 (gl_PREREQ_UNISTD): New macro.
	(gl_HEADER_UNISTD): Invoke it.
	* lib/dup-safer.c (dup_safer) [FCHDIR_REPLACEMENT]: Use the dup
	function.
	* lib/backupfile.c (opendir, closedir): Undefine.
	* lib/chown.c (open, close): Undefine.
	* lib/clean-temp.c (open, close): Undefine.
	* lib/copy-file.c (open, close): Undefine.
	* lib/execute.c (open, close): Undefine.
	* lib/fsusage.c (open, close): Undefine.
	* lib/gc-gnulib.c (open, close): Undefine.
	* lib/getcwd.c (opendir, closedir): Undefine.
	* lib/glob.c (opendir, closedir): Undefine.
	* lib/javacomp.c (open, close): Undefine.
	* lib/mountlist.c (open, close, opendir, closedir): Undefine.
	* lib/openat-proc.c (open, close): Undefine.
	* lib/pagealign_alloc.c (open, close): Undefine.
	* lib/pipe.c (open, close): Undefine.
	* lib/progreloc.c (open, close): Undefine.
	* lib/savedir.c (opendir, closedir): Undefine.
	* lib/utime.c (open, close): Undefine.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add fchdir.

2007-01-10  Bruno Haible  <bruno@clisp.org>

	* lib/striconv.c (mem_cd_iconv): Align the temporary buffer.

2007-01-12  Eric Blake  <ebb9@byu.net>

	Provide a robust <wchar.h>.  Further simplifications are now
	possible in other modules, but not included here.
	* modules/wchar: New module.
	* m4/wchar.m4: New file.
	* lib/wchar_.h: Likewise.
	* modules/mbchar (Depends-on): Depend on wchar, as the first use
	of the new module.
	* MODULES.html.sh (Extended multibyte and wide character utilities):
	New section.

2007-01-12  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/xreadlink.c (SYMLINK_MAX) [!defined SYMLINK_MAX]: Define
	to a reasonable default for memory allocation.
	(xreadlink): Don't allocate a huge buffer, to work around a buggy
	file system that reports garbage st_size values for symlinks.
	Problem reported by Liyang Hu.

2007-01-11  Simon Josefsson  <simon@josefsson.org>

	* gnulib-tool (func_all_modules): Exclude all .* files (e.g.,
	Emacs .#* auto-save files).

2007-01-11  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_all_modules): Exclude all files inside the CVS
	directory.

2007-01-10  Paul Eggert  <eggert@cs.ucla.edu>

	Use @...@ consistently in lib/wctype_.h.
	* lib/wctype_.h [HAVE_WINT_T]: Go back to using @...@, but rely
	on it being set to 1 or 0.
	* m4/wctype.m4 (gl_WCTYPE_H): Set HAVE_WINT_T to 1 or 0, and
	go back to AC_SUBSTing it.
	* modules/wctype (Makefile.am): Undo previous change.

2007-01-10  Eric Blake  <ebb9@byu.net>

	* lib/wctype_.h [HAVE_WINT_T]: Rely on AC_DEFINE.
	* m4/wctype.m4 (gl_WCTYPE_H): No need to AC_SUBST(HAVE_WINT_T).
	* modules/wctype (Makefile.am): Likewise.
	Reported by Chris McGuire.

2007-01-10  Jim Meyering  <jim@meyering.net>

	fts.c: a small readability/maintainability improvement
	* lib/fts.c (fts_read): Make this code slightly more readable and
	maintainable by hoisting the "sp->fts_cur = p" assignments to
	immediately follow the statements that set P.  Derived from
	the patch by Miloslav Trmac in http://bugzilla.redhat.com/222089.

2007-01-10  Eric Blake  <ebb9@byu.net>

	* lib/wctype_.h [HAVE_WINT_T]: Include <stddef.h> before
	<wchar.h>, to work around BSDI bug in BSD/OS 4.0.1.
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Likewise.
	* m4/wint_t.m4 (gt_TYPE_WINT_T): Likewise.
	Reported by Chris McGuire.

2007-01-09  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_all_modules): Use POSIX conforming escaping
	in sed script.

2007-01-09  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh: Accept options --cvs-urls, --git-urls.
	(repo_url_prefix, repo_url_suffix, repo_url_suffix_repl): New
	variables.
	(func_module): Use them.

2007-01-09  Bruno Haible  <bruno@clisp.org>

	* modules/unistr/base: New file.
	* lib/unistr.h: New file.

	* modules/unistr/u8-to-u16: New file.
	* lib/unistr/u8-to-u16.c: New file.

	* modules/unistr/u8-to-u32: New file.
	* lib/unistr/u8-to-u32.c: New file.

	* modules/unistr/u16-to-u8: New file.
	* lib/unistr/u16-to-u8.c: New file.

	* modules/unistr/u16-to-u32: New file.
	* lib/unistr/u16-to-u32.c: New file.

	* modules/unistr/u32-to-u8: New file.
	* lib/unistr/u32-to-u8.c: New file.

	* modules/unistr/u32-to-u16: New file.
	* lib/unistr/u32-to-u16.c: New file.

	* modules/unistr/u8-check: New file.
	* modules/unistr/u16-check: New file.
	* modules/unistr/u32-check: New file.
	* lib/unistr/u8-check.c: New file.
	* lib/unistr/u16-check.c: New file.
	* lib/unistr/u32-check.c: New file.

	* modules/unistr/u8-chr: New file.
	* modules/unistr/u16-chr: New file.
	* modules/unistr/u32-chr: New file.
	* lib/unistr/u8-chr.c: New file.
	* lib/unistr/u16-chr.c: New file.
	* lib/unistr/u32-chr.c: New file.

	* modules/unistr/u8-cmp: New file.
	* modules/unistr/u16-cmp: New file.
	* modules/unistr/u32-cmp: New file.
	* lib/unistr/u8-cmp.c: New file.
	* lib/unistr/u16-cmp.c: New file.
	* lib/unistr/u32-cmp.c: New file.

	* modules/unistr/u8-cpy: New file.
	* modules/unistr/u16-cpy: New file.
	* modules/unistr/u32-cpy: New file.
	* lib/unistr/u8-cpy.c: New file.
	* lib/unistr/u16-cpy.c: New file.
	* lib/unistr/u32-cpy.c: New file.
	* lib/unistr/u-cpy.h: New file.

	* modules/unistr/u8-cpy-alloc: New file.
	* modules/unistr/u16-cpy-alloc: New file.
	* modules/unistr/u32-cpy-alloc: New file.
	* lib/unistr/u8-cpy-alloc.c: New file.
	* lib/unistr/u16-cpy-alloc.c: New file.
	* lib/unistr/u32-cpy-alloc.c: New file.
	* lib/unistr/u-cpy-alloc.h: New file.

	* modules/unistr/u8-endswith: New file.
	* modules/unistr/u16-endswith: New file.
	* modules/unistr/u32-endswith: New file.
	* lib/unistr/u8-endswith.c: New file.
	* lib/unistr/u16-endswith.c: New file.
	* lib/unistr/u32-endswith.c: New file.
	* lib/unistr/u-endswith.h: New file.

	* modules/unistr/u8-mblen: New file.
	* modules/unistr/u16-mblen: New file.
	* modules/unistr/u32-mblen: New file.
	* lib/unistr/u8-mblen.c: New file.
	* lib/unistr/u16-mblen.c: New file.
	* lib/unistr/u32-mblen.c: New file.

	* modules/unistr/u8-mbtouc: New file.
	* modules/unistr/u16-mbtouc: New file.
	* modules/unistr/u32-mbtouc: New file.
	* lib/unistr/u8-mbtouc.c: New file.
	* lib/unistr/u16-mbtouc.c: New file.
	* lib/unistr/u32-mbtouc.c: New file.

	* modules/unistr/u8-mbtouc-safe: New file.
	* modules/unistr/u16-mbtouc-safe: New file.
	* modules/unistr/u32-mbtouc-safe: New file.
	* lib/unistr/u8-mbtouc-safe.c: New file.
	* lib/unistr/u16-mbtouc-safe.c: New file.
	* lib/unistr/u32-mbtouc-safe.c: New file.

	* modules/unistr/u8-move: New file.
	* modules/unistr/u16-move: New file.
	* modules/unistr/u32-move: New file.
	* lib/unistr/u8-move.c: New file.
	* lib/unistr/u16-move.c: New file.
	* lib/unistr/u32-move.c: New file.
	* lib/unistr/u-move.h: New file.

	* modules/unistr/u8-next: New file.
	* modules/unistr/u16-next: New file.
	* modules/unistr/u32-next: New file.
	* lib/unistr/u8-next.c: New file.
	* lib/unistr/u16-next.c: New file.
	* lib/unistr/u32-next.c: New file.

	* modules/unistr/u8-prev: New file.
	* modules/unistr/u16-prev: New file.
	* modules/unistr/u32-prev: New file.
	* lib/unistr/u8-prev.c: New file.
	* lib/unistr/u16-prev.c: New file.
	* lib/unistr/u32-prev.c: New file.

	* modules/unistr/u8-set: New file.
	* modules/unistr/u16-set: New file.
	* modules/unistr/u32-set: New file.
	* lib/unistr/u8-set.c: New file.
	* lib/unistr/u16-set.c: New file.
	* lib/unistr/u32-set.c: New file.
	* lib/unistr/u-set.h: New file.

	* modules/unistr/u8-startswith: New file.
	* modules/unistr/u16-startswith: New file.
	* modules/unistr/u32-startswith: New file.
	* lib/unistr/u8-startswith.c: New file.
	* lib/unistr/u16-startswith.c: New file.
	* lib/unistr/u32-startswith.c: New file.
	* lib/unistr/u-startswith.h: New file.

	* modules/unistr/u8-stpcpy: New file.
	* modules/unistr/u16-stpcpy: New file.
	* modules/unistr/u32-stpcpy: New file.
	* lib/unistr/u8-stpcpy.c: New file.
	* lib/unistr/u16-stpcpy.c: New file.
	* lib/unistr/u32-stpcpy.c: New file.
	* lib/unistr/u-stpcpy.h: New file.

	* modules/unistr/u8-stpncpy: New file.
	* modules/unistr/u16-stpncpy: New file.
	* modules/unistr/u32-stpncpy: New file.
	* lib/unistr/u8-stpncpy.c: New file.
	* lib/unistr/u16-stpncpy.c: New file.
	* lib/unistr/u32-stpncpy.c: New file.
	* lib/unistr/u-stpncpy.h: New file.

	* modules/unistr/u8-strcat: New file.
	* modules/unistr/u16-strcat: New file.
	* modules/unistr/u32-strcat: New file.
	* lib/unistr/u8-strcat.c: New file.
	* lib/unistr/u16-strcat.c: New file.
	* lib/unistr/u32-strcat.c: New file.
	* lib/unistr/u-strcat.h: New file.

	* modules/unistr/u8-strchr: New file.
	* modules/unistr/u16-strchr: New file.
	* modules/unistr/u32-strchr: New file.
	* lib/unistr/u8-strchr.c: New file.
	* lib/unistr/u16-strchr.c: New file.
	* lib/unistr/u32-strchr.c: New file.

	* modules/unistr/u8-strcmp: New file.
	* modules/unistr/u16-strcmp: New file.
	* modules/unistr/u32-strcmp: New file.
	* lib/unistr/u8-strcmp.c: New file.
	* lib/unistr/u16-strcmp.c: New file.
	* lib/unistr/u32-strcmp.c: New file.

	* modules/unistr/u8-strcpy: New file.
	* modules/unistr/u16-strcpy: New file.
	* modules/unistr/u32-strcpy: New file.
	* lib/unistr/u8-strcpy.c: New file.
	* lib/unistr/u16-strcpy.c: New file.
	* lib/unistr/u32-strcpy.c: New file.
	* lib/unistr/u-strcpy.h: New file.

	* modules/unistr/u8-strcspn: New file.
	* modules/unistr/u16-strcspn: New file.
	* modules/unistr/u32-strcspn: New file.
	* lib/unistr/u8-strcspn.c: New file.
	* lib/unistr/u16-strcspn.c: New file.
	* lib/unistr/u32-strcspn.c: New file.
	* lib/unistr/u-strcspn.h: New file.

	* modules/unistr/u8-strdup: New file.
	* modules/unistr/u16-strdup: New file.
	* modules/unistr/u32-strdup: New file.
	* lib/unistr/u8-strdup.c: New file.
	* lib/unistr/u16-strdup.c: New file.
	* lib/unistr/u32-strdup.c: New file.
	* lib/unistr/u-strdup.h: New file.

	* modules/unistr/u8-strlen: New file.
	* modules/unistr/u16-strlen: New file.
	* modules/unistr/u32-strlen: New file.
	* lib/unistr/u8-strlen.c: New file.
	* lib/unistr/u16-strlen.c: New file.
	* lib/unistr/u32-strlen.c: New file.
	* lib/unistr/u-strlen.h: New file.

	* modules/unistr/u8-strmblen: New file.
	* modules/unistr/u16-strmblen: New file.
	* modules/unistr/u32-strmblen: New file.
	* lib/unistr/u8-strmblen.c: New file.
	* lib/unistr/u16-strmblen.c: New file.
	* lib/unistr/u32-strmblen.c: New file.

	* modules/unistr/u8-strmbtouc: New file.
	* modules/unistr/u16-strmbtouc: New file.
	* modules/unistr/u32-strmbtouc: New file.
	* lib/unistr/u8-strmbtouc.c: New file.
	* lib/unistr/u16-strmbtouc.c: New file.
	* lib/unistr/u32-strmbtouc.c: New file.

	* modules/unistr/u8-strncat: New file.
	* modules/unistr/u16-strncat: New file.
	* modules/unistr/u32-strncat: New file.
	* lib/unistr/u8-strncat.c: New file.
	* lib/unistr/u16-strncat.c: New file.
	* lib/unistr/u32-strncat.c: New file.
	* lib/unistr/u-strncat.h: New file.

	* modules/unistr/u8-strncmp: New file.
	* modules/unistr/u16-strncmp: New file.
	* modules/unistr/u32-strncmp: New file.
	* lib/unistr/u8-strncmp.c: New file.
	* lib/unistr/u16-strncmp.c: New file.
	* lib/unistr/u32-strncmp.c: New file.

	* modules/unistr/u8-strncpy: New file.
	* modules/unistr/u16-strncpy: New file.
	* modules/unistr/u32-strncpy: New file.
	* lib/unistr/u8-strncpy.c: New file.
	* lib/unistr/u16-strncpy.c: New file.
	* lib/unistr/u32-strncpy.c: New file.
	* lib/unistr/u-strncpy.h: New file.

	* modules/unistr/u8-strnlen: New file.
	* modules/unistr/u16-strnlen: New file.
	* modules/unistr/u32-strnlen: New file.
	* lib/unistr/u8-strnlen.c: New file.
	* lib/unistr/u16-strnlen.c: New file.
	* lib/unistr/u32-strnlen.c: New file.
	* lib/unistr/u-strnlen.h: New file.

	* modules/unistr/u8-strpbrk: New file.
	* modules/unistr/u16-strpbrk: New file.
	* modules/unistr/u32-strpbrk: New file.
	* lib/unistr/u8-strpbrk.c: New file.
	* lib/unistr/u16-strpbrk.c: New file.
	* lib/unistr/u32-strpbrk.c: New file.
	* lib/unistr/u-strpbrk.h: New file.

	* modules/unistr/u8-strrchr: New file.
	* modules/unistr/u16-strrchr: New file.
	* modules/unistr/u32-strrchr: New file.
	* lib/unistr/u8-strrchr.c: New file.
	* lib/unistr/u16-strrchr.c: New file.
	* lib/unistr/u32-strrchr.c: New file.

	* modules/unistr/u8-strspn: New file.
	* modules/unistr/u16-strspn: New file.
	* modules/unistr/u32-strspn: New file.
	* lib/unistr/u8-strspn.c: New file.
	* lib/unistr/u16-strspn.c: New file.
	* lib/unistr/u32-strspn.c: New file.
	* lib/unistr/u-strspn.h: New file.

	* modules/unistr/u8-strstr: New file.
	* modules/unistr/u16-strstr: New file.
	* modules/unistr/u32-strstr: New file.
	* lib/unistr/u8-strstr.c: New file.
	* lib/unistr/u16-strstr.c: New file.
	* lib/unistr/u32-strstr.c: New file.
	* lib/unistr/u-strstr.h: New file.

	* modules/unistr/u8-strtok: New file.
	* modules/unistr/u16-strtok: New file.
	* modules/unistr/u32-strtok: New file.
	* lib/unistr/u8-strtok.c: New file.
	* lib/unistr/u16-strtok.c: New file.
	* lib/unistr/u32-strtok.c: New file.
	* lib/unistr/u-strtok.h: New file.

	* modules/unistr/u8-uctomb: New file.
	* modules/unistr/u16-uctomb: New file.
	* modules/unistr/u32-uctomb: New file.
	* lib/unistr/u8-uctomb.c: New file.
	* lib/unistr/u16-uctomb.c: New file.
	* lib/unistr/u32-uctomb.c: New file.

	* MODULES.html.sh (Unicode string functions): Add the new modules.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_all_modules): Use find, not ls, to traverse the
	modules directory. Filter out CVS, ChangeLog, COPYING, README also from
	subdirectories.

2007-01-08  Karl Berry  <karl@gnu.org>

	* doc/error.texi: mention that main() fns must set program_name
	when progname is used.

2007-01-08  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/wctype.m4 (gl_WCTYPE_H): Compute ABSOLUTE_WCTYPE_H even if
	WCTYPE_H is empty, for the benefit of builds from non-distclean
	directories.  Problem reported by Eric Blake in
	<http://lists.gnu.org/archive/html/bug-gnulib/2007-01/msg00157.html>.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	* m4/canonicalize.m4 (AC_FUNC_CANONICALIZE_FILE_NAME): Remove
	PROVIDE_CANONICALIZE_FILENAME_MODE macro definition.
	* lib/canonicalize.h: Test GNULIB_CANONICALIZE instead of
	PROVIDE_CANONICALIZE_FILENAME_MODE.
	* modules/canonicalize (configure.ac): Use gl_MODULE_INDICATOR.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	* m4/fts.m4 (gl_FUNC_FTS_LGPL): Remove _LGPL_PACKAGE macro definition.
	* lib/fts_.h (_LGPL_PACKAGE): Remove macro.
	Use !GNULIB_FTS instead of _LGPL_PACKAGE.
	* lib/fts.c: Likewise.
	* modules/fts (configure.ac): Use gl_MODULE_INDICATOR.

2006-12-25  Bruno Haible  <bruno@clisp.org>

	* modules/utf8-ucs4-safe: New file.
	* lib/utf8-ucs4-safe.h: New file.
	* lib/unistr/utf8-ucs4-safe.c: New file.

	* modules/utf16-ucs4-safe: New file.
	* lib/utf16-ucs4-safe.h: New file.
	* lib/unistr/utf16-ucs4-safe.c: New file.

	* MODULES.html.sh (Unicode string functions): Add the new modules.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	* modules/utf8-ucs4 (Files, lib_SOURCES): Add unistr/utf8-ucs4.c.
	(Depends-on): Add unitypes.
	* lib/utf8-ucs4.h: Add double-inclusion guard. Include unitypes.h.
	(u8_mbtouc_aux): Move out to separate file.
	(u8_mbtouc): Use ucs4_t, uint8_t types.
	* lib/unistr/utf8-ucs4.c: New file.

	* modules/utf16-ucs4 (Files, lib_SOURCES): Add unistr/utf16-ucs4.c.
	(Depends-on): Add unitypes.
	* lib/utf16-ucs4.h: Add double-inclusion guard. Include unitypes.h.
	(u16_mbtouc_aux): Move out to separate file.
	(u16_mbtouc): Use ucs4_t, uint16_t types.
	* lib/unistr/utf16-ucs4.c: New file.

	* modules/ucs4-utf8 (Files, lib_SOURCES): Add unistr/ucs4-utf8.c.
	(Depends-on): Add unitypes.
	* lib/ucs4-utf8.h: Add double-inclusion guard. Include unitypes.h.
	(u8_uctomb_aux): Move out to separate file.
	(u8_uctomb): Use ucs4_t, uint8_t types.
	* lib/unistr/ucs4-utf8.c: New file.

	* modules/ucs4-utf16 (Files, lib_SOURCES): Add unistr/ucs4-utf16.c.
	(Depends-on): Add unitypes.
	* lib/ucs4-utf16.h: Add double-inclusion guard. Include unitypes.h.
	(u16_uctomb_aux): Move out to separate file.
	(u16_uctomb): Use ucs4_t, uint16_t types.
	* lib/unistr/ucs4-utf16.c: New file.

2006-12-25  Bruno Haible  <bruno@clisp.org>

	* modules/unitypes: New file.
	* lib/unitypes.h: New file.
	* MODULES.html.sh (func_all_modules): New section "Unicode string
	functions". Move ucs4-utf8, ucs4-utf16, utf8-ucs4, utf16-ucs4 to
	this section. Add unitypes.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	Avoid variable names that conflict with those from libtool.
	* m4/lib-link.m4 (AC_LIB_RPATH, AC_LIB_LINKFLAGS_BODY,
	AC_LIB_LINKFLAGS_FROM_LIBS): Rename libext to acl_libext,
	shlibext to acl_shlibext, libname_spec to acl_libname_spec,
	library_names_spec to acl_library_names_spec, hardcode_* to
	acl_hardcode_*.
	Reported by Ralf Wildenhues.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	* m4/gc-arcfour.m4 (gl_GC_ARCFOUR): Remove GC_USE_ARCFOUR macro
	definition.
	* m4/gc-arctwo.m4 (gl_GC_ARCTWO): Remove GC_USE_ARCTWO macro
	definition.
	* m4/gc-des.m4 (gl_GC_DES): Remove GC_USE_DES macro definition.
	* m4/gc-hmac-md5.m4 (gl_GC_HMAC_MD5): Remove GC_USE_HMAC_MD5 macro
	definition.
	* m4/gc-hmac-sha1.m4 (gl_GC_HMAC_SHA1): Remove GC_USE_HMAC_SHA1 macro
	definition.
	* m4/gc-md2.m4 (gl_GC_MD2): Remove GC_USE_MD2 macro definition.
	* m4/gc-md4.m4 (gl_GC_MD4): Remove GC_USE_MD4 macro definition.
	* m4/gc-md5.m4 (gl_GC_MD5): Remove GC_USE_MD5 macro definition.
	* m4/gc-random.m4 (gl_GC_RANDOM): Remove GC_USE_RANDOM macro
	definition.
	* m4/gc-rijndael.m4 (gl_GC_RIJNDAEL): Remove GC_USE_RIJNDAEL macro
	definition.
	* m4/gc-sha1.m4 (gl_GC_SHA1): Remove GC_USE_SHA1 macro definition.
	* lib/gc-gnulib.c: Use GNULIB_GC_<algorithm> instead of
	GC_USE_<algorithm>.
	* lib/gc-libgcrypt.c: Likewise.
	* modules/gc-arcfour (configure.ac): Use gl_MODULE_INDICATOR.
	* modules/gc-arctwo (configure.ac): Likewise.
	* modules/gc-des (configure.ac): Likewise.
	* modules/gc-hmac-md5 (configure.ac): Likewise.
	* modules/gc-hmac-sha1 (configure.ac): Likewise.
	* modules/gc-md2 (configure.ac): Likewise.
	* modules/gc-md4 (configure.ac): Likewise.
	* modules/gc-md5 (configure.ac): Likewise.
	* modules/gc-random (configure.ac): Likewise.
	* modules/gc-rijndael (configure.ac): Likewise.
	* modules/gc-sha1 (configure.ac): Likewise.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	* m4/close-stream.m4 (gl_CLOSE_STREAM): Remove GNULIB_CLOSE_STREAM
	macro definition.
	* m4/fcntl-safer.m4 (gl_FCNTL_SAFER): Remove GNULIB_FCNTL_SAFER macro
	definition.
	* m4/stdio-safer.m4 (gl_FOPEN_SAFER): Remove GNULIB_FOPEN_SAFER macro
	definition.
	* modules/close-stream (configure.ac): Invoke gl_MODULE_INDICATOR.
	* modules/fcntl-safer (configure.ac): Likewise.
	* modules/fopen-safer (configure.ac): Likewise.
	* modules/fwriteerror (configure.ac): Likewise. Remove explicit
	GNULIB_FWRITEERROR macro definition.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	* m4/gnulib-common.m4: New file.
	* gnulib-tool (func_get_autoconf_snippet): Undo last change.
	(func_get_filelist): Add m4/gnulib-common.m4.

2007-01-08  Bruno Haible  <bruno@clisp.org>

	* m4/lib-link.m4 (AC_LIB_LINKFLAGS_BODY): Simplify the sorting
	command.

2007-01-08  Jim Meyering  <jim@meyering.net>

	Use a more robust test for a "can't happen" condition.
	* lib/fts.c (fts_read): Revert the change of 2006-11-22, since it
	narrowed the st_size value.  Presuming the "can't happen" condition
	is true, that narrowing could conceivably convert an invalid st_size
	value into a valid one.  Instead, use a change based on Matthew
	Woehlke's original patch.

	Slight readability improvement: use an assert-like macro
	in place of literal "abort ()" uses.
	* lib/fts.c (fts_assert): Define.
	(fts_set_stat_required, cwd_advance_fd, fts_read, fd_ring_check):
	Use this macro instead of a bare 'abort'.

2007-01-05  Paul Eggert  <eggert@cs.ucla.edu>

	Don't worry about using IRIX 5.3's wctype.h broken definitions;
	simply work around them.
	* lib/wctype_.h: Remove test for HAVE_WCTYPE_CTMP_BUG.
	(iswalnum, iswalpha, iswblank, iswcntrl, iswdigit, iswgraph, iswlower):
	(iswprint, iswpunct, iswspace, iswupper, iswxdigit): Undef before
	declaring.
	Don't bother to define as macros, since the standard doesn't require it.
	* m4/wctype.m4 (WCTYPE_H, ABSOLUTE_WCTYPE_H): Simplify, since we no
	longer worry about IRIX 5.3.
	(HAVE_WCTYPE_CTMP_BUG): Remove.

2007-01-04  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/wctype_.h (_ctmp_) [HAVE_WCTYPE_CTMP_BUG]: Now of type wchar_t,
	not wint_t.  Also, include <ctype.h>, to fix another IRIX bug.
	* m4/wctype.m4 (gl_WCTYPE_H): Likewise.
	Problems reported by Georg Schwarz for IRIX 5.3.

	* gnulib-tool (autoconf_minversion): Take the maximum version number
	found, not the minimum.  Problem reported by James Youngman.

2007-01-03  Karl Berry  <karl@gnu.org>

	* doc/error.texi: new file, explaining interaction with progname.
	* doc/gnulib.texi: include it.  Update copyright.

2007-01-03  Simon Josefsson  <simon@josefsson.org>

	* gnulib-tool (func_create_testdir): Run AC_CANONICAL_BUILD and
	AC_CANONICAL_HOST, to improve autobuild outputs.

2007-01-03  Paolo Bonzini  <bonzini@gnu.org>
	    Yoann Vandoorselaere <yoann.v@prelude-ids.com>

	* lib/poll.c (poll): Use recv on Mac OS X to distinguish connected
	sockets, server sockets, and other file descriptors.  Count errors
	to compute the return value.  Reorder the code a bit to be easier
	to follow.  Don't set event bits that were not requested (except
	POLLERR and POLLHUP).

2007-01-01  Bruno Haible  <bruno@clisp.org>

	* modules/lchmod (Include): Require lchmod.h, not lchown.h.

2007-01-03  Jim Meyering  <jim@meyering.net>

	* modules/fts-lgpl (Depends-on): Add i-ring.  Reported by Bruno Haible.

2007-01-02  Bruno Haible  <bruno@clisp.org>

	* modules/settime (Include): Require timespec.h.
	* modules/nanosleep (Include): Likewise.

2007-01-01  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_copyright_notice): Bump year.
	(func_get_autoconf_snippet): Emit a GNULIB_<modulename> macro.

2007-01-01  Bruno Haible  <bruno@clisp.org>

	Improve support for OpenBSD.
	* build-aux/config.rpath (libname_spec): Export.
	(library_names_spec): New variable. Export.
	* m4/lib-link.m4 (AC_LIB_LINKFLAGS_BODY): Extract libname_spec and
	library_names_spec from the config.rpath output. Locate shared library
	through the name pattern in library_names_spec.

2007-01-01  Eric Blake  <ebb9@byu.net>

	* lib/version-etc.c (COPYRIGHT_YEAR): Bump for new year.

2006-12-30  Paul Eggert  <eggert@cs.ucla.edu>

	* gnulib-tool (SORT): Remove, since we no longer assume GNU sort.
	Rewrite so as not to assume GNU sort or "tail -1".  Also, don't
	assume the C locale, and avoid an "eval" that could cause trouble.
	Problem with SORT reported by Bob Proulx.

	* lib/getpagesize.h (getpagesize) [defined __amigaos4__]:
	Define.  Trivial patch from Henning Nielsen Lund, originally
	sent to bug-grep@gnu.org today.

2006-12-29  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/acl.h: Include sys/types.h and sys/stat.h, for mode_t and
	struct stat.  Problem reported by Henning Nielsen Lund.
	* lib/acl.c: Include acl.h first, to check interface.  Don't
	bother to include sys/types.h and sys/stat.h again.

2006-12-28  Paul Eggert  <eggert@cs.ucla.edu>

	Import the following change from libc; problem reported by
	Sven Verdoolaege.

	2005-10-13  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1373]
	* lib/argp.h: Remove __NTH for __argp_usage inline function.

2006-12-28  Jim Meyering  <jim@meyering.net>

	* build-aux/announce-gen: Do not assume that the package
	builds any of tar.gz, tar.bz2, and .xdelta files.
	Suggestion from Simon Josefsson.

2006-12-28  Simon Josefsson  <simon@josefsson.org>

	* modules/announce-gen: New file.

2006-12-27  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/mbchar.h: Just include <wctype.h>; the wctype module
	handles its gotchas now.
	* lib/mbswidth.c: Likewise.
	* lib/wcwidth.h: Likewise.
	* m4/mbchar.m4 (gl_MBCHAR): Don't bother checking for wctype.h
	and iswcntrl; the wctype module does this stuff now.
	* m4/mbswidth.m4 (gl_MBSWIDTH): Likewise.
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Likewise.
	* modules/mbchar (Depends-on): Add wctype.
	* modules/mbswidth (Depends-on): Likewise.
	* modules/wcwidth (Depends-on): Likewise.

2006-12-27  Eric Blake  <ebb9@byu.net>

	* lib/fnmatch.c: Reinstate inclusion of <wchar.h>, since this
	module uses more than what <wctype.h> is required to provide.

2006-12-26  Eric Blake  <ebb9@byu.net>

	* gnulib-tool (sed_extract_prog): Avoid space-tab.

2006-12-26  Eric Blake  <ebb9@byu.net>

	* modules/absolute-header: New module.
	* modules/fcntl (Depends-on): Depend on it.
	* modules/inttypes (Depends-on): Likewise.
	* modules/stdint (Depends-on): Likewise.
	* modules/sys_stat (Depends-on): Likewise.
	* modules/wctype (Depends-on): Likewise.
	* MODULES.html.sh (Support for building libraries and
	executables): Document it.

2006-12-25  Paul Eggert  <eggert@cs.ucla.edu>

	* gnulib-tool (SED): Remove, undoing previous change.
	The problem was that it broke coreutils on Solaris, because
	"sed --posix" leaked into a makefile.
	(sed): New alias, if 'alias' and GNU sed.

2006-12-24  Jim Meyering  <jim@meyering.net>

	Work around an fchownat bug in glibc-2.4:
	http://lists.ubuntu.com/archives/ubuntu-users/2006-September/093218.html
	This bug would cause "chown -RP ... DIR" to follow symlinks in DIR,
	in spite of the -P option.
	* m4/openat.m4 (gl_FUNC_FCHOWNAT, gl_FUNC_FCHOWNAT_DEREF_BUG):
	New macros.
	(gl_PREREQ_OPENAT): Require gl_FUNC_FCHOWNAT.
	* modules/openat (Files): Add lib/fchownat.c.
	* lib/openat.c (fchownat): Don't define here.  Move to...
	* lib/fchownat.c: ...this new file.

2006-12-23  Paul Eggert  <eggert@cs.ucla.edu>

	Fix bug reported by Bruno Haible in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-12/msg00228.html>
	where quotearg.c didn't compile on Mac OS X 10.2 because it
	lacks <wchar.h> and wint_t.
	* lib/wctype_.h (__wctype_wint_t): New type.
	Include <stdio.h>, <time.h>, <wchar.h> only if HAVE_WINT_T.
	(iswalnum, iswalpha, iswblank, iswcntrl, iswdigit, iswgraph):
	(iswlower, iswprint, iswpunct, iswspace, iswupper, ixwxdigit):
	Arg is now of type __wctype_wint_t, not wint_t.
	* m4/wctype.m4 (gl_WCTYPE_H): Require gt_TYPE_WINT_T, and
	substitute HAVE_WINT_T.
	* modules/wctype (Files): Add m4/wint_t.m4.
	(wctype.h): Substitute HAVE_WINT_T.

2006-12-23  Bruno Haible  <bruno@clisp.org>

	* lib/safe-read.h [C++]: Wrap declarations in extern "C".

2006-12-23  Bruno Haible  <bruno@clisp.org>

	* lib/canonicalize-lgpl.c (__realpath): Test HAVE_READLINK instead of
	S_ISLNK.
	Needed because gnulib's sys/stat.h replacement defines S_ISLNK on
	mingw.

2006-12-22  Bruno Haible  <bruno@clisp.org>

	* lib/copy-file.c: Include acl.h.
	(copy_file_preserving) [USE_ACL]: Use copy_acl instead of chmod.
	Close the file descriptors only after being done with copy_acl.
	* modules/copy-file (Depends-on): Add acl.

2006-12-22  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (SED): New variable.
	Use $SED instead of sed everywhere.

2006-12-22  Bruno Haible  <bruno@clisp.org>

	* modules/no-c++: New file.
	* m4/no-c++.m4: New file.
	* MODULES.html.sh (Support for building libraries and executables):
	Add no-c++.

2006-12-22  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/mktime.m4 (AC_FUNC_MKTIME): Sync from Autoconf.
	Include <limits.h>, and use its INT_MAX to rewrite the
	j loop so that it does not overflow 'int'.  Problem reported by
	Ralf Wildenhues in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-12/msg00084.html>.
	Play it safe by shifting left by 1 rather than multiplying by 2,
	as GCC is less likely to optimize this away when the value
	is signed (when it assumes overflow leads to undefined behavior).
	Also, don't assume time_t uses two's complement.

2006-12-21  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh: New module wctype.
	* lib/wctype_.h, m4/wctype.m4, modules/wctype: New files.
	* lib/fnmatch.c: Don't bother to include <wchar.h> before
	<wctype.h>, since the new wctype module should fix this.
	* lib/quotearg.c: Include <wctype.h> unconditionally, since
	the wctype module should arrange for it.
	* lib/regex_internal.h: Likewise.
	* m4/quotearg.m4 (gl_QUOTEARG): Don't check for wctype.h or iswprint,
	since the wctype module should handle this now.
	* m4/regex.m4 (gl_PREREQ_REGEX): Don't check for wctype.h.
	* modules/fnmatch (Depends-on): Add wctype.
	* modules/quotearg (Depends-on): Likewise.
	* modules/regex (Depends-on): Likewise.

2006-12-19  Bruno Haible  <bruno@clisp.org>

	* lib/strdup.h [C++]: Wrap definitions in extern "C".
	Suggested by Lorenzo Bettini <bettini@dsi.unifi.it>.

2006-12-19  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* modules/savewd (Depends-on): Fix dependency on fcntl.

2006-12-18  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/stdint.m4 (gl_STDINT_H): Set STDINT_H to empty if stdint.h
	conforms to C99, rather than relying on the user's environment
	setting of STDINT_H.

2006-12-18  Paul Eggert  <eggert@cs.ucla.edu>
	and Eric Blake  <ebb9@byu.net>

	* lib/dirname.h (DOUBLE_SLASH_IS_DISTINCT_ROOT): Default to 0, not 1.
	This is more consistent with the other defines here.
	* m4/double-slash-root.m4 (gl_DOUBLE_SLASH_ROOT):
	Port to z/OS.  Problem reported by Paul Gilmartin.
	Change local vars to use gl_ prefix rather than ac_.
	Don't define DOUBLE_SLASH_IS_DISTINCT_ROOT to 0, for consistency
	with other defines.
	* modules/double-slash-root: New module.
	* modules/dirname (Files): Remove m4/double-slash-root.m4.
	(Depends-on): Add double-slash-root.
	* MODULES.html.sh (File system functions): Mention new module.

2006-12-14  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/yesno.c [!ENABLE_NLS]: Don't include getline.h.
	(yesno) [!ENABLE_NLS]: Don't invoke getline or rpmatch.
	This is for the benefit of gzip, which doesn't do i18n.

2006-12-12  Jim Meyering  <jim@meyering.net>

	* m4/acl.m4 (gl_ACL_GET_FILE): Fix logic error.
	Reported by Andreas Schwab <schwab@suse.de>.

2006-12-12  Bruno Haible  <bruno@clisp.org>

	Merge these changes.
	2006-09-05  Bruno Haible  <bruno@clisp.org>
	* lib/iconvme.c (iconv_string): No need to save and restore errno when
	iconv_alloc succeeded.
	(iconv_alloc): Don't assume that malloc() or realloc(), when failing,
	sets errno to ENOMEM. (malloc on GNU/kFreeBSD doesn't.) No need to
	test for " && dest " at the end - dest is always != NULL there. Call
	iconv with 4xNULL arguments initially, to reset the state. Call iconv
	with 2xNULL arguments, also to flush the state storage. Handle the
	IRIX iconv behaviour. Realloc the final result, to throw away unused
	memory.

2006-12-11  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/openat.m4 (gl_FUNC_OPENAT): Don't compile mkdirat
	and fchmodat unconditionally, since glibc 2.4 has them.
	Problem reported by Arkadiusz Miskiewicz.

2006-12-10  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Show the include files only for those
	modules that are copied and specified.
	Reported by Karl Berry.

2006-12-08  Jim Meyering  <jim@meyering.net>

	* build-aux/announce-gen ($VERSION): Don't use of $Revision...$.
	Instead, use Emacs' time-stamp write hook.  Note that the time is UTC.

	* build-aux/announce-gen: Add two new options, both optional:
	--bootstrap-tools=TOOL_LIST
	      a comma-separated list of tools, e.g.,
	      autoconf,automake,bison,gnulib
	--gnulib-snapshot-date=DATE
	      if gnulib is in the bootstrap tool list,
	      then report this as the snapshot date.
	      If not specified, use the current date/time.
	      If you specify a date here, be sure it's UTC.

2006-12-05  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/test-argp-2.sh: Fix test to match actual output.
	(func_compare): Fix sed script to be portable.

2006-12-05  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/utimens.c (futimens) [HAVE_BUGGY_NFS_TIME_STAMPS]: Add a
	workaround for this case.  It is not autoconfigured now; offhand
	it's hard to see how to autoconfigure it.

2006-12-03  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/mkdir-p.c (make_dir_parents): Fix race condition when making
	a directory that is about to be chowned.  Such a directory's
	initial file permissions should permit the owner only and this
	should not be changed until after the chown, since the group and
	other bits would be incorrect if they granted permission before
	the chown.

	Fix porting problem for iswctype reported by Georg Schwarz in:
	http://lists.gnu.org/archive/html/bug-coreutils/2006-12/msg00017.html
	* lib/fnmatch.c (WIDE_CHAR_SUPPORT): Require HAVE_ISWCTYPE, too.
	* lib/regex_internal.h (RE_ENABLE_I18N): Likewise.
	* m4/fnmatch.m4 (_AC_LIBOBJ_FNMATCH): Check for iswctype, too.
	* m4/regex.m4 (gl_PREREQ_REGEX): Likewise.

2006-12-03  Jim Meyering  <jim@meyering.net>

	* lib/fts.c (fts_load): Don't set sp->fts_dev here, since
	p->fts_statp may not yet be defined.
	(fts_read): Instead, set it in the caller, once p->fts_statp is
	sure to be defined, and corresponds to a top-level directory.
	This bug made du -x fail.  Here's the coreutils test case:
	http://git.sv.gnu.org/gitweb/?p=coreutils.git;a=commit;h=ba45154d8e9f
	Reported by Mike Frysinger.

2006-12-01  Jim Meyering  <jim@meyering.net>

	* modules/savewd (Depends-on): Add fcntl_h to avoid self-test
	build failure due to missing definition of HAVE_WORKING_O_NOFOLLOW.
	Reported by Simon Josefsson.

2006-11-30  Jim Meyering  <jim@meyering.net>

	* m4/warning.m4: Use the all-permissive copyright notice
	recommended by RMS (rather than LGPL).
	* m4/vararrays.m4: Likewise.
	* m4/flexmember.m4: Likewise.

2006-11-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): Initialize also
	noinst_LIBRARIES. Augment noinst_LIBRARIES and noinst_LTLIBRARIES
	using +=.
	Reported by Simon Josefsson <simon@josefsson.org>.

2006-11-28  James Youngman <jay@gnu.org>

	* README: Advise users that they might find the bug-gnulib@gnu.org
	and autotools-announce@gnu.org mailing lists useful.

2006-11-28  Bruno Haible  <bruno@clisp.org>

	* m4/ptrdiff_max.m4: Remove file.

2006-11-21  Bruno Haible  <bruno@clisp.org>

	* m4/eoverflow.m4 (gl_EOVERFLOW): Use AC_COMPUTE_INT instead of
	_AC_COMPUTE_INT.
	(AC_COMPUTE_INT): Add fallback definition for autoconf < 2.61.
	* m4/ptrdiff_max.m4 (gl_PTRDIFF_MAX): Use AC_COMPUTE_INT instead of
	_AC_COMPUTE_INT.
	(AC_COMPUTE_INT): Add fallback definition for autoconf < 2.61.
	* m4/size_max.m4 (gl_SIZE_MAX): Use AC_COMPUTE_INT instead of
	_AC_COMPUTE_INT.
	(AC_COMPUTE_INT): Add fallback definition for autoconf < 2.61.

2006-11-28  Jim Meyering  <jim@meyering.net>

	* lib/regcomp.c (parse_branch): Rename local, exp->expr, to avoid
	warning from "gcc -Wshadow" about shadowing the builtin.

2006-11-27  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_BITSIZEOF): Use AC_COMPUTE_INT instead of
	_AC_COMPUTE_INT.
	(AC_COMPUTE_INT): Add fallback definition for autoconf < 2.61.

2006-11-27  Bruno Haible  <bruno@clisp.org>
	    Paul Eggert  <eggert@cs.ucla.edu>

	* lib/regex.h (__restrict_arr): Redo logic of #if, for clarity.

2006-11-26  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): Initialize also
	noinst_LTLIBRARIES.

2006-11-27  Paul Eggert  <eggert@cs.ucla.edu>
	    Bruno Haible  <bruno@clisp.org>

	* lib/gettext.h (_LIBGETTEXT_HAVE_VARIABLE_SIZE_ARRAYS): Define to 0
	if compiling with "gcc -ansi".

2006-11-26  Paul Eggert  <eggert@cs.ucla.edu>

	Fix some incompatibilities with gcc -ansi -pedantic.
	* lib/regex.h (__restrict_arr): Don't use the [restrict] syntax
	if compiling pedantically with GCC, unless it's C99 or later.
	Don't trust sys/cdefs.h's definition of __restrict_arr, either, as
	it mishandles gcc -ansi -pedantic as well.
	* lib/regex_internal.h (re_token_t): Don't use enum bitfields
	if gcc -pedantic.
	* lib/regexec.c (check_node_accept_bytes): Don't use auto
	initializers for struct if -pedantic, unless it's C99 or later.

2006-11-25  Nix  <nix@esperi.org.uk>  (tiny change)

	* m4/fcntl_h.m4 (gl_FCNTL_H): Test the atime, not the mtime.
	Don't close an fd more than once. Identical atimes indicate
	success, not failure.

2006-11-22  Robinson Mittmann <bob@hoplon.com>  (tiny change)

	* lib/sincosl.c (kernel_sinl): Fix typo in threshold.

2006-11-23  Jim Meyering  <jim@meyering.net>

	* build-aux/announce-gen: New file.  From coreutils.

2006-11-22  Jim Meyering  <jim@meyering.net>

	Work around a compile-time error from the HP-UX 11.00 /bin/cc.
	* lib/fts.c (enum Fts_stat): Give this previously-anon enum a name.
	(fts_read): Use a temporary to narrow the overused st_size member
	before using it in a switch statement.  Reported by Matthew Woehlke.

	* m4/clock_time.m4 (gl_CLOCK_TIME): Quote AC_SUBST argument.
	* m4/euidaccess.m4 (gl_PREREQ_EUIDACCESS): Likewise.

2006-11-20  Bruno Haible  <bruno@clisp.org>

	* gettext.m4 (AM_GNU_GETTEXT): Revert 2005-07-28 patch: Use
	changequote instead of pairs of brackets.
	Reported by Andreas Schwab <schwab@suse.de>.

2006-11-21  Jim Meyering  <jim@meyering.net>

	* lib/fts.c (fts_safe_changedir): Move a declaration "up",
	so as to remain compatible with older compilers.
	Patch from Michael Deutschmann.

2006-11-20  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh (File system functions): Add openat.

	* lib/openat.h (rpl_fstatat): New macro, if
	[HAVE_OPENAT && ! LSTAT_FOLLOWS_SLASHED_SYMLINK.
	(fstatat): Define to rpl_fstatat under the same conditions,
	unless COMPILING_FSTATAT.
	* m4/openat.m4 (gl_FUNC_OPENAT): Compile fstatat.c too, if fstatat
	seems to have the bug.
	* lib/fstatat.c: New file.
	* modules/openat (Files): Add it.

2006-11-20  Bruno Haible  <bruno@clisp.org>

	* Makefile: New file.

2006-11-20  Jim Meyering  <jim@meyering.net>

	The beginnings of syntax-related checks for gnulib.
	* lib/Makefile: New file.
	* lib/t-idcache: New script.  Ensure that the two halves of
	idcache.c stay in sync.

	* lib/idcache.c: Adjust comments in user- and group- portions to
	be more accurate, and to be consistent with one another.

2006-11-20  Jim Meyering  <jim@meyering.net>

	* lib/idcache.c: Restore most of the 2006-11-06 patch, so as to
	continue using the flexible array member (thus, this module performs
	half as many malloc calls), with the addition that...
	(getgroup, getuser): Consistently record a non-match via an empty
	"name" string, and map an empty string match to a NULL return value.
	* modules/idcache (Depends-on): Re-add flexmember.

	* lib/idcache.c (getuser): Remove all uses of the register keyword.
	(getuidbyname, getgroup, getgidbyname): Likewise.

	Use cleaner syntax: NULL rather than 0.
	* lib/idcache.c (getuidbyname, getgidbyname): Return NULL, not 0.

2006-11-20  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/idcache.c: Undo most recent patch, dated 2006-11-06.
	It mishandled the case where the group was missing.
	Problem reported by Greg Schafer.
	* modules/idcache: Likewise.

2006-11-18  Jim Meyering  <jim@meyering.net>

	* check-module (%exempt_header): Add exception for some
	conditionally-included headers.

	* modules/i-ring (Depends-on): Add verify.
	(License): Change to LGPL.

2006-11-16  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/getaddinfo (Depends-on): Remove inttostr; add snprintf.
	* lib/getaddrinfo.c: Include snprintf.h rather than intprops.h
	and inttostr.h.  Use snprintf rather than uinttostr, so that
	LGPLed code doesn't depend on GPLed.

2006-11-17  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/inline (License): Change from GPL to LGPL.

2006-11-17  Jim Meyering  <jim@meyering.net>

	* modules/d-type (License): Switch to LGPL.

2006-11-15  Bruno Haible  <bruno@clisp.org>

	* m4/alloca.m4 (gl_FUNC_ALLOCA): Fix the AC_CACHE_CHECK message.

2006-11-15  Eric Blake  <ebb9@byu.net>

	* m4/allocsa.m4 (gl_ALLOCSA): Don't invoke macro already picked up by
	the module dependency.

2006-11-15  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>
	    Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Add license consistency check.

2006-11-15  Eric Blake  <ebb9@byu.net>

	* m4/alloca.m4 (gl_FUNC_ALLOCA): Use AC_CACHE_CHECK to avoid a
	random "(cached)" in configure output.

2006-11-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/inttypes.m4 (gl_INTTYPES_H): Use AC_CACHE_CHECK so that the
	test for conforming inttypes.h is both announced and cached.

	* MODULES.html.sh (seen_modules, seen_files): New variables.
	(func_module): Rewrite to use a few less gnulib-tool and sed
	invocations.  Avoid a couple of quadratic algorithms for ...
	(missed_modules, missed_files): ... these, with ...
	(func_append, func_tmpdir): ... these new functions, from
	gnulib-tool.  Analogously, install traps for cleanup.

	* tests/test-gc.c (main): Remove unused variables.
	* tests/test-read-file.c: Include stdlib.h, for 'free'.

2006-11-14  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/inttostr (License): Change to LGPL.

2006-11-14  Eric Blake  <ebb9@byu.net>

	* modules/tempname (License): Change to LGPL.

2006-11-14  Eric Blake  <ebb9@byu.net>

	* doc/functions.texi (Function Portability): *printf functions on
	Cygwin now understand all POSIX size specifiers.

2006-11-14  Bruno Haible  <bruno@clisp.org>

	* modules/c-ctype (License): Change to LGPL.

2006-11-12  Bruno Haible  <bruno@clisp.org>

	* m4/lib-link.m4 (AC_LIB_LINKFLAGS, AC_LIB_HAVE_LINKFLAGS,
	AC_LIB_LINKFLAGS_BODY): Also set a LIB${NAME}_PREFIX variable. Needed
	for GNOME libraries, for which the include files are installed in
	subdirectories of $prefix/include.

2006-11-12  Bruno Haible  <bruno@clisp.org>

	* m4/lib-link.m4: Require at least autoconf-2.54.
	(AC_LIB_LINKFLAGS_BODY) [autoconf < 2.61]: Turn dots into the library
	name to underscores for the --with option.

2006-11-13  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Set gl_source_base correctly in
	the tests directory.
	Reported by Ralf Wildenhues.

2006-11-13  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_initmacro_start): Also override AC_LIBSOURCES.
	(func_emit_initmacro_end): Undo the override here.
	(func_emit_initmacro_done): Emit a definition for gl_LIBSOURCES.
	Works around the famous automake error in coreutils.

2006-11-13  Eric Blake  <ebb9@byu.net>

	* lib/gl_anytree_oset.h (gl_tree_search_atleast): Return the
	element, not its node.

2006-11-12  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): Replace occurrences of
	'$(top_srcdir)/build-aux/', taking into account the real auxdir.

2006-11-12  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: New option --local-symlink.
	(func_usage): Document it.
	(lsymbolic): New variable.
	(func_import, func_create_testdir): If --symlink was not specified,
	test whether --local-symlink was specified and the file comes from
	the local_gnulib_dir.

2006-11-12  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_ln): New function.
	(func_ln_if_changed, func_create_testdir): Use it instead of "ln -s".

2006-11-12  Bruno Haible  <bruno@clisp.org>

	Finish support for source files in subdirectories.
	* gnulib-tool (func_emit_lib_Makefile_am): If some of the source files
	are in subdirectories, set uses_subdirs and add 'subdir-objects' to
	AUTOMAKE_OPTIONS.
	(func_import, func_create_testdir): Invoke AM_PROG_CC_C_O in this case.

2006-11-12  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_automake_snippet): Synthesize also an
	EXTRA_lib_SOURCES augmentation.
	(func_emit_lib_Makefile_am): Initialize EXTRA_lib..._SOURCES to empty.

2006-11-12  Jim Meyering  <jim@meyering.net>

	Make fts (in FTS_CWDFD mode) more efficient by caching a few open
	file descriptors.  This also averts a failure on systems with
	native openat support when a traversed directory lacks "x" access.
	* lib/fts_.h: Include "i-ring.h"
	(struct FTS) [fts_fd_ring]: New member.
	* lib/fts.c (RESTORE_INITIAL_CWD): Also call fd_ring_clear.
	(FCHDIR): Add parentheses.
	(fd_ring_check, fd_ring_print) [!FTS_DEBUG]: Define away.
	(cwd_advance_fd): Add a 3rd parameter.  Adjust all callers.
	When descending, rather than simply closing the previous
	fts_cwd_fd value, push that file descriptor onto the ring.
	(same_fd, fd_ring_print, fd_ring_check) [FTS_DEBUG]: New functions.
	(fts_open): Initialize the new fd_ring member.
	(fts_close): Clear the ring.
	(fts_safe_changedir): When possible, use our new fd_ring to skip
	the diropen and fstat and dev/ino comparison that would normally
	accompany a virtual `chdir ("..")'.

	* modules/fts (Depends-on): Add i-ring.
	* modules/i-ring: New module.
	* lib/i-ring.c, lib/i-ring.h, lib/i-ring-test.c: New files.
	* m4/i-ring.m4: New file.

2006-11-12  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_create_testdir): Fix replacement of
	`build-aux' in configure.ac.  Run autotools in gltests
	subdirectory.
	(func_create_testdir, func_create_megatestdir, test): There is
	no need for '--force' in most autotool invocations in a new
	tree.  Actually fail the whole test if any of the tools, or the
	configure or make stages fail.

	Sync from Automake.
	* build-aux/gnupload: Revert last change.  Add pointer to upload
	instructions of the GNU Maintenance Instructions.
	Suggestion by Karl Berry.

2006-11-10  Jim Meyering  <jim@meyering.net>

	* lib/fts.c [FTS_DEBUG]: Don't try to print a pointer via %s.

2006-11-09  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/gettext.h (dgettext, dcgettext, ngettext) [! ENABLE_NLS]:
	(dngettext, dcngettext, bindtextdomain) [! ENABLE_NLS]:
	(bind_textdomain_codeset) [! ENABLE_NLS]:
	Evaluate all the arguments.  That way, callers get compatible behavior
	if the arguments have side effects.  Also, it avoids some GCC
	diagnostics in some cases; Joel E. Denny reported problems when Bison
	was configured with --enable-gcc-warnigs.

2006-11-10  Jim Meyering  <jim@meyering.net>

	* m4/inline.m4 (gl_INLINE): Check with the compiler, not cpp, so that
	relevant options in CFLAGS (like -O, -fno-inline) are taken into
	account.

2006-11-10  Jim Meyering  <jim@meyering.net>

	* modules/inline: New file/module.
	* modules/xalloc (Files): Remove m4/inline.m4.
	(Depends-on): Add inline, instead.
	* modules/oset: Likewise.
	* modules/list: Likewise.

2006-11-09  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stdint_.h (uintmax_t): Fix typo: int64_t -> uint64_t.
	Problem reported by Matthew Woehlke.

2006-11-09  Bruno Haible  <bruno@clisp.org>

	* lib/tempname.c (gen_tempname): Remove variant that invokes
	__gen_tempname.
	* m4/tempname.m4 (gl_FUNC_GEN_TEMPNAME): Don't test for
	__gen_tempname.

2006-11-08  Bruno Haible  <bruno@clisp.org>

	* m4/longlong.m4 (AC_TYPE_LONG_LONG_INT): Set ac_cv_type_long_long_int
	to 'yes' instead of 'cross-compiling'.

2006-11-08  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/quotearg.h (quotearg_free): New decl.
	* lib/quotearg.c (quotearg_free): New function.
	(slot0, nslots, slotvec0, slotvec):
	Now file-scope so that quotearg_free can get at them.

2006-11-08  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Sync from Automake.
	* build-aux/gnupload: Add missing 'gnu' to example URL.
	Report by Karl Berry.

2006-11-08  Bruno Haible  <bruno@clisp.org>

	* m4/inline.m4 (gl_INLINE): Also test __NO_INLINE__.
	Suggested by Paul Eggert.

2006-11-08  Jim Meyering  <jim@meyering.net>

	* lib/fts.c [!_LGPL_PACKAGE]: Don't include fcntl--.h twice.
	It's already included if !_LIBC.
	(fts_safe_changedir): Add a comment.

2006-11-07  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/longlong.m4 (AC_TYPE_LONG_LONG_INT): Detect bug in
	Tandem NonStop Kernel (OSS) cc -O circa 2004, reported by
	Matthew Woehlke.

	* lib/xalloc.h (XMALLOC, XNMALLOC, XZALLOC, XCALLOC): Move
	definitions up, to avoid colliding with change below.
	(static_inline) [HAVE_INLINE]: New macro.
	(xnmalloc, xnrealloc, x2nrealloc, xcharalloc):
	Provide extern decls when !HAVE_INLINE.  Do not define unless
	static_inline is defined, either by us or by xmalloc.c.  Use
	static_inline rather than static inline.
	(XCALLOC): Optimize sizeof(T) = 1 case.
	* lib/xmalloc.c (static_inline) [!HAVE_INLINE]: New macro.

2006-11-07  Bruno Haible  <bruno@clisp.org>

	* lib/xalloc.h (XNMALLOC): Restore optimization of sizeof(T) = 1 case.
	* m4/xalloc.m4 (gl_PREREQ_XALLOC): Require gl_INLINE instead of
	AC_C_INLINE.
	* modules/xalloc (Files): Add m4/inline.m4.

2006-11-07  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* README: Fix typo.
	* doc/gnulib.texi (Miscellaneous Notes): Likewise, rename...
	(Miscellanous Notes): ...from this.

2006-11-07  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/flexmember.m4 (AC_C_FLEXIBLE_ARRAY_MEMBER):
	Mention that offsetof should be used instead of sizeof.
	From Bruno Haible.

2006-11-07  Bruno Haible  <bruno@clisp.org>

	* lib/w32spawn.h (prepare_spawn): Use XNMALLOC instead of xmalloc.

2006-11-06  Paul Eggert  <eggert@cs.ucla.edu>

	Simplify xmalloc expressions. Add overflow check in xmalloc arguments.
	* lib/gl_anyavltree_list2.h (create_subtree_with_contents):
	(gl_tree_create, gl_tree_add_first, gl_tree_add_last):
	(gl_tree_add_before, gl_tree_add_after):
	Use XMALLOC instead of xmalloc, and XCALLOC instead of xzalloc.
	* lib/gl_anyhash_list2.h (hash_resize): Likewise.
	* lib/gl_anylinked_list2.h (gl_linked_create_empty, gl_linked_create):
	(gl_linked_add_first, gl_linked_add_last, gl_linked_add_before):
	(gl_linked_add_after, gl_linked_add_at): Likewise.
	* lib/gl_anyrbtree_list2.h (create_subtree_with_contents):
	(gl_tree_create, gl_tree_add_first, gl_tree_add_last):
	(gl_tree_add_before, gl_tree_add_after): Likewise.
	* lib/gl_anytree_list2.h (gl_tree_create_empty): Likewise.
	* lib/gl_anytree_oset.h (gl_tree_create_empty): Likewise.
	* lib/gl_anytreehash_list1.h (add_to_bucket): Likewise.

2006-11-06  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/gl_oset.h: Use C comment style, not C++ comment style.

2006-11-06  Bruno Haible  <bruno@clisp.org>

	* m4/inline.m4: New file.
	* m4/gl_list.m4 (gl_LIST): Require gl_INLINE.
	* modules/list (Files): Add m4/inline.m4.
	* modules/oset (Files): Likewise.

2006-11-06  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/idcache.c: Include <stddef.h>, for offsetof.
	(struct userid.name): Change from char * to a flexible array member.
	All uses changed.
	* modules/idcache (Depends-on): Add flexmember.

	* MODULES.html.sh (Core language properties): New module flexmember.
	* modules/flexmember, m4/flexmember.m4: New files.

	* lib/xalloc.h (xnmalloc, xnrealloc, x2nrealloc): Now static
	inline functions that are identical with the old xnmalloc_inline,
	xnrealloc_inline, x2nrealloc_inline of lib/xmalloc.c.  This is so
	that we can avoid some unnecessary integer multiplications and
	divisions in the common case where the element size is known at
	compile time.
	(XNMALLOC) [HAVE_INLINE]: Remove special case, which is no longer
	needed.
	(xnboundedmalloc): Remove.
	(XMALLOC, XNMALLOC, XZALLOC, XCALLOC): Use lower-case letters for
	arguments, for consistency with rest of this header.
	(xcharalloc): Rewrite using XNMALLOC.
	* lib/xmalloc.c (xnmalloc_inline, xnmalloc, xnrealloc_inline):
	(xnrealloc, x2nrealloc_inline, x2nrealloc): Remove.  The *_inline
	versions have been moved to lib/xalloc.h and renamed to be the
	non-*_inline versions.
	(xmalloc, xrealloc): Implement without reference to the xnmalloc
	and xnrealloc functions, since those functions are now inline and
	now call us.
	(x2realloc): Invoke x2realloc, not x2realloc_inline, to accommodate
	renaming described above.
	* m4/xalloc.m4 (gl_PREREQ_XMALLOC): Remove AC_C_INLINE since
	xmalloc.c no longer uses inline directly.  gl_PREREQ_XALLOC now
	captures the dependency in AC_C_INLINE.

	New module canonicalize-lgpl, proposed by Charles Wilson in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-11/msg00020.html>
	with a few small changes afterwards.
	* MODULES.html.sh (File system functions): New module
	canonicalize-lgpl.
	* lib/canonicalize.h: Add comments for canonicalize_filename_mode
	and canonicalize_file_name.
	* lib/canonicalize-lgpl.c, m4/canonicalize-lgpl.m4:
	* modules/canonicalize-lgpl: New files.

2006-11-05  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import, func_create_testdir): Create directories
	also for files in subdirectories of lib/.

2006-11-05  Bruno Haible  <bruno@clisp.org>

	* lib/gl_array_list.c (gl_array_iterator_next): Make pointer decrement
	ANSI C compliant.

2006-11-03  Bruno Haible  <bruno@clisp.org>

	Simplify xmalloc expressions. Add overflow check in xmalloc arguments.
	* m4/xalloc.m4 (gl_PREREQ_XALLOC): Require AC_C_INLINE.
	* lib/xalloc.h (XMALLOC, XNMALLOC, XZALLOC, XCALLOC): New macros.
	(xnboundedmalloc): New inline function.
	* lib/classpath.c (new_classpath): Use XNMALLOC instead of xmalloc.
	* lib/clean-temp.c (create_temp_dir): Use XNMALLOC, XMALLOC instead of
	xmalloc.
	* lib/concatpath.c (concatenated_pathname): Use XNMALLOC instead of
	xmalloc.
	* lib/fatal-signal.c (at_fatal_signal): Use XNMALLOC instead of xmalloc.
	* lib/findprog.c (find_in_path): Use XNMALLOC instead of xmalloc.
	* lib/gl_array_list.c (gl_array_create_empty): Use XMALLOC instead of
	xmalloc.
	(gl_array_create): Use XNMALLOC, XMALLOC instead of xmalloc.
	* lib/gl_array_oset.c (gl_array_create_empty): Use XNMALLOC instead of
	xmalloc.
	* lib/gl_avltree_oset.c (gl_tree_add_first, gl_tree_add_before,
	gl_tree_add_after): Use XMALLOC instead of xmalloc.
	* lib/gl_carray_list.c (gl_carray_create_empty): Use XMALLOC instead of
	xmalloc.
	(gl_carray_create): Use XNMALLOC, XMALLOC instead of xmalloc.
	* lib/gl_rbtree_oset.c (gl_tree_add_first, gl_tree_add_before,
	gl_tree_add_after): Use XMALLOC instead of xmalloc.
	* lib/gl_sublist.c (gl_sublist_create): Use XMALLOC instead of xmalloc.
	* lib/pagealign_alloc.c (new_memnode): Use XMALLOC instead of xmalloc.
	* lib/sh-quote.c (shell_quote_argv): Use XNMALLOC instead of xmalloc.
	* lib/xvasprintf.c (xstrcat): Use XNMALLOC instead of xmalloc.

2006-11-03  Bruno Haible  <bruno@clisp.org>

	* lib/c-ctype.h [C++]: Define functions without name mangling.
	* lib/fwriteerror.h [C++]: Likewise.
	* lib/gcd.h [C++]: Likewise.
	* lib/linebreak.h [C++]: Likewise.

2006-11-03  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/canonicalize.h: (canonicalize_mode_t, CAN_EXISTING):
	(CAN_ALL_BUT_LAST, CAN_MISSING, canonicalize_filename_mode):
	Define only if PROVIDE_CANONICALIZE_FILENAME_MODE is defined.
	* m4/canonicalize.m4 (AC_FUNC_CANONICALIZE_FILE_NAME):
	Check for functions and headers just once.
	Check for declaration of canonicalize_file_name.
	Define PROVIDE_CANONICALIZE_FILENAME_MODE.

2006-11-02  Charles Wilson  <cygwin@cwilson.fastmail.fm>

	* gnulib-tool (func_import): Fix typo in actioncmd.

2006-11-02  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_automake_snippet): Interpret a backslash-
	newline sequence in the Makefile.am snippet as a space, like "make"
	does.
	Reported by Roger Persson <perrog@gmail.com>.

2006-11-01  Bruno Haible  <bruno@clisp.org>

	* m4/strcase.m4 (gl_FUNC_STRNCASECMP): Check whether strncasecmp is
	already declared in <string.h>.
	* lib/strcase.h (strncasecmp): Don't declare it if yes.

2006-11-01  Bruno Haible  <bruno@clisp.org>

	* m4/strcase.m4 (gl_FUNC_STRCASECMP): Don't define strcasecmp here.
	* lib/strcase.h: Include <string.h>.
	(strcasecmp): Define to rpl_strcasecmp here.

2006-11-01  Bruno Haible  <bruno@clisp.org>

	* lib/printf-parse.c (PRINTF_PARSE): Cast malloc/realloc results.

2006-11-01  Eric Blake  <ebb9@byu.net>

	* lib/mkstemp-safer.c (mkstemp_safer): Allow C++ compilation.

	* m4/mkstemp.m4 (gl_FUNC_MKSTEMP): Allow C++ configuration.

2006-10-29  Bruno Haible  <bruno@clisp.org>

	Make it compile in C++ mode.
	* lib/full-write.c (full_rw): Add a cast.

2006-11-01  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_automake_snippet): Change sed_combine_lines to
	be POSIX compliant.
	Reported by Roger Persson <perrog@gmail.com>.

2006-11-01  Eric Blake  <ebb9@byu.net>

	* lib/getopt_.h: Fix comments.

2006-10-31  Eric Blake  <ebb9@byu.net>

	* modules/tmpdir (Depends-on): Add sys_stat.
	* modules/mkdtemp (Depends-on): Add tempname, drop unistd.
	* lib/mkdtemp.c (gen_tempname): Remove; tempname covers this.
	* lib/tmpdir.c (S_ISDIR): Simplify, thanks to sys_stat.
	* m4/mkdtemp.m4 (gl_PREREQ_MKDTEMP): Simplify, thanks to
	tempname.

2006-10-31  Paul Eggert  <eggert@cs.ucla.edu>

	Avoid some C++ diagnostics reported by Bruno Haible.
	* lib/quotearg.c (clone_quoting_options): Use xmemdup rather than
	xmalloc.
	(quotearg_alloc): Use xcharalloc rather than xmalloc.
	(struct slotvec): Move to top level.
	(quotearg_n_options): Rewrite to avoid xmalloc.
	* lib/xalloc.h (xcharalloc): New function.
	* (xrealloc, xnrealloc, x2realloc, x2nrealloc, xmemdup):
	[defined __cplusplus]: Add function template that provides result
	type propagation.  This part of the change is from Bruno Haible.

2006-10-29  Bruno Haible  <bruno@clisp.org>

	Make it compile in C++ mode.
	* lib/striconv.c (mem_cd_iconv): Cast malloc/realloc result.
	* lib/strnlen1.c (strnlen1): Cast memchr result.
	* lib/mbchar.h (mb_copy): Rename arguments to 'new_mbc', 'old_mbc'.
	* lib/clean-temp.c (string_equals, string_hash): Add casts.
	(create_temp_dir): Rename local variable 'template'.
	(compile_csharp_using_sscli): Add cast.
	* lib/fatal-signal.c (at_fatal_signal): Cast xmalloc result.
	* lib/findprog.c (find_in_path): Likewise.
	* lib/linebreak.c (mbs_width_linebreaks): Cast malloc result.
	* lib/wait-process.c (register_slave_subprocess): Likewise.

2006-10-22  Bruno Haible  <bruno@clisp.org>

	* modules/tsearch: New file.
	* lib/tsearch.h: New file.
	* lib/tsearch.c: New file, from glibc-2.5 with small modifications.
	* m4/tsearch.m4: New file.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add tsearch.

2006-10-29  Eric Blake  <ebb9@byu.net>

	* lib/arcfour.c: Assume config.h.
	* lib/arctwo.c: Likewise.
	* lib/base64.c: Likewise.
	* lib/check-version.c: Likewise.
	* lib/crc.c: Likewise.
	* lib/des.c: Likewise.
	* lib/gc-gnulib.c: Likewise.
	* lib/gc-libgcrypt.c: Likewise.
	* lib/gc-pbkdf2-sha1.c: Likewise.
	* lib/getaddrinfo.c: Likewise.
	* lib/getdelim.c: Likewise.
	* lib/getline.c: Likewise.
	* lib/hmac-md5.c: Likewise.
	* lib/hmac-sha1.c: Likewise.
	* lib/iconvme.c: Likewise.
	* lib/md2.c: Likewise.
	* lib/md4.c: Likewise.
	* lib/memxor.c: Likewise.
	* lib/read-file.c: Likewise.
	* lib/readline.c: Likewise.
	* lib/rijndael-alg-fst.c: Likewise.
	* lib/rijndael-api-fst.c: Likewise.
	* lib/xgetdomainname.c: Likewise.

2006-10-28  Eric Blake  <ebb9@byu.net>

	* lib/xstrndup.c: Assume config.h.

2006-10-27  Paul Eggert  <eggert@cs.ucla.edu>

	Move stat.h-substitute stuff from lib/stat-macros.h to lib/stat_.h.
	stat-macros.h is now for our own macros, whereas stat_h is for
	macros in the <sys/stat.h> name space.
	* lib/stat-macros.h: Remove copyright notice, as this file is now tiny.
	(STAT_MACROS_H): Remove.
	(S_IFMT, S_ISBLK, S_ISCHR, S_ISDIR, S_ISFIFO, S_ISLNK, S_ISNAM):
	(S_ISMPB, S_ISMPC, S_ISNWK, S_ISREG, S_ISSOCK, S_ISDOOR, S_ISPORT):
	(S_TYPEISMQ, S_TYPEISTMO, S_TYPEISSEM, S_TYPEISSHM, S_ISCTG, S_ISOFD):
	(S_ISOFL, S_ISWHT, S_ISUID, S_ISGID, S_ISVTX, S_IRUSR, S_IRGRP):
	(S_IROTH, S_IWUSR, S_IWGRP, S_IWOTH, S_IXUSR, S_IXGRP, S_IXOTH):
	(S_IRWXU, S_IRWXG, S_IRWXO, S_IXUGO, S_IRWXUGO):
	Move these macros to ...
	* lib/stat_.h: here.  Don't include stat-macros.h.
	* lib/canonicalize.c: Don't include stat-macros.h.
	* lib/chown.c: Likewise.
	* lib/euidaccess.c: Likewise.
	* lib/file-type.c: Likewise.
	* lib/filemode.c: Likewise.
	* lib/glob.c: Likewise.
	* lib/isapipe.c: Likewise.
	* lib/lchown.c: Likewise.
	* lib/lstat.c: Likewise.
	* lib/mkdir-p.c: Likewise.
	* lib/rmdir.c: Likewise.
	* m4/lchown.m4 (gl_FUNC_LCHOWN): Don't require gl_STAT_MACROS.
	* m4/sys_stat_h.m4 (gl_HEADER_SYS_STAT_H): Don't check for io.h
	unless mkdir isn't declared, to speed up 'configure'.
	Always create sys/stat.h, since it's unlikely any real sys/stat.h
	would define all the S_* symbols.
	* modules/canonicalize (Depends-on):
	Depend on sys_stat, not stat-macros.
	* modules/chown: Likewise.
	* modules/euidaccess: Likewise.
	* modules/filemode: Likewise.
	* modules/file-type: Likewise.
	* modules/glob: Likewise.
	* modules/isapipe: Likewise.
	* modules/lchown: Likewise.
	* modules/lstat: Likewise.
	* modules/mkancesdirs: Likewise.
	* modules/rmdir: Likewise.
	* modules/mkdir-p (Depends-on): Also depend on sys_stat.
	* modules/modechange: Likewise.
	* modules/stat-macros (Files): Remove m4/stat-macros.m4.
	(configure.ac): Remove gl_STAT_MACROS.
	* modules/sys_stat (Depends-on): Remove stat-macros.

2006-10-27  Bruno Haible  <bruno@clisp.org>

	* m4/signed.m4: Remove file.
	* m4/vasnprintf.m4 (gl_PREREQ_PRINTF_ARGS_: Remove bh_C_SIGNED
	invocation.
	* modules/vasnprintf (Files): Remove m4/signed.m4.

2006-10-27  Bruno Haible  <bruno@clisp.org>

	Update to GNU gettext 0.16.
	* modules/gettext (Files): Add m4/intl.m4, m4/intldir.m4. Remove
	m4/inttypes-h.m4, m4/signed.m4.
	* m4/gettext.m4: Update to GNU gettext 0.16.
	* m4/intl.m4: New file, from GNU gettext.
	* m4/intldir.m4: New file, from GNU gettext.
	* config/srclist.txt: Update

2006-10-27  Eric Blake  <ebb9@byu.net>

	* MODULES.html.sh: Document tempname.
	* modules/mkstemp (Depends-on): Add tempname, and drop transitive
	dependencies.
	(Files): Move lib/tempname.c...
	* modules/tempname: ...to this new module.
	* m4/mkstemp.m4 (gl_FUNC_MKSTEMP): Remove tempname checks.
	(gl_PREREQ_TEMPNAME): Move...
	* m4/tempname.m4: ...to this new file.
	* lib/mkstemp.c (includes) [!_LIBC]: Use tempname.h.
	* modules/sys_stat (Depends-on): Add stat-macros.
	* lib/stat_.h (includes): Pick up stat macros.
	* m4/sys_stat_h.m4 (gl_HEADER_SYS_STAT_H): Replace <sys/stat.h>
	if stat macros are broken.
	* lib/tempname.c (includes): No need to include "stat-macros.h".
	(__gen_tempname) [!_LIBC]: Expose as gen_tempname.
	(direxists, __path_search) [!_LIBC]: Don't compile these in
	gnulib; the tmpdir module covers that.
	* lib/tempname.h: New file.

2006-10-26  Paul Eggert  <eggert@cs.ucla.edu>

	* COPYING: Explain how gnulib-tool converts licence headers.
	Almost all wording by Eric Blake.

2006-10-25  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/mbchar.h (is_basic_table): Make read-only.
	* lib/mbchar.c (is_basic_table): Likewise.
	Reported by John Darrington.

2006-10-25  Bruno Haible  <bruno@clisp.org>

	* lib/progname.h (set_program_name): Undefine before defining.

2006-10-25  Bruno Haible  <bruno@clisp.org>

	* lib/gettext.h (_LIBGETTEXT_HAVE_VARIABLE_SIZE_ARRAYS): Define to
	false for non-gcc C++ compilers.
	Reported by Nelson H. F. Beebe <beebe@math.utah.edu>.

2006-10-24  Bruno Haible  <bruno@clisp.org>

	* lib/striconv.c (mem_cd_iconv, str_cd_iconv): Treat all non-GNU
	iconv implementations like Irix iconv.

2006-10-24  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/vararrays: New file.
	* m4/vararrays.m4: New file, taken from diffutils.
	* MODULES.html.sh: New module vararrays.

2006-10-24  Karl Berry  <karl@gnu.org>

	* doc/gnulib-intro.texi: --- instead of --; non-naive naive.
	Don't call GNU Unix.

2006-10-24  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* users.txt: Add Libtool.

	Sync from Libtool:

	2006-10-24  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/argz.c: Remove check for HAVE_CONFIG_H, to conform
	to gnulib's policy of including config.h unconditionally.

2006-10-24  Bruno Haible  <bruno@clisp.org>

	* modules/wcwidth (Files): Add m4/wint_t.m4.
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Require gt_TYPE_WINT_T.
	* lib/wcwidth.h (iswprint): Use 'int' if 'wint_t' is not defined.

2006-10-24  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getdate.y (yyerror): Make the arguments pointer-to-const,
	to pacify GCC with some -W flags enabled.  Problem reported by
	Bruno Haible.

2006-10-24  Jim Meyering  <jim@meyering.net>

	* MODULES.html.sh: Remove uinttostr.  It's not a module.
	Reported by Karl Berry.

2006-10-23  Bruno Haible  <bruno@clisp.org>

	* lib/fts.c (fts_build): Move variable declaration, for C89 compliance.

2006-10-24  Bruno Haible  <bruno@clisp.org>

	* lib/gl_list.h: Use C comment style, not C++ comment style.

2006-10-23  Eric Blake  <ebb9@byu.net>

	* lib/getaddrinfo.c (includes): Add missing include.

2006-10-23  Bruno Haible  <bruno@clisp.org>
	    Paul Eggert  <eggert@cs.ucla.edu>

	Ability to rename obstack_free.
	* lib/obstack.h (__obstack_free): New macro. Declare instead of
	obstack_free.
	(obstack_free): Invoke the __obstack_free macro.
	* lib/obstack.c (obstack_free): Use __obstack_free macro.

2006-10-23  Bruno Haible  <bruno@clisp.org>
	    Paul Eggert  <eggert@cs.ucla.edu>

	* lib/argp.h (argp_parse, __argp_parse): Comment out the identifiers
	__argc, __argv from the declaration. (They are defined as macros on
	mingw.)

2006-10-22  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-intro.texi: New file.
	* doc/gnulib.texi: Include it.

2006-10-21  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib.texi: Split the chapter "Gnulib" into 3 chapters
	"Introduction", "Miscellanous Notes", "Particular Modules".

2006-10-21  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am, func_emit_tests_Makefile_am):
	Change mostlyclean-local rule to avoid sh syntax error from bash
	versions 2.00..2.05 when $(MOSTLYCLEANDIRS) is empty.

2006-10-23  Jim Meyering  <jim@meyering.net>

	* lib/getaddrinfo.c (getnameinfo): Use new lightweight uinttostr,
	in place of snprintf.

	* modules/inttostr (Files): Add lib/uinttostr.c.
	* lib/uinttostr.c (inttostr): New file/function.
	* lib/inttostr.h (uinttostr): Declare.
	* m4/inttostr.m4: Add AC_LIBOBJ([uinttostr]).
	* MODULES.html.sh (Numeric conversion functions <stdlib.h>):
	Add uinttostr.
	* modules/getaddrinfo (Depends-on): Remove snprintf.  Add inttostr.

2006-10-21  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/canonicalize.c (ELOOP): Define if not already defined.
	Problem reported by Bruno Haible in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-10/msg00282.html>.

2006-10-21  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stdint_.h [defined _AIX]: Don't include <sys/types.h>.
	Problem reported by Perry Smith and Ville Laurikari.

	* lib/getndelim2.c (SSIZE_MAX): Use same defn that getdelim.c
	uses.

2006-10-19  Bruno Haible  <bruno@clisp.org>

	* lib/getndelim2.c (SSIZE_MAX): Provide fallback definition. Needed
	for mingw.

2006-10-19  Bruno Haible  <bruno@clisp.org>

	* lib/openat-priv.h (EOPNOTSUPP): Provide fallback definition.
	Needed for mingw.

2006-10-19  Bruno Haible  <bruno@clisp.org>

	* m4/size_max.m4 (gl_SIZE_MAX): Cache the result.

2006-10-19  Bruno Haible  <bruno@clisp.org>

	* m4/allocsa.m4 (gl_ALLOCSA): Invoke gl_FUNC_ALLOCA, don't AC_REQUIRE
	it.

2006-10-19  Bruno Haible  <bruno@clisp.org>

	* m4/alloca.m4 (gl_FUNC_ALLOCA): Cache the result of the AC_EGREP_CPP
	invocation.

2006-10-19  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Don't include ftruncate and
	mountlist by default.

2006-10-16  Bruno Haible  <bruno@clisp.org>

	* lib/c-strstr.c: Include c-strstr.h.

2006-10-18  Charles Wilson  <cygwin@cwilson.fastmail.fm>

	* gnulib-tool: Don't clobber $sourcebase when $local_gnulib_dir ends
	in a slash.

2006-10-18  Bruno Haible  <bruno@clisp.org>

	* lib/lock.h [C++]: Wrap definitions in extern "C".

2006-10-18  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_initmacro_end): Remove duplicates from the
	gl_LIBOBJS list.

2006-10-18  Bruno Haible  <bruno@clisp.org>

	* lib/findprog.c (find_in_path): Avoid "gcc -Wwrite-strings" warning.

2006-10-19  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/xstrtol.h: Include gettext.h.
	(_STRTOL_ERROR): Wrap English-language formats inside gettext.
	Problem reported by Eric Blake.
	* modules/xstrtol (Depends-on): Add gettext-h.

2006-10-19  Paul Eggert  <eggert@cs.ucla.edu>  (tiny change)

	* lib/strftime.c (advance): New macro.
	(add): Use it to avoid adding 0 to a FILE *.  FILE can be an
	incomplete type, so you can't add 0 to it.  Problem and patch
	reported by Eelco Dolstra for dietlibc.

2006-10-18  Jim Meyering  <jim@meyering.net>

	* lib/readutmp.c (desirable_utmp_entry): Use "bool" as the
	type for a local, and rename it: s/up/user_proc/.

2006-10-18  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/readutmp.c (desirable_utmp_entry): Implement new flag:
	READ_UTMP_USER_PROCESS.
	* lib/readutmp.h (READ_UTMP_USER_PROCESS): New flag

2006-10-17  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/localcharset.c: Do not check HAVE_SETLOCALE.
	* m4/localcharset.m4 (gl_LOCALCHARSET): Don't check for setlocale.

2006-10-17  Eric Blake  <ebb9@byu.net>

	* lib/sigprocmask.c (sigprocmask): Fix typo.

	* m4/signalblocking.m4 (gl_PREREQ_SIGPROCMASK): Fix typo.

	* modules/clean-temp (Makefile.am): Don't add to make output...
	(configure.ac): ...instead define SIGNAL_SAFE_LIST inside
	config.h.

2006-10-17  Bruno Haible  <bruno@clisp.org>

	* lib/gettext.h (gettext, ngettext, pgettext, npgettext): Define
	differently if DEFAULT_TEXT_DOMAIN is set.

2006-10-16  Bruno Haible  <bruno@clisp.org>

	* lib/clean-temp.c: Include fwriteerror.h.

2006-10-16  Bruno Haible  <bruno@clisp.org>

	* getndelim2.m4 (gl_GETNDELIM2): Remove 2003-10-23 hack.

2006-10-16  Bruno Haible  <bruno@clisp.org>

	* m4/signalblocking.m4 (gl_PREREQ_SIGPROCMASK): Also test for sigset_t.
	* lib/sigprocmask.h: Include <sys/types.h>.
	(sigset_t): Use the system's definition if present.

2006-10-17  Eric Blake  <ebb9@byu.net>

	* lib/xvasprintf.c (includes): Assume config.h.
	* lib/xasprintf.c (includes): Likewise.

2006-10-16  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/fsusage.c (PROPAGATE_ALL_ONES): Don't assume uintmax_t is
	at least as wide as intmax_t.

2006-10-16  Alexandre Duret-Lutz  <adl@gnu.org>

	(Imported from Automake.)
	* build-aux/gnupload: Update to version 1.1 of directive file.

2006-10-16  Eric Blake  <ebb9@byu.net>

	* modules/configmake (Makefile.am): Add pkglibexecdir support, to
	match Automake 1.10a.

2006-10-14  Bruno Haible  <bruno@clisp.org>

	* modules/sigprocmask: New file.
	* lib/sigprocmask.h: New file.
	* lib/sigprocmask.c: New file.
	* m4/signalblocking.m4 (gl_SIGNALBLOCKING): Renamed from
	gt_SIGNALBLOCKING. When not defining HAVE_POSIX_SIGNALBLOCKING,
	request sigprocmask.o.
	(gl_PREREQ_SIGPROCMASK): New macro.
	* modules/fatal-signal (Files): Remove m4/signalblocking.m4.
	(Depends-on): Add sigprocmask.
	* m4/fatal-signal.m4 (gl_FATAL_SIGNAL): Don't require
	gt_SIGNALBLOCKING. Test for 'raise' only once.
	* lib/fatal-signal.c: Include sigprocmask.h.
	(fatal_signal_set, init_fatal_signal_set, block_fatal_signals,
	unblock_fatal_signals): Define always.
	* MODULES.html.sh (Support for systems lacking POSIX:2001): Add
	sigprocmask.

2006-10-14  Paul Eggert  <eggert@cs.ucla.edu>

	Sync from Automake.
	* build-aux/install-sh (posix_mkdir): Reject FreeBSD 6.1 mkdir -p -m,
	which incorrectly sets the mode of an existing destination
	directory.  In some cases the unpatched install-sh could do the
	equivalent of "chmod 777 /" or "chmod 0 /" on a buggy FreeBSD
	system.  We hope this is rare in practice, but it's clearly worth
	fixing.  Problem reported by Alex Unleashed in
	<http://lists.gnu.org/archive/html/bug-autoconf/2006-10/msg00012.html>.
	Also, don't bother to check for -m bugs unless we're using -m;
	suggested by Stepan Kasal.

2006-10-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Sync from Automake.
	* build-aux/depcomp (gcc3): Put dependency extraction flags before the
	`-c' flag, so they appear at the same position as in %FASTDEP%
	mode in depend2.am.  Fixes build failure for FreeBSD's c89,
	which ignores unknown options only after the first non-option.
	Bug report against M4 by Nelson H. F. Beebe.

2006-10-13  Jim Meyering  <jim@meyering.net>

	Fix a bug in yesterday's change.
	* lib/fts.c (fts_open): When using FTS_XDEV|FTS_NOSTAT,
	p->fts_statp->st_dev would be used uninitialized.
	Ensures that we always call fts_stat on the very first entry.
	Miklos Szeredi reported that find -xdev stopped working.

2006-10-12  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_automake_snippet): Append an automatically
	computed EXTRA_DIST augmentation.
	* modules/acl (Makefile.am): Remove EXTRA_DIST augmentation.
	* modules/alloca-opt (Makefile.am): Likewise.
	* modules/allocsa (Makefile.am): Likewise.
	* modules/arcfour (Makefile.am): Likewise.
	* modules/arctwo (Makefile.am): Likewise.
	* modules/argmatch (Makefile.am): Likewise.
	* modules/argz (Makefile.am): Likewise.
	* modules/atexit (Makefile.am): Likewise.
	* modules/backupfile (Makefile.am): Likewise.
	* modules/byteswap (Makefile.am): Likewise.
	* modules/c-strtod (Makefile.am): Likewise.
	* modules/c-strtold (Makefile.am): Likewise.
	* modules/calloc (Makefile.am): Likewise.
	* modules/canon-host (Makefile.am): Likewise.
	* modules/canonicalize (Makefile.am): Likewise.
	* modules/chdir-long (Makefile.am): Likewise.
	* modules/chdir-safer (Makefile.am): Likewise.
	* modules/check-version (Makefile.am): Likewise.
	* modules/chown (Makefile.am): Likewise.
	* modules/cloexec (Makefile.am): Likewise.
	* modules/close-stream (Makefile.am): Likewise.
	* modules/closeout (Makefile.am): Likewise.
	* modules/crc (Makefile.am): Likewise.
	* modules/csharpexec (Makefile.am): Likewise.
	* modules/cycle-check (Makefile.am): Likewise.
	* modules/des (Makefile.am): Likewise.
	* modules/dev-ino (Makefile.am): Likewise.
	* modules/dirfd (Makefile.am): Likewise.
	* modules/dirname (Makefile.am): Likewise.
	* modules/dup2 (Makefile.am): Likewise.
	* modules/eealloc (Makefile.am): Likewise.
	* modules/error (Makefile.am): Likewise.
	* modules/euidaccess (Makefile.am): Likewise.
	* modules/exclude (Makefile.am): Likewise.
	* modules/exitfail (Makefile.am): Likewise.
	* modules/fcntl-safer (Makefile.am): Likewise.
	* modules/fcntl (Makefile.am): Likewise.
	* modules/file-type (Makefile.am): Likewise.
	* modules/fileblocks (Makefile.am): Likewise.
	* modules/filemode (Makefile.am): Likewise.
	* modules/filenamecat (Makefile.am): Likewise.
	* modules/fnmatch (Makefile.am): Likewise.
	* modules/fopen-safer (Makefile.am): Likewise.
	* modules/fpending (Makefile.am): Likewise.
	* modules/fprintftime (Makefile.am): Likewise.
	* modules/free (Makefile.am): Likewise.
	* modules/fsusage (Makefile.am): Likewise.
	* modules/ftruncate (Makefile.am): Likewise.
	* modules/fts (Makefile.am): Likewise.
	* modules/gc-arcfour (Makefile.am): Likewise.
	* modules/gc-des (Makefile.am): Likewise.
	* modules/gc-hmac-md5 (Makefile.am): Likewise.
	* modules/gc-hmac-sha1 (Makefile.am): Likewise.
	* modules/gc-md4 (Makefile.am): Likewise.
	* modules/gc-pbkdf2-sha1 (Makefile.am): Likewise.
	* modules/gc-sha1 (Makefile.am): Likewise.
	* modules/gc (Makefile.am): Likewise.
	* modules/getaddrinfo (Makefile.am): Likewise.
	* modules/getcwd (Makefile.am): Likewise.
	* modules/getdelim (Makefile.am): Likewise.
	* modules/getdomainname (Makefile.am): Likewise.
	* modules/getgroups (Makefile.am): Likewise.
	* modules/gethostname (Makefile.am): Likewise.
	* modules/gethrxtime (Makefile.am): Likewise.
	* modules/getline (Makefile.am): Likewise.
	* modules/getloadavg (Makefile.am): Likewise.
	* modules/getlogin_r (Makefile.am): Likewise.
	* modules/getndelim2 (Makefile.am): Likewise.
	* modules/getopt (Makefile.am): Likewise.
	* modules/getpagesize (Makefile.am): Likewise.
	* modules/getpass-gnu (Makefile.am): Likewise.
	* modules/getpass (Makefile.am): Likewise.
	* modules/getsubopt (Makefile.am): Likewise.
	* modules/gettime (Makefile.am): Likewise.
	* modules/gettimeofday (Makefile.am): Likewise.
	* modules/getugroups (Makefile.am): Likewise.
	* modules/getusershell (Makefile.am): Likewise.
	* modules/glob (Makefile.am): Likewise.
	* modules/group-member (Makefile.am): Likewise.
	* modules/hard-locale (Makefile.am): Likewise.
	* modules/hash (Makefile.am): Likewise.
	* modules/hmac-md5 (Makefile.am): Likewise.
	* modules/hmac-sha1 (Makefile.am): Likewise.
	* modules/human (Makefile.am): Likewise.
	* modules/idcache (Makefile.am): Likewise.
	* modules/imaxabs (Makefile.am): Likewise.
	* modules/imaxdiv (Makefile.am): Likewise.
	* modules/inet_ntop (Makefile.am): Likewise.
	* modules/inet_pton (Makefile.am): Likewise.
	* modules/intprops (Makefile.am): Likewise.
	* modules/inttostr (Makefile.am): Likewise.
	* modules/inttypes (Makefile.am): Likewise.
	* modules/isapipe (Makefile.am): Likewise.
	* modules/javaversion (Makefile.am): Likewise.
	* modules/lchmod (Makefile.am): Likewise.
	* modules/lchown (Makefile.am): Likewise.
	* modules/localcharset (Makefile.am): Likewise.
	* modules/long-options (Makefile.am): Likewise.
	* modules/lstat (Makefile.am): Likewise.
	* modules/malloc (Makefile.am): Likewise.
	* modules/mathl (Makefile.am): Likewise.
	* modules/mbchar (Makefile.am): Likewise.
	* modules/md2 (Makefile.am): Likewise.
	* modules/md4 (Makefile.am): Likewise.
	* modules/md5 (Makefile.am): Likewise.
	* modules/memcasecmp (Makefile.am): Likewise.
	* modules/memchr (Makefile.am): Likewise.
	* modules/memcmp (Makefile.am): Likewise.
	* modules/memcoll (Makefile.am): Likewise.
	* modules/memcpy (Makefile.am): Likewise.
	* modules/memmem (Makefile.am): Likewise.
	* modules/memmove (Makefile.am): Likewise.
	* modules/mempcpy (Makefile.am): Likewise.
	* modules/memrchr (Makefile.am): Likewise.
	* modules/memset (Makefile.am): Likewise.
	* modules/memxor (Makefile.am): Likewise.
	* modules/mkancesdirs (Makefile.am): Likewise.
	* modules/mkdir-p (Makefile.am): Likewise.
	* modules/mkdir (Makefile.am): Likewise.
	* modules/mkdtemp (Makefile.am): Likewise.
	* modules/mkstemp (Makefile.am): Likewise.
	* modules/mktime (Makefile.am): Likewise.
	* modules/modechange (Makefile.am): Likewise.
	* modules/mountlist (Makefile.am): Likewise.
	* modules/nanosleep (Makefile.am): Likewise.
	* modules/obstack (Makefile.am): Likewise.
	* modules/openat (Makefile.am): Likewise.
	* modules/pagealign_alloc (Makefile.am): Likewise.
	* modules/pathmax (Makefile.am): Likewise.
	* modules/physmem (Makefile.am): Likewise.
	* modules/poll (Makefile.am): Likewise.
	* modules/posixtm (Makefile.am): Likewise.
	* modules/posixver (Makefile.am): Likewise.
	* modules/putenv (Makefile.am): Likewise.
	* modules/quote (Makefile.am): Likewise.
	* modules/quotearg (Makefile.am): Likewise.
	* modules/raise (Makefile.am): Likewise.
	* modules/read-file (Makefile.am): Likewise.
	* modules/readline (Makefile.am): Likewise.
	* modules/readlink (Makefile.am): Likewise.
	* modules/readtokens (Makefile.am): Likewise.
	* modules/readutmp (Makefile.am): Likewise.
	* modules/realloc (Makefile.am): Likewise.
	* modules/regex (Makefile.am): Likewise.
	* modules/rename-dest-slash (Makefile.am): Likewise.
	* modules/rename (Makefile.am): Likewise.
	* modules/rijndael (Makefile.am): Likewise.
	* modules/rmdir (Makefile.am): Likewise.
	* modules/rpmatch (Makefile.am): Likewise.
	* modules/safe-read (Makefile.am): Likewise.
	* modules/safe-write (Makefile.am): Likewise.
	* modules/same-inode (Makefile.am): Likewise.
	* modules/same (Makefile.am): Likewise.
	* modules/save-cwd (Makefile.am): Likewise.
	* modules/savedir (Makefile.am): Likewise.
	* modules/setenv (Makefile.am): Likewise.
	* modules/settime (Makefile.am): Likewise.
	* modules/sha1 (Makefile.am): Likewise.
	* modules/sig2str (Makefile.am): Likewise.
	* modules/snprintf (Makefile.am): Likewise.
	* modules/stat-macros (Makefile.am): Likewise.
	* modules/stat-time (Makefile.am): Likewise.
	* modules/stdbool (Makefile.am): Likewise.
	* modules/stdint (Makefile.am): Likewise.
	* modules/stdlib-safer (Makefile.am): Likewise.
	* modules/stpcpy (Makefile.am): Likewise.
	* modules/stpncpy (Makefile.am): Likewise.
	* modules/strcase (Makefile.am): Likewise.
	* modules/strcasestr (Makefile.am): Likewise.
	* modules/strchrnul (Makefile.am): Likewise.
	* modules/strcspn (Makefile.am): Likewise.
	* modules/strdup (Makefile.am): Likewise.
	* modules/strerror (Makefile.am): Likewise.
	* modules/strftime (Makefile.am): Likewise.
	* modules/strndup (Makefile.am): Likewise.
	* modules/strnlen (Makefile.am): Likewise.
	* modules/strpbrk (Makefile.am): Likewise.
	* modules/strsep (Makefile.am): Likewise.
	* modules/strstr (Makefile.am): Likewise.
	* modules/strtod (Makefile.am): Likewise.
	* modules/strtoimax (Makefile.am): Likewise.
	* modules/strtok_r (Makefile.am): Likewise.
	* modules/strtol (Makefile.am): Likewise.
	* modules/strtoll (Makefile.am): Likewise.
	* modules/strtoul (Makefile.am): Likewise.
	* modules/strtoull (Makefile.am): Likewise.
	* modules/strtoumax (Makefile.am): Likewise.
	* modules/strverscmp (Makefile.am): Likewise.
	* modules/sys_socket (Makefile.am): Likewise.
	* modules/sys_stat (Makefile.am): Likewise.
	* modules/sysexits (Makefile.am): Likewise.
	* modules/time_r (Makefile.am): Likewise.
	* modules/timegm (Makefile.am): Likewise.
	* modules/timespec (Makefile.am): Likewise.
	* modules/tmpfile-safer (Makefile.am): Likewise.
	* modules/trim (Makefile.am): Likewise.
	* modules/unistd-safer (Makefile.am): Likewise.
	* modules/unlinkdir (Makefile.am): Likewise.
	* modules/unlocked-io (Makefile.am): Likewise.
	* modules/userspec (Makefile.am): Likewise.
	* modules/utime (Makefile.am): Likewise.
	* modules/utimecmp (Makefile.am): Likewise.
	* modules/utimens (Makefile.am): Likewise.
	* modules/vasnprintf (Makefile.am): Likewise.
	* modules/vasprintf (Makefile.am): Likewise.
	* modules/vsnprintf (Makefile.am): Likewise.
	* modules/xalloc (Makefile.am): Likewise.
	* modules/xgetcwd (Makefile.am): Likewise.
	* modules/xnanosleep (Makefile.am): Likewise.
	* modules/xreadlink (Makefile.am): Likewise.
	* modules/xstrtod (Makefile.am): Likewise.
	* modules/xstrtol (Makefile.am): Likewise.
	* modules/xstrtold (Makefile.am): Likewise.
	* modules/yesno (Makefile.am): Likewise.
	* modules/getdate (Makefile.am): Don't add getdate.h to EXTRA_DIST.

2006-10-12  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/error (Makefile.am): Distribute files through
	EXTRA_DIST, not lib_SOURCES.

2006-10-12  Eric Blake  <ebb9@byu.net>

	* modules/error (Makefile.am): Distribute files in /lib.
	* modules/obstack (Makefile.am): Likewise.

2006-10-12  Bruno Haible  <bruno@clisp.org>

	* modules/acl (Makefile.am): Distribute all files in lib/ through
	EXTRA_DIST.
	* modules/arcfour (Makefile.am): Likewise.
	* modules/arctwo (Makefile.am): Likewise.
	* modules/argmatch (Makefile.am): Likewise.
	* modules/argz (Makefile.am): Likewise.
	* modules/atexit (Makefile.am): Likewise.
	* modules/backupfile (Makefile.am): Likewise.
	* modules/c-strtod (Makefile.am): Likewise.
	* modules/c-strtold (Makefile.am): Likewise.
	* modules/calloc (Makefile.am): Likewise.
	* modules/canon-host (Makefile.am): Likewise.
	* modules/canonicalize (Makefile.am): Likewise.
	* modules/chdir-long (Makefile.am): Likewise.
	* modules/chdir-safer (Makefile.am): Likewise.
	* modules/check-version (Makefile.am): Likewise.
	* modules/chown (Makefile.am): Likewise.
	* modules/cloexec (Makefile.am): Likewise.
	* modules/close-stream (Makefile.am): Likewise.
	* modules/closeout (Makefile.am): Likewise.
	* modules/crc (Makefile.am): Likewise.
	* modules/cycle-check (Makefile.am): Likewise.
	* modules/des (Makefile.am): Likewise.
	* modules/dirfd (Makefile.am): Likewise.
	* modules/dirname (Makefile.am): Likewise.
	* modules/dup2 (Makefile.am): Likewise.
	* modules/euidaccess (Makefile.am): Likewise.
	* modules/exclude (Makefile.am): Likewise.
	* modules/exitfail (Makefile.am): Likewise.
	* modules/fcntl-safer (Makefile.am): Likewise.
	* modules/file-type (Makefile.am): Likewise.
	* modules/fileblocks (Makefile.am): Likewise.
	* modules/filemode (Makefile.am): Likewise.
	* modules/filenamecat (Makefile.am): Likewise.
	* modules/fnmatch (Makefile.am): Likewise.
	* modules/fopen-safer (Makefile.am): Likewise.
	* modules/fpending (Makefile.am): Likewise.
	* modules/fprintftime (Makefile.am): Likewise.
	* modules/free (Makefile.am): Likewise.
	* modules/fsusage (Makefile.am): Likewise.
	* modules/ftruncate (Makefile.am): Likewise.
	* modules/fts (Makefile.am): Likewise.
	* modules/gc (Makefile.am): Likewise.
	* modules/gc-pbkdf2-sha1 (Makefile.am): Likewise.
	* modules/getaddrinfo (Makefile.am): Likewise.
	* modules/getcwd (Makefile.am): Likewise.
	* modules/getdelim (Makefile.am): Likewise.
	* modules/getdomainname (Makefile.am): Likewise.
	* modules/getgroups (Makefile.am): Likewise.
	* modules/gethostname (Makefile.am): Likewise.
	* modules/gethrxtime (Makefile.am): Likewise.
	* modules/getline (Makefile.am): Likewise.
	* modules/getloadavg (Makefile.am): Likewise.
	* modules/getlogin_r (Makefile.am): Likewise.
	* modules/getopt (Makefile.am): Likewise.
	* modules/getpass (Makefile.am): Likewise.
	* modules/getpass-gnu (Makefile.am): Likewise.
	* modules/getsubopt (Makefile.am): Likewise.
	* modules/gettime (Makefile.am): Likewise.
	* modules/gettimeofday (Makefile.am): Likewise.
	* modules/getugroups (Makefile.am): Likewise.
	* modules/getusershell (Makefile.am): Likewise.
	* modules/glob (Makefile.am): Likewise.
	* modules/group-member (Makefile.am): Likewise.
	* modules/hard-locale (Makefile.am): Likewise.
	* modules/hash (Makefile.am): Likewise.
	* modules/hmac-md5 (Makefile.am): Likewise.
	* modules/hmac-sha1 (Makefile.am): Likewise.
	* modules/human (Makefile.am): Likewise.
	* modules/idcache (Makefile.am): Likewise.
	* modules/imaxabs (Makefile.am): Likewise.
	* modules/imaxdiv (Makefile.am): Likewise.
	* modules/inet_ntop (Makefile.am): Likewise.
	* modules/inet_pton (Makefile.am): Likewise.
	* modules/inttostr (Makefile.am): Likewise.
	* modules/isapipe (Makefile.am): Likewise.
	* modules/lchown (Makefile.am): Likewise.
	* modules/long-options (Makefile.am): Likewise.
	* modules/lstat (Makefile.am): Likewise.
	* modules/malloc (Makefile.am): Likewise.
	* modules/mathl (Makefile.am): Likewise.
	* modules/mbchar (Makefile.am): Likewise.
	* modules/md2 (Makefile.am): Likewise.
	* modules/md4 (Makefile.am): Likewise.
	* modules/md5 (Makefile.am): Likewise.
	* modules/memcasecmp (Makefile.am): Likewise.
	* modules/memchr (Makefile.am): Likewise.
	* modules/memcmp (Makefile.am): Likewise.
	* modules/memcoll (Makefile.am): Likewise.
	* modules/memcpy (Makefile.am): Likewise.
	* modules/memmem (Makefile.am): Likewise.
	* modules/memmove (Makefile.am): Likewise.
	* modules/mempcpy (Makefile.am): Likewise.
	* modules/memrchr (Makefile.am): Likewise.
	* modules/memset (Makefile.am): Likewise.
	* modules/memxor (Makefile.am): Likewise.
	* modules/mkancesdirs (Makefile.am): Likewise.
	* modules/mkdir (Makefile.am): Likewise.
	* modules/mkdir-p (Makefile.am): Likewise.
	* modules/mkdtemp (Makefile.am): Likewise.
	* modules/mkstemp (Makefile.am): Likewise.
	* modules/mktime (Makefile.am): Likewise.
	* modules/modechange (Makefile.am): Likewise.
	* modules/mountlist (Makefile.am): Likewise.
	* modules/nanosleep (Makefile.am): Likewise.
	* modules/openat (Makefile.am): Likewise.
	* modules/pagealign_alloc (Makefile.am): Likewise.
	* modules/physmem (Makefile.am): Likewise.
	* modules/poll (Makefile.am): Likewise.
	* modules/posixtm (Makefile.am): Likewise.
	* modules/posixver (Makefile.am): Likewise.
	* modules/putenv (Makefile.am): Likewise.
	* modules/quote (Makefile.am): Likewise.
	* modules/quotearg (Makefile.am): Likewise.
	* modules/raise (Makefile.am): Likewise.
	* modules/read-file (Makefile.am): Likewise.
	* modules/readline (Makefile.am): Likewise.
	* modules/readlink (Makefile.am): Likewise.
	* modules/readtokens (Makefile.am): Likewise.
	* modules/readutmp (Makefile.am): Likewise.
	* modules/realloc (Makefile.am): Likewise.
	* modules/regex (Makefile.am): Likewise.
	* modules/rename (Makefile.am): Likewise.
	* modules/rename-dest-slash (Makefile.am): Likewise.
	* modules/rijndael (Makefile.am): Likewise.
	* modules/rmdir (Makefile.am): Likewise.
	* modules/rpmatch (Makefile.am): Likewise.
	* modules/safe-read (Makefile.am): Likewise.
	* modules/safe-write (Makefile.am): Likewise.
	* modules/same (Makefile.am): Likewise.
	* modules/save-cwd (Makefile.am): Likewise.
	* modules/savedir (Makefile.am): Likewise.
	* modules/setenv (Makefile.am): Likewise.
	* modules/settime (Makefile.am): Likewise.
	* modules/sha1 (Makefile.am): Likewise.
	* modules/sig2str (Makefile.am): Likewise.
	* modules/snprintf (Makefile.am): Likewise.
	* modules/stdlib-safer (Makefile.am): Likewise.
	* modules/stpcpy (Makefile.am): Likewise.
	* modules/stpncpy (Makefile.am): Likewise.
	* modules/strcase (Makefile.am): Likewise.
	* modules/strcasestr (Makefile.am): Likewise.
	* modules/strchrnul (Makefile.am): Likewise.
	* modules/strcspn (Makefile.am): Likewise.
	* modules/strdup (Makefile.am): Likewise.
	* modules/strerror (Makefile.am): Likewise.
	* modules/strftime (Makefile.am): Likewise.
	* modules/strndup (Makefile.am): Likewise.
	* modules/strnlen (Makefile.am): Likewise.
	* modules/strpbrk (Makefile.am): Likewise.
	* modules/strsep (Makefile.am): Likewise.
	* modules/strstr (Makefile.am): Likewise.
	* modules/strtod (Makefile.am): Likewise.
	* modules/strtoimax (Makefile.am): Likewise.
	* modules/strtok_r (Makefile.am): Likewise.
	* modules/strtol (Makefile.am): Likewise.
	* modules/strtoll (Makefile.am): Likewise.
	* modules/strtoul (Makefile.am): Likewise.
	* modules/strtoull (Makefile.am): Likewise.
	* modules/strtoumax (Makefile.am): Likewise.
	* modules/strverscmp (Makefile.am): Likewise.
	* modules/time_r (Makefile.am): Likewise.
	* modules/timegm (Makefile.am): Likewise.
	* modules/tmpfile-safer (Makefile.am): Likewise.
	* modules/unistd-safer (Makefile.am): Likewise.
	* modules/unlinkdir (Makefile.am): Likewise.
	* modules/userspec (Makefile.am): Likewise.
	* modules/utime (Makefile.am): Likewise.
	* modules/utimecmp (Makefile.am): Likewise.
	* modules/utimens (Makefile.am): Likewise.
	* modules/vasnprintf (Makefile.am): Likewise.
	* modules/vasprintf (Makefile.am): Likewise.
	* modules/vsnprintf (Makefile.am): Likewise.
	* modules/xalloc (Makefile.am): Likewise.
	* modules/xgetcwd (Makefile.am): Likewise.
	* modules/xnanosleep (Makefile.am): Likewise.
	* modules/xreadlink (Makefile.am): Likewise.
	* modules/xstrtod (Makefile.am): Likewise.
	* modules/xstrtol (Makefile.am): Likewise.
	* modules/xstrtold (Makefile.am): Likewise.
	* modules/yesno (Makefile.am): Likewise.

2006-10-12  Jim Meyering  <jim@meyering.net>

	* m4/getloadavg.m4: Revert the change below.

	* m4/getloadavg.m4 (gl_GETLOADAVG): Test for the existence of
	lib/getloadavg.c using "ls -L", not "test -f".  The latter would
	fail with a symlink, which is what coreutils' ./bootstrap now
	creates by default.

2006-10-12  Bruno Haible  <bruno@clisp.org>

	* lib/inttypes_.h (_LONG_LONG_FORMAT_PREFIX): Don't define for MSVC or
	mingw.
	(_PRI64_PREFIX, _PRIu64_PREFIX, _SCN64_PREFIX, _SCNu64_PREFIX): Handle
	MSVC and mingw explicitly.

2006-10-11  Simon Josefsson  <jas@extundo.com>
	    Bruno Haible  <bruno@clisp.org>

	Add support for multiple gnulib-tool invocations in the scope of a
	single configure.ac file.
	* gnulib-tool (func_emit_lib_Makefile_am): In the _LIBADD variable,
	use a private [LT]LIBOBJS variant. Define a _DEPENDENCIES variable
	with the same contents as the _LIBADD variable.
	(func_emit_initmacro_start, func_emit_initmacro_end,
	func_emit_initmacro_done): New functions.
	(func_import, func_create_testdir): Invoke them. Allow the identifiers
	gl_LIBOBJS and gl_LTLIBOBJS.

2006-10-11  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (GETTEXTPATH, AUTOHEADER, AUTOPOINT): New variables.
	(func_create_testdir): Don't create po/Makefile.am, don't invoke
	autoreconf. Instead, invoke autopoint explicitly but move back the
	*.m4 files from gnulib.

2006-10-11  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_usage): Make module names after --create-testdir
	optional.
	(func_create_testdir): If no module was specified, use nearly all
	modules.

2006-10-12  Jim Meyering  <jim@meyering.net>

	Big performance improvement for fts-based tools that use FTS_NOSTAT.
	Avoid spurious inode-mismatch problems on non-POSIX file systems.
	Details: http://article.gmane.org/gmane.comp.lib.gnulib.bugs/7416
	* lib/fts_.h (FTS_DEFER_STAT): Define new flag.
	(FTS_OPTIONMASK): Extend the mask to reflect this addition.
	* lib/fts.c (DT_IS_KNOWN, DT_MUST_BE): Define.
	(FTS_NO_STAT_REQUIRED, FTS_STAT_REQUIRED): Define.
	(fts_set_stat_required): New function.
	(fts_open): Defer the calls to fts_stat, if possible or requested.
	Move the code that maps a command-line fts_info value FTS_DOT to FTS_D
	into fts_stat itself.
	(fts_read): Perform any required (deferred) fts_stat call.
	(fts_build): Likewise, for the directory we're about to open and read.
	In the readdir loop, carefully decide whether each entry will require
	an eventual call to fts_stat, using dirent.d_type info if available.
	(fts_stat): Move the test for whether to honor FTS_COMFOLLOW on
	a command line argument into this function.  Update all callers.
	Map a return value of FTS_DOT to FTS_D for a command line argument.
	* modules/fts (Depends-on): Add d-type.  Alphabetize.
	Thanks to Miklos Szeredi for his tenacity and for the initial
	bug report about "find" failing on a FUSE-based file system.

	* lib/fts.c (fts_open): Use consistent indentation.

2006-10-12  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/extensions.m4 (AC_USE_SYSTEM_EXTENSIONS): Renamed from
	gl_USE_SYSTEM_EXTENSIONS, to fix a coreutils bootstrap failure
	reported by Jim Meyering.  All uses of cache variables renamed
	to match Autoconf's.
	(gl_USE_SYSTEM_EXTENSIONS): New macro, which simply requires
	the other one.

	* m4/rename-dest-slash.m4 (gl_FUNC_RENAME_TRAILING_DEST_SLASH):
	Fix misspelling in diagnostic.

2006-10-11  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/mkdir-p.c (HAVE_FCHMOD): Define to false if not already
	defined.  Problem reported by Matthew Woehlke.

	* lib/inttypes_.h (_LONG_LONG_FORMAT_PREFIX): New macro.
	Add support for Tandem NonStop R series.
	(_PRI64_PREFIX, _PRIu64_PREFIX, _SCN64_PREFIX, _SCNu64_PREFIX):
	Use new macro.

	* lib/rename-dest-slash.c: Include stdbool.h but not string.h.
	(has_trailing_slash): Omit size arg; all callers changed.
	Omit 'inline', since it doesn't help performance and we'd
	need to configure it.
	Don't count //, ///, etc. as having a trailing slash.
	As a side effect, this removes a C99ism reported by Matthew Woehlke.
	(rpl_rename_dest_slash): On failure, use rename's errno rather
	than (in some cases) an incorrect or junk errno.
	Simplify code by removing need to compute length; this does
	cause it to make two passes instead of one over the file name,
	but it's worth it.

	* m4/extensions.m4 (gl_USE_SYSTEM_EXTENSIONS): Undo previous
	change, since Autoconf's version may no longer be appropriate now
	that we are using CVS Autoconf's version.  Add support for Tandem.

2006-10-11  Paul Eggert  <eggert@cs.ucla.edu>
	    Bruno Haible  <bruno@clisp.org>

	* lib/allocsa.h (sa_alignment_longlong, sa_alignment_max): Test
	HAVE_LONG_LONG_INT instead of HAVE_LONG_LONG.
	* m4/allocsa.m4 (gl_ALLOCSA): Invoke AC_TYPE_LONG_LONG_INT instead of
	gl_AC_TYPE_LONG_LONG.

	* lib/printf-args.h (arg_type, argument): Test HAVE_LONG_LONG_INT
	instead of HAVE_LONG_LONG.
	* lib/printf-args.c (printf_fetchargs): Likewise.
	* lib/printf-parse.c (PRINTF_PARSE): Likewise.
	* lib/vasnprintf.c (VASNPRINTF): Likewise.
	* m4/vasnprintf.m4 (gl_PREREQ_PRINTF_ARGS, gl_PREREQ_PRINTF_PARSE,
	gl_PREREQ_VASNPRINTF): Invoke AC_TYPE_LONG_LONG_INT instead of
	gl_AC_TYPE_LONG_LONG.

2006-10-11  Bruno Haible  <bruno@clisp.org>

	* m4/longlong.m4: Add comments.
	* m4/ulonglong.m4: Likewise.

2006-10-10  Bruno Haible  <bruno@clisp.org>

	Make it possible to #define stpcpy, strdup to aliases.
	* lib/stpcpy.c (stpcpy) [!_LIBC]: Don't undefine.
	* lib/strdup.c (strdup) [!_LIBC]: Don't undefine.

2006-10-10  Bruno Haible  <bruno@clisp.org>

	Make it possible to #define gcd to an alias.
	* lib/gcd.c: Include config.h.

2006-10-10  Bruno Haible  <bruno@clisp.org>

	Make it possible to #define c_isascii to an alias.
	* lib/c-ctype.h: Don't define the macros if NO_C_CTYPE_MACROS is
	defined. Undefine the macros before defining them, to avoid gcc
	warnings.
	* lib/c-ctype.c: Include config.h. Don't undefine the macros; instead,
	define NO_C_CTYPE_MACROS early.

2006-10-10  Bruno Haible  <bruno@clisp.org>

	Make it possible to #define set_program_name to an alias.
	* lib/progname.c: Don't undefine set_program_name; instead, undefine
	ENABLE_RELOCATABLE early.

2006-10-10  Paul Eggert  <eggert@cs.ucla.edu>

	Port to Tandem NSK OSS, which has 64-bit signed int but at most
	32-bit unsigned int.  Problem reported by Matthew Woehlke in:
	http://lists.gnu.org/archive/html/bug-coreutils/2006-10/msg00062.html
	More generally, don't assume that 64-bit signed int is available
	if unsigned int is, and vice versa.
	* lib/inttypes_.h (_PRIu64_PREFIX, _SCNu64_PREFIX): Depend on
	unsigned symbols, not on their signed counterparts.
	* lib/stdint_.h (uint64_t, uint_least64_t, uint_fast64_t, uintmax_t):
	(UINT64_MAX, UINT_LEAST64_MAX, UINT_FAST64_MAX, UINTMAX_MAX):
	(UINT64_C, UINTMAX_C):
	Likewise.
	* lib/strtoimax.c (strtoll): Depend on signed symbols, not their
	unsigned counterparts.
	(Have_long_long, Unsigned): New macros.
	(Int): Renamed from INT.
	(strtoimax): Use the new macros.
	* m4/stdint.m4 (gl_STDINT_H): Require AC_TYPE_UNSIGNED_LONG_LONG_INT
	and substitute HAVE_UNSIGNED_LONG_LONG_INT.
	* modules/inttypes (inttypes.h): Substitute
	HAVE_UNSIGNED_LONG_LONG_INT.
	* modules/stdint (stdint.h): Likewise.
	(Files): Add m4/ulonglong.m4.

2006-10-10  Bruno Haible  <bruno@clisp.org>

	Fix a gcc -Wshadow warning.
	* lib/gl_anyhash_list2.h (hash_resize): Rename local variable 'index'
	to 'bucket'.
	* lib/gl_anylinked_list2.h (gl_linked_search_from_to,
	gl_linked_indexof_from_to): Likewise.
	* lib/gl_linkedhash_list.c (add_to_bucket, remove_from_bucket):
	Likewise.
	* lib/gl_anytreehash_list1.h (add_to_bucket, remove_from_bucket):
	Likewise.
	* lib/gl_anytreehash_list2.h (gl_tree_search_from_to): Likewise.
	Reported by Eric Blake.

2006-10-09  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/filemode.h [HAVE_DECL_STRMODE]: Include unistd.h too,
	for NetBSD.  Problem reported by Bruno Haible.

2006-10-09  Jim Meyering  <jim@meyering.net>

	* lib/lchown.c: Include <sys/stat.h> before "stat-macros.h".
	Patch from Bruno Haible.

2006-10-09  Jim Meyering  <jim@meyering.net>

	* lib/fts-cycle.c (leave_dir): When "leaving" a top level directory due
	to FTS_SKIP, don't copy the parent's uninitialized dev/ino values.
	Trigger with e.g., mkdir d && valgrind ./chmod u+rwx d d

2006-10-08  Paul Eggert  <eggert@cs.ucla.edu>

	Don't include <config.h> twice; this doesn't work in some cases,
	e.g., when config.h has "#define intmax_t long long int" and
	we include <config.h>, <inttypes.h>, <config.h> in that order.
	Problem reported by Matthew Woehlke in:
	http://lists.gnu.org/archive/html/bug-coreutils/2006-10/msg00073.html
	* lib/fprintftime.c: Don't include config.h or fprintftime.h.
	* lib/fts-cycle.c: Don't include config.h.
	* lib/strftime.c: Include fprintftime.h if FPRINTFTIME is defined.
	* lib/xstrtoimax.c: Remove copyright notice since it's short tnow.
	Don't include config.h or xstrtol.h.  Define STRTOL_T_MINIMUM
	and STRTOL_T_MAXIMUM unconditionally, since we now assume gnulib
	inttypes.h.
	* lib/xstrtoumax.c: Likewise.
	* lib/xstrtol.c: Include config.h and xstrtol.h after defining
	__strtol and the like, so that this module is more like its siblings.
	(STRTOL_T_MINIMUM, STRTOL_T_MAXIMUM) [! defined STRTOL_T_MINIMUM]:
	Remove; no longer needed now that we assume gnulib inttypes.h.

2006-10-08  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi: Emphasize the drawbacks of the --symlink
	option.

2006-10-07  Jim Meyering  <jim@meyering.net>

	* modules/inttypes (inttypes.h): Revert what seems to have been
	an inadvertent part of today's change: use "|", not "/" in the
	substitution for the "/"-containing string, $(ABSOLUTE_INTTYPES_H).

2006-10-07  Bruno Haible  <bruno@clisp.org>

	* modules/sublist: New file.

2006-10-07  Bruno Haible  <bruno@clisp.org>

	* modules/alloca-opt (alloca.h): Add a "DO NOT EDIT" comment.
	* modules/argz (argz.h): Likewise.
	* modules/arpa_inet (arpa/inet.h): Likewise.
	* modules/byteswap (byteswap.h): Likewise.
	* modules/configmake (configmake.h): Likewise.
	* modules/fcntl (fcntl.h): Likewise.
	* modules/fnmatch (fnmatch.h): Likewise.
	* modules/getopt (getopt.h): Likewise.
	* modules/glob (glob.h): Likewise.
	* modules/inttypes (inttypes.h): Likewise.
	* modules/netinet_in (netinet/in.h): Likewise.
	* modules/poll (poll.h): Likewise.
	* modules/stdbool (stdbool.h): Likewise.
	* modules/stdint (stdint.h): Likewise.
	* modules/sys_select (sys/select.h): Likewise.
	* modules/sys_socket (sys/socket.h): Likewise.
	* modules/sys_stat (sys/stat.h): Likewise.
	* modules/sysexits (sysexits.h): Likewise.
	* modules/unistd (unistd.h): Likewise.
	* gnulib-tool (func_emit_lib_Makefile_am, func_emit_tests_Makefile_am):
	Add a "DO NOT EDIT" comment to the generated file.
	(func_import): Likewise for gnulib-comp.m4.

2006-10-07  Bruno Haible  <bruno@clisp.org>

	* lib/gl_sublist.h: New file.
	* lib/gl_sublist.c: New file.

2006-10-06  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/mkancesdirs.c (mkancesdirs): Pass to MAKE_DIR both the full file
	name (relative to the original working directory) and the file
	name component (relative to the temporary working directory).  All
	callers changed.
	* lib/mkancesdirs.h (mkancesdirs): Adjust prototype to match.
	* lib/mkdir-p.c (make_dir_parents): Likewise.
	* lib/mkdir-p.h (make_dir_parents): Likewise.

2006-10-06  Eric Blake  <ebb9@byu.net>

	Define several macros for use by the clean-temp module.
	* m4/close-stream.m4 (gl_CLOSE_STREAM): Define GNULIB_CLOSE_STREAM.
	* m4/fcntl-safer.m4 (gl_FCNTL_SAFER): Define GNULIB_FCNTL_SAFER.
	* m4/stdio-safer.m4 (gl_FOPEN_SAFER): Define GNULIB_FOPEN_SAFER.

	* lib/clean-temp.h (close_stream_temp): New declaration.
	* lib/clean-temp.c (includes): Pull in headers according to what
	other modules are in use.
	(close_stream_temp) [GNULIB_CLOSE_STREAM]: New function.

2006-10-06  Bruno Haible  <bruno@clisp.org>

	* lib/javacomp.c (write_temp_file): Use fopen_temp, fwriteerror_temp
	instead of fopen, fwriteerror.

2006-10-06  Bruno Haible  <bruno@clisp.org>

	* lib/clean-temp.h (cleanup_temp_file, cleanup_temp_subdir,
	cleanup_temp_dir_contents, cleanup_temp_dir): Change return type to
	int.
	* lib/clean-temp.c (do_unlink, do_rmdir, cleanup_temp_file,
	cleanup_temp_subdir, cleanup_temp_dir_contents, cleanup_temp_dir):
	Return an error indicator.
	Suggested by Eric Blake.

2006-10-06  Bruno Haible  <bruno@clisp.org>

	* lib/clean-temp.c (PATH_MAX): Provide a fallback for GNU Hurd.
	Reported by Eric Blake.

2006-10-06  Bruno Haible  <bruno@clisp.org>

	* modules/closeout (Description): Mention stderr too.

2006-10-06  Bruno Haible  <bruno@clisp.org>
	and Paul Eggert  <eggert@cs.ucla.edu>

	* lib/closeout.c (close_stdout): Also close stderr.
	* lib/closeout.h: Update comment.

2006-10-05  Paul Eggert  <eggert@cs.ucla.edu>

	Fix some Darwin-7.9.0 porting problems reported by Bruno Haible in
	<http://lists.gnu.org/archive/html/bug-coreutils/2006-10/msg00063.html>.
	* lib/dirchownmod.c: Include lchown.h.
	* lib/lchown.c: Don't include files that lchown.h now includes.
	Don't declare chown, since lchown.h now does that.
	* lib/lchown.h: Include errno.h, sys/types.h, unistd.h.
	(lchown): Define to rpl_chown if lchown is declared but
	does not exist.  Declare using a prototype if lchown is not
	declared.  Add a copyright notice.
	* lib/mkstemp.h: Include <unistd.h>.
	* lib/openat.c: Include lchown.h.

	* lib/fcntl_.h (O_NOFOLLOW): Don't depend on O_NOFOLLOW_IS_INEFFECTIVE;
	we now test for that separately.
	* lib/fts.c (fts_safe_changedir): Inspect HAVE_WORKING_O_NOFOLLOW
	rather than O_NOFOLLOW, when testing whether it's possible to
	avoid a race condition reliably.
	* lib/savewd.c (savewd_chdir): Likewise.

	Remove macros that are no longer needed now that stdint.h is
	reliable.
	* lib/fsusage.c (UINTMAX_MAX): Remove.
	* lib/human.c (SIZE_MAX, UINTMAX_MAX): Remove.
	* lib/utimecmp.c (SIZE_MAX): Remove.

	* m4/lchown.m4 (gl_FUNC_LCHOWN): Check whether lchown is declared.

	* m4/fcntl_h.m4 (gl_FCNTL_H): Define HAVE_WORKING_O_NOFOLLOW instead
	of O_NOFOLLOW_IS_INEFFECTIVE.  Define HAVE_WORKING_O_NOATIME if
	O_NOATIME works.

2006-10-05  Bruno Haible  <bruno@clisp.org>

	* lib/gl_list.h (gl_sortedlist_search_from_to,
	gl_sortedlist_indexof_from_to): New declarations.
	(gl_list_implementation): New fields sortedlist_search_from_to,
	sortedlist_indexof_from_to.
	(gl_sortedlist_search_from_to, gl_sortedlist_indexof_from_to): New
	inline functions.
	* lib/gl_list.c (gl_sortedlist_search_from_to,
	gl_sortedlist_indexof_from_to): New functions.
	* lib/gl_array_list.c (gl_array_sortedlist_indexof_from_to): New
	function.
	(gl_array_sortedlist_indexof, gl_array_sortedlist_search): Use it.
	(gl_array_sortedlist_search_from_to): New function.
	(gl_array_list_implementation): Update.
	* lib/gl_carray_list.c (gl_carray_sortedlist_indexof_from_to): New
	function.
	(gl_carray_sortedlist_indexof, gl_carray_sortedlist_search): Use it.
	(gl_carray_sortedlist_search_from_to): New function.
	(gl_carray_list_implementation): Update.
	* lib/gl_anylinked_list2.h (gl_linked_sortedlist_search_from_to,
	gl_linked_sortedlist_indexof_from_to): New functions.
	* lib/gl_linked_list.c (gl_linked_list_implementation): Update.
	* lib/gl_linkedhash_list.c (gl_linkedhash_list_implementation): Update.
	* lib/gl_anytree_list2.h (gl_tree_sortedlist_search_from_to,
	gl_tree_sortedlist_indexof_from_to): New functions.
	* lib/gl_avltree_list.c (gl_avltree_list_implementation): Update.
	* lib/gl_avltreehash_list.c (gl_avltreehash_list_implementation):
	Update.
	* lib/gl_rbtree_list.c (gl_rbtree_list_implementation): Update.
	* lib/gl_rbtreehash_list.c (gl_avltreehash_list_implementation):
	Update.

2006-10-05  Bruno Haible  <bruno@clisp.org>

	* lib/gl_list.h (gl_list_search_from, gl_list_search_from_to,
	gl_list_indexof_from, gl_list_indexof_from_to): New declarations.
	(struct gl_list_implementation): Add fields search_from_to,
	indexof_from_to. Remove fields search, indexof.
	(gl_list_search): Use the search_from_to method.
	(gl_list_search_from, gl_list_search_from_to): New functions.
	(gl_list_indexof): Use the indexof_from_to method.
	(gl_list_indexof_from, gl_list_indexof_from_to): New functions.
	* lib/gl_list.c (gl_list_search): Use the search_from_to method.
	(gl_list_search_from, gl_list_search_from_to): New functions.
	(gl_list_indexof): Use the indexof_from_to method.
	(gl_list_indexof_from, gl_list_indexof_from_to): New functions.
	* lib/gl_array_list.c (gl_array_indexof_from_to): Renamed from
	gl_array_indexof. Add start_index, end_index arguments.
	(gl_array_search_from_to): Renamed from gl_array_search. Add
	start_index, end_index arguments.
	(gl_array_remove, gl_array_list_implementation): Update.
	* lib/gl_carray_list.c (gl_carray_indexof_from_to): Renamed from
	gl_carray_indexof. Add start_index, end_index arguments.
	(gl_carray_search_from_to): Renamed from gl_carray_search. Add
	start_index, end_index arguments.
	(gl_carray_remove, gl_carray_list_implementation): Update.
	* lib/gl_anylinked_list2.h (gl_linked_search_from_to): Renamed from
	gl_linked_search. Add start_index, end_index arguments.
	(gl_linked_indexof_from_to): Renamed from gl_linked_indexof. Add
	start_index, end_index arguments.
	(gl_linked_remove): Update.
	* lib/gl_linked_list.c (gl_linked_list_implementation): Update.
	* lib/gl_linkedhash_list.c (gl_linkedhash_list_implementation): Update.
	* lib/gl_anytree_list1.h (iterstack_item_t): Change type of 'rightp'
	field to 'size_t'.
	* lib/gl_anytree_list2.h (gl_tree_search_from_to): Renamed from
	gl_tree_search. Add start_index, end_index arguments.
	(gl_tree_indexof_from_to): Renamed from gl_tree_indexof. Add
	start_index, end_index arguments.
	(gl_tree_remove): Update.
	* lib/gl_avltree_list.c (gl_avltree_list_implementation): Update.
	* lib/gl_rbtree_list.c (gl_rbtree_list_implementation): Update.
	* lib/gl_anytreehash_list1.h (compare_position_threshold): New
	function.
	* lib/gl_anytreehash_list2.h (gl_tree_search_from_to): Renamed from
	gl_tree_search. Add start_index, end_index arguments.
	(gl_tree_indexof_from_to): Renamed from gl_tree_indexof. Add
	start_index, end_index arguments.
	* lib/gl_avltreehash_list.c (gl_avltreehash_list_implementation):
	Update.
	* lib/gl_rbtreehash_list.c (gl_rbtreehash_list_implementation): Update.

2006-10-05  Bruno Haible  <bruno@clisp.org>

	* modules/fwriteerror (configure.ac): Define GNULIB_FWRITEERROR.

	* lib/clean-temp.h (open_temp, fopen_temp, close_temp, fclose_temp,
	fwriteerror_temp): New declarations.
	* lib/clean-temp.c (uintptr_t): Provide fallback definition.
	(descriptors): New variable.
	(cleanup): First, close the descriptors.
	(register_fd, unregister_fd, open_temp, fopen_temp, close_temp,
	fclose_temp, fwriteerror_temp): New functions.

2006-10-04  Jim Meyering  <jim@meyering.net>

	* lib/fts.c (fts_open): Tiny comment change.

2006-10-04  Bruno Haible  <bruno@clisp.org>

	Make it possible to invoke AC_GNU_SOURCE after gl_LOCK_EARLY.
	* m4/lock.m4 (gl_LOCK_EARLY_BODY): New macro, extracted code from
	gl_LOCK_BODY.
	(gl_LOCK_EARLY): Require gl_LOCK_EARLY_BODY, not gl_LOCK_BODY.
	(gl_LOCK_BODY): Remove settings of CPPFLAGS, now done in
	gl_LOCK_EARLY_BODY.
	(gl_LOCK): Require gl_LOCK_BODY.

2006-10-04  Bruno Haible  <bruno@clisp.org>

	* lib/gl_oset.h (gl_setelement_threshold_fn): New type.
	(gl_oset_search_atleast): New declaration.
	(struct gl_oset_implementation): Add field 'search_atleast'.
	(gl_oset_search_atleast): New inline function.
	* lib/gl_oset.c (gl_oset_search_atleast): New function.
	* lib/gl_array_oset.c (gl_array_search_atleast): New function.
	(gl_array_oset_implementation): Update.
	* lib/gl_anytree_oset.h (gl_tree_search_atleast): New function.
	* lib/gl_avltree_oset.c (gl_avltree_oset_implementation): Update.
	* lib/gl_rbtree_oset.c (gl_rbtree_oset_implementation): Update.

2006-10-04  Bruno Haible  <bruno@clisp.org>

	* lib/fatal-signal.c (fatal_signals) [WOE32]: Add the SIGBREAK signal.

2006-10-03  Bruno Haible  <bruno@clisp.org>

	* lib/gl_rbtreehash_list.c (gl_rbtreehash_list_implementation): Renamed
	from gl_avltreehash_list_implementation.

2006-10-03  Bruno Haible  <bruno@clisp.org>

	* lib/gl_oset.c (gl_oset_add): Fix return type.

2006-10-02  Paolo Bonzini  <bonzini@gnu.org>  (tiny change)

	* lib/quotearg.c (mbstate_t) [!HAVE_MBRTOWC]: #define to int.

2006-10-02  Eric Blake  <ebb9@byu.net>

	* modules/strnlen (Depends-on): Add extensions.

2006-10-02  Eric Blake  <ebb9@byu.net>

	* m4/extensions.m4 (gl_USE_SYSTEM_EXTENSIONS): Use autoconf's
	definition in 2.60+.

2006-10-02  Dmitry V. Levin  <ldv@altlinux.org>

	* lib/fts.c (fts_close, fts_build, fts_palloc): Remove redundant
	checks.

2006-10-02  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): Don't add no-dependencies
	to the AUTOMAKE_OPTIONS.
	Reported by Jim Meyering.

2006-09-29  Paul Eggert  <eggert@cs.ucla.edu>

	Work around bug in Solaris 10 /proc file system:
	/proc/self/fd/NNN/.. isn't the parent directory of
	the directory whose file descriptor is NNN.  This needs to
	be worked around at run time, not compile time, since a
	program might be built on Solaris 8, where things work, and
	run on Solaris 10.
	* lib/openat-priv.h (BUILD_PROC_NAME): Remove.  All callers changed
	to use the following interface instead:
	(OPENAT_BUFFER_SIZE): New macro.
	(openat_proc_name): New function.
	* lib/at-func.c (AT_FUNC_NAME): Adjust to above changes.
	* lib/openat.c (openat_permissive, openat_needs_fchdir, fdopendir):
	Likewise.
	* lib/openat-proc.c: New file.
	* modules/openat (Files): Add lib/openat-proc.c.
	(Depends-on): Add same-inode, stdbool.
	* m4/openat.m4 (gl_FUNC_OPENAT): Add AC_LIBOBJ(openat-proc).

2006-09-29  Bruno Haible  <bruno@clisp.org>

	* lib/fwriteerror.h (fwriteerror_no_ebadf): New declaration.
	* lib/(do_fwriteerror): Renamed from fwriteerror. Add ignore_ebadf
	argument. Set stdout_closed before testing for ferror, not after.
	(fwriteerror, fwriteerror_no_ebadf): New functions.

2006-09-28  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/intmax.m4 (gt_TYPE_INTMAX_T): Avoid unused variables warning.

2006-09-28  Paolo Bonzini  <bonzini@gnu.org>

	* lib/poll.c (rpl_poll) [__APPLE__]: Use FIONREAD instead of MSG_PEEK.
	* m4/poll.m4: Look for sys/ioctl.h and sys/filio.h.

2006-09-28  Jim Meyering  <jim@meyering.net>

	* lib/mkdir-p.c: Include "dirchownmod.h", not "dirchownmod.c".
	Include <unistd.h>.

2006-09-28  Bruno Haible  <bruno@clisp.org>

	* modules/avltreehash-list (Depends-on): Add stdint, remove size_max.
	* modules/linkedhash-list (Depends-on): Likewise.
	* modules/rbtreehash-list (Depends-on): Likewise.

2006-09-28  Bruno Haible  <bruno@clisp.org>

	* lib/strndup.h: Simplify the redefinition of strndup.
	(_GL_CONCAT, _GL_XCONCAT, __STRNDUP_ID): Remove macros.
	* m4/strndup.m4 (gl_FUNC_STRNDUP): Don't define __STRNDUP_PREFIX.

2006-09-28  Bruno Haible  <bruno@clisp.org>

	* lib/gl_avltreehash_list.c: Include <stdint.h> instead of size_max.h.
	* lib/gl_linkedhash_list.c: Likewise.
	* lib/gl_rbtreehash_list.c: Likewise.

2006-09-27  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/canon-host.c (canon_host_r): Work around bug in Darwin 7.9.0
	getaddrinfo.

	* lib/__fpending.h: Don't include <stdio_ext.h> unless
	HAVE_DECL___FPENDING.  This avoids a bug with lsbcc, where
	it causes <stdio_ext.h> to cause a compile-time error.
	Problem reported by Nelson H. F. Beebe.
	* lib/getpass.c: Likewise, except for HAVE_DECL___FSETLOCKING instead
	of HAVE_DECL___PENDING.

	* m4/fpending.m4 (gl_FUNC_FPENDING): Check for stdio_ext at most once.
	* m4/getpass.m4 (gl_PREREQ_GETPASS): Check for __fsetlocking's
	declaration.

2006-09-27  Jim Meyering  <jim@meyering.net>

	This file could end up with a definition for a function
	named __strndup, rather than rpl_strndup on a system with
	incomplete weak_alias support.
	* lib/strndup.c (strndup): Rename from __strndup.
	Remove #defines that used to map __strndup to strndup.
	Don't use K&R prototypes.
	Remove LIBC-related code, since this file is not sync'd with glibc.
	* lib/strndup.h: Revamp, accordingly.
	* m4/strndup.m4: Modernize.

2006-09-26  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/savewd (Depends-on): Add 'raise'.
	* lib/savewd.c: Include <signal.h>, for 'raise'.

2006-09-26  Jim Meyering  <jim@meyering.net>

	* m4/acl.m4 (AC_FUNC_ACL): Disable ACL support altogether
	when we detect Darwin 8.7.0's acl_get_file bug.
	Rearrange to perform the new (below) run-test while $LIBS
	contains any acl-related library.  Set USE_ACL at the end.
	(gl_ACL_GET_FILE): New function.

2006-09-26  Eric Blake  <ebb9@byu.net>

	* lib/verror.c: Include <config.h> unconditionally.

2006-09-25  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/clock-time (Maintainer): Add self.
	* modules/getlogin_r (Depends-on): Add extensions.

2006-09-25  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* modules/clock-time: New module.
	* modules/nanosleep (Depends-on): Add clock-time.
	* modules/gethrxtime (Depends-on): Likewise.
	* modules/gettime (Depends-on): Likewise.
	* modules/settime (Depends-on): Likewise.

	* modules/fts-lgpl: Depend on openat.
	* modules/mkancesdirs: Depend on savewd.
	* modules/mkdir-p: Likewise.

2006-09-25  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/host-os.m4 (gl_HOST_OS): Require AC_CANONICAL_HOST.

	* m4/chdir-long.m4 (gl_FUNC_CHDIR_LONG): Rename cache variable from
	`gl_have_arbitrary_file_name_length_limit' to
	`gl_cv_have_arbitrary_file_name_length_limit', so that caching
	actually works between configure runs.

2006-09-25  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Bruno Haible  <bruno@clisp.org>

	* m4/stpncpy.m4 (gl_FUNC_STPNCPY): Include <string.h>.

2006-09-25  Jim Meyering  <jim@meyering.net>

	* m4/fcntl_h.m4 (gl_FCNTL_H): Fix typo in test for failed open.
	This typo caused coreutils/tests/dd/misc to fail on Darwin 8.7.0.

2006-09-25  Eric Blake  <ebb9@byu.net>

	* gnulib-tool (func_import, func_create_testdir): Fix typos in
	exec's in 2006-09-18 patch when shuffling fds.

2006-09-25  Bruno Haible  <bruno@clisp.org>

	* m4/getloadavg.m4 (gl_GETLOADAVG): Fix directory in error message.
	Reported by Jim Meyering.

2006-09-24  Jim Meyering  <jim@meyering.net>

	* m4/ls-mntd-fs.m4 (gl_LIST_MOUNTED_FILE_SYSTEMS): Don't use '>' to
	compare a pointer against a literal "0".  That caused failures with
	at least HP-UX's hpcc.

2006-09-22  Simon Josefsson  <jas@extundo.com>

	* modules/gc-sha1:
	* modules/gc-md4:
	* modules/gc-hmac-sha1:
	* modules/gc-hmac-md5:
	* modules/gc-des:
	* modules/gc-arcfour: Distribute more files.

2006-09-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/gl_anylinked_list2.h [lint] (gl_linked_iterator)
	(gl_linked_iterator_from_to): Initialize struct completely.
	* lib/gl_anytree_list2.h [lint] (gl_tree_iterator): Likewise.
	(gl_tree_iterator_from_to): Likewise
	* lib/gl_anytree_oset.h [lint] (gl_tree_iterator): Likewise.
	* lib/gl_array_list.c [lint] (gl_array_iterator)
	(gl_array_iterator_from_to): Likewise.
	* lib/gl_array_oset.c [lint] (gl_array_iterator): Likewise.
	* lib/gl_carray_list.c [lint] (gl_carray_iterator)
	(gl_carray_iterator_from_to): Likewise.

	* lib/gc-gnulib.c [GC_USE_HMAC_SHA1]: include hmac.h for hmac_sha1.
	* lib/md4.c (md4_process_block): Remove unused variable.
	* lib/rijndael-api-fst.c (rijndaelBlockDecrypt): GCC suggests
	parentheses for clarity.

2006-09-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* modules/bison-i18n (Depends-on): Add gettext.

2006-09-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/fsusage.m4 (gl_STATFS_TRUNCATES): Avoid unused variable.
	* m4/getdate.m4 (gl_C_COMPOUND_LITERALS): Likewise.
	* m4/jm-winsz1.m4 (gl_HEADER_TIOCGWINSZ_IN_TERMIOS_H): Likewise;
	also add missing comma that caused broken test.
	* m4/link-follow.m4 (gl_AC_FUNC_LINK_FOLLOWS_SYMLINK): Include
	stdlib.h, for `abort'.
	* m4/ls-mntd-fs.m4 (gl_LIST_MOUNTED_FILE_SYSTEMS): Avoid unused
	variables.
	* m4/mkdir-slash.m4 (gl_FUNC_MKDIR_TRAILING_SLASH): Check for and
	include unistd.h if present, for `rmdir'.
	* m4/physmem.m4 (gl_SYS__SYSTEM_CONFIGURATION): Avoid unused
	variables.
	* m4/putenv.m4 (gl_FUNC_PUTENV): Rewrite using AC_RUN_IFELSE, and
	in the process include standard headers for prototypes.
	* m4/readutmp.m4 (gl_READUTMP): Require AC_GNU_SOURCE, so utmpxname
	gets declared on GNU/Linux.
	* m4/rmdir-errno.m4 (gl_FUNC_RMDIR_NOTEMPTY): Check for and include
	unistd.h, for `rmdir'.
	* m4/time_r.m4 (gl_TIME_R): Avoid unused variables.

	* m4/fnmatch.m4 (_AC_FUNC_FNMATCH_IF): Avoid expression that is
	always true.
	* m4/strndup.m4 (gl_FUNC_STRNDUP): include stdlib.h, for `free'.

	* m4/sockpfaf.m4 (gl_SOCKET_FAMILIES): Avoid gcc -Wall warnings.

2006-09-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_version): Create output all at once.  This
	may help avoid triggering unnecessary SIGPIPEs, and at any
	rate it doesn't hurt.

2006-09-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Bruno Haible  <bruno@clisp.org>

	* m4/lock.m4 (gl_LOCK_BODY): Avoid unused variables warning.
	* m4/mbswidth.m4 (gl_MBSWIDTH): Likewise.
	* m4/signed.m4 (bh_C_SIGNED): Likewise.

	* m4/vasprintf.m4 (gl_PREREQ_VASPRINTF_H): New macro.
	(gl_FUNC_VASPRINTF): Invoke it.

2006-09-22  Bruno Haible  <bruno@clisp.org>

	* m4/getloadavg.m4 (gl_GETLOADAVG): Expect the directory of
	getloadavg.c as first argument.

2006-09-22  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import, func_create_testdir): Set gl_source_base
	at the beginning of the gl_INIT macro.
	* modules/getloadavg (configure.ac): Pass $gl_source_base to
	gl_GETLOADAVG.

2006-09-22  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_megatestdir): Don't include the config-h
	module.
	Suggested by Ralf Wildenhues.

2006-09-20  Paul Eggert  <eggert@cs.ucla.edu>

	Import this patch from libc:

	2006-09-06  Jakub Jelinek  <jakub@redhat.com>

	* lib/regex_internal.c (re_string_reconstruct): Handle
	offset < pstr->valid_raw_len && pstr->offsets_needed case.
	Ensure no bytes read before raw_mbs array.  Pass a saved copy of
	pstr->valid_len - 1 rather than pstr->valid_raw_len - 1 to
	re_string_context_at.

	* m4/regex.m4 (gl_REGEX): Check for locale.h, since the test
	now requires it.
	(gl_PREREQ_REGEX): Don't check for locale.h any more, since
	gl_REGEX now does it for us.
	(gl_REGEX): Add test taken from
	http://sourceware.org/ml/libc-hacker/2006-09/msg00008.html.

	* m4/mkstemp.m4 (gl_FUNC_MKSTEMP): Require AC_SYS_LARGEFILE.
	Check that large offsets work.  Modernize Autoconf usages.
	Prefer "yes" to mean a good thing rather than a bad.
	Don't put "#define mkstemp" in config.h, as this might interfere
	with standard system headers that "#define mkstemp mkstemp64".

	* modules/mkstemp (Depends-on): Add extensions, so that
	mkstemp is visible on some platforms.
	(Makefile.am): Add mkstemp.h to EXTRA_DIST.
	(Include): Change to "mkstemp.h" from <stdlib.h>.
	(Files): Add mkstemp.h.

	* lib/mkstemp.h: New file, since some standard headers
	#define mkstemp.
	* lib/mkstemp.c: Revamp to put the !_LIBC code together.
	Include "mkstemp.h".
	Make the _LIBC code resemble glibc original more,
	e.g., use K&R style.
	* lib/mkstemp-safer.c: Include "mkstemp.h" instead of <stdlib.h>.
	(mkstemp): Remove, since mkstemp.h does this for us.
	* lib/stdlib--.h: Include mkstemp.h.

	Import this patch from libc:

	2006-04-07  Ulrich Drepper  <drepper@redhat.com>

	* lib/tempname.c (__gen_tempname): Change attempts_min
	into a macro.  Use preprocessor to decide how to initialize
	attempts [Coverity CID 67].

2006-09-20  Bruno Haible  <bruno@clisp.org>

	* lib/mkdtemp.c: Import from libc.
	2006-04-07  Ulrich Drepper  <drepper@redhat.com>
		* sysdeps/posix/tempname.c (__gen_tempname): Change
		attempts_min into a macro.  Use preprocessor to decide how to
		initialize attempts [Coverity CID 67].
	2001-11-27  Paul Eggert  <eggert@twinsun.com>
		* sysdeps/posix/tempname.c (__gen_tempname): Try at least
		ATTEMPTS_MIN or TMP_MAX times, whichever is greater.

2006-09-19  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_exit): New function, to allow to pass the
	exit status portably through the trap.  Use everywhere.
	(--help, --version): Signal a write error.
	(trap): catch SIGPIPE, for write errors.
	Exit at the end of the trap, with the correct exit status.

2006-09-19  Karl Berry  <karl@gnu.org>

	* doc/gnulib.texi: note about the license texinfo files.

2006-09-19  Eric Blake  <ebb9@byu.net>

	* gnulib-tool: Avoid space-tab.

2006-09-18  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getaddrinfo.c (getaddrinfo) [defined HAVE_IPV6]: Fix typo
	that prevented coreutils 6.1 from building.  Problem reported
	by Petter Reinholdtsen.

2006-09-18  Paul Eggert  <eggert@cs.ucla.edu>

	* gnulib-tool (avoidlist): Fix typo that broke options like
	--avoid=lock that are used by coreutils bootstrap.

2006-09-18  Mark D. Baushke  <mdb@gnu.org>

	* m4/inttypes.m4 (gl_INTTYPES_H): Quote "test" args
	more systematically.

2006-09-18  Jim Meyering  <jim@meyering.net>

	* lib/savewd.c (savewd_restore): Don't shadow: s/status/child_status/.

2006-09-18  Bruno Haible  <bruno@clisp.org>

	* modules/inttypes (Files): Remove m4/inttypes-h.m4.

2006-09-18  Bruno Haible  <bruno@clisp.org>

	* m4/inttypes-h.m4 (gl_HEADER_INTTYPES_H): Remove macro.
	* m4/inttypes-pri.m4: Require autoconf >= 2.52.
	(gt_INTTYPES_PRI): Invoke AC_CHECK_HEADERS on inttypes.h. Test
	ac_cv_header_inttypes_h instead of gl_cv_header_inttypes_h.
	* m4/gettext.m4: Require autoconf >= 2.52.
	(gt_INTL_SUBDIR_CORE): Invoke AC_CHECK_HEADERS on inttypes.h.
	* m4/inttypes.m4 (gl_INTTYPES_H): Test ac_cv_header_inttypes_h instead
	of gl_cv_header_inttypes_h.

2006-09-18  Bruno Haible  <bruno@clisp.org>

	* lib/javaversion.c: Include configmake.h.

2006-09-18  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import, func_create_testdir): Use exec tricks to
	avoid that the while loops be executed in a subshell.

2006-09-18  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (func_module): Break long lines.
	Suggested by Bruce Korb <bkorb@gnu.org>.

2006-09-17  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Speed up by a factor of 1.12.
	* gnulib-tool (nl): New variable.
	(func_import): Rewrite include directive extraction to only read each
	directive once.

2006-09-17  Bruno Haible  <bruno@clisp.org>

	* modules/javaversion (Makefile.am): Remove DEFS setting.
	(Depends-on): Add configmake, for PKGDATADIR definition.

2006-09-17  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Rewrite all files at once.

2006-09-17  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_append): New function, stolen from libtool.m4.
	(func_modules_transitive_closure, func_modules_add_dummy,
	func_modules_to_filelist, func_import, func_create_testdir,
	func_create_megatestdir, ...): Use it wherever possible.
	Suggested by Ralf Wildenhues.

2006-09-16  Karl Berry  <karl@gnu.org>

	* doc/fdl.texi (ADDENDUM): switch to @heading from @appendixsubsec,
	to avoid sectioning errors.
	* doc/lgpl.texi, gpl.texi (Copying): downcase @unnumbered title.
	[ifinfo]: blank line after @center-ed titles.
	* doc/lgpl.texi (Library Copying): Rename main node to GNU LGPL.
	Spell FSF address consistently with others.
	(These changes approved by rms.)

2006-09-15  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Speed up by a factor of 1.61.
	* gnulib-tool (func_modules_transitive_closure): Rewrite to not check
	already checked module names again.

2006-09-15  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Speed up by a factor of 1.13.
	* gnulib-tool (func_import): Rewrite all old_files at once; likewise
	for new_files, and the input to func_add_or_update.

2006-09-15  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_all_modules, func_modules_to_filelist, func_import,
	func_create_testdir, ...): Change 'sort | uniq' to 'sort -u'.

2006-09-15  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/mkancesdirs (Depends-on): Add fcntl.
	* modules/savewd: New file.
	* MODULES.html.sh (File system functions): Add savewd.

	* modules/configmake (Makefile.am): Add support for the
	Automake-supplied PKGLIBDIR, PKGINCLUDEDIR, PKGDATADIR.

2006-09-15  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/savewd.m4: New file.

2006-09-15  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/dirchownmod.c: Don't include fcntl.h; no longer needed.
	(dirchownmod): New arg FD.  All callers changed.
	Use FD rather than opening the directory ourself, as opening is
	now the caller's responsibility.
	* lib/dirchownmod.h: Likewise.
	* lib/mkancesdirs.c: Include <sys/types.h>, for portability to older
	hosts that require <sys/types.h> before <sys/stat.h>.  Include
	fcntl.h, savewd.h, and unistd.h, not dirname.h and stat-macros.h.
	(test_dir): Remove.
	(mkancesdirs): Return length of prefix of FILE that has already
	been made, or -2 if there is a child doing the work.  Redo
	algorithm so that it is O(N) rather than O(N**2).  Optimize away
	".", and treat ".." specially since it might stray back into
	already-created areas.  Use a subprocess if necessary.  New arg
	WD; all users changed.  MAKE_DIR function should now return 1
	if it creates a directory that is not readable.  Return -2 if
	a child process is spun off.
	* lib/mkancesdirs.h: Include <stddef.h>, for ptrdiff_t.
	Adjust signature to match code.
	* lib/mkdir-p.c: Include dirname.h, for IS_ABSOLUTE_FILE_NAME.
	(make_dir_parents): Use a subprocess if necessary.  New arg WD;
	all users changed.
	* lib/savewd.c, lib/savewd.h: New files.

2006-09-15  Jim Meyering  <jim@meyering.net>

	* modules/rename-dest-slash: New module.
	* MODULES.html.sh (posix_compat): Add it here.

	* modules/rename: Reflect vb_FUNC_RENAME -> gl_FUNC_RENAME change.

2006-09-15  Jim Meyering  <jim@meyering.net>

	* m4/rename-dest-slash.m4 (gl_FUNC_RENAME_TRAILING_DEST_SLASH): New
	file.

	* m4/rename.m4 (gl_FUNC_RENAME): Rename from vb_FUNC_RENAME.

2006-09-15  Jim Meyering  <jim@meyering.net>

	* lib/rename-dest-slash.c (has_trailing_slash): Use
	FILE_SYSTEM_PREFIX_LEN, for non-POSIX systems.
	(rpl_rename_dest_slash): Perform the cheaper trailing slash
	test before testing whether SRC is a directory.
	Suggestions from Bruno Haible.

	Avoid a warning about an unused variable.
	* lib/regex_internal.c (re_dfa_add_node): Move declaration of "type"
	into the #ifdef block where it's used.

	* lib/rename-dest-slash.c: New file.

2006-09-14  Bruno Haible  <bruno@clisp.org>

	* lib/allocsa.c: Include <config.h> unconditionally.
	* lib/asnprintf.c: Likewise.
	* lib/asprintf.c: Likewise.
	* lib/c-strcasecmp.c: Likewise.
	* lib/c-strcasestr.c: Likewise.
	* lib/c-strncasecmp.c: Likewise.
	* lib/c-strstr.c: Likewise.
	* lib/classpath.c: Likewise.
	* lib/clean-temp.c: Likewise.
	* lib/concatpath.c: Likewise.
	* lib/copy-file.c: Likewise.
	* lib/csharpcomp.c: Likewise.
	* lib/csharpexec.c: Likewise.
	* lib/execute.c: Likewise.
	* lib/fatal-signal.c: Likewise.
	* lib/findprog.c: Likewise.
	* lib/fwriteerror.c: Likewise.
	* lib/gl_array_list.c: Likewise.
	* lib/gl_array_oset.c: Likewise.
	* lib/gl_avltree_list.c: Likewise.
	* lib/gl_avltree_oset.c: Likewise.
	* lib/gl_avltreehash_list.c: Likewise.
	* lib/gl_carray_list.c: Likewise.
	* lib/gl_linked_list.c: Likewise.
	* lib/gl_linkedhash_list.c: Likewise.
	* lib/gl_list.c: Likewise.
	* lib/gl_oset.c: Likewise.
	* lib/gl_rbtree_list.c: Likewise.
	* lib/gl_rbtree_oset.c: Likewise.
	* lib/gl_rbtreehash_list.c: Likewise.
	* lib/imaxabs.c: Likewise.
	* lib/imaxdiv.c: Likewise.
	* lib/javacomp.c: Likewise.
	* lib/javaexec.c: Likewise.
	* lib/javaversion.c: Likewise.
	* lib/linebreak.c: Likewise.
	* lib/localcharset.c: Likewise.
	* lib/lock.c: Likewise.
	* lib/mbchar.c: Likewise.
	* lib/mbswidth.c: Likewise.
	* lib/mkdtemp.c: Likewise.
	* lib/pipe.c: Likewise.
	* lib/printf-args.c: Likewise.
	* lib/printf-parse.c: Likewise.
	* lib/progname.c: Likewise.
	* lib/progreloc.c: Likewise.
	* lib/readlink.c: Likewise.
	* lib/sh-quote.c: Likewise.
	* lib/stpcpy.c: Likewise.
	* lib/stpncpy.c: Likewise.
	* lib/strcasecmp.c: Likewise.
	* lib/strcasestr.c: Likewise.
	* lib/strcspn.c: Likewise.
	* lib/striconv.c: Likewise.
	* lib/strncasecmp.c: Likewise.
	* lib/strnlen1.c: Likewise.
	* lib/strstr.c: Likewise.
	* lib/strtok_r.c: Likewise.
	* lib/tls.c: Likewise.
	* lib/tmpdir.c: Likewise.
	* lib/unicodeio.c: Likewise.
	* lib/unsetenv.c: Likewise.
	* lib/vasnprintf.c: Likewise.
	* lib/vasprintf.c: Likewise.
	* lib/wait-process.c: Likewise.
	* lib/xallocsa.c: Likewise.
	* lib/xsetenv.c: Likewise.
	* lib/xstriconv.c: Likewise.

2006-09-13  Simon Josefsson  <jas@extundo.com>

	* m4/getdate.m4: Don't AC_LIBOBJ([getdate]), automake takes care of
	that internally, suggested by Ralf Wildenhues
	<Ralf.Wildenhues@gmx.de>.

2006-09-13  Simon Josefsson  <jas@extundo.com>

	* gnulib-tool (func_emit_lib_Makefile_am): Use $(LIBOBJS), not
	@LIBOBJS@.
	Suggested by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2006-09-13  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/_fpending.c: Include <config.h> unconditionally, since we no
	longer worry about uses that don't define HAVE_CONFIG_H.
	* lib/acl.c, lib/alloca.c, lib/argmatch.c, lib/atexit.c:
	* lib/backupfile.c, lib/basename.c, lib/c-stack.c, lib/c-strtod.c:
	* lib/calloc.c,lib/ canon-host.c, lib/canonicalize.c, lib/chdir-long.c:
	* lib/chdir-safer.c, lib/chown.c, lib/cloexec.c, lib/close-stream.c:
	* lib/closeout.c, lib/creat-safer.c, lib/cycle-check.c, lib/diacrit.c:
	* lib/dirchownmod.c, lib/dirfd.c, lib/dirname.c, lib/dup-safer.c:
	* lib/dup2.c, lib/error.c, lib/euidaccess.c, lib/exclude.c:
	* lib/exitfail.c, lib/fchmodat.c, lib/fchown-stub.c, lib/fd-safer.c:
	* lib/file-type.c, lib/fileblocks.c, lib/filemode.c, lib/filenamecat.c:
	* lib/fnmatch.c, lib/fopen-safer.c, lib/fprintftime.c, lib/free.c:
	* lib/fsusage.c, lib/ftruncate.c, lib/fts-cycle.c, lib/fts.c:
	* lib/full-write.c, lib/gai_strerror.c, lib/getcwd.c, lib/getdate.y:
	* lib/getdomainname.c, lib/getgroups.c, lib/gethostname.c:
	* lib/gethrxtime.c, lib/getloadavg.c, lib/getlogin_r.c:
	* lib/getndelim2.c, lib/getnline.c, lib/getopt.c, lib/getopt1.c:
	* lib/getpass.c, lib/gettime.c, lib/gettimeofday.c, lib/getugroups.c:
	* lib/getusershell.c, lib/glob.c, lib/group-member.c:
	* lib/hard-locale.c, lib/hash-pjw.c, lib/hash.c, lib/human.c:
	* lib/idcache.c, lib/inet_ntop.c, lib/inet_pton.c, lib/inttostr.c:
	* lib/isdir.c, lib/lchown.c, lib/linebuffer.c, lib/long-options.c:
	* lib/lstat.c, lib/malloc.c, lib/md5.c, lib/memcasecmp.c, lib/memchr.c:
	* lib/memcmp.c, lib/memcoll.c, lib/memcpy.c, lib/memmove.c:
	* lib/memrchr.c, lib/mkancesdirs.c, lib/mkdir-p.c, lib/mkdir.c:
	* lib/mkdirat.c, lib/mkstemp-safer.c, lib/mkstemp.c, lib/modechange.c:
	* lib/mountlist.c, lib/nanosleep.c, lib/obstack.c, lib/open-safer.c:
	* lib/openat-die.c, lib/openat.c, lib/pagealign_alloc.c, lib/physmem.c:
	* lib/pipe-safer.c, lib/posixtm.c, lib/posixver.c, lib/putenv.c:
	* lib/quote.c, lib/quotearg.c, lib/raise.c, lib/readtokens.c:
	* lib/readtokens0.c, lib/readutmp.c, lib/realloc.c, lib/regex.c:
	* lib/rename.c, lib/rmdir.c, lib/rpmatch.c, lib/safe-read.c:
	* lib/same.c, lib/save-cwd.c, lib/savedir.c, lib/setenv.c:
	* lib/settime.c, lib/sha1.c, lib/sig2str.c, lib/snprintf.c:
	* lib/strdup.c, lib/strerror.c, lib/strftime.c, lib/stripslash.c:
	* lib/strndup.c, lib/strnlen.c, lib/strpbrk.c, lib/strtod.c:
	* lib/strtoimax.c, lib/strtol.c, lib/strverscmp.c, lib/tempname.c:
	* lib/time_r.c, lib/timegm.c, lib/tmpfile-safer.c, lib/unlinkdir.c:
	* lib/userspec.c, lib/utime.c, lib/utimecmp.c, lib/utimens.c:
	* lib/version-etc-fsf.c, lib/version-etc.c, lib/xalloc-die.c:
	* lib/xgetcwd.c, lib/xgethostname.c, lib/xmalloc.c, lib/xmemcoll.c:
	* lib/xnanosleep.c, lib/xreadlink.c, lib/xstrtod.c, lib/xstrtoimax.c:
	* lib/xstrtol.c, lib/xstrtoumax.c, lib/yesno.c:
	Likewise.

2006-09-13  Eric Blake  <ebb9@byu.net>

	* lib/getopt.c: Fix typo in last commit.

2006-09-12  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-help.c (argp_doc): Make sure NULL is not passed to
	dgettext.

2006-09-12  Jim Meyering  <jim@meyering.net>

	* lib/nanosleep.c: Include <sys/types.h> before sys/select.h, to avoid
	compilation failure (due to use of pid_t in latter) on NetBSD 1.6.
	Reported by Nelson H. F. Beebe.

2006-09-10  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-parse.c (__argp_parse) [!_LIBC]: Make sure
	program_invocation_name and program_invocation_short_name are
	initialized.
	* lib/argp-namefrob.h: Move declarations of program_invocation_name
	and program_invocation_short_name to argp.h, so they are visible
	to user programs.
	* lib/argp.h: Likewise

2006-09-10  Bruno Haible  <bruno@clisp.org>

	* modules/mkdtemp (Files): Remove m4/ulonglong.m4, m4/stdint_h.m4,
	m4/inttypes_h.m4, m4/uintmax_t.m4.

2006-09-10  Bruno Haible  <bruno@clisp.org>

	* m4/mkdtemp.m4 (gl_PREREQ_MKDTEMP): Don't require
	gl_AC_TYPE_UINTMAX_T.

2006-09-10  Bruno Haible  <bruno@clisp.org>

	* lib/mkdtemp.c: Include <stdint.h> always. Don't include <inttypes.h>.

2006-09-09  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp.h (struct argp): Document the N_("..") "\v" N_("..")
	convention.  Text proposed by Bruno Haible.
	(struct argp_option): Document the use of N_() wrappers.

	* lib/argp-help.c (argp_doc): Split the untranslated doc string on
	'\v', and translate the two parts separately, instead of feeding
	the whole string to gettext.  This allows to exclude
	'\v' from the strings visible to the translator by writing doc
	strings as N_("..") "\v" N_("..").

2006-09-09  Paul Eggert  <eggert@cs.ucla.edu>

	* config/srclist.txt: Undo latest change; the bug was fixed.

2006-09-09  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): Eliminate lib_LDFLAGS
	assignments if building a library without libtool.
	(func_emit_tests_Makefile_am): Likewise. Handle lib_* variables as
	in func_emit_lib_Makefile_am.
	(func_import): When building a static library libfoo.a, arrange to
	define variables LIBFOO_LIBDEPS and LIBFOO_LTLIBDEPS.
	(func_create_testdir): Likewise.
	* modules/gc (configure.ac, Makefile.am): If building statically,
	augment gl_libdeps and gl_ltlibdeps instead of lib_LDFLAGS.
	* modules/iconvme (configure.ac, Makefile.am): Likewise.
	* modules/striconv (configure.ac, Makefile.am): Likewise.
	Based on a suggestion by Ralf Wildenhues.

2006-09-08  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/mktime.m4 (AC_FUNC_MKTIME): Sync from Autoconf.
	Check for unistd.h too, since Autoconf doesn't assume POSIX.
	Also:

	2006-09-08  Paul Eggert  <eggert@cs.ucla.edu>
	Add year_2050_test to catch glibc bug 2821
	<http://sourceware.org/bugzilla/show_bug.cgi?id=2821>.

	2006-08-15  Paul Eggert  <eggert@cs.ucla.edu>
	Prefer #ifdef to #if.

	2006-04-02  Paul Eggert  <eggert@cs.ucla.edu>
	Return from 'main' instead of calling 'exit'.

2006-09-08  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/mktime.c (guess_time_tm): Fix bug where mktime
	returned the maximum time_t value rather than (time_t) -1.
	Problem originally reported by William Bardwell
	<http://sourceware.org/bugzilla/show_bug.cgi?id=2821>.

	* lib/isapipe.h (HAVE_FIFO_PIPES) [!defined HAVE_FIFO_PIPES]:
	Moved to here ...
	* lib/isapipe.c (HAVE_FIFO_PIPES) [!defined HAVE_FIFO_PIPES]:
	... from here.

2006-09-08  Paul Eggert  <eggert@cs.ucla.edu>

	* config/srclist.txt: Temporarily comment out mktime.c until glibc bug
	2821 is fixed.

2006-09-08  Jim Meyering  <jim@meyering.net>

	Don't make generated files read-only.  That would bother too many
	people.  However, do retain the ability to work when targets are
	read-only: remove the destination and temporary files before writing
	them (when generated via sed or echo), or by using the -f option for
	both cp and mv commands.  Suggestion to use -f from Paul Eggert.
	* modules/alloca-opt, modules/argz, modules/arpa_inet:
	* modules/byteswap, modules/configmake, modules/fcntl:
	* modules/fnmatch, modules/getopt, modules/glob, modules/inttypes:
	* modules/localcharset, modules/netinet_in, modules/poll:
	* modules/stdbool, modules/stdint, modules/sys_select:
	* modules/sys_socket, modules/sys_stat, modules/sysexits:

2006-09-08  Jim Meyering  <jim@meyering.net>

	Avoid new build failure on FreeBSD 6.0.
	* m4/ls-mntd-fs.m4 (gl_LIST_MOUNTED_FILE_SYSTEMS): Include
	<sys/param.h> when testing whether getmntinfo uses statvfs.  Patch by
	Pavel Tsekov, in <http://savannah.gnu.org/bugs/?17643>.

2006-09-07  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/fsusage.m4 (gl_FILE_SYSTEM_USAGE): Don't use plain echo.

2006-09-07  Jim Meyering  <jim@meyering.net>

	Fix global typo in last change: use chmod u-w, not chmod u-x.
	Spotted by Paul Eggert and Bruce Korb.
	* modules/alloca-opt, modules/argz, modules/arpa_inet:
	* modules/byteswap, modules/configmake, modules/fcntl:
	* modules/fnmatch, modules/getopt, modules/glob, modules/inttypes:
	* modules/localcharset, modules/netinet_in, modules/poll:
	* modules/stdbool, modules/stdint, modules/sys_select:
	* modules/sys_socket, modules/sys_stat, modules/sysexits:

2006-09-06  Jim Meyering  <jim@meyering.net>

	Make generated files be read-only.
	* modules/alloca-opt (Makefile.am): Work also when $@ is read-only.
	Ensure that each generated file is now read-only.
	* modules/argz: Likewise.
	* modules/arpa_inet: Likewise.
	* modules/byteswap: Likewise.
	* modules/configmake: Likewise.
	* modules/fcntl: Likewise.
	* modules/fnmatch: Likewise.
	* modules/getopt: Likewise.
	* modules/glob: Likewise.
	* modules/inttypes: Likewise.
	* modules/netinet_in: Likewise.
	* modules/poll: Likewise.
	* modules/stdbool: Likewise.
	* modules/stdint: Likewise.
	* modules/sys_select: Likewise.
	* modules/sys_socket: Likewise.
	* modules/sys_stat: Likewise.
	* modules/sysexits: Likewise.
	* modules/localcharset: Same as above, but continue using temporary
	file named "t-$@" (why different?) rather than the "$@-t" used
	everywhere else.

	* modules/sysexits (Makefile.am): Replace literal occurrences
	of "sysexit.h" more readable, and more consistent, "$@".

2006-09-06  Bruno Haible  <bruno@clisp.org>

	* modules/striconv: New file.
	* modules/xstriconv: New file.
	* MODULES.html.sh (Internationalization functions): Add striconv,
	xstriconv.

2006-09-06  Bruno Haible  <bruno@clisp.org>

	* modules/gc (Makefile.am): Augment lib_LDFLAGS, not lib_LIBADD.
	* modules/iconvme (Makefile.am): Likewise. Also handle the case of
	not using libtool correctly.

2006-09-06  Bruno Haible  <bruno@clisp.org>

	* lib/striconv.h: New file.
	* lib/striconv.c: New file, merging iconvme.c with GNU gettext's
	iconvstring.c.
	* lib/xstriconv.h: New file.
	* lib/xstriconv.c: New file.

2006-09-06  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): Initialize also
	lib_..._LDFLAGS.

2006-09-05  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/argz_.h: Sync from Libtool.

	2006-09-04  George Bosilca <bosilca@cs.utk.edu>
		and Ralf Wildenhues <Ralf.Wildenhues@gmx.de>

	* lib/libltdl/argz_.h: It's __cplusplus, not _cplusplus.

2006-09-05  Davide Angelocola  <davide.angelocola@tiscali.it>

	* modules/trim: New file.

2006-09-05  Davide Angelocola  <davide.angelocola@tiscali.it>

	* lib/trim.h: New file.
	* lib/trim.c: New file.

2006-09-05  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (String handling): Add trim.

2006-09-04  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (signed.m4, gettext.m4): changes not propagated
	until next release.

2006-09-03  Bruno Haible  <bruno@clisp.org>

	* m4/lib-link.m4 (AC_LIB_LINKFLAGS_BODY): Locate mingw shared libraries
	correctly.

2006-09-01  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/getloadavg.m4 (gl_GETLOADAVG): Use CONFIGURING_GETLOADAVG,
	not gl_GETLOADAVG.  Omit unneeded semicolons.
	Problems reported by Ralf Wildenhues in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-09/msg00000.html>.
	(gl_PREREQ_GETLOADAVG): Use AC_DEFUN, not m4_define.  Put
	at the end, which is the usual gnulib style.

	* m4/fstypename.m4 (gl_FSTYPENAME): Use AC_CHECK_MEMBERS instead
	of doing all the work ourselves.
	* m4/fsusage.m4 (gl_PREREQ_FSUSAGE_EXTRA): Don't check for
	sys/statvfs.h since the code doesn't use HAVE_SYS_STATVFS_H.

2006-09-01  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getloadavg.c: Use CONFIGURING_GETLOADAVG, not gl_GETLOADAVG.
	Problem reported by Ralf Wildenhues in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-09/msg00000.html>.

	* lib/mountlist.c: All uses of HAVE_F_FSTYPENAME_IN_STATFS replaced by
	HAVE_STRUCT_STATFS_F_FSTYPENAME.

2006-09-01  Paul Eggert  <eggert@cs.ucla.edu>

	* gnulib-tool (func_emit_lib_Makefile_am): Fix typos in
	yesterday's patch by changing test -n to test -z.

2006-08-31  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/getloadavg (Files): Add m4/getloadavg.m4.
	(configure.ac): AC_FUNC_GETLOADAVG -> gl_GETLOADAVG, as
	the former is now obsolescent.

	* modules/chdir-long (Depends-on): Add fcntl.

2006-08-31  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/fnmatch.m4: Add comment that Autoconf AC_FUNC_FNMATCH is
	obsolescent, and programs should use gnulib instead.
	* m4/getloadavg.m4: New file, with contents taken from Autoconf
	but with prefixes changed.

2006-08-31  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getloadavg.c [defined gl_GETLOADAVG]: Don't include config.h
	or stdbool.h, because they might not exist while configuring.

	* lib/chdir-long.c: Include <fcntl.h>, for O_DIRECTORY.
	Don't include unistd.h or limits.h; not needed, since chdir-long.h
	does that for us.
	(O_DIRECTORY): Remove.

2006-08-31  Eric Blake  <ebb9@byu.net>

	* gnulib-tool: Don't let emacs change spaces to TAB.

2006-08-31  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: When calling func_import more than once, do it in a
	subshell.
	Reported by Eric Blake <ebb9@byu.net>.

2006-08-31  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (nl): Remove variable.
	(sed_transform_lib_file): Use more robust test for config-h module.
	(func_import): Fix typo in 2006-08-25 patch.

2006-08-31  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): When --makefile-name was
	specified, augment Makefile.am variables instead of assigning them.

2006-08-30  Paul Eggert  <eggert@cs.ucla.edu>

	Work around a bug in both the Linux and SunOS 64-bit kernels:
	nanosleep mishandles sleeps for longer than 2**31 seconds.
	Problem reported by Frank v Waveren in
	<http://lists.gnu.org/archive/html/bug-coreutils/2006-08/msg00298.html>.
	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP): Require gl_CLOCK_TIME.
	Check for nanosleep bug.
	(LIB_NANOSLEEP): Append clock_gettime library if needed.

2006-08-30  Paul Eggert  <eggert@cs.ucla.edu>

	Work around a bug in both the Linux and SunOS 64-bit kernels:
	nanosleep mishandles sleeps for longer than 2**31 seconds.
	Problem reported by Frank v Waveren in
	<http://lists.gnu.org/archive/html/bug-coreutils/2006-08/msg00298.html>.
	* lib/nanosleep.c (BILLION): New constant.
	(getnow) [HAVE_BUG_BIG_NANOSLEEP]: New functions.
	(rpl_nanosleep) [HAVE_BUG_BIG_NANOSLEEP]: Completely new
	implementation.

2006-08-30  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/nanosleep (Depends-on): Add gettime.

2006-08-30  Paul Eggert  <eggert@cs.ucla.edu>
	and Simon Josefsson  <jas@extundo.com>
	and Oskar Liljeblad  <oskar@osk.mine.nu>

	* MODULES.html.sh (Support for building documentation): Add gpl, lgpl.
	* gnulib-tool (func_import): New license type 'unmodifiable license
	text'.
	* modules/fdl: Use it.  Longer description.
	* module/gpl, module/lgpl: New files.

2006-08-30  Jim Meyering  <jim@meyering.net>

	* lib/isapipe.c (isapipe): Rename local s/fd/fd_pair/ to avoid
	shadowing the parameter.

2006-08-29  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Sync from Libtool:

	2006-08-28  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/libltdl/argz.c: Use `#ifdef HAVE_CONFIG_H', to facilitate code
	sharing with gnulib.  Report by Eric Blake.

2006-08-29  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/isapipe: New file.
	* MODULES.html.sh (File descriptor based Input/Output): Add isapipe.

2006-08-29  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/configmake (Makefile.am): Add a comment, and omit
	the CONFIGMAKE_ prefix from generated macro names.  Suggested
	by Bruno Haible.

2006-08-29  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/isapipe.m4: New file.

2006-08-29  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/isapipe.c, lib/isapipe.h: New files.

2006-08-29  Jim Meyering  <jim@meyering.net>

	* modules/configmake (Makefile.am): Make configmake.h depend on
	Makefile.  Otherwise, a stale configmake.h could hang around.

2006-08-29  Eric Blake  <ebb9@byu.net>

	* lib/error.c (error_at_line, print_errno_message): Match libc, after
	resolution of upstream bug 3044.

2006-08-29  Bruno Haible  <bruno@clisp.org>

	* modules/localcharset (Depends-on): Add configmake.
	(Makefile.am): Remove setting of LIBDIR through DEFS.

2006-08-29  Bruno Haible  <bruno@clisp.org>

	* lib/localcharset.c: Include configmake.h in order to get LIBDIR
	defined.

2006-08-28  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/fcntl: New file.
	* modules/chdir-safer (Depends-on): Add fcntl.
	* modules/fts: Likewise.
	* modules/mkdir-p: Likewise.

	* modules/stdint (Makefile.am): Do not substitute ABSOLUTE_INTTYPES_H.
	This undoes the most recent change, since we're now addressing the
	problem in a different way.

	* gnulib-tool (emit_lib_Makefile_am): Don't put $makefile_name
	into output, since the output might be called Makefile.am even
	if $makefile_name is something different.
	(func_import): Use $makefile_am rather than
	${makefile_name-Makefile.am}, to fix a bug where makefile_name was
	empty.

	* modules/inttypes (Files): Add m4/inttypes-h.m4.

2006-08-28  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/inttypes.m4 (gl_INTTYPES_H): Move ABSOLUTE_INTTYPES_H code here...
	* m4/stdint.m4 (gl_STDINT_H): ... from here.  This undoes the most
	recent change to stdint.m4, since we're now addressing the problem in a
	different way.

2006-08-28  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/fcntl_h.m4: New file.

2006-08-28  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/fcntl_.h: New file.
	* lib/chdir-safer.c (O_DIRECTORY, O_NOFOLLOW): Remove, now that we have
	the fcntl module.
	* lib/dirchownmod.c: Likewise.
	* lib/fts.c: Likewise.

	* lib/inttypes_.h [defined _GL_JUST_INCLUDE_ABSOLUTE_INTTYPES_H]:
	Include @ABSOLUTE_INTTYPES_H@ if available, but do nothing else.
	* lib/stdint_.h (_GL_JUST_INCLUDE_ABSOLUTE_INTTYPES_H): Define
	just before including <inttypes.h>, to avoid circular inclusion.

2006-08-28  Jim Meyering  <jim@meyering.net>

	* doc/visibility.texi: Actually read and correct the grammar of the
	sentence affected by yesterday's change.

2006-08-28  Eric Blake  <ebb9@byu.net>

	* modules/inttypes (Makefile.am): Fix sed error when inttypes.h
	needs wrapper.

2006-08-28  Eric Blake  <ebb9@byu.net>

	* m4/inttypes.m4 (gl_INTTYPES_H): Fix missing #endif.

2006-08-28  Eric Blake  <ebb9@byu.net>

	* m4/codeset.m4 (AM_LANGINFO_CODESET): Avoid compiler warning.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* modules/c-strstr: New file, from GNU gettext.
	* MODULES.html.sh (String handling): Add c-strstr.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* m4/inttypes.m4 (gl_INTTYPES_H): Don't test for the existence of SCNX*
	macros.
	Reported by Eric Blake.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* lib/vasnprintf.c (EOVERFLOW): Remove definition.
	(VASNPRINTF): Return a string of length > INT_MAX without failing.
	* lib/vasprintf.c: Include errno.h, limits.h.
	(EOVERFLOW): New fallback definition.
	(vasprintf): Test here whether the string length is > INT_MAX.
	* lib/vsnprintf.c: Include errno.h, limits.h.
	(EOVERFLOW): New fallback definition.
	(vsnprintf): Fix bug when generated string was too long for the buffer.
	Test here whether the string length is > INT_MAX.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* lib/inttypes_.h (SCNX*): Remove definitions.
	Reported by Eric Blake.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* lib/c-strstr.h: New file, from GNU gettext.
	* lib/c-strstr.c: New file, from GNU gettext.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: Reorder some statements.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: New option --makefile-name.
	(func_emit_lib_Makefile_am, func_emit_tests_Makefile_am): Use
	$makefile_name.
	(func_import): Write $makefile_name to the cache file, and read it from
	there unless explicitly specified. Use $makefile_name as file name
	instead of Makefile.am. Adjust the recommendations accordingly.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_verify_module): Check against misapplying patch.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_relativize, func_relconcat): New functions.
	Give an error if --local-dir is given with --update.
	Remove trailing slashes from $local_gnulib_dir.
	(func_import): Store the relativized $local_gnulib_dir in
	gnulib-cache.m4, and read it from there if not specified explicitly.

2006-08-28  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_get_tests_module): Don't assume that $gnulib_dir
	is the current directory. Respect also $local_gnulib_dir.

2006-08-28  Bruno Haible  <bruno@clisp.org>
	    Simon Josefsson  <jas@extundo.com>

	BeOS portability.
	* lib/getaddrinfo.c (PF_INET, PF_UNSPEC): New macros.

2006-08-27  Jim Meyering  <jim@meyering.net>

	* doc/visibility.texi: Remove duplicate word: "pointer".

2006-08-26  Bruno Haible  <bruno@clisp.org>

	* modules/inttypes (Files): Add lib/inttypes_.h, remove lib/inttypes.h.
	Add m4/inttypes.m4, remove m4/_inttypes_h.m4 and m4/include_next.m4.
	(Makefile.am): Create inttypes.h from inttypes_.h.
	* modules/stdint (Makefile.am): Substitute also ABSOLUTE_INTTYPES_H.

	* modules/imaxabs: New file.

	* modules/imaxdiv: New file.

2006-08-26  Bruno Haible  <bruno@clisp.org>

	* m4/inttypes.m4: New file.
	* m4/_inttypes_h.m4: Remove file.
	* m4/inttypes-pri.m4 (gt_INTTYPES_PRI): Also AC_SUBST
	PRI_MACROS_BROKEN.
	* m4/stdint.m4 (gl_STDINT_H): Define also ABSOLUTE_INTTYPES_H.

	* m4/imaxabs.m4: New file.

	* m4/imaxdiv.m4: New file.

2006-08-26  Bruno Haible  <bruno@clisp.org>

	* lib/inttypes_.h: New file.
	* lib/inttypes.h: Remove file.
	* lib/stdint_.h: Include <inttypes.h> through its absolute filename.

	* lib/imaxabs.c: New file.

	* lib/imaxdiv.c: New file.

2006-08-25  Paul Eggert  <eggert@cs.ucla.edu>

	New config-h module, so that "make" output needn't be cluttered
	by -DHAVE_CONFIG_H.
	* MODULES.html.sh (Support for building libraries and executables):
	Add config-h.
	* modules/config-h: New file.
	* gnulib-tool (nl, sed_transform_lib_file): New vars.
	(func_import): Turn "#ifdef HAVE_CONFIG_H" to "#if 1" if
	the config-h module is used.

	New configmake module, so that "make" output needn't be cluttered
	by fluff like '-DLIBDIR=\"/usr/local/lib\"'.
	* MODULES.html.sh (Support for building libraries and executables):
	Add configmake.
	* modules/configmake: New file.

2006-08-25  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/config-h.m4: New file.

2006-08-24  Paul Eggert  <eggert@cs.ucla.edu>

	* config/srclist.txt: Add elisp-comp.

2006-08-24  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh (Support for building libraries and executables):
	Add elisp-comp.
	* build-aux/elisp-comp: New file.
	* modules/elisp-comp: New file.

2006-08-24  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Use non-default values of
	sourcebase and m4base.

2006-08-24  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (Compatibility checks for POSIX:2001 functions: Fix
	HTML structure.

2006-08-23  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/openat (Depends-on): Add lchown.

2006-08-23  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import, func_create_testdir): Emit an invocation
	of gl_LOCK_EARLY instead of gl_LOCK.

2006-08-23  Bruno Haible  <bruno@clisp.org>

	* m4/lock.m4 (gl_LOCK_BODY): Change the default value of gl_use_threads
	on OSF/1 to no.
	Reported by Stephen Cartwright <sgcartwr@ucalgary.ca>.

2006-08-23  Bruno Haible  <bruno@clisp.org>

	* m4/fsusage.m4 (gl_FILE_SYSTEM_USAGE): Don't consider BeOS statvfs
	as unusable.

	* m4/lock.m4 (gl_LOCK_EARLY): Renamed from gl_LOCK.
	(gl_LOCK_BODY): Remove gl_PREREQ_LOCK invocation.
	(gl_LOCK): New macro.

2006-08-22  Simon Josefsson  <jas@extundo.com>

	* modules/gc-md5 (Makefile.am): Need to add md5.h, after changes
	to md5 module.

2006-08-22  Simon Josefsson  <jas@extundo.com>

	* MODULES.html.sh: Add "Support for maintaining and release
	projects".

	* build-aux/gnupload: New file, from coreutils.

2006-08-22  Paul Eggert  <eggert@cs.ucla.edu>

	Avoid the need for AC_LIBSOURCES in m4 macros.
	* modules/arcfour (EXTRA_DIST): Add arcfour.h.
	* modules/arctwo (EXTRA_DIST): Add arctwo.h.
	* modules/check-version (EXTRA_DIST): Add check-version.h.
	* modules/crc (EXTRA_DIST): Add crc.h.
	* modules/des (EXTRA_DIST): Add des.h.
	* modules/gc (EXTRA_DIST): Add gc.h.
	* modules/getdelim (EXTRA_DIST): Add getdelim.h.
	* modules/getline (EXTRA_DIST): Add getline.h.
	* modules/getlogin_r (EXTRA_DIST): Add getlogin_r.h.
	* modules/hmac-md5 (EXTRA_DIST): Add hmac.h.
	* modules/hmac-sha1 (EXTRA_DIST): Add hmac.h.
	* modules/md2 (EXTRA_DIST): Add md2.h.
	* modules/md4 (EXTRA_DIST): Add md4.h.
	* modules/pagealign_alloc (EXTRA_DIST): Add pagealign_alloc.h.
	* modules/read-file (EXTRA_DIST): Add read-file.h.
	* modules/readline (EXTRA_DIST): Add readline.h.
	* modules/rijndael (EXTRA_DIST): Add rijndael-alg-fst.h,
	rijndael-api-fst.h.

2006-08-22  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/rijndael.m4 (gl_ARCFOUR):
	* m4/arctwo.m4 (gl_ARCTWO):
	* m4/check-version.m4 (gl_CHECK_VERSION):
	* m4/crc.m4 (gl_CRC):
	* m4/des.m4 (gl_DES):
	* m4/gc-pbkdf2-sha1.m4 (gl_GC_PBKDF2_SHA1):
	* m4/gc.m4 (gl_GC):
	* m4/getdelim.m4 (gl_FUNC_GETDELIM):
	* m4/getline.m4 (gl_FUNC_GETLINE):
	* m4/getlogin_r.m4 (gl_GETLOGIN_R_SUBSTITUTE):
	* m4/hmac-md5.m4 (gl_HMAC_MD5):
	* m4/hmac-sha1.m4 (gl_HMAC_SHA1):
	* m4/md2.m4 (gl_MD2):
	* m4/md4.m4 (gl_MD4):
	* m4/pagealign_alloc.m4 (gl_PAGEALIGN_ALLOC):
	* m4/read-file.m4 (gl_FUNC_READ_FILE):
	* m4/readline.m4 (gl_FUNC_READLINE):
	* m4/rijndael.m4 (gl_RIJNDAEL):
	Don't use AC_LIBSOURCES; instead, rely on the files in ../modules/
	to get the necessary .h files and whatnot.

2006-08-22  Paul Eggert  <eggert@cs.ucla.edu>

	* config/srclist.txt: Remove gnupload, since coreutils now syncs from
	gnulib rather than the other way around.
	* config/srclistvars.sh (COREUTILS): Remove.

2006-08-22  Jim Meyering  <jim@meyering.net>

	* modules/mkdir-p (Makefile.am): Fix typo: s/lib+SOURCES/lib_SOURCES/.

	* modules/getpass-gnu (Makefile.am): Add getpass.h to EXTRA_DIST.

2006-08-22  Eric Blake  <ebb9@byu.net>

	* modules/regexprops-generic: New file.
	* MODULES.html.sh (Support for building documentation): List it.

2006-08-22  Eric Blake  <ebb9@byu.net>

	* m4/stdint_h.m4 (gl_AC_HEADER_STDINT_H): Avoid compiler warning.
	* m4/inttypes_h.m4 (gl_AC_HEADER_INTTYPES_H): Likewise.
	* m4/longlong.m4 (AC_TYPE_LONG_LONG_INT): Likewise.
	* m4/intmax_t.m4 (gt_AC_TYPE_INTMAX_T): Likewise.

2006-08-22  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): Don't treat lib_LIBRARIES
	and lib_LTLIBRARIES like the other lib_* variables.

2006-08-22  Bruno Haible  <bruno@clisp.org>

	* build-aux/x-to-1.in: New file, from GNU gettext.

2006-08-22  Bruno Haible  <bruno@clisp.org>

	* m4/readutmp.m4 (gl_READUTMP): Compile readutmp.c only if <utmp.h> or
	<utmpx.h> exists.

2006-08-22  Bruno Haible  <bruno@clisp.org>

	* lib/readutmp.h: Skip most definitions if neither <utmp.h> nor
	<utmpx.h> exists.

2006-08-21  Paul Eggert  <eggert@cs.ucla.edu>

	BeOS portability.
	* lib/dirchownmod.c (dirchownmod): Don't use fchmod if it doesn't
	exist.
	Problem reported by Bruno Haible.

2006-08-21  Paul Eggert  <eggert@cs.ucla.edu>

	Avoid the need for AC_LIBSOURCES in m4 macros.
	* modules/acl (EXTRA_DIST): Add acl.h.
	* modules/argmatch (Files): Add m4/argmatch.m4.
	(configure.ac): Add gl_ARGMATCH.
	(EXTRA_DIST): Renamed from lib_SOURCES, for
	consistency with the other modules.  Remove argmatch.c.
	* modules/backupfile (EXTRA_DIST): Add backupfile.h.
	* modules/c-strtod (EXTRA_DIST): Add c-strtod.h.
	* modules/c-strtold (EXTRA_DIST): Add c-strtod.c, c-strtod.h.
	* modules/canonhost (EXTRA_DIST): Add c-canonhost.h.
	* modules/canonicalize (EXTRA_DIST): Add canonicalize.h.
	* modules/chdir-long (EXTRA_DIST): Add chdir-long.h.
	* modules/chdir-safer (EXTRA_DIST): Add chdir-safer.h.
	* modules/cloexec (EXTRA_DIST): Add cloexec.h.
	* modules/close-stream (EXTRA_DIST): Add close-stream.h.
	* modules/closeout (EXTRA_DIST): Add closeout.h.
	* modules/cycle-check (EXTRA_DIST): Add cycle-check.h.
	* modules/dev-ino (EXTRA_DIST): Add dev-ino.h.
	* modules/dirfd (EXTRA_DIST): Add dirfd.h.
	* modules/dirname (EXTRA_DIST): Renamed from lib_SOURCES.  Add
	dirname.h; remove basename.c and stripslash.c.
	* modules/exclude (EXTRA_DIST): Add exclude.h.
	* modules/exitfail (EXTRA_DIST): Add exitfail.h.
	* modules/fcntl-safer (EXTRA_DIST): Add fcntl-safer.h fcntl--.h.
	* modules/file-type (EXTRA_DIST): Add file-type.h.
	* modules/filemode (EXTRA_DIST): Add filemode.h.
	* modules/filenamecat (EXTRA_DIST): Add filenamecat.h.
	* modules/fopen-safer (EXTRA_DIST): Add stdio-safer.h stdio--.h.
	* modules/fpending (EXTRA_DIST): Add __fpending.h.
	* modules/fprintftime (EXTRA_DIST): Add fprintftime.h.
	* modules/fsusage (EXTRA_DIST): Add fsusage.h.
	* modules/fts (EXTRA_DIST): Add fts_.h fts-cycle.c.
	* modules/getcwd (EXTRA_DIST): Add getcwd.h.
	* modules/getdate (EXTRA_DIST): Add getdate.c.
	* modules/gethrxtime (EXTRA_DIST): Add gethrxtime.h xtime.h.
	* modules/getpagesize (EXTRA_DIST): Add getpagesize.h.
	* modules/getpass (EXTRA_DIST): Add getpass.h.
	* modules/glob (EXTRA_DIST): Add glob_.h glob-libc.h.
	* modules/group-member (EXTRA_DIST): Add group-member.h.
	* modules/hard-locale (EXTRA_DIST): Add hard-locale.h.
	* modules/hash (EXTRA_DIST): Add hash.h.
	* modules/human (EXTRA_DIST): Add human.h.
	* modules/inttypes (EXTRA_DIST): Add inttypes.h.
	* modules/lchmod (EXTRA_DIST): Add lchmod.h.
	* modules/lchown (EXTRA_DIST): Add lchown.h.
	* modules/long-options (EXTRA_DIST): Add long-options.h.
	* modules/lstat (EXTRA_DIST): Add lstat.h.
	* modules/md5 (EXTRA_DIST): Add memcasecmp.h.
	* modules/memcoll (EXTRA_DIST): Add memcoll.h.
	* modules/mempcpy (EXTRA_DIST): Add mempcpy.h.
	* modules/memrchr (EXTRA_DIST): Add memrchr.h.
	* modules/memxor (EXTRA_DIST): Add memxor.h.
	* modules/mkancesdirs (EXTRA_DIST): Add mkancesdirs.h.
	* modules/mkdir-p (EXTRA_DIST): Add modechange.h.
	* modules/mountlist (EXTRA_DIST): Add mountlist.h.
	* modules/openat (EXTRA_DIST): Add at-func.c openat.h openat-priv.h.
	* modules/pathmax (EXTRA_DIST): Add pathmax.h.
	* modules/physmem (EXTRA_DIST): Add physmem.h.
	* modules/posixtm (EXTRA_DIST): Add posixtm.h.
	* modules/posixver (EXTRA_DIST): Add posixver.h.
	* modules/quote (EXTRA_DIST): Add quote.h.
	* modules/quotearg (EXTRA_DIST): Add quotearg.h.
	* modules/readtokens (EXTRA_DIST): Add readtokens.h.
	* modules/readutmp (EXTRA_DIST): Add readutmp.h.
	* modules/regex (EXTRA_DIST): Add regcomp.c regex.h regex_internal.c
	regex_internal.h regexec.c.
	* modules/safe-read (EXTRA_DIST): Add safe-read.h.
	* modules/safe-write (EXTRA_DIST): Add safe-write.h.
	* modules/same (EXTRA_DIST): Add same.h.
	* modules/same-inode (EXTRA_DIST): Add same-inode.h.
	* modules/save-cwd (EXTRA_DIST): Add save-cwd.h.
	* modules/savedir (EXTRA_DIST): Add savedir.h.
	* modules/sha1 (EXTRA_DIST): Add sha1.h.
	* modules/sig2str (EXTRA_DIST): Add sig2str.h.
	* modules/stat-macros (EXTRA_DIST): Add stat-macros.h.
	* modules/stat-time (EXTRA_DIST): Add stat-time.h.
	* modules/stdlib-safer (EXTRA_DIST): Add stdlib-safer.h stdlib--.h.
	* modules/strdup (EXTRA_DIST): Add strdup.h.
	* modules/strftime (EXTRA_DIST): Add strftime.h.
	* modules/strndup (EXTRA_DIST): Add strndup.h.
	* modules/strnlen (EXTRA_DIST): Add strnlen.h.
	* modules/strverscmp (EXTRA_DIST): Add strverscmp.h.
	* modules/time_r (EXTRA_DIST): Add time_r.h.
	* modules/timespec (EXTRA_DIST): Add timespec.h.
	* modules/tmpfile-safer (EXTRA_DIST): Add stdio-safer.h stdio--.h.
	* modules/unistd-safer (EXTRA_DIST): Add unistd-safer.h unistd--.h.
	* modules/unlinkdir (EXTRA_DIST): Add unlinkdir.h.
	* modules/unlocked-io (EXTRA_DIST): Add unlocked-io.h.
	* modules/userspec (EXTRA_DIST): Add userspec.h.
	* modules/utimecmp (EXTRA_DIST): Add utimecmp.h.
	* modules/utimens (EXTRA_DIST): Add utimens.h.
	* modules/xalloc (EXTRA_DIST): Add xalloc.h.
	* modules/xgetcwd (EXTRA_DIST): Add xgetcwd.h.
	* modules/xnanosleep (EXTRA_DIST): Add xnanosleep.h.
	* modules/xreadlink (EXTRA_DIST): Add xreadlink.h.
	* modules/xstrtod (EXTRA_DIST): Add xstrtod.h.
	* modules/xstrtol (EXTRA_DIST): Add xstrtol.h.
	* modules/xstrtold (EXTRA_DIST): Add xstrtod.c xstrtod.h.
	* modules/yesno (EXTRA_DIST): Add yesno.h.

2006-08-21  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/mkdir-p.m4 (gl_MKDIR_PARENTS): Check for fchmod.

	* m4/argmatch.m4: New file, from coreutils with AC_LIBSOURCES removed.
	* m4/dev-ino.m4, same-inode.m4: Remove.

	* m4/_inttypes_h.m4 (gl_INTTYPES_H):
	* m4/acl.m4 (AC_FUNC_ACL):
	* m4/backupfile.m4 (gl_BACKUPFILE):
	* m4/c-strtod.m4 (gl_C99_STRTOLD):
	* m4/canon-host.m4 (gl_CANON_HOST):
	* m4/canonicalize.m4 (AC_FUNC_CANONICALIZE_FILE_NAME):
	* m4/chdir-long.m4 (gl_FUNC_CHDIR_LONG):
	* m4/chdir-safer.m4 (gl_CHDIR_SAFER):
	* m4/cloexec.m4 (gl_CLOEXEC):
	* m4/close-stream.m4 (gl_CLOSE_STREAM):
	* m4/closeout.m4 (gl_CLOSEOUT):
	* m4/dirfd.m4 (gl_FUNC_DIRFD):
	* m4/dirname.m4 (gl_DIRNAME):
	* m4/exclude.m4 (gl_EXCLUDE):
	* m4/exitfail.m4 (gl_EXITFAIL):
	* m4/fcntl-safer.m4 (gl_FCNTL_SAFER):
	* m4/file-type.m4 (gl_FILE_TYPE):
	* m4/filemode.m4 (gl_FILEMODE):
	* m4/filenamecat.m4 (gl_FILE_NAME_CONCAT):
	* m4/fpending.m4 (gl_FUNC_FPENDING):
	* m4/fprintftime.m4 (gl_FPRINTFTIME):
	* m4/fts.m4 (gl_FUNC_FTS):
	* m4/getcwd.m4 (gl_FUNC_GETCWD_NULL):
	* m4/getdate.m4 (gl_GETDATE):
	* m4/gethrxtime.m4 (gl_GETHRXTIME):
	* m4/getpagesize.m4 (gl_GETPAGESIZE):
	* m4/getpass.m4 (gl_FUNC_GETPASS):
	* m4/gettime.m4 (gl_GETTIME):
	* m4/getugroups.m4 (gl_GETUGROUPS):
	* m4/glob.m4 (gl_GLOB_SUBSTITUTE):
	* m4/group-member.m4 (gl_FUNC_GROUP_MEMBER):
	* m4/hard-locale.m4 (gl_HARD_LOCALE):
	* m4/hash.m4 (gl_HASH):
	* m4/idcache.m4 (gl_IDCACHE):
	* m4/lchmod.m4 (gl_FUNC_LCHMOD):
	* m4/lchown.m4 (gl_FUNC_LCHOWN):
	* m4/long-options.m4 (gl_LONG_OPTIONS):
	* m4/lstat.m4 (gl_FUNC_LSTAT):
	* m4/md5.m4 (gl_MD5):
	* m4/memcasecmp.m4 (gl_MEMCASECMP):
	* m4/memcoll.m4 (gl_MEMCOLL):
	* m4/mempcpy.m4 (gl_FUNC_MEMPCPY):
	* m4/memrchr.m4 (gl_FUNC_MEMRCHR):
	* m4/memxor.m4 (gl_MEMXOR):
	* m4/mkancesdirs.m4 (gl_MKANCESDIRS):
	* m4/mkdir-p.m4 (gl_MKDIR_PARENTS):
	* m4/modechange.m4 (gl_MODECHANGE):
	* m4/mountlist.m4 (gl_MOUNTLIST):
	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP):
	* m4/openat.m4 (gl_FUNC_OPENAT):
	* m4/pathmax.m4 (gl_PATHMAX):
	* m4/physmem.m4 (gl_PHYSMEM):
	* m4/posixtm.m4 (gl_POSIXTM):
	* m4/posixver.m4 (gl_POSIXVER):
	* m4/quote.m4 (gl_QUOTE):
	* m4/quotearg.m4 (gl_QUOTEARG):
	* m4/readtokens.m4 (gl_READTOKENS):
	* m4/readutmp.m4 (gl_READUTMP):
	* m4/regex.m4 (gl_REGEX):
	* m4/safe-read.m4 (gl_SAFE_READ):
	* m4/safe-write.m4 (gl_SAFE_WRITE):
	* m4/same.m4 (gl_SAME):
	* m4/save-cwd.m4 (gl_SAVE_CWD):
	* m4/savedir.m4 (gl_SAVEDIR):
	* m4/settime.m4 (gl_SETTIME):
	* m4/sha1.m4 (gl_SHA1):
	* m4/sig2str.m4 (gl_FUNC_SIG2STR):
	* m4/stat-macros.m4 (gl_STAT_MACROS):
	* m4/stat-time.m4 (gl_STAT_TIME):
	* m4/stdio-safer.m4 (gl_FOPEN_SAFER):
	* m4/stdlib-safer.m4 (gl_STDLIB_SAFER):
	* m4/strdup.m4 (gl_FUNC_STRDUP):
	* m4/strftime.m4 (gl_FUNC_GNU_STRFTIME):
	* m4/strndup.m4 (gl_FUNC_STRNDUP):
	* m4/strnlen.m4 (gl_FUNC_STRNLEN):
	* m4/strverscmp.m4 (gl_FUNC_STRVERSCMP):
	* m4/time_r.m4 (gl_TIME_R):
	* m4/timespec.m4 (gl_TIMESPEC):
	* m4/unistd-safer.m4 (gl_UNISTD_SAFER):
	* m4/unlinkdir.m4 (gl_UNLINKDIR):
	* m4/unlocked-io.m4 (gl_FUNC_GLIBC_UNLOCKED_IO):
	* m4/userspec.m4 (gl_USERSPEC):
	* m4/utimecmp.m4 (gl_UTIMECMP):
	* m4/utimens.m4 (gl_UTIMENS):
	* m4/xalloc.m4 (gl_XALLOC):
	* m4/xgetcwd.m4 (gl_XGETCWD):
	* m4/xnanosleep.m4 (gl_XNANOSLEEP):
	* m4/xreadlink.m4 (gl_XREADLINK):
	* m4/xstrtod.m4 (gl_XSTRTOD):
	* m4/yesno.m4 (gl_YESNO):
	Don't use AC_LIBSOURCES; instead, rely on the files in ../modules/
	to get the necessary .h files and whatnot.

2006-08-21  Mark D. Baushke  <mdb@gnu.org>
	    Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_verify_module): Work around Sun's non-POSIX 1003.2
	/bin/sh understanding of '!' conditional negation.

2006-08-21  Jim Meyering  <jim@meyering.net>

	* modules/openat (Depends-on): Really alphabetize.

	* modules/acl (Depends-on): Add error and quote.

	* check-module (find_included_lib_files): Add at-func.c to the
	ok-to-include-more-than-once white list.

	* modules/openat (Depends-on): Add lstat.  Alphabetize.

2006-08-21  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am, func_emit_tests_Makefile_am):
	Emit a pkgdata_DATA variable only if some snippets add contents to it.
	Reported by Martin Lambers <marlam@marlam.de>.

2006-08-21  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): If the snippets already
	specify an installation location, don't emit a noinst_LIBRARIES or
	noinst_LTLIBRARIES assignment.

2006-08-21  Bruno Haible  <bruno@clisp.org>

	BeOS portability.
	* modules/mbchar (Include): Don't test HAVE_WCTYPE_H any more, since
	BeOS has mbrtowc() but no <wctype.h>.

2006-08-21  Bruno Haible  <bruno@clisp.org>

	BeOS portability.
	* m4/mbchar.m4 (gl_MBCHAR): Compile mbchar.c also if <wctype.h> doesn't
	exist.

2006-08-21  Bruno Haible  <bruno@clisp.org>

	BeOS portability.
	* lib/mbchar.h: Include <wctype.h> only if it exists.

2006-08-20  Paul Eggert  <eggert@cs.ucla.edu>

	Remove files that are no longer needed by their respective modules.
	* m4/obstack.m4: Remove.
	* m4/strerror_r.m4: Remove.
	* m4/uint32_t.m4: Remove.
	* m4/uintptr_t.m4: Remove.
	* m4/ullong_max.m4: Remove.
	* m4/xstrtoimax.m4: Remove.
	* m4/xstrtoumax.m4: Remove.

	* m4/cycle-check.m4 (gl_CYCLE_CHECK): Do not require
	gl_AC_TYPE_UINTMAX_T, gl_STRUCT_DEV_INO, or gl_SAME_INODE, since gnulib
	dependencies now capture this.

	* m4/cycle-check.m4 (gl_CYCLE_CHECK):
	Do not use AC_LIBSOURCES, since gnulib modules now do this.
	* m4/fsusage.m4 (gl_FSUSAGE): Likewise.
	* m4/human.m4 (gl_HUMAN): Likewise.
	* m4/inttostr.m4 (gl_INTTOSTR): Likewise.
	* m4/xstrtol.m4 (gl_XSTRTOL): Likewise.

	* m4/filemode.m4 (gl_FILEMODE): Require AC_STRUCT_ST_DM_MODE.

	* m4/filemode.m4 (gl_PREREQ_FSUSAGE_EXTRA): Do not require
	gl_AC_TYPE_INTMAX_T or gl_AC_TYPE_UINTMAX_T, since we now require
	stdint.
	* m4/human.m4 (gl_HUMAN): Likewise.
	* m4/inttostr.m4 (gl_PREREQ_INTTOSTR): Likewise.
	* m4/mkstemp.m4 (gl_PREREQ_TEMPNAME): Likewise.
	* m4/strtoimax.m4 (gl_PREREQ_STRTOIMAX): Likewise.
	* m4/strtoumax.m4 (gl_PREREQ_STRTOUMAX): Likewise.
	* m4/xstrtol (gl_XSTRTOL): Likewise.

	* m4/gethrxtime.m4 (gl_XTIME): gl_AC_TYPE_LONG_LONG ->
	AC_TYPE_LONG_LONG_INT.
	* m4/strtoimax.m4 (gl_PREREQ_STRTOIMAX): Likewise.
	* m4/strtoll.m4 (gl_FUNC_STRTOLL): Likewise.
	* m4/strtoull.m4 (gl_FUNC_STRTOULL): Likewise, for unsigned long.
	* m4/strtoumax.m4 (gl_PREREQ_STRTOUMAX): Likewise.

	* m4/human.m4 (gl_HUMAN): Do not require AM_STDBOOL_H since we depend
	on stdbool.

	* m4/xstrtol.m4 (gl_PREREQ_XSTRTOL_H, gl_PREREQ_XSTRTOL): Remove.
	(gl_PREREQ_XSTRTOUL): Remove.

	* m4/ls-mntd-fs.m4 (gl_LIST_MOUNTED_FILE_SYSTEMS): Check for hasmntopt.

	* m4/posixver.m4: Fix comment since head -1 now works even in POSIX
	mode.

2006-08-20  Paul Eggert  <eggert@cs.ucla.edu>

	Add and change modules to make it easier for coreutils to use
	gnulib-tool.
	* modules/backupfile (Files): Remove m4/d-ino.m4.
	(Depends-on): Add d-ino.
	* modules/cycle-check (Depends-on): Add stdint.
	(lib_SOURCES): Add cycle-check.h.
	* modules/d-ino: New module.
	* modules/d-type: New module.
	* modules/error (Files): Remove m4/strerror_r.m4.
	* modules/filemode (Files): Add m4/st_dm_mode.m4.
	* modules/fsuage (Files): Remove m4/ulonglong.m4, m4/stdint_h.m4,
	m4/inttypes_h.m4, m4/uintmax_t.m4.
	(Depends-on): Add stdint.
	(lib_SOURCES): Add fsusage.h.
	* modules/getcwd (Files): Remove d-ino.m4.
	(Depends-on): Add d-ino.
	* modules/getndelim2 (Depends-on): Add stdint.
	* modules/glob (Files): Remove m4/d-type.m4.
	(Depends-on): Add d-type.
	* modules/host-os: New module.
	* modules/human (Files):  Remove m4/ulonglong.m4, m4/stdint_h.m4,
	m4/inttypes_h.m4, m4/uintmax_t.m4.
	* Depends-on: Add stdint.
	(lib_SOURCES): Add human.h.
	* modules/inttostr (Files): Remove m4/intmax_t.m4,
	m4/inttostr.m4, m4/inttypes_h.m4, m4/longlong.m4, m4/stdint_h.m4,
	m4/uintmax_t.m4, m4/ulonglong.m4.
	(Depends-on): Add stdint.
	(EXTRA_DIST): Add inttostr.h.
	* modules/lchmod: New module.
	* modules/link-follow: New module.
	* modules/mkdir-p (Files): Remove lib/lchmod.h, m4/lchmod.m4.
	(Depends-on): Add lchmod.
	* modules/mkstemp (Files): Remove m4/ulonglong.m4,
	m4/stdint_h.m4, m4/inttypes_h.m4, m4/uintmax_t.m4.
	(Depends-on): Add stdint.
	* modules/obstack (Files): Remove m4/inttypes_h.m4, m4/obstack.m4,
	m4/stdint_h.m4, m4/uintmax_t.m4, m4/ulonglong.m4.
	(Depends-on): Add stdint.
	(configure.ac): Change gl_OBSTACK to AC_FUNC_OBSTACK.
	* modules/perl: New module.
	* modules/regex (Depends-on): Add stdint.
	* modules/rmdir-errno: New module.
	* modules/strtoimax (Files): Remove m4/stdint_h.m4, m4/inttypes_h.m4,
	m4/intmax_t.m4.
	(Depends-on): Add stdint.
	* modules/strtoumax (Files): Remove m4/stdint_h.m4, m4/inttypes_h.m4,
	m4/uintmax_t.m4.
	(Depends-on): Add stdint.
	* modules/unlink-busy: New module.
	* modules/utimecmp (Depends-on): Add stdint.
	* modules/uptime: New module.
	* modules/winsz-ioctl: New module.
	* modules/winsz-termios: New module.
	* modules/xnanosleep (Depends-on): Add nanosleep.
	* modules/ullong_max: Remove.
	* modules/xstrtoimax (Files): Remove m4/xstrtoimax.m4.
	(configure.ac): Remove gl_XSTRTOIMAX; no action needed now.
	* modules/xstrtol (Files): Remove m4/ulonglong.m4, m4/longlong.m4,
	m4/stdint_h.m4, m4/inttypes_h.m4, m4/uintmax_t.m4, m4/intmax_t.m4.
	(Depends-on): Add inttypes.
	(lib_SOURCES): Add xstrtol.h.
	* modules/xstrtoumax (Files): Remove m4/xstrtoumax.m4.
	(configure.ac): Remove gl_XSTRTOUMAX; no action needed now.
	* MODULES.html.sh: Move 'assert' into the assert section.
	Move 'dummy' into the linking section.
	Remove ullong_max.
	Add section for compatibility checks for POSIX:2001 functions,
	and put d-ino, d-type, link-follow, rmdir-errno, unlink-busy,
	winsz-ioctl, and winsz-termios into it.
	Add lchmod.
	Add top-level Misc section and put host-os, perl, and uptime
	into it.

2006-08-20  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/cycle-check.h: Include <stdint.h> unconditionally, since we
	now assume the stdint module.  Do not include inttypes.h.
	* lib/fsusage.h: Likewise.
	* lib/getndelim2.c: Likewise.
	* lib/human.h: Likewise.
	* lib/inttostr.h: Likewise.
	* lib/obstack.c: Likewise.
	* lib/regex_internal.h: Likewise.
	* lib/tempname.c: Likewise.
	* lib/utimecmp.c: Likewise.
	* lib/xstrtol.h: Likewise.

	* lib/stat_.h: Fix typo: HAVE_FUNC_LSTAT -> HAVE_LSTAT.

	* lib/strtoimax.c: Adjust to macro name changes in Autoconf,
	e.g., HAVE_LONG_LONG -> HAVE_LONG_LONG_INT.
	* lib/xtime.h: Likewise.

2006-08-19  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/openat (Files): Add lib/fchmodat.c.
	Fixes problem reported by Jay Youngman.

2006-08-19  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/fchmodat.c: New file, from coreutils.  This was inadvertently
	omitted in the 2006-08-17 update.  Problem reported by Jay Youngman.

2006-08-18  Paul Eggert  <eggert@cs.ucla.edu>
	    Bruno Haible  <bruno@clisp.org>

	* m4/bison-i18n.m4 (BISON_I18N): Also handle the case where yacc exists
	and is a script that invokes bison. Tighten the code. Add comments.

2006-08-18  Jim Meyering  <jim@meyering.net>

	* m4/gethrxtime.m4 (gl_PREREQ_GETHRXTIME): Also check for
	CLOCK_REALTIME, since gethrxtime may revert to using clock_gettime via
	gettime.c.  Gabor Z. Papp reported that gethrxtime-using programs
	failed to link due to unresolved clock_gettime on a linux-2.4.x system.

2006-08-18  Bruno Haible  <bruno@clisp.org>

	* modules/bison-i18n: New file.
	* MODULES.html.sh (Internationalization functions): Add it.

2006-08-18  Bruno Haible  <bruno@clisp.org>

	* m4/ls-mntd-fs.m4 (gl_LIST_MOUNTED_FILE_SYSTEMS): Also check for
	sys/statvfs.h. When getmntinfo was found, check its declaration and
	set either MOUNTED_GETMNTINFO or MOUNTED_GETMNTINFO2 depending on it.

2006-08-18  Bruno Haible  <bruno@clisp.org>

	* m4/bison-i18n.m4: New file, from bison.

2006-08-18  Bruno Haible  <bruno@clisp.org>

	* lib/mountlist.c [MOUNTED_GETMNTINFO2]: Include sys/statvfs.h.
	(ME_DUMMY): Treat "kernfs" as a dummy.
	(read_file_system_list) [MOUNTED_GETMNTINFO2]: Implement.

2006-08-17  Paul Eggert  <eggert@cs.ucla.edu>

	Update from coreutils.

	2006-08-15  Jim Meyering  <jim@meyering.net>

	* m4/openat.m4 (gl_FUNC_OPENAT): Add at-func.c via AC_LIBSOURCES.

	2006-01-17  Jim Meyering  <jim@meyering.net>

	* m4/fts.m4 (gl_FUNC_FTS_CORE): Depend on gl_FUNC_OPENAT.

	2006-01-11  Jim Meyering  <jim@meyering.net>

	* m4/openat.m4 (gl_FUNC_OPENAT): Require and compile fchmodat.c.
	Check for the lchmod function.

2006-08-17  Paul Eggert  <eggert@cs.ucla.edu>

	Update from coreutils.

	* lib/__fpending.h: Add copyright notice.
	* lib/fprintftime.h: Likewise.
	* lib/savedir.c: Use (C) in copyright notice.
	* lib/savedir.h: Likewise.

	2006-08-15  Jim Meyering  <jim@meyering.net>

	* lib/at-func.c: New file, with the logic of all emulated at-functions.
	* lib/openat-priv.h: Include <errno.h> and define ENOSYS,
	in support of the EXPECTED_ERRNO macro.
	* lib/openat.c (fstatat, unlinkat, fchownat): Remove function
	definitions.  Instead, define the appropriate symbols and include
	"at-func.c".
	* lib/mkdirat.c (mkdirat): Likewise.
	* lib/fchmodat.c (fchmodat): Likewise.
	(ENOSYS): Remove definition.
	* lib/openat.c: Don't include <errno.h>, now that "openat-priv.h" does
	it.  Don't include "unistd--.h" -- it wasn't ever used.

	2006-01-17  Jim Meyering  <jim@meyering.net>

	Rewrite fts.c not to change the current working directory,
	by using openat, fstatat, fdopendir, etc..

	* lib/fts.c [! _LIBC]: Include "openat.h" and "unistd--.h".
	(HAVE_OPENAT_SUPPORT): Define.
	[_LIBC] (fchdir): Don't undef or define; no longer used.
	(FCHDIR): Define in terms of cwd_advance_fd rather than fchdir.
	Now, this `function' always succeeds, and consumes its file descriptor
	parameter -- so callers must not close such FDs.  Update callers.
	(diropen_fd, opendirat, cwd_advance_fd): New functions.
	(diropen): Add parameter, SP.  Adjust all callers.
	Implement using diropen_fd, rather than open.
	(fts_open): Initialize new member, fts_cwd_fd.
	Remove fts_rft-setting code.
	(fts_close): Close fts_cwd_fd, if necessary.
	(__opendir2): Define in terms of opendir or opendirat,
	depending on whether the FST_NOCHDIR flag is set.
	(fts_build): Since fts_safe_changedir consumes its FD, and since
	this code must do `closedir(dirp)', dup the dirfd(dirp) argument,
	and close the dup'd file descriptor upon failure.
	(fts_stat): Use fstatat(...AT_SYMLINK_NOFOLLOW) in place of lstat.
	(fts_safe_changedir): Tweak semantics to reflect that this function
	now calls cwd_advance_fd and hence consumes its FD argument.
	* lib/fts_.h [struct FTS] (fts_cwd_fd): New member.
	[struct FTS] (fts_rft): Remove now-unused member.
	[struct FTS] (fts_cycle.state): Improve comment.

	* lib/openat.c (openat_needs_fchdir): New function.
	* lib/openat.h (openat_needs_fchdir): Declare it.

2006-08-16  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/memcoll.c (memcoll): Set errno = 0 in the shortcut case, too.
	Problem and fix reported by Pádraig Brady in
	<http://lists.gnu.org/archive/html/bug-coreutils/2006-08/msg00099.html>.

2006-08-15  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/cycle-check (configure.ac): Add gl_CYCLE_CHECK.

2006-08-15  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/memcoll.c (memcoll): Optimize for the common case where the
	arguments are bytewise equal.

2006-08-15  Paul Eggert  <eggert@cs.ucla.edu>

	* doc/regexprops-generic.texi: Add a copyright notice.

2006-08-15  Bruno Haible  <bruno@clisp.org>

	* modules/tmpdir (License): Change to LGPL.

2006-08-15  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_all_modules, func_verify_module): COPYING is not a
	module.

2006-08-14  Simon Josefsson  <jas@extundo.com>

	* config/srclist.txt: Add gnupload.

2006-08-14  Paul Eggert  <eggert@cs.ucla.edu>

	Change copyright notice from LGPL 2 to GPL 2, since that's the
	standard form used in the gnulib repository.
	* tests/test-lock.c: Likewise.
	* tests/test-stdint.c: Likewise.
	* tests/test-tls.c: Likewise.

	* users.txt: Add bison, diffutils, libprelude, prelude-lml,
	prelude-manager.  User shorter URLs for GNU projects, without '?'.
	Add copyright notice.

	* check-module: Add copyright notice.  Output a copyright
	notice if "--version" is specified.
	* modules/COPYING: New file.
	* tests/test-getaddrinfo.c: Add copyright notice.
	* tests/test-verify.c: Likewise.

2006-08-14  Paul Eggert  <eggert@cs.ucla.edu>

	Change copyright notice from LGPL 2 to GPL 2, since that's the
	standard form used in the gnulib repository.
	* lib/lock.c: LGPL -> GPL.
	* lib/lock.h: Likewise.
	* lib/strnlen1.c: Likewise.
	* lib/strnlen1.h: Likewise.
	* lib/tls.c: Likewise.
	* lib/tls.h: Likewise.
	* lib/tmpdir.c: Likewise.

	* lib/TODO: Remove; this belongs only in coreutils.

2006-08-14  Paul Eggert  <eggert@cs.ucla.edu>

	Add copyright notices to long-enough files that lack them, since
	otherwise the files aren't clearly free.  Use the same notice that
	getdate.texi already uses.
	* doc/alloca-opt.texi: Add copyright notice.
	* doc/alloca.texi: Likewise.
	* doc/ctime.texi: Likewise.
	* doc/functions.texi: Likewise.
	* doc/gcd.texi: Likewise.
	* doc/gnulib-tool.texi: Likewise.
	* doc/inet_ntoa.texi: Likewise.
	* doc/visibility.texi: Likewise.

	* doc/getdate.texi: Update FDL version from 1.1 to 1.2.
	* doc/quote.texi: Add copyright notice.

	* doc/solaris-versions: Add SunOS 5.10, SunOS 1.x, SunOS 4.0, SunOS
	4.0.x, SunOS 4.1.1.1, SunOS 4.1.1_U1, SunOS 4.1.3B.  SunOS 4.1.3
	was Solaris 1.1A.  Remove space before B in Solaris 1.1.1B.
	Mention SunOS 5.11.  Mention that everything before SunOS 5.7
	is now obsolete, and give a pointer to the Sun list.
	Add copyright notice.

2006-08-14  Paul Eggert  <eggert@cs.ucla.edu>

	* config/srclistvars.sh: Add copyright notice.

2006-08-14  Eric Blake  <ebb9@byu.net>

	Import the following change from libc:

	2006-08-12  Ulrich Drepper  <drepper@redhat.com>

	Upstream bug 2997.
	* lib/misc/error.c: Add space between program name and message if file
	name is missing.

2006-08-12  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (ssize_t.m4, sig_atomic_t.m4, signalblocking.m4):
	remove, these originate in gnulib now.

2006-08-11  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* doc/Makefile (standards.info standards.html standards.dvi):
	Also depend on make-stds.texi.

2006-08-11  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/pipe-safer.c (pipe_safer): Fix misspelling: HAVE_FUNC_PIPE ->
	HAVE_PIPE.  Fix a file descriptor leak when fd_safer fails.

	* lib/regex_internal.c (re_string_skip_chars): Don't assume WEOF fits
	in wchar_t.  Problem reported by Eric Blake.

	* lib/snprintf.c (snprintf): memcpy LEN bytes, not SIZE - 1, when
	LEN is smaller than SIZE.  Suggested by Bruno Haible.
	Also, help the compiler to keep LEN in a register.

2006-08-11  Eric Blake  <ebb9@byu.net>

	* users.txt: Sort.  Add tar.

2006-08-11  Bruno Haible  <bruno@clisp.org>

	* users.txt: New file.

2006-08-11  Bruno Haible  <bruno@clisp.org>

	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Include <stdio.h> and <time.h>
	before <wchar.h>. Needed for OSF/1 and BSD/OS.

2006-08-10  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/snprintf (Depends-on): Remove minmax.
	(Maintainer): Add self and Bruno.

2006-08-10  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/.cppi-disable: Add snprintf.h, socket_.h.
	* lib/snprintf.c: Include <errno.h> and <limits.h>.
	(EOVERFLOW): Define if the system does not.
	Do not include "minmax.h"; it wasn't used.
	(snprintf): Don't assume size_t promotes to an unsigned type.
	Fix bug when generated string was too long for the buffer: the
	buffer's contents are supposed to be the initial prefix of the
	output.  Don't assume vasnprintf returns EOVERFLOW if the size
	exceeds INT_MAX; do the check ourselves.

	Import the following changes from libc:

	2006-06-02  Jakub Jelinek  <jakub@redhat.com>

	* lib/posix/regex_internal.c (re_string_skip_chars): If no character
	has been converted at all, set *last_wc to WEOF.  If mbrtowc failed,
	set wc to the byte which couldn't be converted.
	(re_string_reconstruct): Don't clear valid_raw_len before calling
	re_string_skip_chars.  If wc is WEOF after re_string_skip_chars, set
	tip_context using re_string_context_at.

	2006-05-02  Ulrich Drepper  <drepper@redhat.com>

	* lib/posix/regex.h: g++ still cannot handled [restrict].

	2006-04-21  Ulrich Drepper  <drepper@redhat.com>

	* lib/posix/regex.h: Remove special handling for VMS.

2006-08-10  Jim Meyering  <jim@meyering.net>

	* modules/same-inode: New module.
	* modules/dev-ino: New module.
	* modules/cycle-check: Depend on these modules, rather than simply
	including their .h files.
	(Makefile.am): Don't list cycle-check.[ch] here, now that they're
	required via m4/cycle-check.m4.
	* modules/same: Depend on new same-inode module, rather than
	including same-inode.h.
	* modules/chdir-safer: New file.

	* modules/chown (Depends-on): Add stat-macros.

2006-08-10  Jim Meyering  <jim@meyering.net>

	* m4/cycle-check.m4: New file.
	Require gl_STRUCT_DEV_INO and gl_SAME_INODE.
	* m4/dev-ino.m4, m4/same-inode.m4: New files.

2006-08-10  Eric Blake  <ebb9@byu.net>

	* modules/verror (Depends-on): Remove bogus gl_VERROR that snuck
	in from original proposal.

2006-08-10  Eric Blake  <ebb9@byu.net>
	and Ralf Wildenhues <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_import): Detect unexpanded macros in gnulib
	namespace.

2006-08-10  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Detect unexpanded macros here
	as well.

2006-08-09  Paul Eggert  <eggert@cs.ucla.edu>

	Sync from coreutils.

	2006-07-19  Mike Frysinger  <vapier@gentoo.org>

	* lib/mountlist.c [ME_REMOTE]: Filter out cifs.
	Reported by Toralf Förster in <http://bugs.gentoo.org/141012>.

2006-08-09  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/restrict: Remove; no longer needed now that we assume
	Autoconf 2.59 or later.
	* MODULES.html.sh: Remove 'restrict'.
	* modules/argp (Depends-on): Remove 'restrict'.
	* modules/base64 (Depends-on): Likewise.
	* modules/gc (Depends-on): Likewise.
	* modules/getaddrinfo (Depends-on): Likewise.
	* modules/glob (Depends-on): Likewise.
	* modules/inet_ntop (Depends-on): Likewise.
	* modules/inet_pton (Depends-on): Likewise.
	* modules/memxor (Depends-on): Likewise.
	* modules/regex (Depends-on): Likewise.
	* modules/strtok_r (Depends-on): Likewise.
	* modules/time_r (Depends-on): Likewise.

2006-08-09  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/argp.m4 (gl_ARGP): Require AC_C_RESTRICT.
	* m4/gc.m4 (gl_PREREQ_GC): Likewise.
	* m4/glob.m4 (gl_PREREQ_GLOB): Likewise.
	* m4/inet_ntop.m4 (gl_PREREQ_INET_NTOP): Likewise.
	* m4/inet_pton.m4 (gl_PREREQ_INET_PTON): Likewise.
	* m4/memxor.m4 (gl_MEMXOR): Likewise.
	* m4/restrict.m4: Remove; no longer needed.  All remaining uses of
	gl_C_RESTRICT replaced by AC_C_RESTRICT.

	Merge from coreutils.
	* m4/regex.m4 (gl_PREREQ_REGEX): Require AC_C_RESTRICT, not
	gl_C_RESTRICT, now that we assume Autoconf 2.59 or later.
	* m4/strtok_r.m4 (gl_FUNC_STRTOK_R): Likewise.
	* m4/time_r.m4 (gl_TIME_R): Likewise.

2006-08-09  Karl Berry  <karl@gnu.org>

	* config/srclist.txt: no more gettext-tools, per Bruno.

2006-08-08  Eric Blake  <ebb9@byu.net>

	* modules/verror: New module.
	* MODULES.html.sh: Document it.

2006-08-08  Eric Blake  <ebb9@byu.net>

	* lib/verror.h, lib/verror.c: New files.

2006-08-08  Eric Blake  <ebb9@byu.net>

	* lib/verror.c (verror_at_line): Work around glibc bug 2997, so that
	verror_at_line output complies with GNU Coding Standards even when
	file is NULL.

2006-08-07  Bruno Haible  <bruno@clisp.org>

	* lib/allocsa.h (sa_alignof) [_AIX]: Also consider 'long long' in newer
	versions of AIX.
	Reported by Ralf Wildenhues.

2006-08-07  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_create_testdir): Wrap the set of autoconf snippets
	in an AC_DEFUN. Needed so that the autoconf snippets can use
	AC_REQUIRE.

2006-08-06  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* gnulib-tool (func_emit_lib_Makefile_am, func_emit_tests_Makefile_am):
	Initialize pkgdata_DATA.
	* modules/javaversion (Makefile.am): Add to pkgdata_DATA, rather than
	overriding it.

2006-08-06  Eric Blake  <ebb9@byu.net>

	* lib/error.h: Fold in some upstream changes from glibc.
	* lib/error.c: Likewise.

2006-08-04  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am, func_emit_tests_Makefile_am):
	Make the mostlyclean-local rule depend on mostlyclean-generic.
	Reported by Jim Meyering. Solution suggested by Ralf Wildenhues.

2006-07-31  Bruno Haible  <bruno@clisp.org>

	* m4/localcharset.m4 (gl_LOCALCHARSET): Remove tests for <stddef.h>,
	<stdlib.h>, <string.h>.

2006-07-30  Bruno Haible  <bruno@clisp.org>

	* modules/readlink (License): Change to LGPL.

2006-07-30  Bruno Haible  <bruno@clisp.org>

	* modules/javaversion (Makefile.am): Distribute javaversion.java and
	javaversion.class. Also install javaversion.class in $(pkgdatadir) and
	set PKGDATADIR to point to it.

2006-07-30  Bruno Haible  <bruno@clisp.org>

	* modules/csharpexec (configure.ac): Comment out macro invocation.
	* modules/javaexec (configure.ac): Likewise.
	* modules/javacomp-script (configure.ac): Likewise.

	* modules/csharpcomp-script (configure.ac): Use AC_REQUIRE.

2006-07-30  Bruno Haible  <bruno@clisp.org>

	* modules/clean-temp (Depends-on): Add linkedhash-list, remove
	linked-list.

2006-07-30  Bruno Haible  <bruno@clisp.org>

	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Assume <string.h> exists.

2006-07-30  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am, func_emit_tests_Makefile_am):
	Initialize MOSTLYCLEANFILES to core and *.stackdump, so that core dumps
	get removed.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	Make it possible for gnulib-tool to work with locally modified or
	augmented gnulib repositories.
	* gnulib-tool (func_usage): Document --local-dir option.
	(local_gnulib_dir): New variable.
	Handle --local-dir option.
	(func_lookup_file): New function.
	(func_all_modules, func_verify_module): Look also in $local_gnulib_dir.
	(func_get_description, func_get_filelist, func_get_description,
	func_get_filelist, func_get_dependencies, func_get_autoconf_snippet,
	func_get_automake_snippet, func_get_include_directive,
	func_get_license, func_get_maintainer): Use func_lookup_file.
	(func_import, func_create_testdir): Use func_lookup_file.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* modules/setenv (Depends-on): Add unistd.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* lib/setenv.c: Undo unintended modification done on 2006-02-27.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* lib/localcharset.c: Assume <stddef.h>, <stdlib.h>, <string.h> exist.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (import, update): If there is no Makefile.am, look at
	aclocal.m4, instead of bailing out.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_usage): Revert most of the 2006-07-15 change.
	Categorize the options by when they are useful.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_usage): Document option --no-libtool.
	Handle option --no-libtool.
	(func_emit_lib_Makefile_am, func_emit_tests_Makefile_am): Update
	for changed semantics of $libtool variable.
	(func_import): Likewise. If libtool is not used, show this through
	an option --no-libtool.
	(func_create_testdir): Update.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Extend error message about missing
	--doc-base.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Don't create the $docbase directory if
	there is no file to store there.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (autoconf_minversion): If a --dir option is given and
	relevant, look for configure.ac there, not in the current directory.
	Also use a simple search for AC_PREREQ, not "autoconf --trace".

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (SORT): New variable.
	(func_usage): Undocument --assume-autoconf option.
	Remove --assume-autoconf option handling.
	(autoconf_minversion): Determine from the contents of configure.ac.
	(func_import): Remove autoconf_minversion handling.
	Suggested by Eric Blake.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* doc/gnulib-tool.texi (gl_LIBTOOL): Mention --no-libtool option.

2006-07-29  Bruno Haible  <bruno@clisp.org>

	* config/srclist.txt (*setenv.[ch]): Remove rules.

2006-07-28  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* m4/inet_pton.m4, inet_ntop.m4: Check for netinet/in.h too.

2006-07-28  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* lib/inet_ntop.h, inet_pton.h: Need to include netinet/in.h before
	arpa/inet.h.

2006-07-28  Simon Josefsson  <jas@extundo.com>

	* modules/inet_ntop (Depends-on): Depend on arpa_inet.
	* modules/inet_pton (Depends-on): Likewise.

2006-07-28  Simon Josefsson  <jas@extundo.com>

	* m4/netinet_in_h.m4: New file.

2006-07-28  Simon Josefsson  <jas@extundo.com>

	* lib/inet_ntop.h, inet_pton.h: No need to guard netinet/in.h
	#include's.

2006-07-28  Simon Josefsson  <jas@extundo.com>

	* lib/inet_ntop.h, inet_pton.h: No need to guard arpa/inet.h
	#include's.

2006-07-28  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/modechange.c (mode_compile): Numeric modes now affect setuid and
	setgid on directories only if they set these bits.
	* lib/modechange.h: Remove obsolete comment about masks.

2006-07-28  Eric Blake  <ebb9@byu.net>

	* lib/regex_internal.h (struct re_dfa_t) [!_LIBC]: Avoid invalid C89
	macro expansion.

2006-07-28  Bruno Haible  <bruno@clisp.org>

	* lib/inet_ntop.h, inet_pton.h: Use #if HAVE* instead of #ifdef HAVE*.

2006-07-28  Bruno Haible  <bruno@clisp.org>

	* m4/mbchar.m4 (gl_MBCHAR): Also test for iswcntrl.

2006-07-28  Bruno Haible  <bruno@clisp.org>

	* lib/mbchar.h (iswalnum, iswalpha, iswblank, iswcntrl, iswdigit,
	iswgraph, iswlower, iswprint, iswpunct, iswspace, iswupper, iswxdigit):
	Define fallbacks.
	Avoids link error on FreeBSD 4.x.
	Reported by Yoann Vandoorselaere <yoann.v@prelude-ids.com>.

	* lib/wcwidth.h (iswprint): Assume an ASCII compatible wide character
	encoding.
	* lib/mbswidth.c (iswcntrl): Likewise.

2006-07-27  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H): Define __STDC_CONSTANT_MACROS during the
	test.

2006-07-27  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h (INT*_C, UINT*_C) [C++]: Define these if
	__STDC_CONSTANT_MACROS is defined, not if __STDC_LIMIT_MACROS is
	defined.

2006-07-26  Eric Blake  <ebb9@byu.net>

	* m4/unistd-safer.m4 (gl_UNISTD_SAFER): Check for missing pipe.

2006-07-26  Eric Blake  <ebb9@byu.net>

	* lib/mkstemp-safer.c [! HAVE_MKSTEMP]: Add prototype for platforms
	like mingw that lack mkstemp.
	* lib/pipe-safer.c (pipe_safer) [!HAVE_FUNC_PIPE]: Provide fallback to
	avoid compilation warning on mingw.

2006-07-26  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H): Also verify the existence of the macros
	INT*_MIN, INT_LEAST*_MAX, INT_LEAST*_MIN, UINT_LEAST*_MAX,
	INT_FAST*_MIN, INTPTR_MIN.

2006-07-25  Bruno Haible  <bruno@clisp.org>

	* modules/version-etc (Depends-on): Add stdarg.

2006-07-25  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_INTEGER_TYPE_SUFFIX): Avoid 'eval' in front of
	complex commands.

2006-07-25  Bruno Haible  <bruno@clisp.org>

	* lib/version-etc.c (version_etc_va): Use va_copy, assumed to be
	defined in <stdarg.h> or config.h.

2006-07-24  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/stdio-safer.m4 (gl_FOPEN_SAFER, gl_TMPFILE_SAFER): New macros.
	(gl_STDIO_SAFER): Remove.

2006-07-24  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh (File stream based Input/Output):
	Add fopen-safer, tmpfile-safer; remove stdio-safer.
	* modules/getusershell (Depends-on): Change stdio-safer to fopen-safer.
	* modules/fopen-safer, modules/tmpfile-safer: New files.
	* modules/stdio-safer: Remove.

2006-07-24  Bruno Haible  <bruno@clisp.org>

	* modules/tmpdir: New file.
	* MODULES.html.sh (File system functions): Add it.

2006-07-24  Bruno Haible  <bruno@clisp.org>

	* modules/javacomp (Depends-on): Add unistd, javaversion, binary-io,
	getline, pathname, fwriteerror, clean-temp, xvasprintf, strstr.

2006-07-24  Bruno Haible  <bruno@clisp.org>

	* modules/clean-temp: New file.

2006-07-24  Bruno Haible  <bruno@clisp.org>

	* m4/tmpdir.m4: New file, from GNU gettext.

2006-07-24  Bruno Haible  <bruno@clisp.org>

	* lib/tmpdir.h: New file, from GNU gettext.
	* lib/tmpdir.c: New file, from GNU gettext.

2006-07-24  Bruno Haible  <bruno@clisp.org>

	* lib/clean-temp.h: New file, from GNU gettext.
	* lib/clean-temp.c: New file, from GNU gettext.

2006-07-23  Eric Blake  <ebb9@byu.net>

	* modules/stdio-safer (Files): Add tmpfile-safer.c.
	(Depends-on): Add binary-io.

2006-07-23  Eric Blake  <ebb9@byu.net>

	* m4/stdio-safer.m4 (gl_STDIO_SAFER): Add tmpfile-safer.c.

2006-07-23  Eric Blake  <ebb9@byu.net>

	* lib/tmpfile-safer.c: New file.
	* lib/stdio-safer.h (fopen_safer): Add prototype.
	* lib/stdio--.h (tmpfile): Make safer.

2006-07-23  Bruno Haible  <bruno@clisp.org>

	* lib/gl_anylinked_list2.h (ASYNCSAFE): New macro.
	(gl_linked_add_first, gl_linked_add_last, gl_linked_add_before,
	gl_linked_add_after, gl_linked_add_at, gl_linked_remove_node,
	gl_linked_remove_at): Use it.

2006-07-22  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>
	and Simon Josefsson <jas@extundo.com>

	* lib/getaddrinfo.h (AI_PASSIVE): Make sure it is defined.

	* lib/getaddrinfo.c (getaddrinfo): Support AI_PASSIVE.

2006-07-22  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/close-stream: New file.
	* modules/closeout (Description): Make it clear that it exits
	with a diagnostic on error.
	(Depends-on): Add close-stream.  Remove fpending, stdbool.
	* MODULES.html.sh (File stream based Input/Output): Add close-stream.

2006-07-22  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/close-stream.m4: New file.

2006-07-22  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/close-stream.c, lib/close-stream.h: New files.

2006-07-22  Bruno Haible  <bruno@clisp.org>

	Merge from GNU gettext 0.15.

	2006-05-01  Bruno Haible  <bruno@clisp.org>

		* build-aux/javacomp.sh.in: Update for changed javacomp.m4.

	2006-07-22  Bruno Haible  <bruno@clisp.org>

		* modules/javaversion: New file.
		* MODULES.html.sh (Java): Add javaversion.

	2006-03-12  Bruno Haible  <bruno@clisp.org>

		* build-aux/javaexec.sh.in: Update for changed javaexec.m4.

	2005-12-04  Bruno Haible  <bruno@clisp.org>

		* build-aux/csharpexec.sh.in: Add support for 'clix' launcher
		(untested).

	2006-06-21  Bruno Haible  <bruno@clisp.org>

		Avoid warnings from recent versions of mcs.
		* build-aux/csharpcomp.sh.in (options_mcs): Don't use options
		-o, -L, -r any more. Use options documented since mcs-1.0
		instead. Similarly for -g.

	2005-12-04  Bruno Haible  <bruno@clisp.org>

		* build-aux/csharpcomp.sh.in: Suffix for resources is
		.resources, not .resource.

	2005-07-09  Bruno Haible  <bruno@clisp.org>

		* build-aux/csharpcomp.sh.in (options_csc): For -l option,
		add a .dll suffix.
		Reported by Mark Junker <mjscod@gmx.de>.

	2006-07-22  Bruno Haible  <bruno@clisp.org>

		* modules/gettext: Upgrade to gettext-0.15.
		(Files): Remove m4/isc-posix.m4. Add m4/lock.m4,
		m4/visibility.m4.
		Replace m4/inttypes.m4 with m4/inttypes-h.m4.

2006-07-22  Bruno Haible  <bruno@clisp.org>

	Merge from GNU gettext 0.15.

	2006-03-25  Bruno Haible  <bruno@clisp.org>

		* lib-link.m4 (AC_LIB_LINKFLAGS_FROM_LIBS): New macro.

	2006-07-21  Bruno Haible  <bruno@clisp.org>

		* javacomp.m4 (gt_JAVACOMP): Convert target_version "null" to
		"1.1".

	2006-05-09  Bruno Haible  <bruno@clisp.org>

		* javacomp.m4 (gt_JAVACOMP): On Cygwin, set
		CLASSPATH_SEPARATOR to a semicolon. Use CLASSPATH_SEPARATOR
		for the conftestver execution.

	2006-05-01  Bruno Haible  <bruno@clisp.org>

		* javacomp.m4 (gt_JAVACOMP): Accept a source-version and an
		optional target-version argument. Verify that the compiler
		groks source of the specified source-version, or add -source
		option as necessary. Verify that the compiler produces
		bytecode in the specified target-version, or add -target and
		-source options as necessary. Make the result of the test
		available as variable CONF_JAVAC. Also log error output in
		config.log.

	2006-03-11  Bruno Haible  <bruno@clisp.org>

		* javacomp.m4 (gt_JAVACOMP): Treat gcj-4.x like gcj-3.x.

	2006-05-09  Bruno Haible  <bruno@clisp.org>

		* javaexec.m4 (gt_JAVAEXEC): On Cygwin, set
		CLASSPATH_SEPARATOR to a semicolon.

	2006-03-12  Bruno Haible  <bruno@clisp.org>

		* javaexec.m4 (gt_JAVAEXEC): Make the result of the test
		available as variable CONF_JAVA, for subsequent autoconf
		tests. Also log error output in config.log.

	2006-07-19  Bruno Haible  <bruno@clisp.org>

		* getline.m4 (AM_FUNC_GETLINE): When cross-compiling, assume
		that getline works on glibc2 systems. Needed to avoid trouble
		in relocatable.c.
		Reported by Nils Magnus Larsgard <nmlarsgaard@atmel.no>.

	2005-12-04  Bruno Haible  <bruno@clisp.org>

		* csharpexec.m4 (gt_CSHARPEXEC): Add support for 'clix'
		launcher (untested).

	2005-12-04  Bruno Haible  <bruno@clisp.org>

		* csharpcomp.m4 (gt_CSHARPCOMP): Also set CSHARPCOMPFLAGS.

	2006-07-22  Bruno Haible  <bruno@clisp.org>

		* gettext.m4: Update from GNU gettext-0.15.
		* nls.m4: Likewise.
		* po.m4: Likewise.
		* inttypes-pri.m4: Likewise.
		* inttypes-h.m4: Renamed from inttypes.m4.
		(gl_HEADER_INTTYPES_H): Renamed from gt_HEADER_INTTYPES_H.

2006-07-22  Bruno Haible  <bruno@clisp.org>

	Merge from GNU gettext 0.15.

	2005-07-05  Bruno Haible  <bruno@clisp.org>

		* printf-args.c (printf_fetchargs): Work around broken
		definition of wint_t on mingw.

	2005-02-12  Bruno Haible  <bruno@clisp.org>

		* xallocsa.h: Add extern "C" for C++.

	2006-05-17  Bruno Haible  <bruno@clisp.org>

		Cygwin portability.
		* progreloc.c (WIN32_NATIVE): Renamed from WIN32.

	2006-04-30  Bruno Haible  <bruno@clisp.org>

		* progreloc.c: Include <mach-o/dyld.h> if available.
		(find_executable): Use _NSGetExecutablePath when possible.

	2006-05-06  Charles Wilson  <cygwin@cwilson.fastmail.fm>

		* progreloc.c (maybe_executable) [CYGWIN]: Use the access()
		function.

	2005-12-29  Bruno Haible  <bruno@clisp.org>

		* progreloc.c (set_program_name_and_installdir): Fix
		compilation error.

	2005-12-04  Bruno Haible  <bruno@clisp.org>

		Cygwin portability.
		* progreloc.c: Include <windows.h> also on Cygwin.
		(find_executable): Add support for Cygwin.
		(set_program_name_and_installdir): Handle also platforms with
		nonempty EXEEXT.

	2006-07-11  Bruno Haible  <bruno@clisp.org>

		* javacomp.c: Fix a comment.
		Reported by Jim Meyering.

	2006-04-30  Bruno Haible  <bruno@clisp.org>

		* javacomp.h (compile_java_class): Add source_version,
		target_version arguments.
		* javacomp.c: Rewritten to choose only a compiler that
		respects the specified source_version and target_version.

	2006-06-27  Bruno Haible  <bruno@clisp.org>

		Assume correct S_ISDIR macro.
		* mkdtemp.c: Remove test of STAT_MACROS_BROKEN.

	2006-07-22  Bruno Haible  <bruno@clisp.org>

		* javaversion.h: New file, from GNU gettext.
		* javaversion.c: New file, from GNU gettext.
		* javaversion.java: New file, from GNU gettext.
		* javaversion.class: New file, from GNU gettext.

	2006-05-17  Bruno Haible  <bruno@clisp.org>

		Cygwin portability.
		* javaexec.c (execute_java_class): Test for jview program
		also on Cygwin.

	2006-04-09  Bruno Haible  <bruno@clisp.org>

		* fatal-signal.c: Don't include string.h.
		(at_fatal_signal): Use a copying loop instead of memcpy.

	2005-12-04  Bruno Haible  <bruno@clisp.org>

		* csharpexec.c: Add support for 'clix' launcher (untested).
		(execute_csharp_using_sscli): New function.
		(execute_csharp_program): Call it.

	2006-06-21  Bruno Haible  <bruno@clisp.org>

		Avoid warnings from recent versions of mcs.
		* csharpcomp.c (compile_csharp_using_mono): Don't use options
		-o, -L, -r any more. Use options documented since mcs-1.0
		instead. Similarly for -g.

	2005-07-09  Bruno Haible  <bruno@clisp.org>

		* csharpcomp.c (compile_csharp_using_sscli): For -l option,
		add a .dll suffix.
		Reported by Mark Junker <mjscod@gmx.de>.

	2006-06-17  Bruno Haible  <bruno@clisp.org>

		* config.charset: Update for NetBSD 3.0.

	2006-05-17  Bruno Haible  <bruno@clisp.org>

		Cygwin portability.
		* localcharset.c (WIN32_NATIVE): Renamed from WIN32.

	2006-05-16  Bruno Haible  <bruno@clisp.org>

		* localcharset.c [CYGWIN]: Include <windows.h>.
		(get_charset_aliases): For Cygwin, return the same CPxxx
		aliases list as under WIN32.
		(locale_charset) [CYGWIN]: Try to retrieve the encoding from
		the environment variables. Fall back to GetACP().

	2006-04-05  Bruno Haible  <bruno@clisp.org>

		* config.charset: Update Juan Manuel Guerrero's address.

	2005-02-12  Bruno Haible  <bruno@clisp.org>

		* allocsa.h: Add extern "C" for C++.

	2005-02-10  Bruno Haible  <bruno@clisp.org>

		* allocsa.h (sa_alignof): Define differently with AIX xlc, to
		avoid a bug of this compiler on AIX 3.2.5 dealing with enums.

	2006-07-22  Bruno Haible  <bruno@clisp.org>

		* gettext.h: Update to GNU gettext-0.15.

2006-07-22  Bruno Haible  <bruno@clisp.org>

	* config/srclist.txt: Resync printf-args.c, vasnprintf.c,
	localcharset.c, mkdtemp.c, config.rpath, lib-ld.m4, lib-link.m4,
	lib-prefix.m4, longdouble.m4, ssize_t.m4.

2006-07-21  Eric Blake  <ebb9@byu.net>

	* modules/stdlib-safer: New file.
	* MODULES.html.sh (File stream based Input/Output): Add
	stdlib-safer.

2006-07-21  Eric Blake  <ebb9@byu.net>

	* lib/stdlib-safer.h: New file from coreutils, required by
	stdlib--.h.

2006-07-20  Paul Eggert  <eggert@cs.ucla.edu>

	* gnulib-tool (func_usage): Document --assume-autoconf='latest-stable'.

2006-07-20  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: Recognize new option --assume-autoconf.
	(autoconf_minversion): New variable.
	(func_get_filelist): Use it to decide whether to add onceonly_2_57.m4.

2006-07-20  Bruno Haible  <bruno@clisp.org>

	* MODULES.html.sh (func_all_modules): Add a missing func_begin_table.

2006-07-19  Derek R. Price  <derek@ximbiot.com>

	* lib/getaddrinfo.h: Don't define unimplemented AI_* flags.
	Reindent and repaginate.

2006-07-19  Derek Price  <derek@ximbiot.com>

	* doc/gnulib.texi (Libtool and Windows):  Eliminate passive voice.
	Correct grammar.

2006-07-17  Bruno Haible  <bruno@clisp.org>

	* modules/list: New file.
	* modules/array-list: New file.
	* modules/carray-list, modules/carray-list-tests: New files.
	* modules/linked-list, modules/linked-list-tests: New files.
	* modules/avltree-list, modules/avltree-list-tests: New files.
	* modules/rbtree-list, modules/rbtree-list-tests: New files.
	* modules/linkedhash-list, modules/linkedhash-list-tests: New files.
	* modules/avltreehash-list, modules/avltreehash-list-tests: New files.
	* modules/rbtreehash-list, modules/rbtreehash-list-tests: New files.
	* modules/oset: New file.
	* modules/array-oset: New file.
	* modules/avltree-oset, modules/avltree-oset-tests: New files.
	* modules/rbtree-oset, modules/rbtree-oset-tests: New files.
	* tests/test-carray_list.c: New file.
	* tests/test-linked_list.c: New file.
	* tests/test-avltree_list.c: New file.
	* tests/test-rbtree_list.c: New file.
	* tests/test-linkedhash_list.c: New file.
	* tests/test-avltreehash_list.c: New file.
	* tests/test-rbtreehash_list.c: New file.
	* tests/test-avltree_oset.c: New file.
	* tests/test-rbtree_oset.c: New file.
	* MODULES.html.sh (Container data structures): New section.

2006-07-17  Bruno Haible  <bruno@clisp.org>

	* m4/gl_list.m4: New file.

2006-07-17  Bruno Haible  <bruno@clisp.org>

	* lib/gl_list.h: New file.
	* lib/gl_list.c: New file.
	* lib/gl_array_list.h: New file.
	* lib/gl_array_list.c: New file.
	* lib/gl_carray_list.h: New file.
	* lib/gl_carray_list.c: New file.
	* lib/gl_linked_list.h: New file.
	* lib/gl_linked_list.c: New file.
	* lib/gl_anylinked_list1.h: New file.
	* lib/gl_anylinked_list2.h: New file.
	* lib/gl_avltree_list.h: New file.
	* lib/gl_avltree_list.c: New file.
	* lib/gl_anyavltree_list1.h: New file.
	* lib/gl_anyavltree_list2.h: New file.
	* lib/gl_rbtree_list.h: New file.
	* lib/gl_rbtree_list.c: New file.
	* lib/gl_anyrbtree_list1.h: New file.
	* lib/gl_anyrbtree_list2.h: New file.
	* lib/gl_anytree_list1.h: New file.
	* lib/gl_anytree_list2.h: New file.
	* lib/gl_linkedhash_list.h: New file.
	* lib/gl_linkedhash_list.c: New file.
	* lib/gl_anyhash_list1.h: New file.
	* lib/gl_anyhash_list2.h: New file.
	* lib/gl_avltreehash_list.h: New file.
	* lib/gl_avltreehash_list.c: New file.
	* lib/gl_rbtreehash_list.h: New file.
	* lib/gl_rbtreehash_list.c: New file.
	* lib/gl_anytreehash_list1.h: New file.
	* lib/gl_anytreehash_list2.h: New file.

	* lib/gl_oset.h: New file.
	* lib/gl_oset.c: New file.
	* lib/gl_array_oset.h: New file.
	* lib/gl_array_oset.c: New file.
	* lib/gl_avltree_oset.h: New file.
	* lib/gl_avltree_oset.c: New file.
	* lib/gl_rbtree_oset.h: New file.
	* lib/gl_rbtree_oset.c: New file.
	* lib/gl_anytree_oset.h: New file.

2006-07-16  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/mkancesdirs.m4: New file.
	* m4/mkdir-p.m4 (gl_MKDIR_PARENTS): Mention dirchownmod.c,
	dirchownmod.h.  Don't require AC_FUNC_ALLOCA, gl_AFS, gl_CHDIR_SAFER;
	no longer needed.  Require gl_FUNC_LCHOWN, since dirchownmod.c needs
	it.

2006-07-16  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/dirchownmod.c, lib/dirchownmod.h, lib/mkancesdirs.c:
	* lib/mkancesdirs.h: New files.
	* lib/mkdir-p.c: Don't include alloca.h, stdio.h, sys/types.h,
	unistd.h, string.h, chdir-safer.h, dirname.h, lchmod.h, lchown.h,
	save-cwd.h.  Instead, include dirchownmod.h and mkancesdirs.h.
	(make_dir_parents): New args MAKE_ANCESTOR, OPTIONS, ANNOUNCE,
	MODE_BITS.  Remove options VERBOSE_FMT_STRING, CWD_ERRNO.  All
	callers changed.  Revamp internals significantly, by not
	attempting to create directories that are temporarily more
	permissive than the final results.  Do not attempt to use
	save_cwd/restore_cwd; it isn't worth it for mkdir and install.
	This removes some race conditions, fixes some bugs, and simplifies
	things.  Use new dirchownmod function to do owner and mode changes.
	* lib/mkdir-p.h: Likewise.
	* lib/modechange.c (octal_to_mode): New function.
	(struct mode_change): New member mentioned.
	(make_node_op_equals): New arg mentioned.  All callers changed.
	(mode_compile): Keep track of which mode bits the user has explicitly
	mentioned.
	(mode_adjust): New arg DIR, so that we implement the X op correctly.
	New arg PMODE_BITS, to keep track of which mode bits the user
	mentioned; it treats S_ISUID and S_ISGID speciall.
	All callers changed.
	* lib/modechange.h: Likewise.

2006-07-16  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh: Add mkancestors.
	* modules/mkancesdirs: New module.
	* modules/mkdir-p (Files): Remove lib/chdir-safer.c, lib/chdir-safer.h,
	lib/same-inode.h, m4/afs.m4, m4/chdir-safer.m4.
	The chdir-safer and afs files are now orphans; I'll remove them
	unless someone speaks up.
	Add lib/dirchownmod.c, lib/dirchownmod.h.
	(Depends-on): Remove alloca, chown, save-cwd, dirname.
	Add lchown, mkancesdirs.
	(Maintainer): Add self.

2006-07-15  Karl Berry  <karl@gnu.org>

	* gnulib-tool: help message wording/arrangement.

2006-07-14  Simon Josefsson  <jas@extundo.com>

	* doc/gnulib.texi (Libtool and Windows): New section.

2006-07-12  Simon Josefsson  <jas@extundo.com>

	* modules/gendocs (License): Fix license, approved by Karl.

2006-07-12  Eric Blake  <ebb9@byu.net>

	* MODULES.html.sh: Add gendocs.

2006-07-11  Eric Blake  <ebb9@byu.net>

	* modules/fdl: New module, to install doc/fdl.texi.
	* MODULES.html.sh: Add new section for documentation modules.
	* gnulib-tool: Avoid space-tab.
	(--doc-base): New option, to manage files from doc.

2006-07-11  Eric Blake  <ebb9@byu.net>

	* m4/absolute-header.m4: Fix comments to match recent change.

2006-07-11  Eric Blake  <ebb9@byu.net>

	* gnulib-tool: List --doc-base before --tests-base.

2006-07-11  Derek R. Price  <derek@ximbiot.com>

	* lib/glob.c: s/NAMLEN/_D_EXACT_NAMLEN/.

2006-07-11  Bruno Haible  <bruno@clisp.org>

	* README: Mention where to put documentation.

2006-07-10  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* doc/functions.texi, gnulib-tool.texi, gnulib.texi: Fix some typos.

2006-07-10  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/sys_stat_h.m4 (gl_HEADER_SYS_STAT_H): Like today's change
	to stdint.m4.

2006-07-10  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/stdint.m4 (gl_STDINT_H): Like yesterday's change to
	absolute-header.m4.  Also, set ABSOLUTE_STDINT_H to a string
	"no/such/file/stdint.h" when there is no such file, so that
	the resulting C code can be parsed by dodgy compilers.
	Problems reported by Bob Proulx.

2006-07-10  Derek R. Price  <derek@ximbiot.com>

	* lib/backupfile.c, dirfd.h, fts.c, getcwd.c, glob.c, glob_.h:
	Ignore the obsolescent !HAVE_DIRENT_H case.  Consolidate NAMLEN
	macros into the GNU _D_EXACT_NAMLEN.
	* lib/savedir.c:  Likewise.
	(savedirstream): Use _D_EXACT_NAMLEN in preference to strlen.

2006-07-10  Derek R. Price  <derek@ximbiot.com>
	and Paul Eggert  <eggert@cs.ucla.edu>

	* m4/backupfile.m4, d-ino.m4, d-type.m4, dirfd.m4, fts.m4, getcwd.m4:
	* m4/savedir.m4:
	Ignore the obsolescent !HAVE_DIRENT_H case.  Consolidate NAMLEN
	macros into the GNU _D_EXACT_NAMLEN.

2006-07-09  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/absolute-header.m4 (gl_ABSOLUTE_HEADER): Use "" rather than <>
	around the absolute name, to work around a problem with the HP-UX
	11.23 native C compiler, reported by Bob Proulx.

2006-07-09  Paul Eggert  <eggert@cs.ucla.edu>

	* doc/maintain.texi, make-stds.texi: Sync from
	<http://savannah.gnu.org/projects/gnustandards>.

2006-07-09  Paul Eggert  <eggert@cs.ucla.edu>

	* build-aux/depcomp, build-aux/install-sh: Sync from Automake.

2006-07-09  Jim Meyering  <jim@meyering.net>

	* m4/glob.m4: Remove a doubled word in a comment.

2006-07-09  Jim Meyering  <jim@meyering.net>

	* lib/argp-pv.c: Remove a doubled word in a comment.
	* lib/check-version.c (check_version): Likewise.
	* lib/javacomp.c (compile_java_class): Likewise.

2006-07-08  Paul Eggert  <eggert@cs.ucla.edu>

	* gnulib-tool (func_get_filelist): Don't echo m4/onceonly_2_57.m4,
	for the benefit of people using Autoconf 2.60.  If you want to
	support older Autoconf versions you can copy m4/onceonly_2_57.m4
	(or m4/onceonly.m4, if pre-2.57) manually.

2006-07-08  Jim Meyering  <jim@meyering.net>

	* m4/link-follow.m4: Remove one of two adjacent "whether"s in a
	comment.
	* m4/getopt.m4: Remove one of two adjacent "your"s in a comment.
	* m4/regex.m4 (gl_REGEX): Remove one of two adjacent "the"s in a
	comment.

2006-07-08  Jim Meyering  <jim@meyering.net>

	* lib/getndelim2.h (getndelim2): Remove doubled "after" in comment.

2006-07-07  Simon Josefsson  <jas@extundo.com>

	* tests/test-crc.c: Change expected crc value, the test vector
	were probably computed using the old broken crc.c?

2006-07-06  Simon Josefsson  <jas@extundo.com>

	* modules/sys_socket (Files): Add m4/sockpfaf.m4 (this module is
	now the canonical place for the M4 file).

	* modules/getaddrinfo (Files): Remove m4/sockpfaf.m4, we get it
	from the sys_socket dependency now.

	* modules/inet_pton (Files): Ditto.

	* modules/inet_ntop (Files): Ditto.

2006-07-06  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>  (tiny change)

	* modules/getusershell (configure.ac): Use gl_FUNC_GETUSERSHELL,
	not gl_PREREQ_GETUSERSHELL.

2006-07-06  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/_inttypes_h.m4 (gl_INTTYPES_H): Use AC_CHECK_DECLS_ONCE
	with only one argument, for Autoconf 2.60.
	* m4/fileblocks.m4 (gl_PREREQ_FILEBLOCKS): AC_CHECK_DECLS_ONCE may
	expand to nothing, so add a shell command to avoid syntax error.
	* m4/getpass.m4 (gl_PREREQ_GETPASS): Likewise.

2006-07-06  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/strtod.c (strtod): cast the argument of tolower to unsigned char.

2006-07-06  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/fnmatch.m4 (_AC_LIBOBJ_FNMATCH): Don't check for getenv decl;
	no longer needed.  Check for isblank decl.
	* m4/mkstemp.m4 (gl_PREREQ_TEMPNAME): Don't check for getenv decl.
	* m4/regex.m4 (gl_PREREQ_REGEX): Dheck for isblank decl instead
	of existence.

2006-07-06  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getloadavg.c: Use __VMS, not VMS.
	* lib/getopt.c: Likewise.
	* lib/getpagesize.h: Likewise.
	* lib/glob.c: Remove most VMS cruft; it hasn't been tested for a while
	and probably does not work.

2006-07-06  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/.cppi-disable: Add wcwidth.
	* lib/fnmatch.c (ISBLANK): Remove.  All uses changed to isblank.
	(isblank) [! (defined isblank || HAVE_DECL_ISBLANK)]: New macro.
	(ISGRAPH): Remove.  All uses changed to isgraph.
	(FOLD) [!defined _LIBC]: Remove special case.
	* lib/getdate.y (lookup_word): Remove no-longer-needed call to islower.
	* lib/regex_internal.h (isblank): Depend on HAVE_DECL_ISBLANK, not
	HAVE_ISBLANK.
	* lib/strftime.c (TOLOWER, TOUPPER) [!defined _LIBC]: Remove special
	case.

2006-07-06  Jim Hyslop  <jhyslop@dreampossible.ca>  (tiny change)

	* lib/getaddrinfo.c: Changes to compile under MSVC6: changed
	'#if WIN32_NATIVE' to '#ifdef' & moved WSAAPI macro inside
	brackets.  Other minor changes to suppress some compiler
	warnings.

2006-07-06  Derek R. Price  <derek@ximbiot.com>
	and Paul Eggert  <eggert@cs.ucla.edu>

	* m4/backupfile.m4 (gl_BACKUPFILE): Check for dirent.h, instead
	of invoking obsolescent AC_HEADER_DIRENT macro.
	* m4/d-ino.m4 (gl_CHECK_TYPE_STRUCT_DIRENT_D_INO): Likewise.
	* m4/d-type.m4 (gl_CHECK_TYPE_STRUCT_DIRENT_D_TYPE): Likewise.
	* m4/dirfd.m4 (gl_FUNC_DIRFD): Likewise.
	* m4/fts.m4 (gl_FUNC_FTS_CORE): Likewise.
	* m4/getcwd.m4 (gl_PREREQ_GETCWD): Likewise.
	* m4/glob.m4 (gl_PREREQ_GLOB): Likewise.
	* m4/savedir.m4 (gl_SAVEDIR): Likewise.
	* m4/readdir.m4: Remove; no longer needed.

2006-07-06  Derek R. Price  <derek@ximbiot.com>
	and Paul Eggert  <eggert@cs.ucla.edu>

	* lib/backupfile.c [HAVE_DIRENT_H && ! HAVE_NDIR_H]:
	Don't worry about this obsolete case any more.
	(HAVE_DIR): Remove.  All uses removed; we now assume you can read
	directories.
	* lib/dirfd.h [HAVE_DIRENT_H && ! HAVE_NDIR_H]: Don't
	worry about this obsolete case any more.
	* lib/fts.c: Likewise.
	* lib/getcwd.c: Likewise.
	* lib/glob.h: Likewise.
	* lib/savedir.c: Likewise.

2006-07-05  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/xstrtol.m4 (gl_PREREQ_XSTRTOL): Use AC_CHECK_DECLS_ONCE
	rather than AC_CHECK_DECLS for strtoimax and strtoumax.
	* m4/getusershell.m4 (gl_PREREQ_GETUSERSHELL): Remove; no longer
	needed.
	All uses removed.
	* m4/strtol.m4 (gl_PREREQ_STRTOL): Likewise.
	* m4/strtoul.m4 (gl_PREREQ_STRTOUL): Likewise.
	* m4/exclude.m4 (gl_EXCLUDE): Don't check for isascii; no longer
	needed.
	* m4/getdate.m4 (gl_GETDATE): Likewise.
	* m4/getusershell.m4 (gl_PREREQ_GETUSERSHELL): Likewise.
	* m4/memcasecmp.m4 (gl_MEMCASECMP): Likewise.
	* m4/strtod.m4 (gl_FUNC_STRTOD): Likewise.
	* m4/strtol.m4 (gl_PREREQ_STRTOL): Likewise.
	* m4/strtoul.m4 (gl_PREREQ_STRTOUL): Likewise.
	* m4/xstrtol.m4 (gl_PREREQ_XSTRTOL): Likewise.
	* m4/exclude.m4 (gl_EXCLUDE): Don't require AC_C_INLINE; no longer
	needed.

2006-07-05  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/memcasecmp.c: Include <limits.h>.
	(memcasecmp): Don't assume UCHAR_MAX <= INT_MAX.
	* lib/strtod.c (strtod): Don't assume isspace works on negative chars.
	Don't assume isdigit succeeds only on '0' through '9'.

2006-07-05  Eric Blake  <ebb9@byu.net>

	* modules/getaddrinfo (Depends-on): Add snprintf.

2006-07-05  Eric Blake  <ebb9@byu.net>

	* m4/sockpfaf.m4 (gl_SOCKET_FAMILIES): Use gl_HEADER_SYS_SOCKET
	to avoid 'header present but could not be compiled' on cygwin.

2006-07-05  Eric Blake  <ebb9@byu.net>

	* lib/getaddrinfo.h (NI_NUMERICHOST, NI_NUMERICSERV): Define if
	missing from netdb.h.
	* lib/getaddrinfo.c (includes): Include inet_ntop and snprintf.

2006-07-05  Derek R. Price  <derek@ximbiot.com>

	* m4/calloc.m4 (_AC_FUNC_CALLOC_IF): Don't require AC_HEADER_STDC;
	no longer needed.
	* m4/exclude.m4 (gl_EXCLUDE): Likewise.
	* m4/getdate.m4 (gl_GETDATE): Likewise.
	* m4/getusershell.m4 (gl_PREREQ_GETUSERSHELL): Likewise.
	* m4/memcasecmp.m4 (gl_MEMCASECMP): Likewise.
	* m4/strtod.m4 (gl_FUNC_STRTOD): Likewise.
	* m4/strtol.m4 (gl_PREREQ_STRTOL): Likewise.
	* m4/xstrtol.m4 (gl_PREREQ_XSTRTOL): Likewise.

2006-07-05  Derek R. Price  <derek@ximbiot.com>

	* lib/exclude.c (IN_CTYPE_DOMAIN, is_space): Remove; no longer needed.
	All uses of is_space replaced by isspace.
	* lib/exit.h: Don't talk about STDC_HEADERS.
	* lib/fnmatch.c (ISASCII): Remove; no longer needed.  All uses removed.
	(ISPRINT, ISDIGIT, ISALNUM, ISALPHA, ISCNTRL, ISLOWER, ISPUNCT):
	(ISSPACE, ISUPPER, ISXDIGIT): Remove; no longer needed.  All uses
	replaced by isprint etc.
	* lib/getdate.y (IN_CTYPE_DOMAIN, ISSPACE, ISALPHA, ISLOWER): Likewise.
	* lib/getusershell.c (IN_CTYPE_DOMAIN, ISSPACE): Likewise.
	* lib/memcasecmp.c (IN_CTYPE_DOMAIN, ISLOWER, TOUPPER): Likewise.
	* lib/strtod.c (IN_CTYPE_DOMAIN, ISSPACE, ISDIGIT, TOLOWER): Likewise.
	* lib/strtol.c (IN_CTYPE_DOMAIN): Likewise.
	* lib/xstrtol.c (IN_CTYPE_DOMAIN, ISSPACE): Likewise.

2006-07-05  Bruno Haible  <bruno@clisp.org>

	* m4/strndup.m4 (gl_FUNC_STRNDUP): When cross-compiling, check whether
	the function exists, before testing against AIX.
	Reported by Martin Lambers <marlam@marlam.de>.

2006-07-04  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/cycle-check (lib_SOURCES): Add same-inode.h.
	From Mark D. Baushke.

2006-07-04  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/absolute-header.m4 (gl_ABSOLUTE_HEADER): Prepend three slashes
	to the absolute name, not just one, to bypass Sun C 5.8's
	"warning: #include of /usr/include/... may be non-portable".

2006-07-04  Eric Blake  <ebb9@byu.net>

	* modules/dirname-tests: New test module.
	* tests/test-dirname.c: New file, replacing dirname.c
	TEST_DIRNAME section that was recently deleted.

2006-07-04  Bruno Haible  <bruno@clisp.org>

	Assume ANSI C header files and <ctype.h> functions.
	* lib/mbswidth.c (IN_CTYPE_DOMAIN, ISPRINT, ISCNTRL): Remove macros.
	(mbsnwidth): Use isprint, iscntrl instead.

2006-07-03  Paul Eggert  <eggert@cs.ucla.edu>

	Merge from coreutils.
	* MODULES.html.sh: Add xstrtold.
	* modules/xstrtold: New file.
	* modules/cycle-check (Files): Add lib/same-inode.h.
	* modules/dirname (Files): Add m4/double-slash-root.m4.
	* modules/getcwd (Files): Add m4/getcwd-abort-bug.m4.
	* modules/mkdir-p (Files): Add lib/same-inode.h.
	* modules/same (Files): Add lib/same-inode.h.

2006-07-03  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/absolute-header.m4: Renamed from full-header-path.m4.
	This is to keep the terminology clean; POSIX talks about
	"absolute pathnames", not "full pathnames", but the GNU
	Coding Standards say to use "path" for something else;
	so use "absolute" to keep both sides happy.
	(gl_ABSOLUTE_HEADER): Renamed from gl_FULL_HEADER_PATH.
	Set gl_absolute_header, not gl_full_header_path.
	Set gl_cv_absolute_<header>, not gl_full_path_<header>.
	Define ABSOLUTE_<HEADER>, not FULL_PATH_<HEADER>.
	All uses changed.

	Merge from coreutils.

	2006-06-30  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/c-strtod.m4 (gl_C_STRTOLD): Add c-strtod.c to LIBSOURCES.
	Require gl_USE_SYSTEM_EXTENSIONS, not gl_C_STRTOD, since we don't
	want to require the building of c-strtod.o.
	* m4/lib-check.m4 (cu_LIB_CHECK): Remove SEQ_LIBM, since seq no longer
	needs -lm directly.
	* m4/xstrtod.m4 (gl_XSTRTOLD): New macro.

	2006-06-19  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/lib-ignore.m4 (gl_IGNORE_UNUSED_LIBRARIES): Prefer binutils's
	--as-needed option if available.  Problem reported by Albert Chin in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-06/msg00114.html>.
	However, use -Wl,--as-needed, not bare --as-needed, since HP-UX 11.11
	cc merely issues a bunch of annoying warnings for --as-needed
	(this problem was reported by Bob Proulx).  Also, try linking with
	-lm to detect a bug in binutils 2.16 (this problem was reported
	by Ralf Wildenhues).

	2006-06-18  Jim Meyering  <jim@meyering.net>

	Test for a bug that causes glibc's getcwd to suffer a failed assertion.
	* m4/getcwd-abort-bug.m4 (gl_FUNC_GETCWD_ABORT_BUG): New file and
	macro.
	* m4/getcwd.m4 (gl_FUNC_GETCWD): If we detect support for getcwd_null,
	also check for glibc-2.4's abort-inducing bug.

	* m4/getcwd-path-max.m4 (gl_FUNC_GETCWD_PATH_MAX): Fix typo.
	Low-probability clean-up should be to use rmdir to get rid of
	the just-created directory, not unlink.

	* m4/ftruncate.m4 (gl_FUNC_FTRUNCATE): If ftruncate is missing, make
	configure fail, and request a bug report to inform us about it.
	Add a comment that, barring reports to the contrary, in 2007 we'll
	assume ftruncate is universally available.

	2006-04-17  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/filemode.m4 (gl_FILEMODE): Check for strmode declaration.

	2006-03-12  Jim Meyering  <jim@meyering.net>

	* m4/chdir-safer.m4 (gl_CHDIR_SAFER): Add same-inode.h to the list.
	* m4/cycle-check.m4 (gl_CYCLE_CHECK): Likewise.
	* m4/same.m4 (gl_SAME): Likewise.
	* m4/root-dev-ino.m4 (gl_ROOT_DEV_INO): Likewise.

	2006-03-11  Eric Blake  <ebb9@byu.net>

	* m4/double-slash-root.m4: New file, provides gl_DOUBLE_SLASH_ROOT.
	* m4/dirname.m4 (gl_DIRNAME): Use gl_DOUBLE_SLASH_ROOT.
	* m4/dos.m4 (FILE_SYSTEM_PREFIX_LEN): Move from here to dirname.h.
	(FILE_SYSTEM_DRIVE_PREFIX_CAN_BE_RELATIVE): New define.

2006-07-03  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stdint_.h: Include <sys/types.h> after @FULL_PATH_STDINT_H@, for
	MacOS X 10.4.6.  Don't mention <sys/int_types.h>.  Problems
	reported by Mark D. Baushke, one in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-07/msg00015.html>.

	Merge from coreutils.

	* lib/.cppi-disable: Add stdint_.h.
	* lib/.cvsignore: Add stdint.h.

	2006-06-30  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/xstrtod.c (XSTRTOD, DOUBLE): New macros, so that we can support
	both double and long double versions.
	(XSTRTOD): Renamed from xstrtod.  Use DOUBLE internally.
	* lib/xstrtold.c: New file.
	* lib/xstrtod.h (xstrtold): New decl.

	2006-05-22  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/filemode.c (setst): Remove.
	(strmode): Rewrite to avoid setst.  This makes the code shorter,
	(arguably) clearer, and the generated code is a bit smaller on my
	Debian GNU/Linux stable x86 host.

	2006-04-17  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/filemode.c: Include "filemode.h" first, to test the interface.
	Assume that filemode.h includes sys/types.h and sys/stat.h.
	(HAVE_ST_DM_MODE): New macro, moved here from ls.c.
	(ftypelet): Reorder to put common cases first, for efficiency.
	Add 'P', 'w'.  Remove 'M', since it's now the caller's responsibility
	to do 'M'.
	(strmode): Renamed from mode_string, and now stores 12 bytes instead
	of 10, for compatibility with FreeBSD.  All callers changed.
	(filemodestring): Now stores 12 bytes instead of 10, and sets file
	types that can't be deduced solely from st_mode.  First arg is now a
	const pointer.
	* lib/filemode.h (HAVE_DECL_STRMODE): Include <string.h> for strmode.
	(strmode): Renamed from mode_string.
	(filemodestring): New decl.
	* lib/stat-macros.h: Don't undef S_ISDOOR, since it's never buggy.
	(S_ISDOOR): Don't bother with S_IFDOOR, since that code is never
	needed.
	(S_ISPORT, S_ISWHT): New macros, if not already defined.

	2006-04-12  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/fsusage.c: Don't include <inttypes.h> or <stdint.h>, since
	fsusage.h now does that.  Include fsusage.h first, to test interface.
	Prefer statvfs if it works, since it's blessed by POSIX.  Attempt
	at most one method (the old code could have generated decls that
	didn't conform to C89, not that this was ever exercised).
	* lib/fsusage.h: Include <inttypes.h> and <stdint.h> if they exist.

	2006-03-19  Jim Meyering  <jim@meyering.net>

	Work even in a chroot where d_ino values for entries in "/"
	don't match the stat.st_ino values for the same names.
	* lib/getcwd.c (__getcwd): When no d_ino value matches the target inode
	number, iterate through all entries again, using lstat instead.
	Reported by Kenshi Muto in http://bugs.debian.org/355810, and by
	Zouhir Hafidi in https://bugzilla.redhat.com/bugzilla/190656.

	* lib/getcwd.c (__getcwd): Clarify a comment.
	Use memcpy in place of a call to strcpy.

	2006-03-12  Jim Meyering  <jim@meyering.net>

	* lib/fts-cycle.c (leave_dir): If cycle-check's saved dev-ino pair
	matches that of the current directory (which we're about to chdir ".."
	out of), then save the dev-ino of the parent, instead.

	* lib/same-inode.h (SAME_INODE): New file/macro.
	* lib/chdir-safer.c (SAME_INODE): Remove definition.
	Include "same-inode.h", instead.
	* lib/same.c: Likewise.
	* lib/cycle-check.h: Include "same-inode.h".
	(CYCLE_CHECK_REFLECT_CHDIR_UP): Define.
	* lib/cycle-check.c (SAME_INODE): Remove definition.
	* lib/root-dev-ino.h: Include "same-inode.h".

	2006-03-11  Eric Blake  <ebb9@byu.net>

	* lib/same.c (same_name): s/base_name/last_component/
	* lib/backupfile.c (check_extension, numbered_backup): Likewise.
	* lib/filenamecat.c (file_name_concat): Likewise.

	2006-03-11  Eric Blake  <ebb9@byu.net>,
		    Paul Eggert  <eggert@cs.ucla.edu>

	* lib/dirname.h (FILE_SYSTEM_PREFIX_LEN): Move here from dos.m4.
	[FILE_SYSTEM_ACCEPTS_DRIVE_LETTER_PREFIX]: Don't treat 1: as a
	drive prefix.
	(IS_ABSOLUTE_FILE_NAME): Treat all drive letters as absolute on
	platforms like cygwin with FILE_SYSTEM_DRIVE_PREFIX_IS_ABSOLUTE.
	(last_component): New method.
	* lib/dirname.c (dir_len): Determine when drive letters need a
	subsequent slash.  Preserve // when it is special.
	(dir_name): Don't append dot when drive letter is absolute.
	[TEST_DIRNAME]: Move into a full-blown gnulib test.
	* lib/basename.c (base_name): New semantics - malloc the result.
	Preserve // when it is special.  Preserve relative files that look
	like drive letters.
	(base_len): Preserve // when it is special.
	(last_component): New method, similar to old base_name semantics.
	* lib/stripslash.c (strip_trailing_slashes): Use last_component, not
	base_name.  Strip redundant slashes from ///.

2006-07-03  Jim Meyering  <jim@meyering.net>

	* lib/cycle-check.h (CYCLE_CHECK_REFLECT_CHDIR_UP): Abort if this
	macro is used before the first cycle_check call.

2006-07-03  Eric Blake  <ebb9@byu.net>

	* modules/dirname (Depends-on): Add xstrndup.

2006-07-02  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/stdint.m4 (gl_STDINT_H): Use more-mnemonic identifiers for
	test cases, so that config.log is a bit easier to follow.

2006-07-02  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stdint_.h (intmax_t, uintmax_t): Prefer long to long long if
	both are 64 bits, since this seems to be the tradition, and this
	prevents gcc -Wformat from warning about usages with PRIuMAX.  If
	we ever run into a host that prefers long long to long in this
	case, we'll need another configure-time test.  Problem reported by
	Jim Meyering.

2006-07-02  Eric Blake  <ebb9@byu.net>

	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Simplify by using AC_CHECK_DECLS.

2006-07-01  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/inttypes (Depends-on): No longer depends on stdint.
	* modules/stdint (Description): Say more about assumptions.
	Say that the fast types might differ.  Say macros are used.
	(Files): Remove m4/size_max.m4, m4/wchar_t.m4.  Add m4/longlong.m4.
	(Makefile.am): Revise list of substituted symbols to match
	new stdint.m4.
	* modules/stdint-tests (Files): Add m4/wchar_t.m4, m4/wint_t.m4.
	(configure.ac): Add gt_TYPE_WCHAR_T, gt_TYPE_WINT_T.
	* tests/test-stdint.c (verify_same_types)
	[! (__GNUC__ >= 2 && DO_PEDANTIC)]: Put in a decl, so that
	the code conforms to C99/C89.
	Test for WCHAR_MIN and WCHAR_MAX only if HAVE_WCHAR_T.
	Test for WINT_MIN and WINT_MAX only if HAVE_WINT_T.

2006-07-01  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/longlong.m4 (AC_TYPE_LONG_LONG_INT): Backport from Autoconf 2.60,
	but fix a bug, by requiring at least 64 bits.
	* m4/ulonglong.m4 (AC_TYPE_UNSIGNED_LONG_LONG_INT): Likewise.
	* m4/longlong.m4 (gl_AC_TYPE_LONG_LONG): Now just call
	AC_TYPE_LONG_LONG_INT.  This macro is obsolete and will go soon.
	* m4/ulonglong.m4 (gl_AC_TYPE_UNSIGNED_LONG_LONG) Likewise.

	* m4/stdint.m4 (gl_STDINT_H): Rewrite to accommodate stdint_.h
	changes.  Make 2.59 a prerequisite.  Check and substitute for
	HAVE_LONG_LONG_INT.  Rely on Autoconf to check for stdint.h and
	inttypes.h.  Do not use special include files; just use the
	defaults.  Check for sys/inttypes.h and sys/bitypes.h in the usual
	way now.  Remove no-longer-needed tests for HAVE_LONG_64BIT,
	HAVE_LONG_LONG_64BIT, int8_t, int16_t, int32_t, int64_t, uint8_t,
	uint16_t, uint32_t uint64_t, int_least8_t, int_least16_t,
	int_least32_t, int_least64_t, uint_least8_t, uint_least16_t,
	uint_least32_t, uint_least64_t, int_fast8_t, int_fast16_t,
	int_fast32_t, int_fast64_t, uint_fast8_t uint_fast16_t,
	uint_fast32_t, uint_fast64_t, intptr_t, uintptr_t, intmax_t,
	uintmax_t, INT8_MIN, INT8_MAX, UINT8_MAX, INT16_MIN, INT16_MAX,
	UINT16_MAX, INT32_MIN, INT32_MAX, UINT32_MAX, INT64_MIN,
	INT64_MAX, UINT64_MAX, INT_LEAST8_MIN, INT_LEAST8_MAX,
	UINT_LEAST8_MAX, INT_LEAST16_MIN, INT_LEAST16_MAX,
	UINT_LEAST16_MAX, INT_LEAST32_MIN, INT_LEAST32_MAX,
	UINT_LEAST32_MAX, INT_LEAST64_MIN, INT_LEAST64_MAX,
	UINT_LEAST64_MAX, INT_FAST8_MIN, INT_FAST8_MAX, UINT_FAST8_MAX,
	INT_FAST16_MIN, INT_FAST16_MAX, UINT_FAST16_MAX, INT_FAST32_MIN,
	INT_FAST32_MAX, UINT_FAST32_MAX, INT_FAST64_MIN, INT_FAST64_MAX,
	UINT_FAST64_MAX, INTPTR_MIN, INTPTR_MAX, UINTPTR_MAX, INTMAX_MIN,
	INTMAX_MAX, UINTMAX_MAX, PTRDIFF_MIN, PTRDIFF_MAX, SIG_ATOMIC_MIN,
	SIG_ATOMIC_MAX, SIZE_MAX, WCHAR_MIN, WCHAR_MAX, WINT_MIN,
	WINT_MAX.  Check for C99 conformance more strictly, by detecting
	bugs in glibc 2.4, Solaris 10, and OpenBSD 3.9.  On the other hand do
	not check for things that C99 does not require, e.g., int8_t.  If
	a test isn't needed unless <stdint.h> isn't working, and is
	unlikely to be needed for any other reason, then don't do it
	unless <stdint.h> isn't working.  Do not check for ptrdiff_t or
	size_t, since we assume C89 freestanding at least.  Do not check
	for sig_atomic_t, wchar_t, or wint_t, since the code now does
	the right thing even if the types are not defined.  Instead use:
	(gl_STDINT_TYPE_PROPERTIES): New macro.
	(gl_HEADER_STDINT_H, gl_HEADER_INTTYPES_H): Remove.  Don't bother
	testing whether <sys/types.h> clashes, as Autoconf does this for
	us now.  All uses removed.
	(gl_STDINT_CHECK_TYPES, gl_STDINT_MISSING_BOUND):
	(gl_STDINT_MISSING_BOUNDS, gl_STDINT_MISSING_BOUNDS2):
	(gl_CHECK_TYPE_SAME):
	Remove; no longer needed.
	(gl_STDINT_BITSIZEOF): Don't bother to check whether the type
	exists, since we'll return 0 anyway in that case.
	(gl_INTEGER_TYPE_SUFFIX, gl_STDINT_INCLUDES): New macros.

2006-07-01  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stdint_.h (_GL_STDINT_H): Renamed from _STDINT_H, to avoid
	possible collision with system files.
	(<stdio.h>, <time.h>, <wchar.h>) [defined __cplusplus && ! defined
	__STDC_CONSTANT_MACROS)]: Do not include, since we don't need
	WCHAR_MIN and WCHAR_MAX in this case.
	(<stddef.h>): Do not include; no longer needed.
	(<sys/types.h>): Include if @HAVE_SYS_TYPES_H@, not if
	(defined(__OpenBSD__) || defined(__bsdi__) || defined(__sgi)).
	(<sys/inttypes.h>): Include if @HAVE_SYS_INTTYPES_H@ &&
	!@HAVE_INTTYPES_H@, not if (defined(__FreeBSD__)
	&& (__FreeBSD__ >= 3) && (__FreeBSD__ <= 4)).
	(__STDINT_H__) [@HAVE_STDINT_H@ && defined __sgi && ! defined
	__c99]: Define, to work around IRIX <stdint.h> incompatibility.
	(@FULL_PATH_STDINT_H@) [!(defined(__sgi) && @HAVE_INTTYPES_H@ &&
	!defined(__c99))]: Include in this case too, since it's harmless
	now.
	(<inttypes.h>) [@HAVE_INTTYPES_H@]: Include, since it's no longer
	dangerous to do so.
	(@FULL_PATH_INTTYPES_H@) [(defined(__hpux) || defined(_AIX)) &&
	@HAVE_INTTYPES_H@]: Do not include, since we now include <inttypes.h>.
	(_STDINT_MIN, _STDINT_MAX): New macros.
	(int8_t, uint8_t, int16_t, uint16_t, int32_t, uint32_t, int64_t):
	(uint64_t, int_least8_t, uint_least8_t, int_least16_t):
	(uint_least16_t, int_least32_t, uint_least32_t, int_least64_t):
	(uint_least64_t, int_fast8_t, uint_fast8_t, int_fast16_t):
	(uint_fast16_t, int_fast32_t, uint_fast32_t, int_fast64_t):
	(uint_fast64_t, intptr_t, uintptr_t, intmax_t, uintmax_t): Now
	macros, not typedefs; this simplifies things quite a bit.
	Use long int for all types narrower than int64_t.
	(intmax_t, uintmax_t, INTMAX_C, UINTMAX_C):
	Define in terms of long long int or int64_t or long int,
	not int64_t or int32_t.  This saves some compile-time testing.
	(INT8_MIN, INT8_MAX, UINT8_MAX, INT16_MIN, INT16_MAX, UINT16_MAX):
	(INT32_MIN, INT32_MAX, UINT32_MAX, INT64_MIN, INT64_MAX):
	(UINT64_MAX, INT_LEAST8_MIN, INT_LEAST8_MAX, UINT_LEAST8_MAX):
	(INT_LEAST16_MIN, INT_LEAST16_MAX, UINT_LEAST16_MAX):
	(INT_LEAST32_MIN, INT_LEAST32_MAX, UINT_LEAST32_MAX):
	(INT_LEAST64_MIN, INT_LEAST64_MAX, UINT_LEAST64_MAX, INT_FAST8_MIN):
	(INT_FAST8_MAX, UINT_FAST8_MAX, INT_FAST16_MIN, INT_FAST16_MAX):
	(UINT_FAST16_MAX, INT_FAST32_MIN, INT_FAST32_MAX, UINT_FAST32_MAX):
	(INT_FAST64_MIN, INT_FAST64_MAX, UINT_FAST64_MAX, INTPTR_MIN):
	(INTPTR_MAX, UINTPTR_MAX, INTMAX_MIN, INTMAX_MAX, UINTMAX_MAX):
	(PTRDIFF_MIN, PTRDIFF_MAX, SIG_ATOMIC_MIN, SIG_ATOMIC_MAX):
	(SIZE_MAX, WCHAR_MIN, WCHAR_MAX, WINT_MIN, WINT_MAX):
	undef any previous version and define our own version, for
	simplicity and consistency with the new macros for types.
	(PTRDIFF_MIN, PTRDIFF_MAX, SIG_ATOMIC_MIN, SIG_ATOMIC_MAX):
	(SIZE_MAX, WCHAR_MIN, WCHAR_MAX, WINT_MIN, WINT_MAX):
	Simplify definitions by using _STDINT_MIN and _STDINT_MAX
	where appropriate.  Rely on new symbols @PTRDIFF_T_SUFFIX@,
	@SIG_ATOMIC_T_SUFFIX@, @SIZE_T_SUFFIX@, @WCHAR_T_SUFFIX@,
	@WINT_T_SUFFIX@ to keep things simple here.
	(UINT8_C, UINT16_C, UINT32_C, INT64_C, UINT64_C):
	Simplify by assuming typical 8/16/32/64 host, since we're
	already doing that elsewhere anyway.
	Use (LONG_MAX >> 31 >> 31 == 1) rather than @HAVE_LONG_64BIT@,
	and assume long long int is 64 bits if available.  This
	speeds up 'configure'.

2006-07-01  Eric Blake  <ebb9@byu.net>

	* m4/stdarg.m4 (gl_STDARG_H): Use proper AH_VERBATIM.
	Reported by Andreas Buening.

2006-07-01  Eric Blake  <ebb9@byu.net>

	* m4/stdarg.m4 (gl_STDARG_H): Properly parenthesize gl_va_copy.

2006-06-30  Jim Hyslop  <jhyslop@dreampossible.ca>  (tiny change)

	* lib/getaddrinfo.c: fixed typo

2006-06-29  Jim Meyering  <jim@meyering.net>

	* modules/strftime (Maintainer): Add my name, since with the
	FPRINTFTIME changes strftime.c has forked from glibc.

2006-06-29  Eric Blake  <ebb9@byu.net>

	* m4/sys_stat_h.m4 (gl_HEADER_SYS_STAT_H): Use AC_C_INLINE.

2006-06-29  Eric Blake  <ebb9@byu.net>

	* m4/sys_stat_h.m4 (gl_HEADER_SYS_STAT_H): New file.

2006-06-29  Eric Blake  <ebb9@byu.net>

	* lib/stat_.h: New file.

2006-06-29  Eric Blake  <ebb9@byu.net>

	* lib/stat_.h (rpl_mkdir): Declare inline, to avoid warnings about
	unused static function.

2006-06-29  Eric Blake  <ebb9@byu.net>

	* doc/functions.texi (Function Portability): Document missing lstat
	on mingw.

2006-06-29  Eric Blake  <ebb9@byu.net>

	* MODULES.html.sh: Add sys_stat.
	* modules/sys_stat: New module.
	* modules/mkstemp (Depends-on): Add sys_stat.

2006-06-29  Derek R. Price  <derek@ximbiot.com>

	* m4/strftime.m4: Don't call AC_FUNC_STRFTIME.

2006-06-29  Derek R. Price  <derek@ximbiot.com>

	* m4/c-bs-a.m4: Removed.

2006-06-29  Derek R. Price  <derek@ximbiot.com>

	* lib/strftime.c: Assume strftime() exists.

2006-06-29  Derek Price  <derek@ximbiot.com>

	* modules/c-bs-a: Removed - \a is C89.
	* MODULES.html.sh: Remove c-bs-a.

2006-06-29  Bruno Haible  <bruno@clisp.org>

	* modules/wcwidth (License): Change to LGPL.

2006-06-28  Simon Josefsson  <jas@extundo.com>

	* tests/test-getaddrinfo.c: Test getnameinfo too.  Call WSAStartup
	on _WIN32.

	* modules/getaddrinfo (Depends-on): Add inet_ntop, needed by
	getnameinfo.

2006-06-28  Simon Josefsson  <jas@extundo.com>

	* m4/getaddrinfo.m4: Look for getnameinfo prototypes too.

2006-06-28  Simon Josefsson  <jas@extundo.com>

	* lib/getaddrinfo.c: Try to load ws2_32.dll on Windows, to find the
	functions there.  It will succeed on Windows XP, but on Windows
	2000 and (presumably) earlier, it will fail, and use the internal
	re-implementation.
	(use_win32_p): New function.
	(getaddrinfo): Use strtoul on servname, to support numeric ports.
	Support AI_NUMERICSERV to disable getservbyname.
	(getnameinfo): New function, only supports
	NI_NUMERICHOST|NI_NUMERICSERV for now.

	* lib/getaddrinfo.h: Test and check for AI_* flags separately, MinGW
	only have some of them.  Add AI_NUMERICSERV.  Add prototype for
	getnameinfo.

2006-06-28  Eric Blake  <ebb9@byu.net>

	* modules/wcwidth: New file.
	* modules/mbchar (Depends-on): Add wcwidth.
	* modules/mbswidth (Depends-on): Add wcwidth.
	* MODULES.html.sh: Add wcwidth.

2006-06-28  Eric Blake  <ebb9@byu.net>

	* m4/mbswidth.m4 (gl_MBSDWIDTH): Move wcwidth from here...
	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): ...to this new file.

2006-06-28  Eric Blake  <ebb9@byu.net>

	* lib/xvasprintf.h: Fix comments.

2006-06-28  Eric Blake  <ebb9@byu.net>

	* lib/mbchar.h (wcwidth): Include wcwidth.h.
	* lib/mbswidth.c (wcwidth): Move from here...
	* lib/wcwidth.h: ...to this new file.

2006-06-28  Derek R. Price  <derek@ximbiot.com>

	* m4/savedir.m4: Remove AC_FUNC_CLOSEDIR_VOID requirement.

	* m4/fnmatch.m4 (_AC_LIBOBJ_FNMATCH): Don't require AC_C_CONST, since
	it's obsolete.
	* m4/strftime.m4 (gl_FUNC_GNU_STRFTIME): Likewise.

2006-06-28  Derek R. Price  <derek@ximbiot.com>

	* lib/savedir.c (CLOSEDIR): Remove.  All uses changed to closedir.
	Autoconf 2.60 says this stuff was obsolete.

2006-06-28  Bruno Haible  <bruno@clisp.org>

	* modules/wcwidth (Files): Add m4/wchar_t.m4.

2006-06-28  Bruno Haible  <bruno@clisp.org>

	* m4/wcwidth.m4 (gl_FUNC_WCWIDTH): Also require AC_C_INLINE and
	gt_TYPE_WCHAR_T.

2006-06-28  Bruno Haible  <bruno@clisp.org>

	* lib/wcwidth.h: Declare nothing if !HAVE_WCHAR_T. Provide a fallback
	declaration for wcwidth.
	* lib/mbswidth.c: Restore the includes of <wchar.h> and <wctypes.h>.

2006-06-28  Bruno Haible  <bruno@clisp.org>

	* lib/mkdtemp.c [MINGW]: Include <io.h>.
	(mkdir): Define using _mkdir.

2006-06-28  Bruno Haible  <bruno@clisp.org>

	* lib/getaddrinfo.h: Fix POSIX URL.
	* lib/getaddrinfo.c (WIN32_NATIVE): New macro. Use it instead of
	_WIN32.
	(use_win32_p): Make static.
	(getaddrinfo): Reject service name if it is empty or does not consist
	solely of decimal digits, or if its value is > 65535.
	(getnameinfo): Remove useless casts.

2006-06-27  Simon Josefsson  <jas@extundo.com>

	* modules/sys_select: New file, suggested by Bruno Haible, Paul
	Eggert and Martin Lambers.

2006-06-27  Simon Josefsson  <jas@extundo.com>

	* m4/sys_select_h.m4: New file, suggested by Bruno Haible, Paul
	Eggert and Martin Lambers.

2006-06-27  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_BITSIZEOF): For nonexistent types, set the
	result to 0, not to empty.
	Reported by Martin Neitzel <neitzel@sco.gaertner.de>.

2006-06-27  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h (intmax_t, uintmax_t): Undefine before typedef.

2006-06-26  Simon Josefsson  <jas@extundo.com>

	* m4/inet_ntop.m4: Don't check for sys/types.h, we assume it is
	present.

2006-06-26  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/base64.c (B64): Use _ as the formal parameter, not x, to avoid
	bug in IBM C V6 for AIX.  Problem reported by Larry Jones in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-06/msg00181.html>.

2006-06-26  Mark D. Baushke  <mdb@gnu.org>

	* m4/stdint.m4 (gl_STDINT_H): Treat BSD/OS like OpenBSD.

2006-06-26  Bruno Haible  <bruno@clisp.org>

	* modules/stdint (Makefile.am): Also substitute HAVE_WCHAR_H.

2006-06-26  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H): Test also for <wchar.h>.

2006-06-26  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H): Don't include <stdint.h> when using the
	SGI C compiler in pre-C99 mode.
	Suggested by Mark D. Baushke and Larry Jones.

2006-06-26  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h: Include <wchar.h> if necessary for WCHAR_MIN or
	WCHAR_MAX.
	Reported by Mark D. Baushke and Larry Jones.

2006-06-26  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h: Don't include <stdint.h> when using the SGI C compiler
	in pre-C99 mode.
	Suggested by Mark D. Baushke and Larry Jones.

2006-06-23  Simon Josefsson  <jas@extundo.com>
	    Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_emit_lib_Makefile_am): Define MOSTLYCLEANDIRS.
	Emit mostlyclean-local rule.
	(func_emit_tests_Makefile_am): Likewise.
	* modules/sys_socket (Makefile.am): Use MOSTLYCLEANDIRS.

2006-06-23  Mark D. Baushke  <mdb@gnu.org>

	* lib/stdint_.h: Treat BSD/OS like OpenBSD.

2006-06-23  Bruno Haible  <bruno@clisp.org>

	* tests/test-stdint.c: Update to match ISO C 99 Technical
	Corrigendum 1.

2006-06-23  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H): Treat IRIX like OpenBSD.

2006-06-23  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h: Treat IRIX like OpenBSD.

2006-06-23  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h (UINT8_C, UINT16_C, UINT32_C): Define according to
	ISO C 99 Technical Corrigendum 1.

2006-06-22  Simon Josefsson  <jas@extundo.com>

	* m4/sockpfaf.m4: Include winsock2.h too, to make it work under
	MinGW.

2006-06-22  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/glob.c (collated_compare): Remove 'const' uses that weren't
	needed.  Some compiler complained about some of them.  Problem reported
	by Larry Jones in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-06/msg00172.html>.

2006-06-21  Simon Josefsson  <jas@extundo.com>

	* tests/test-getaddrinfo.c: New file.

	* modules/getaddrinfo-tests: New file.

	* MODULES.html.sh: Add inet_pton.

	* modules/inet_pton: New file.

2006-06-21  Simon Josefsson  <jas@extundo.com>

	* m4/getaddrinfo.m4: Don't define WINVER.  Look for gethostbyname in
	-lws2_32 too.  Fixes getaddrinfo on Windows 2000, with the price
	of using the (limited) gnulib implementation on Windows XP.

	* m4/inet_pton.m4: New file.

2006-06-21  Simon Josefsson  <jas@extundo.com>

	* lib/getaddrinfo.c (getaddrinfo): Set ai_family in the return
	variable.

	* lib/socket_.h: Don't define WINVER.

	* lib/inet_pton.h, inet_pton.c: New file, taken from glibc but
	slightly modified to work in gnulib.

2006-06-21  Simon Josefsson  <jas@extundo.com>

	* doc/gnulib.texi (Windows sockets): Add.

2006-06-21  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/read-file.c (fread_file): Start with buffer allocation of
	0 bytes rather than 1 byte; this simplifies the code.
	Don't invoke feof; it's not needed.  Refactor to avoid duplicate
	code to free buffer and save/restore errno.
	(internal_read_file): Remove unused local.

2006-06-20  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/openat.c (openat): Use ?:, not if, to work around GCC bug 4210
	<http://gcc.gnu.org/bugzilla/show_bug.cgi?id=4210>.
	Problem reported by Denis Excoffier in
	<http://lists.gnu.org/archive/html/bug-tar/2006-06/msg00023.html>.

2006-06-19  Yoann Vandoorselaere  <yoann.v@prelude-ids.com>

	* modules/sys_socket, modules/socklen: Include sys/types since
	FreeBSD 4.x's sys/socket.h needs it.

2006-06-19  Simon Josefsson  <jas@extundo.com>

	* lib/inet_ntop.c: Always build inet_ntop4, since inet_ntop6 calls it.

2006-06-19  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/alloca_.h (alloca) [defined alloca]: Don't define or declare.

2006-06-19  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H): Enclose the values of FULL_PATH_STDINT_H
	and FULL_PATH_INTTYPES_H in angle brackets.
	Reported by Mark D. Baushke <mdb@gnu.org>.

2006-06-17  Eric Blake  <ebb9@byu.net>

	* m4/rmdir-errno.m4 (gl_FUNC_FMDIR_NOTEMPTY): Assume errno.h declares
	errno.

2006-06-17  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H) [FreeBSD >= 5]: Don't include
	<sys/inttypes.h>.

2006-06-17  Bruno Haible  <bruno@clisp.org>

	* m4/setenv.m4 (gl_PREREQ_SETENV, gl_PREREQ_UNSETENV): Remove test
	whether errno is declared. Assume <errno.h> declares errno.

2006-06-17  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h [FreeBSD >= 5]: Don't include <sys/inttypes.h>.

2006-06-17  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h (_UINT8_T, _UINT32_T, _UINT64_T): New macros. Fixes a
	problem on Solaris 2.5.1.

2006-06-16  Eric Blake  <ebb9@byu.net>

	* lib/unsetenv.c [!defined errno]: Assume errno.h declares errno.
	* lib/unicodeio.c [!defined errno]: Likewise.
	* lib/strtol.c [!defined errno]: Likewise.
	* lib/strtod.c [!defined errno]: Likewise.

2006-06-15  Eric Blake  <ebb9@byu.net>

	* m4/ssize_t.m4 (gt_TYPE_SSIZE_T): Work in spite of -Werror.

2006-06-15  Eric Blake  <ebb9@byu.net>

	* config/srclist.txt (ssize_t.m4): Lose sync.

2006-06-15  Bruno Haible  <bruno@clisp.org>

	* modules/stdint (Files): Include m4/full-header-path.m4,
	m4/size_max.m4, m4/wchar_t.m4.
	(Makefile.am): Many more substitutions.
	* modules/stdint-tests: New file.
	* tests/test-stdint.c: New file.

2006-06-15  Bruno Haible  <bruno@clisp.org>

	* m4/stdint.m4 (gl_STDINT_H): Rewritten to produce a complete stdint.h.
	(gl_HEADER_STDINT_H, gl_HEADER_INTTYPES_H, gl_STDINT_CHECK_TYPES,
	gl_STDINT_MISSING_BOUND, gl_STDINT_MISSING_BOUNDS,
	gl_STDINT_MISSING_BOUNDS2, gl_STDINT_BITSIZEOF, gl_CHECK_TYPES_SIGNED,
	gl_CHECK_TYPE_SAME): New macros.

2006-06-15  Bruno Haible  <bruno@clisp.org>

	* m4/size_max.m4 (gl_SIZE_MAX): Make it work also when cross-compiling.

2006-06-15  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h: Rewritten to be fully auto-configured.
	Fixes bug on HP-UX/IA64.

2006-06-11  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getdate.y (__attribute__): Don't define if already defined.
	Problem reported by Larry Jones.
	* lib/utimens.c (__attribute__): Likewise.

2006-06-04  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/regexec.c (group_nodes_into_DFAstates): Fix a buffer overrun
	reported by Andreas Schwab.

2006-05-30  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Bruno Haible  <bruno@clisp.org>

	* m4/strndup.m4 (gl_FUNC_STRNDUP): Replace the AC_REPLACE_FUNCS with a
	check for the declaration of strnlen and a run test that exposes the
	AIX 5.1 strnlen bug.  In the failure case, #define strndup to
	rpl_strndup.

2006-05-30  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Bruno Haible  <bruno@clisp.org>

	* lib/strndup.c (strndup) [!_LIBC]: Don't undefine macro definition.

2006-05-28  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/c-strtod.m4 (gl_C99_STRTOLD): Use a link test rather than a
	compile test, for Tru64 4.0D.

2006-05-28  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (printf-args.c): lose sync.

2006-05-26  Martin Lambers  <marlam@marlam.de>

	* lib/getpass.c: Updates the test for the native W32 API, and adds
	missing includes, thus fixing compilation warnings.

2006-05-25  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/exclude.c (exclude_fnmatch): New function.
	(excluded_file_name): Call exclude_fnmatch.
	* lib/exclude.h (excluded_file_name): New prototype

2006-05-25  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/tempname.c (small_open, large_open): New macros.
	(__open, __open64) [!_LIBC]: Remove.
	(__gen_tempname): Use small_open and large_open instead of __open
	and __open64.  This fixes a portability bug on HP-UX 11.11i
	reported by Simon Wing-Tang in
	<http://lists.gnu.org/archive/html/bug-coreutils/2006-05/msg00114.html>.

2006-05-24  Bruno Haible  <bruno@clisp.org>

	* lib/printf-args.c (printf_fetchargs): Turn NULL pointers for
	TYPE_STRING and TYPE_WIDE_STRING into a non-NULL replacement.
	Reported by Thorsten Maerz <torte@netztorte.de> via
	Aaron Stone <aaron@serendipity.cx>.

2006-05-19  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP): Rename cache variables to use
	gl_ rather than jm_.  Link, don't run, so that cross-compiles are
	allowed.  Check that resulting type is arithmetic.  Move AC_REQUIRE
	and AC_CHECK_HEADERS_ONCE outside of AC_CACHE_CHECK, since they're
	not really conditional on the cache.
	(gl_PREREQ_NANOSLEEP): Check for sys/select.h.

2006-05-19  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/nanosleep.c [HAVE_SYS_SELECT_H]: Include <sys/select.h>.
	Use the usual Autoconf way to include <time.h> and/or sys/time.h.
	(my_usleep): Don't mishandle maximum value.

2006-05-19  Jim Meyering  <jim@meyering.net>

	* lib/getugroups.c: Correct an outdated comment.  From Bruno Haible.

2006-05-17  Bruno Haible  <bruno@clisp.org>

	Cygwin portability.
	* lib/classpath.c (PATH_SEPARATOR) [CYGWIN]: Define as ':'.

2006-05-17  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h: Fix recognition of Cygwin.

2006-05-15  Bruno Haible  <bruno@clisp.org>

	* build-aux/config.rpath: Improve support for Sun C 5.9 on Linux, based
	on libtool patch by Ralf Wildenhues.

2006-05-14  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/stdbool.m4 (AC_HEADER_STDBOOL): Fix overly-picky
	test for C99 conformance; (bool) 0.5 is an integer constant
	expression, but (bool) -0.5 is not.  Problem reported by Fedor
	Sergeev in <http://forum.sun.com/jive/thread.jspa?threadID=96202>.

2006-05-11  Simon Josefsson  <jas@extundo.com>

	* m4/xvasprintf.m4: Fix obvious typo.

2006-05-11  Jim Meyering  <jim@meyering.net>

	* lib/sha1.c (sha1_buffer): Correct comment: s/MD5/SHA1/.  From
	James Lemley.

2006-05-10  Simon Josefsson  <jas@extundo.com>

	* lib/md4.c: Typo fix, update copyright years.
	(K1, K2): Don't use L because it turn computations into 64-bit on
	64-bit platforms.

2006-05-10  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/crc.c (crc32_update): Remove unnecessary L suffix.
	* lib/md4.c (rol): Cast right-shift arg to uint32_t to prevent
	unwanted sign propagation, e.g., on hosts with 64-bit int.
	There still are some problems with reeelly weird theoretical hosts
	(e.g., 33-bit int) but it's not worth worrying about now.
	* lib/sha1.c (rol): Likewise.
	(K1, K2, K3, K4): Remove unnecessary L suffix.

2006-05-10  Bruno Haible  <bruno@clisp.org>

	* lib/des.c: Cast to avoid warnings.

2006-05-09  Bruno Haible  <bruno@clisp.org>

	* modules/xvasprintf (Files): Add m4/xvasprintf.m4.
	(Depends-on): Depend also on xsize, stdarg.
	(configure.ac): Add gl_XVASPRINTF.

2006-05-09  Bruno Haible  <bruno@clisp.org>

	* m4/xvasprintf.m4: New file.

2006-05-09  Bruno Haible  <bruno@clisp.org>

	* lib/xvasprintf.c: Include limits.h, string.h, xsize.h.
	(EOVERFLOW): Define fallback value.
	(xstrcat): New function.
	(xvasprintf): Recognize the special case of a string concatenation.

2006-05-08  Eric Blake  <ebb9@byu.net>

	* gnulib-tool (func_version): Base copyright year on CVS date.
	(func_emit_copyright_notice): New function.
	(func_emit_lib_Makefile_am): Use it.
	(func_emit_tests_Makefile_am): Likewise.
	(func_import): Likewise.

2006-05-08  Bruno Haible  <bruno@clisp.org>

	* modules/stdarg: New file.
	* MODULES.html.sh (func_all_modules): Add section for <stdarg.h>.

2006-05-08  Bruno Haible  <bruno@clisp.org>

	* m4/stdarg.m4: New file, from GNU gettext.

2006-05-08  Bruno Haible  <bruno@clisp.org>

	* config/srclist.txt (build-aux/config.rpath): different from latest
	release.

2006-05-08  Bruno Haible  <bruno@clisp.org>

	* build-aux/config.rpath: Add support for Sun C 5.9 on Linux.

2006-05-05  Jim Meyering  <jim@meyering.net>

	* m4/warning.m4: New file, derived from bison's file by the same name.

2006-05-03  Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h: Shorter URL.
	* lib/inttypes.h: Likewise.

2006-05-02  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/inttypes (Maintainer): Change from Derek Price to 'all'.

2006-05-02  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/verify.h: Document the internals better.  Most of this change
	was written by Bruno Haible.

2006-05-02  Paul Eggert  <eggert@cs.ucla.edu>

	* doc/verify.texi: New file, partly based on a proposal by
	Bruno Haible.

2006-05-02  Bruno Haible  <bruno@clisp.org>

	* m4/full-header-path.m4 (gl_FULL_HEADER_PATH): Move the include_next
	test from here...
	* m4/_inttypes_h.m4 (gl_INTTYPES_H): ... to here.

2006-04-29  Bruno Haible  <bruno@clisp.org>

	* lib/gcd.c: Use WORD_T and GCD instead of unsigned long and gcd.
	Suggested by Oskar Liljeblad <oskar@osk.mine.nu>.

2006-04-29  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool: Make --update option actually work.

2006-04-29  Bruno Haible  <bruno@clisp.org>

	* doc/gcd.texi: New file.
	* doc/gnulib.texi: Include it.

2006-04-25  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getdate.y (get_date): When adding relative date, start with the
	initial time, not with the result of the first mktime call.

2006-04-25  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Output the include directives in three
	blocks, sorted separately.
	Reported by Ben Pfaff <blp@cs.stanford.edu>.

2006-04-24  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/unlink-busy.m4 (gl_FUNC_UNLINK_BUSY_TEXT): Use prototype
	to define main with arguments, for C++.  Reported by Eric Blake.
	* m4/c-stack.m4 (AC_SYS_XSI_STACK_OVERFLOW_HEURISTIC):
	Prefer 'int main ()' to 'int main (void)', for C++.
	* m4/getcwd-path-max.m4 (gl_FUNC_GETCWD_PATH_MAX): Likewise.
	* m4/fsusage.m4 (gl_FILE_SYSTEM_USAGE): Specify a return type
	for 'main', for C99 and C++.

2006-04-24  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/fsusage.m4 (gl_FILE_SYSTEM_USAGE): Use return, not exit.
	Don't assume that exit status -1 is valid.
	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP): Likewise.
	* m4/putenv.m4 (gl_FUNC_PUTENV): Likewise.
	* m4/rmdir-errno.m4 (gl_FUNC_RMDIR_NOTEMPTY): Likewise.
	* m4/readdir.m4 (GL_FUNC_READDIR): Include <stdlib.h>.
	* m4/rename.m4 (vb_FUNC_RENAME): Likewise.
	* m4/unlink-busy.m4 (gl_FUNC_UNLINK_BUSY_TEXT): Use AC_RUN_IFELSE,
	not AC_TRY_RUN.  Use return, not exit.  Don't assume that
	functions can be used without declaring them, or that you can
	exit with status -1.
	* m4/utimes-null.m4 (gl_FUNC_UTIMES_NULL): Likewise.

2006-04-24  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (longdouble.m4): sync lost.

2006-04-24  Eric Blake  <ebb9@byu.net>

	* m4/strerror_r.m4 (AC_FUNC_STRERROR_R): Avoid unused variable warning.

2006-04-24  Bruno Haible  <bruno@clisp.org>

	* m4/poll.m4 (gl_FUNC_POLL): When cross-compiling, reject also the
	poll() implementation in AIX.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2006-04-24  Bruno Haible  <bruno@clisp.org>

	* m4/poll.m4 (gl_FUNC_POLL): Rearrange code, so that POLL_H gets
	assigned exactly once.

2006-04-23  Claudio Fontana  <claudio@gnu.org>
	    Bruno Haible  <bruno@clisp.org>

	* modules/gettext (Makefile.am): Add a -I flag for <libintl.h>.
	* gnulib-tool (func_emit_lib_Makefile_am): Emit empty default value
	for AM_CPPFLAGS.

2006-04-23  Bruno Haible  <bruno@clisp.org>

	* modules/copy-file: Depend on unistd.
	* modules/execute: Likewise.
	* modules/fatal-signal: Likewise.
	* modules/findprog: Likewise.
	* modules/mkdtemp : Likewise.
	* modules/pipe: Likewise.
	* modules/wait-process: Likewise.

2006-04-23  Bruno Haible  <bruno@clisp.org>

	* lib/fwriteerror.c (fwriteerror): Call fclose also when an error
	condition was already detected.
	Reported by Ben Pfaff <blp@cs.stanford.edu>.

2006-04-23  Bruno Haible  <bruno@clisp.org>

	* lib/copy-file.c: Include <unistd.h> unconditionally.
	* lib/execute.c: Likewise.
	* lib/fatal-signal.c: Likewise.
	* lib/findprog.c: Likewise.
	* lib/mkdtemp.c: Likewise.
	* lib/pipe.h: Likewise.
	* lib/pipe.c: Likewise.
	* lib/wait-process.h: Likewise.

2006-04-23  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_usage): Fix --import description. Document
	--update.
	(func_import): Create temporary file in a temporary directory, if
	--dry-run is specified. Silence errors from 'grep' when there are no
	m4 files in $m4dir.
	(func_create_testdir): Silence errors from 'grep' when there are no
	m4 files in $m4dir.
	Reported by Karl Berry <karl@freefriends.org>.

2006-04-20  Bruno Haible  <bruno@clisp.org>

	* m4/argp.m4 (gl_ARGP): Don't call AC_CHECK_DECLS_ONCE with more than
	one argument, so that the code will be portable to Autoconf 2.60.
	* m4/getlogin_r.m4 (gl_PREREQ_GETLOGIN_R): Likewise.
	* m4/getpass.m4 (gl_PREREQ_GETPASS): Likewise.
	* m4/unlocked-io.m4 (gl_FUNC_GLIBC_UNLOCKED_IO): Likewise.

2006-04-19  Derek Price  <derek@ximbiot.com>
	    Eric Blake  <ebb9@byu.net>

	* m4/full-header-path.m4 (gl_FULL_HEADER_PATH): Use </full/path.h>
	rather than "/full/path.h".  Update comment to match.  Shorten &
	generalize m4_translit call via AS_TR_CPP.

2006-04-19  Derek Price  <derek@ximbiot.com>
	    Eric Blake  <ebb9@byu.net>

	* lib/inttypes.h: Correct grammar in comment.

2006-04-18  Derek Price  <derek@ximbiot.com>
	    Paul Eggert  <eggert@cs.ucla.edu>

	* modules/inttypes: New file.
	* modules/strtoimax, modules/strtoumax: Depend on inttypes.

2006-04-18  Derek Price  <derek@ximbiot.com>
	    Paul Eggert  <eggert@cs.ucla.edu>

	* m4/_inttypes_h.m4, m4/full-header-path.m4, m4/include_next.m4:
	New files.

2006-04-18  Derek Price  <derek@ximbiot.com>
	    Paul Eggert  <eggert@cs.ucla.edu>

	* lib/inttypes.h: New file.
	* lib/strtoimax.c: Assume <inttypes.h>.

2006-04-15  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/utimens.c (futimens): glibc futimesat messes up if /proc
	isn't mounted.  Problem reported by Kir Kolyshkin.

2006-04-13  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/regcomp.c (init_dfa): Don't use wchar_t or wctype_t if
	RE_ENABLE_I18N is not defined.  Problem reported by Mark D. Baushke via
	Derek R. Price.
	* lib/regex.h (RE_DUP_MAX): Update comment to match current
	implementation.

2006-04-12  Eric Blake  <ebb9@byu.net>

	* modules/time_r (Makefile.am): Remove lib_SOURCES line, as this
	is now done automatically by the corresponding Autoconf macro.

2006-04-11  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/time_r.m4 (gl_TIME_R): Add AC_LIBSOURCES for time_r.c and
	time_r.h.

2006-04-09  Paul Eggert  <eggert@cs.ucla.edu>

	Merge regex changes from libc, removing some of our
	POSIX-conformance changes that were rejected and redoing them in a
	less-intrusive way.

	* lib/regcomp.c (re_compile_internal, init_dfa):
	Length arg is now size_t, not Idx.  All uses changed.
	(peek_token): Forward decl now says internal_function.
	(__re_error_msgid, __re_error_msgid_idx):
	Now static rather than extern with attribute_hidden.
	(re_compile_pattern) [!defined _LIBC]: Use K&R-style defn.
	For some reason libc prefers K&R style defns for external functions.
	(regerror) [!defined _LIBC]: Likewise.
	(re_set_syntax, re_compile_fastmap, regcomp, regfree, re_comp):
	(seek_collating_symbol_entry, lookup_collation_sequence_value):
	(build_range_exp, build_collating_symbol):
	Use K&R-style defn.
	(re_compile_fastmap): Use '\0' to memset, not 0.
	(utf8_sb_map): Make the calculations more obvious.
	(init_dfa, parse_bracket_exp, build_charclass_op):
	Call calloc and cast result, as glibc does.
	(init_word_char, fetch_token, peek_token, peek_token_bracket):
	(build_range_exp, build_collating_symbol):
	Now internal functions.

	* lib/regex.c [!defined _LIBC]: Allow compiling with C++ compilers.

	* lib/regex.h (__USE_GNU_REGEX): New macro.  Don't depend on
	_REGEX_SOURCE any more; depend on _GNU_SOURCE instead.
	Don't depend on VMS; depend on __VMS instead, for POSIX
	namespace cleanness.
	(regoff_t): Define to ssize_t, not long int.

	Remove the REG_ macros named below.  Instead, make the old names
	(e.g., RE_BACKSLASH_ESCAPE_IN_LISTS) visible only if
	__USE_GNU_REGEX.
	(REG_BACKSLASH_ESCAPE_IN_LISTS):
	(REG_BK_PLUS_QM, REG_CHAR_CLASSES, REG_CONTEXT_INDEP_ANCHORS):
	(REG_CONTEXT_INDEP_OPS, REG_CONTEXT_INVALID_OPS):
	(REG_DOT_NEWLINE, REG_DOT_NOT_NULL, REG_HAT_LISTS_NOT_NEWLINE):
	(REG_INTERVALS, REG_LIMITED_OPS, REG_NEWLINE_ALT):
	(REG_NO_BK_BRACES, REG_NO_BK_PARENS, REG_NO_BK_REFS):
	(REG_NO_BK_VBAR, REG_NO_EMPTY_RANGES):
	(REG_UNMATCHED_RIGHT_PAREN_ORD, REG_NO_POSIX_BACKTRACKING):
	(REG_NO_GNU_OPS, REG_DEBUG, REG_INVALID_INTERVAL_ORD):
	(REG_IGNORE_CASE, REG_CARET_ANCHORS_HERE):
	(REG_CONTEXT_INVALID_DUP, REG_NO_SUB, REG_SYNTAX_EMACS):
	(REG_SYNTAX_AWK, REG_SYNTAX_GNU_AWK, REG_SYNTAX_POSIX_AWK):
	(REG_SYNTAX_GREP, REG_SYNTAX_EGREP, REG_SYNTAX_POSIX_EGREP):
	(REG_SYNTAX_ED, REG_SYNTAX_SED, _REG_SYNTAX_POSIX_COMMON):
	(REG_SYNTAX_POSIX_BASIC, REG_SYNTAX_POSIX_MINIMAL_BASIC):
	(REG_SYNTAX_POSIX_EXTENDED, REG_SYNTAX_POSIX_MINIMAL_EXTENDED):
	(REG_DUP_MAX, REG_UNALLOCATED, REG_REALLOCATE, REG_FIXED):
	(REG_NREGS):
	Remove.  All uses replaced by the old RE_* names.
	(RE_BACKSLASH_ESCAPE_IN_LISTS):
	(RE_BK_PLUS_QM, RE_CHAR_CLASSES, RE_CONTEXT_INDEP_ANCHORS):
	(RE_CONTEXT_INDEP_OPS, RE_CONTEXT_INVALID_OPS):
	(RE_DOT_NEWLINE, RE_DOT_NOT_NULL, RE_HAT_LISTS_NOT_NEWLINE):
	(RE_INTERVALS, RE_LIMITED_OPS, RE_NEWLINE_ALT):
	(RE_NO_BK_BRACES, RE_NO_BK_PARENS, RE_NO_BK_REFS):
	(RE_NO_BK_VBAR, RE_NO_EMPTY_RANGES):
	(RE_UNMATCHED_RIGHT_PAREN_ORD, RE_NO_POSIX_BACKTRACKING):
	(RE_NO_GNU_OPS, RE_DEBUG, RE_INVALID_INTERVAL_ORD):
	(RE_IGNORE_CASE, RE_CARET_ANCHORS_HERE):
	(RE_CONTEXT_INVALID_DUP, RE_NO_SUB):
	Don't bother having these macros be independent of each others'
	values, since they no longer exist in the POSIX name space.

	Rename the following member names back to their old names,
	unless !__USE_GNU_REGEX.  All uses changed back.
	(buffer): Renamed from re_buffer.
	(allocated): Renamed from re_allocated.
	(used): Renamed from re_used.
	(syntax): Renamed from re_syntax.
	(fastmap): Renamed from re_fastmap.
	(translate): Renamed from re_translate.
	(can_be_null): Renamed from re_can_be_null.
	(regs_allocated): Renamed from re_regs_allocated.
	(fastmap_accurate): Renamed from re_fastmap_accurate.
	(no_sub): Renamed from re_no_sub.
	(not_bol): Renamed from re_not_bol.
	(not_eol): Renamed from re_not_eol.
	(newline_anchor): Renamed from re_newline_anchor.
	(num_regs): Renamed from rm_num_regs.
	(start): Renamed from rm_start.
	(end): Renamed from rm_end.

	(free_state): Move up a bit.

	* lib/regex_internal.h (inline) [__GNUC__ < 3 && defined _LIBC]:
	#define to be empty.
	(ASCII_CHARS): New macro, replacing all uses of 0x80 and/or SBC_MAX / 2
	when that is what is intended.
	(SBC_MAX): Define to UCHAR_MAX + 1, not 256.
	(__re_error_msgid, __re_error_msgid_idx): Remove decls; not needed.
	(MAX): New macro.
	(re_xmalloc, re_calloc, re_xrealloc, re_x2realloc): Remove.
	All uses changed back to re_malloc, etc.  It's now the caller's
	responsibility to check for overflow; all callers changed.
	(re_alloc_oversized, re_x2alloc_oversized, re_xnmalloc, re_xnrealloc):
	(re_x2nrealloc): Remove.
	(free_state): Remove decl.

	* lib/regexc.c (regexec, re_match, re_search, re_match_2, re_search_2):
	(re_set_registers, re_exec):
	Use K&R-style defn.

	2006-01-31  Roland McGrath  <roland@redhat.com>

	* lib/regcomp.c (calc_eclosure_iter): Remove dead variables.
	Reported by Mike Frysinger <vapier@gentoo.org>.

	2006-01-15  Andreas Jaeger  <aj@suse.de>

	[BZ #1950]
	* lib/regex_internal.c (re_string_reconstruct): Adjust for
	build_wcs_upper_buffer change.
	(build_wcs_upper_buffer): Change return type.

	2005-12-10  Ulrich Drepper  <drepper@redhat.com>

	* lib/regex_internal.h: Include <stdint.h> if available.

	2005-12-06  Paolo Bonzini  <bonzini@gnu.org>

	* lib/regex_internal.h (SIZE_MAX): Provide a default definition.

	2005-10-14  Ulrich Drepper  <drepper@redhat.com>

	* lib/regcomp.c: Adjust for changed secondary hash function.

	2005-09-30  Ulrich Drepper  <drepper@redhat.com>

	* lib/regex.h: Pretty printing.
	Clean up namespace a bit.

	2005-09-30  Jakub Jelinek  <jakub@redhat.com>

	* lib/regexec.c (update_cur_sifted_state, check_arrival,
	check_arrival_add_next_nodes): Avoid using uninitialized variable.

	2005-09-06  Paul Eggert  <eggert@cs.ucla.edu>
		    Ulrich Drepper  <drepper@redhat.com>

	[BZ #1302]
	* lib/regex_internal.h (bitset_t): Renamed from bitset.  All uses
	changed.
	(bitset_word_t): Renamed from bitset_word.  All uses changed.

	2005-09-22  Ulrich Drepper  <drepper@redhat.com>

	[BZ #281]
	* lib/regex.h: Define RE_TRANSLATE_TYPE as unsigned char *.
	* lib/regcomp.c: Remove unnecessary uses of
	unsigned RE_TRANSLATE_TYPE.
	* lib/regex_internal.h: Likewise.
	* lib/regex_internal.c: Likewise.
	* lib/regexec.c: Likewise.
	Based on a patch by Stepan Kasal <kasal@ucw.cz>.

	2005-09-07  Ulrich Drepper  <drepper@redhat.com>

	* lib/regexec.c (find_recover_state): Remove unnecessary
	initialization.
	(transit_state_bkref): Make DFA a const pointer.
	(get_subexp): Likewise.
	(check_arrival): Likewise.
	(update_cur_sifted_state): Likewise.
	(re_search_internal): Likewise.
	(prune_impossible_nodes): Likewise.
	(acquire_init_state_context): Likewise.
	(proceed_next_node): Likewise.
	(set_regs): Likewise.
	(free_fail_stack_return): Likewise.
	(check_arrival_expand_ecl): Mark DFA parameter as const.
	(check_arrival_expand_ecl_sub): Likewise.
	(check_subexp_limits): Likewise.
	(sub_epsilon_src_nodes):  Likewise.
	(add_epsilon_src_nodes):  Likewise.
	(merge_state_array): Likewise.
	(update_regs): Likewise.
	(build_trtable): Likewise.
	(sift_states_backward): Mark MCTX parameter as const.
	(build_sifted_states): Likewise.
	(update_cur_sifted_state): Likewise.
	(sift_states_mkref): Likewise.
	(check_arrival_expand_ecl): Mark eclosure as const.
	(check_dst_limits_calc_pos_1): Likewise.
	* lib/regex_internal.h (re_match_context_t): Make dfa a const
	pointer.

	2005-09-06  Ulrich Drepper  <drepper@redhat.com>

	* lib/regexec.c (merge_state_with_log): Define dfa as const pointer.
	(transit_state_sb): Likewise.
	(transit_state_mb): Likewise.
	(sift_states_iter_mb): Likewise.
	(check_arrival_add_next_nodes): Likewise.
	(check_node_accept_bytes): Change first parameter to pointer-to-const.
	[_LIBC] (re_search_2_stub): Use mempcpy.

	* lib/regex_internal.c (re_string_reconstruct): Avoid calling
	mbrtowc for very simple UTF-8 case.

	* lib/regex_internal.c (re_acquire_state): Make DFA pointer arg
	a pointer-to-const.
	(re_acquire_state_context): Likewise.
	* lib/regex_internal.h: Adjust prototypes.

	* lib/regex.c: Prevent using C++ compilers.

	* lib/regex_internal.c (re_acquire_state): Minor code rearrangement.
	(re_acquire_state_context): Likewise.

2006-04-09  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/regex (Depends-on): Add ssize_t.

2006-04-09  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/regex.m4 (gl_REGEX): Check for new glibc interface to
	translation table.

2006-04-09  Paul Eggert  <eggert@cs.ucla.edu>

	* doc/gnulib-tool.texi (Modified imports): pathname -> file name.

2006-03-29  Mark D. Baushke  <mdb@gnu.org>
	    Bruno Haible  <bruno@clisp.org>

	* lib/stdint_.h: On OpenBSD, don't redefine types already included in
	<sys/types.h> and <inttypes.h>.

2006-03-25  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/argz.m4 (gl_FUNC_ARGZ): If we define `error_t', also define
	`__error_t_defined', so argp.h will not typedef the former.

2006-03-25  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/regex.m4 (gl_REGEX): Don't insist on REG_SYNTAX_POSIX_EGREP,
	REG_SYNTAX_EMACS, and REG_IGNORE_CASE.  Settle for the traditional
	glibc names.  Even if glibc is changed to conform to POSIX, the
	traditional names will be available anyway, since regex depends on
	the extensions module.  Also, fix a longstanding typo in the
	implementation of Spencer ERE test #75 from grep 2.3.  Problems
	reported by Emanuele Giaquinta.  Also, change sense of cached
	variable, so that the message makes sense.

2006-03-24  Simon Josefsson  <jas@extundo.com>

	* lib/base64.c: Fix problems reported by Eric Blake <ebb9@byu.net>,
	including some doc fixes.
	(base64_encode_alloc): Fix +1 bug on allocation failures.

2006-03-24  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/base64.c (base64_encode): Do not read past end of array with
	unsanitized input on systems with CHAR_BIT > 8.

2006-03-24  Eric Blake  <ebb9@byu.net>

	* lib/time_r.c (copy_string_result): Remove, as it is no longer used.

2006-03-22  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (*setenv.[ch]): get from coreutils.
	* config/srclistvars.sh (COREUTILS): new var.

2006-03-17  Jim Meyering  <jim@meyering.net>

	* m4/regex.m4 (gl_REGEX): Fix typo in last change:
	s/_REGEX_WIDE_OFFSETS/_REGEX_LARGE_OFFSETS/.

2006-03-16  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/regex.m4 (gl_REGEX): Don't check for off_t, since the code
	no longer needs it.  Instead, check that regoff_t is as least
	as wide as ptrdiff_t.

	Don't define _REGEX_WIDE_OFFSETS unless using the included regex,
	so that our regex.h stays compatible with the installed regex.
	This is helpful for installers who configure --without-included-regex.
	Problem reported by Emanuele Giaquinta.

2006-03-16  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/regex.h (regoff_t) [defined _REGEX_LARGE_OFFSETS]:
	Typedef to long int, not to off_, as POSIX will likely change
	in that direction.

2006-03-15  Eric Blake  <ebb9@byu.net>

	* m4/dirfd.m4 (gl_FUNC_DIRFD): Use AC_REQUIRE for AC_HEADER_DIRENT.

2006-03-13  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-help.c (validate_uparams): Fix typo
	* lib/argp-parse.c (argp_default_options): Consistently begin help
	messages with a lowercase letter.

2006-03-11  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/time_r.h (asctime_r, ctime_r): Remove.  These functions can
	overrun buffers and shouldn't be used (much as gets shouldn't be
	used).
	* lib/time_r.c (asctime_r, ctime_r): Likewise.

2006-03-08  Simon Josefsson  <jas@extundo.com>

	* m4/gc-random.m4: Permit 'no' as variable values and fix warnings,
	suggested by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2006-03-08  Simon Josefsson  <jas@extundo.com>

	* m4/gc-random.m4: Call AC_CANONICAL_HOST and use $host_os instead of
	$target, suggested by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2006-03-08  Simon Josefsson  <jas@extundo.com>

	* lib/gc-gnulib.c (randomize): Don't open files called 'no', they
	signal that configure disabled the device.

2006-03-08  Simon Josefsson  <jas@extundo.com>

	* build-aux/maint.mk: Fix refresh-po, to handle no translated
	languages.

2006-03-07  Simon Josefsson  <jas@extundo.com>

	* modules/getopt (Depends-on): Add unistd.

	* modules/unistd: New file.

2006-03-07  Simon Josefsson  <jas@extundo.com>

	* modules/gc-random: New file.

2006-03-07  Simon Josefsson  <jas@extundo.com>

	* m4/unistd_h.m4: New file.

2006-03-07  Simon Josefsson  <jas@extundo.com>

	* m4/readline.m4 (gl_FUNC_READLINE): Rewrite the cached part of the
	test to be side-effect free by storing the result in the cache
	variable gl_cv_lib_readline, and moving the assignment of
	LIBREADLINE and LTLIBREADLINE outside the COMMANDS-TO-SET-IT.
	From Ralf Wildenhues <Ralf.Wildenhues@gmx.de>.

2006-03-07  Simon Josefsson  <jas@extundo.com>

	* m4/gc-random.m4: New file, mostly from gc.m4.  Warn instead of
	error on missing devices (the functions will return an error).

	* m4/gc.m4: Move random stuff to gc-random.m4

2006-03-07  Simon Josefsson  <jas@extundo.com>

	* lib/unistd_.h: New file.

2006-03-07  Simon Josefsson  <jas@extundo.com>

	* lib/gc-libgcrypt.c, gc-gnulib.c: Use GC_USE_RANDOM.

2006-03-07  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/unistd_h.m4 (gl_HEADER_UNISTD): Rename, to match modules file.
	Problem reported by Juan Manuel Guerrero.

2006-03-07  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/c-stack.c: Include unistd.h unconditionally, since we now assume
	the unistd module.
	* lib/getlogin_r.c: Likewise.
	* lib/getlogin_r.h: Likewise.
	* lib/glob.c: Likewise.
	* lib/pagealign_alloc.c: Likewise.
	* lib/unistd_.h: Remove; no longer needed.

2006-03-07  Paul Eggert  <eggert@cs.ucla.edu>

	* MODULES.html.sh (Support for systems lacking POSIX:2001):
	Add unistd.
	* modules/c-stack (Depends-on): Add unistd.
	* modules/getlogin_r: Likewise.
	* modules/glob: Likewise.
	* modules/pagealign_alloc: Likewise.
	* modules/unistd (Files): Remove lib/unistd_.h.
	(EXTRA_DIST): Remove.
	(unistd.h): Create using 'echo' rather than 'cp', so that we don't
	need unistd_.h.
	(MOSTLYCLEANFILES): Remove unistd.h-t.

2006-03-03  Simon Josefsson  <jas@extundo.com>

	* build-aux/maint.mk: Add several syntax checks from CoreUtils.

2006-03-03  Simon Josefsson  <jas@extundo.com>

	* build-aux/maint.mk: Add refresh-po rule, based on ideas from
	libidn and bison.

2006-03-03  Simon Josefsson  <jas@extundo.com>

	* build-aux/maint.mk: Add indent target.

2006-03-03  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de> (tiny change)

	* m4/poll.m4 (gl_FUNC_POLL): If we deem poll(2) unacceptable, use
	our replacement poll.h in any case, to avoid a differing
	declaration from a system header.  Seen on AIX.

2006-03-01  Simon Josefsson  <jas@extundo.com>

	* lib/readline.c: Fix typo, tiny patch from Stepan Kasal
	<kasal@ucw.cz>.

2006-03-01  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/gettime (Depends-on): Add extensions module.
	* modules/nanosleep (Depends-on): Likewise.
	* modules/settime (Depends-on): Likewise.

2006-03-01  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/clock_time.m4 (gl_CLOCK_TIME): Require gl_USE_SYSTEM_EXTENSIONS,
	not merely AC_GNU_SOURCE, for the benefit of Solaris 10 when compiled
	pedantically.
	* m4/nanosleep.m4 (gl_FUNC_NANOSLEEP): Likewise.
	* m4/timespec.m4 (gl_TIMESPEC): Likewise.

	* m4/extensions.m4 (gl_USE_SYSTEM_EXTENSIONS): Use "=" with "test",
	not "==".  Reported by Ralf Wildenhues.

2006-03-01  Karl Berry  <karl@gnu.org>

	* doc/Copyright/request-*: new files, synced from gnuorg.

2006-03-01  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (Copyright/*): new entries.

2006-02-28  Simon Josefsson  <jas@extundo.com>

	* lib/getopt.c: Protect #include of unistd.h, for MSVS.

2006-02-27  Simon Josefsson  <jas@extundo.com>

	* lib/base64.h: Indent #define's.  From Jim Meyering
	<jim@meyering.net>.

2006-02-27  Jim Meyering  <jim@meyering.net>

	Revert the change of 2006-02-24, so these files can continue
	to be sync'd from gettext.
	* lib/mkdtemp.c, setenv.c, unsetenv.c: *Un*-normalize inclusion
	of `config.h'.

2006-02-26  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/intprops: New file.
	* MODULES.html.sh (Numeric conversion functions <stdlib.h>):
	Add intprops.
	* modules/getloadavg (Files): Remove lib/intprops.h.
	(Depends-on): Add intprops.
	* modules/human: Likewise.
	* modules/inttostr: Likewise.
	* modules/openat: Likewise.
	* modules/sig2str: Likewise.
	* modules/userspec: Likewise.
	* modules/utimecmp: Likewise.
	* modules/xnanosleep: Likewise.
	* modules/xstrtol: Likewise.

2006-02-24  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>  (tiny changes)

	* modules/xstrtod: Omit xstrtod.h, xstrtod.c; they're in LIB_SOURCES.
	* modules/lock-tests (TESTS): Use $(EXEEXT).
	* modules/tls-tests: Likewise.
	* modules/argp-tests: Likewise.
	(check_PROGRAMS): New var, replacing...
	(noinst_PROGRAMS, test_argp_SOURCES): Remove.

2006-02-24  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* lib/mkdtemp.c, lib/setenv.c, lib/unsetenv.c: Normalize inclusion of
	`config.h'.

2006-02-24  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/glob.c: Say "invalid" rather than "illegal" in comments.

2006-02-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Sync from coreutils.
	* m4/mkdir-p.m4 (gl_MKDIR_PARENTS): Require gl_FUNC_LCHMOD and
	gl_CHDIR_SAFER.

2006-02-22  Jim Meyering  <jim@meyering.net>

	Sync from coreutils.
	* m4/chdir-safer.m4: New file.

2006-02-20  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/getcwd.c (AT_FDCWD): Work around a bug in Solaris 9 and 10, where
	AT_FDCWD exceeds INT_MAX.
	* lib/openat.h (AT_FDCWD): Likewise.

2006-02-17  Eric Blake  <address@hidden>

	* m4/getaddrinfo.m4 (gl_GETADDRINFO): Fix caching error.

2006-02-16  Simon Josefsson  <jas@extundo.com>

	* modules/getaddrinfo (Depends-on): Add sys_socket.

2006-02-15  Simon Josefsson  <jas@extundo.com>

	* build-aux/maint.mk: Add dsyntax-check rule.

2006-02-15  Eric Blake  <ebb9@byu.net>

	* m4/sys_socket_h.m4 (gl_HEADER_SYS_SOCKET): Don't attempt using
	winsock2.h or ws2tcpip.h when sys/socket.h is present. Fixes
	'present but cannot compile' warnings on cygwin.
	* m4/socklen.m4 (gl_TYPE_SOCKLEN_T): Use gl_HEADER_SYS_SOCKET.  Don't
	use ws2tcpip.h if sys/socket.h works.
	* m4/getaddrinfo.m4 (gl_PREREQ_GETADDRINFO): Use gl_HEADER_SYS_SOCKET.
	(gl_GETADDRINFO): Don't use ws2tcpip.h when sys/socket.h is present.

2006-02-14  Simon Josefsson  <jas@extundo.com>

	* modules/maintainer-makefile (Files): Rename.

	* build-aux/GNUmakefile: Rename Makefile.maint to maint.mk
	and (the local) Makefile.cfg to maint-cfg.mk.

	* build-aux/Makefile.maint, build-aux/maint.mk: Renamed the former
	to the latter.

	* modules/maintainer-makefile: New module.

	* build-aux/Makefile.maint: New file, from GNU CoreUtils, although
	severaly stripped to make it possible to build it up from scratch
	with reliable tests.

	* build-aux/GNUmakefile: New file, from GNU CoreUtils with some
	fixes to permit overriding the default actions when configure and
	makefile are not available.

2006-02-14  Paul Eggert  <eggert@cs.ucla.edu>

	Sync from coreutils.
	* modules/lstat (Depends-on): Don't depend on xalloc.
	(License): Change from GPL to LGPL, since this is now simply a
	replacement for a libc function.

2006-02-14  Jim Meyering  <jim@meyering.net>

	Sync from coreutils.

	Eliminate the unwelcome (albeit unlikely) possibility of xmalloc
	failure on deficient systems, and simplify gnulib lgpl dependencies.
	* lib/lstat.c (rpl_lstat): Rewrite to use stat() in place of the
	xmalloc/lstat combination.  Based on a patch from Bruno Haible.

	* lib/xalloc-die.c: Remove unused definition of N_.

2006-02-14  Jim Meyering  <jim@meyering.net>

	Sync from coreutils.
	* m4/ls-mntd-fs.m4 (AC_FUNC_GETMNTENT): Invoke
	AC_CHECK_FUNCS(getmntent) unconditionally so that tests of
	$ac_cv_func_getmntent (e.g., in gl_LIST_MOUNTED_FILE_SYSTEMS) need not
	double-quote uses of that variable, to accommodate the rare case in
	which getmntent is available in none of the libraries checked.  This
	happens at least on FreeBSD 5.0.

2006-02-13  Simon Josefsson  <jas@extundo.com>

	* gnulib-tool (Usage): Fix --import, from
	karl@freefriends.org (Karl Berry).

2006-02-13  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-fmtstream.c: Restore another bugfix lost on 2005-12-12

2006-02-07  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-namefrob.h: Restore changes accidentally lost during the
	"autoupdate" on 2005-12-12.

2006-02-07  Paul Eggert  <eggert@cs.ucla.edu>

	* modules/closeout (Depends-on): Remove atexit.

2006-02-07  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/closeout.c (close_stdout): Don't assume 'bool' converts nonzero
	ints to 0 or 1, as this isn't true for the stdbool.h substitute.

2006-02-05  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/extensions.m4 (gl_USE_SYSTEM_EXTENSIONS): Don't #define
	__EXTENSIONS__ if this causes compilation to fail.  Problem
	reported by Nelson H. F. Beebe with Solaris 10 and Sun C 5.7
	c89 -D_XOPEN_SOURCE -D_XOPEN_SOURCE_EXTENDED.

2006-01-27  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/fnmatch.c (L_): Renamed from L, to work around a bug in
	Mac OS X 10.3.9 with GCC 3 reported by Claudio Fontana in
	<http://lists.gnu.org/archive/html/bug-gnulib/2006-01/msg00074.html>.
	All uses changed.

2006-01-26  Simon Josefsson  <jas@extundo.com>

	* lib/socket_.h: Set WINVER to 0x0501, to make sure getaddrinfo
	prototype is visible on mingw32.

	* lib/getaddrinfo.h: Define EAI_ADDRFAMILY and EAI_SYSTEM if not set,
	for mingw32.

	* lib/gai_strerror.c, getaddrinfo.h: Protect netdb.h #include (for
	mingw32).

2006-01-26  Paul Eggert  <eggert@cs.ucla.edu>

	* lib/fts.c (diropen): Open with O_NOCTTY | O_NONBLOCK too.  Don't
	attempt to open for write; this always fails, at least on POSIX
	hosts.  This reinstates the 2006-01-09 change, which was
	inadvertently removed.

2006-01-26  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Use "trap 'exit $?' instead of "trap :".
	Reported by Paul Eggert.

2006-01-26  Bruno Haible  <bruno@clisp.org>
	    Paul Eggert  <eggert@cs.ucla.edu>

	* lib/stdbool_.h (_Bool)
	[(! (defined __cplusplus || defined __BEOS__)
	  && !defined __GNUC__
	  && !(defined __HP_cc || defined __xlc__
	       || (defined __SUNPRO_C && (__SUNPRO_C < 0x550 || __STDC__ == 1))
	       || defined __sgi))]:
	#define to signed char in these cases too; this simplifies
	the code (so that we don't have to worry about HP-UX, AIX, SunPRO,
	etc., separately) and makes it more conservative.

2006-01-25  Simon Josefsson  <jas@extundo.com>

	* m4/getaddrinfo.m4: Look for getaddrinfo inside ws2tcip.h and
	-lws2_32.  Protect sys/socket.h and netdb.h #include's.  Include
	ws2tcpip.h with WINVER=0x0501.  All for mingw32.

2006-01-25  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/argp-namefrob.h: Bugfix. Remove stray #

2006-01-25  Paul Eggert  <eggert@cs.ucla.edu>

	* m4/stdbool.m4 (AC_HEADER_STDBOOL): Check for xlc bug if __GCC__ too,
	so that we test the test.
	Check for yet another HP-UX cc bug involving *bool |= bool.

2006-01-25  Karl Berry  <karl@gnu.org>

	* config/srclist.txt (vasnprintf.c): sync lost.

2006-01-25  Jim Meyering  <jim@meyering.net>

	Sync from the stable (b5) branch of coreutils:

	* lib/fts.c (fts_children): Don't let close() clobber errno from
	failed fchdir().

	* lib/fts.c (fts_stat): When following a symlink-to-directory,
	don't necessarily interpret stat-fails+lstat-succeeds as indicating
	a dangling symlink.  That can also happen at least for ELOOP.
	The fix: return FTS_SLNONE only when the stat errno is ENOENT.
	FYI, this bug predates the inclusion of fts.c in coreutils.

	* lib/fts.c (fts_open): Put new maxarglen declaration and uses
	in their own block, so pre-c99 compilers don't object.

	Avoid the double-free (first in fts_read, second in fts_close) that
	would occur when an `active' directory is made inaccessible (e.g.,
	via chmod a-x) during a traversal.
	* lib/fts.c (fts_read): After a failed fchdir, update sp->fts_cur
	before returning.  Reproduce this failure by
	mkdir -p a/b; cd a; chmod a-x . b
	Reported by Stavros Passas.

2006-01-25  Jim Meyering  <jim@meyering.net>

	* lib/fileblocks.c: Remove more useless parentheses.
	* lib/readutmp.h: Likewise.

2006-01-25  Bruno Haible  <bruno@clisp.org>

	* lib/stdbool_.h (_Bool) [IRIX cc]: Define as 'signed char', to avoid
	warnings.
	Reported by Paul Eggert.

2006-01-25  Bruno Haible  <bruno@clisp.org>

	* gnulib-tool (func_import): Use "trap :" instead of "trap -" to get
	rid of a trap command. For Solaris sh.
